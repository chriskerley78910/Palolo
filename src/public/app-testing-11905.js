/**
 * @license Proprietary text 2.0.15 Copyright jQuery Foundation and other contributors.
 * Released under MIT license, http://github.com/requirejs/text/LICENSE
 */
define("text",["module"],function(e){"use strict";var t,n,i,s,r,o=["Msxml2.XMLHTTP","Microsoft.XMLHTTP","Msxml2.XMLHTTP.4.0"],a=/^\s*<\?xml(\s)+version=[\'\"](\d)*.(\d)*[\'\"](\s)*\?>/im,c=/<body[^>]*>\s*([\s\S]+)\s*<\/body>/im,d="undefined"!=typeof location&&location.href,u=d&&location.protocol&&location.protocol.replace(/\:/,""),h=d&&location.hostname,l=d&&(location.port||void 0),p={},f=e.config&&e.config()||{};function useDefault(e,t){return void 0===e||""===e?t:e}return t={version:"2.0.15",strip:function(e){if(e){var t=(e=e.replace(a,"")).match(c);t&&(e=t[1])}else e="";return e},jsEscape:function(e){return e.replace(/(['\\])/g,"\\$1").replace(/[\f]/g,"\\f").replace(/[\b]/g,"\\b").replace(/[\n]/g,"\\n").replace(/[\t]/g,"\\t").replace(/[\r]/g,"\\r").replace(/[\u2028]/g,"\\u2028").replace(/[\u2029]/g,"\\u2029")},createXhr:f.createXhr||function(){var e,t,n;if("undefined"!=typeof XMLHttpRequest)return new XMLHttpRequest;if("undefined"!=typeof ActiveXObject)for(t=0;t<3;t+=1){n=o[t];try{e=new ActiveXObject(n)}catch(e){}if(e){o=[n];break}}return e},parseName:function(e){var t,n,i,s=!1,r=e.lastIndexOf("."),o=0===e.indexOf("./")||0===e.indexOf("../");return-1!==r&&(!o||r>1)?(t=e.substring(0,r),n=e.substring(r+1)):t=e,-1!==(r=(i=n||t).indexOf("!"))&&(s="strip"===i.substring(r+1),i=i.substring(0,r),n?n=i:t=i),{moduleName:t,ext:n,strip:s}},xdRegExp:/^((\w+)\:)?\/\/([^\/\\]+)/,useXhr:function(e,n,i,s){var r,o,a,c=t.xdRegExp.exec(e);return!c||(r=c[2],a=(o=(o=c[3]).split(":"))[1],o=o[0],(!r||r===n)&&(!o||o.toLowerCase()===i.toLowerCase())&&(!a&&!o||function isSamePort(e,t,n,i){if(t===i)return!0;if(e===n){if("http"===e)return useDefault(t,"80")===useDefault(i,"80");if("https"===e)return useDefault(t,"443")===useDefault(i,"443")}return!1}(r,a,n,s)))},finishLoad:function(e,n,i,s){i=n?t.strip(i):i,f.isBuild&&(p[e]=i),s(i)},load:function(e,n,i,s){if(s&&s.isBuild&&!s.inlineText)i();else{f.isBuild=s&&s.isBuild;var r=t.parseName(e),o=r.moduleName+(r.ext?"."+r.ext:""),a=n.toUrl(o),c=f.useXhr||t.useXhr;0!==a.indexOf("empty:")?!d||c(a,u,h,l)?t.get(a,function(n){t.finishLoad(e,r.strip,n,i)},function(e){i.error&&i.error(e)}):n([o],function(e){t.finishLoad(r.moduleName+"."+r.ext,r.strip,e,i)}):i()}},write:function(e,n,i,s){if(p.hasOwnProperty(n)){var r=t.jsEscape(p[n]);i.asModule(e+"!"+n,"define(function () { return '"+r+"';});\n")}},writeFile:function(e,n,i,s,r){var o=t.parseName(n),a=o.ext?"."+o.ext:"",c=o.moduleName+a,d=i.toUrl(o.moduleName+a)+".js";t.load(c,i,function(n){var i=function(e){return s(d,e)};i.asModule=function(e,t){return s.asModule(e,d,t)},t.write(e,c,i,r)},r)}},"node"===f.env||!f.env&&"undefined"!=typeof process&&process.versions&&process.versions.node&&!process.versions["node-webkit"]&&!process.versions["atom-shell"]?(n=require.nodeRequire("fs"),t.get=function(e,t,i){try{var s=n.readFileSync(e,"utf8");"\ufeff"===s[0]&&(s=s.substring(1)),t(s)}catch(e){i&&i(e)}}):"xhr"===f.env||!f.env&&t.createXhr()?t.get=function(e,n,i,s){var r,o=t.createXhr();if(o.open("GET",e,!0),s)for(r in s)s.hasOwnProperty(r)&&o.setRequestHeader(r.toLowerCase(),s[r]);f.onXhr&&f.onXhr(o,e),o.onreadystatechange=function(t){var s,r;4===o.readyState&&((s=o.status||0)>399&&s<600?((r=new Error(e+" HTTP status: "+s)).xhr=o,i&&i(r)):n(o.responseText),f.onXhrComplete&&f.onXhrComplete(o,e))},o.send(null)}:"rhino"===f.env||!f.env&&"undefined"!=typeof Packages&&"undefined"!=typeof java?t.get=function(e,t){var n,i,s=new java.io.File(e),r=java.lang.System.getProperty("line.separator"),o=new java.io.BufferedReader(new java.io.InputStreamReader(new java.io.FileInputStream(s),"utf-8")),a="";try{for(n=new java.lang.StringBuffer,(i=o.readLine())&&i.length()&&65279===i.charAt(0)&&(i=i.substring(1)),null!==i&&n.append(i);null!==(i=o.readLine());)n.append(r),n.append(i);a=String(n.toString())}finally{o.close()}t(a)}:("xpconnect"===f.env||!f.env&&"undefined"!=typeof components&&components.classes&&components.interfaces)&&(i=components.classes,s=components.interfaces,components.utils.import("resource://gre/modules/FileUtils.jsm"),r="@mozilla.org/windows-registry-key;1"in i,t.get=function(e,t){var n,o,a,c={};r&&(e=e.replace(/\//g,"\\")),a=new FileUtils.File(e);try{(n=i["@mozilla.org/network/file-input-stream;1"].createInstance(s.nsIFileInputStream)).init(a,1,0,!1),(o=i["@mozilla.org/intl/converter-input-stream;1"].createInstance(s.nsIConverterInputStream)).init(n,"utf-8",n.available(),s.nsIConverterInputStream.DEFAULT_REPLACEMENT_CHARACTER),o.readString(n.available(),c),o.close(),n.close(),t(c.value)}catch(e){throw new Error((a&&a.path||"")+": "+e)}}),t}),function(t){var n=this||(0,eval)("this"),i=n.document,r=n.navigator,o=n.jQuery,u=n.JSON;!function(e){"function"==typeof define&&define.amd?define("ko",["exports","require"],e):"object"==typeof exports&&"object"==typeof module?e(module.exports||exports):e(n.ko={})}(function(a,w){function J(e,t){return(null===e||typeof e in _)&&e===t}function S(e,n){var i;return function(){i||(i=M.a.setTimeout(function(){i=t,e()},n))}}function T(e,t){var n;return function(){clearTimeout(n),n=M.a.setTimeout(e,t)}}function U(e,t){t&&t!==D?"beforeChange"===t?this.Ob(e):this.Ja(e,t):this.Pb(e)}function V(e,t){null!==t&&t.k&&t.k()}function W(e,t){var n=this.Mc,i=n[F];i.T||(this.ob&&this.Oa[t]?(n.Sb(t,e,this.Oa[t]),this.Oa[t]=null,--this.ob):i.s[t]||n.Sb(t,e,i.t?{$:e}:n.yc(e)),e.Ha&&e.Hc())}function K(e,t,n,i){M.d[e]={init:function(e,s,r,o,a){var c,d;return M.m(function(){var r=s(),o=M.a.c(r),u=(o=!n!=!o,!d);(u||t||o!==c)&&(u&&M.xa.Ca()&&(d=M.a.wa(M.f.childNodes(e),!0)),o?(u||M.f.fa(e,M.a.wa(d)),M.hb(i?i(a,r):a,e)):M.f.za(e),c=o)},null,{i:e}),{controlsDescendantBindings:!0}}},M.h.va[e]=!1,M.f.aa[e]=!0}var C,P,x,R,E,I,M=void 0!==a?a:{};M.b=function(e,t){for(var n=e.split("."),i=M,s=0;s<n.length-1;s++)i=i[n[s]];i[n[n.length-1]]=t},M.H=function(e,t,n){e[t]=n},M.version="3.4.2",M.b("version",M.version),M.options={deferUpdates:!1,useOnlyNativeEvents:!1},M.a=function(){function b(e,t){for(var n in e)e.hasOwnProperty(n)&&t(n,e[n])}function c(e,t){if(t)for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);return e}function d(e,t){return e.__proto__=t,e}function e(e,t,n,i){var s=e[t].match(m)||[];M.a.r(n.match(m),function(e){M.a.ra(s,e,i)}),e[t]=s.join(" ")}var s={__proto__:[]}instanceof Array,a="function"==typeof Symbol,h={},l={};h[r&&/Firefox\/2/i.test(r.userAgent)?"KeyboardEvent":"UIEvents"]=["keyup","keydown","keypress"],h.MouseEvents="click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave".split(" "),b(h,function(e,t){if(t.length)for(var n=0,i=t.length;n<i;n++)l[t[n]]=e});var p={propertychange:!0},f=i&&function(){for(var e=3,n=i.createElement("div"),s=n.getElementsByTagName("i");n.innerHTML="\x3c!--[if gt IE "+ ++e+"]><i></i><![endif]--\x3e",s[0];);return 4<e?e:t}(),m=/\S+/g;return{gc:["authenticity_token",/^__RequestVerificationToken(_.*)?$/],r:function(e,t){for(var n=0,i=e.length;n<i;n++)t(e[n],n)},o:function(e,t){if("function"==typeof Array.prototype.indexOf)return Array.prototype.indexOf.call(e,t);for(var n=0,i=e.length;n<i;n++)if(e[n]===t)return n;return-1},Vb:function(e,t,n){for(var i=0,s=e.length;i<s;i++)if(t.call(n,e[i],i))return e[i];return null},Na:function(e,t){var n=M.a.o(e,t);0<n?e.splice(n,1):0===n&&e.shift()},Wb:function(e){for(var t=[],n=0,i=(e=e||[]).length;n<i;n++)0>M.a.o(t,e[n])&&t.push(e[n]);return t},ib:function(e,t){for(var n=[],i=0,s=(e=e||[]).length;i<s;i++)n.push(t(e[i],i));return n},Ma:function(e,t){for(var n=[],i=0,s=(e=e||[]).length;i<s;i++)t(e[i],i)&&n.push(e[i]);return n},ta:function(e,t){if(t instanceof Array)e.push.apply(e,t);else for(var n=0,i=t.length;n<i;n++)e.push(t[n]);return e},ra:function(e,t,n){var i=M.a.o(M.a.Bb(e),t);0>i?n&&e.push(t):n||e.splice(i,1)},la:s,extend:c,$a:d,ab:s?d:c,D:b,Ea:function(e,t){if(!e)return e;var n,i={};for(n in e)e.hasOwnProperty(n)&&(i[n]=t(e[n],n,e));return i},rb:function(e){for(;e.firstChild;)M.removeNode(e.firstChild)},nc:function(e){for(var t=((e=M.a.W(e))[0]&&e[0].ownerDocument||i).createElement("div"),n=0,s=e.length;n<s;n++)t.appendChild(M.ba(e[n]));return t},wa:function(e,t){for(var n=0,i=e.length,s=[];n<i;n++){var r=e[n].cloneNode(!0);s.push(t?M.ba(r):r)}return s},fa:function(e,t){if(M.a.rb(e),t)for(var n=0,i=t.length;n<i;n++)e.appendChild(t[n])},uc:function(e,t){var n=e.nodeType?[e]:e;if(0<n.length){for(var i=n[0],s=i.parentNode,r=0,o=t.length;r<o;r++)s.insertBefore(t[r],i);for(r=0,o=n.length;r<o;r++)M.removeNode(n[r])}},Ba:function(e,t){if(e.length){for(t=8===t.nodeType&&t.parentNode||t;e.length&&e[0].parentNode!==t;)e.splice(0,1);for(;1<e.length&&e[e.length-1].parentNode!==t;)e.length--;if(1<e.length){var n=e[0],i=e[e.length-1];for(e.length=0;n!==i;)e.push(n),n=n.nextSibling;e.push(i)}}return e},wc:function(e,t){7>f?e.setAttribute("selected",t):e.selected=t},cb:function(e){return null===e||e===t?"":e.trim?e.trim():e.toString().replace(/^[\s\xa0]+|[\s\xa0]+$/g,"")},sd:function(e,t){return e=e||"",!(t.length>e.length)&&e.substring(0,t.length)===t},Rc:function(e,t){if(e===t)return!0;if(11===e.nodeType)return!1;if(t.contains)return t.contains(3===e.nodeType?e.parentNode:e);if(t.compareDocumentPosition)return 16==(16&t.compareDocumentPosition(e));for(;e&&e!=t;)e=e.parentNode;return!!e},qb:function(e){return M.a.Rc(e,e.ownerDocument.documentElement)},Tb:function(e){return!!M.a.Vb(e,M.a.qb)},A:function(e){return e&&e.tagName&&e.tagName.toLowerCase()},Zb:function(e){return M.onError?function(){try{return e.apply(this,arguments)}catch(e){throw M.onError&&M.onError(e),e}}:e},setTimeout:function(e,t){return setTimeout(M.a.Zb(e),t)},dc:function(e){setTimeout(function(){throw M.onError&&M.onError(e),e},0)},q:function(e,t,n){var i=M.a.Zb(n);if(n=f&&p[t],M.options.useOnlyNativeEvents||n||!o)if(n||"function"!=typeof e.addEventListener){if(void 0===e.attachEvent)throw Error("Browser doesn't support addEventListener or attachEvent");var s=function(t){i.call(e,t)},r="on"+t;e.attachEvent(r,s),M.a.G.qa(e,function(){e.detachEvent(r,s)})}else e.addEventListener(t,i,!1);else o(e).bind(t,i)},Fa:function(e,t){if(!e||!e.nodeType)throw Error("element must be a DOM node when calling triggerEvent");var s;if(s=!("input"!==M.a.A(e)||!e.type||"click"!=t.toLowerCase())&&("checkbox"==(s=e.type)||"radio"==s),M.options.useOnlyNativeEvents||!o||s)if("function"==typeof i.createEvent){if("function"!=typeof e.dispatchEvent)throw Error("The supplied element doesn't support dispatchEvent");(s=i.createEvent(l[t]||"HTMLEvents")).initEvent(t,!0,!0,n,0,0,0,0,0,!1,!1,!1,!1,0,e),e.dispatchEvent(s)}else if(s&&e.click)e.click();else{if(void 0===e.fireEvent)throw Error("Browser doesn't support triggering events");e.fireEvent("on"+t)}else o(e).trigger(t)},c:function(e){return M.I(e)?e():e},Bb:function(e){return M.I(e)?e.p():e},fb:function(t,n,i){var s;n&&("object"==typeof t.classList?(s=t.classList[i?"add":"remove"],M.a.r(n.match(m),function(e){s.call(t.classList,e)})):"string"==typeof t.className.baseVal?e(t.className,"baseVal",n,i):e(t,"className",n,i))},bb:function(e,n){var i=M.a.c(n);null!==i&&i!==t||(i="");var s=M.f.firstChild(e);!s||3!=s.nodeType||M.f.nextSibling(s)?M.f.fa(e,[e.ownerDocument.createTextNode(i)]):s.data=i,M.a.Wc(e)},vc:function(e,t){if(e.name=t,7>=f)try{e.mergeAttributes(i.createElement("<input name='"+e.name+"'/>"),!1)}catch(e){}},Wc:function(e){9<=f&&(e=1==e.nodeType?e:e.parentNode).style&&(e.style.zoom=e.style.zoom)},Sc:function(e){if(f){var t=e.style.width;e.style.width=0,e.style.width=t}},nd:function(e,t){e=M.a.c(e),t=M.a.c(t);for(var n=[],i=e;i<=t;i++)n.push(i);return n},W:function(e){for(var t=[],n=0,i=e.length;n<i;n++)t.push(e[n]);return t},bc:function(e){return a?Symbol(e):e},xd:6===f,yd:7===f,C:f,ic:function(e,t){for(var n=M.a.W(e.getElementsByTagName("input")).concat(M.a.W(e.getElementsByTagName("textarea"))),i="string"==typeof t?function(e){return e.name===t}:function(e){return t.test(e.name)},s=[],r=n.length-1;0<=r;r--)i(n[r])&&s.push(n[r]);return s},kd:function(e){return"string"==typeof e&&(e=M.a.cb(e))?u&&u.parse?u.parse(e):new Function("return "+e)():null},Gb:function(e,t,n){if(!u||!u.stringify)throw Error("Cannot find JSON.stringify(). Some browsers (e.g., IE < 8) don't support it natively, but you can overcome this by adding a script reference to json2.js, downloadable from http://www.json.org/json2.js");return u.stringify(M.a.c(e),t,n)},ld:function(e,t,n){var s=(n=n||{}).params||{},r=n.includeFields||this.gc,o=e;if("object"==typeof e&&"form"===M.a.A(e)){o=e.action;for(var a=r.length-1;0<=a;a--)for(var c=M.a.ic(e,r[a]),d=c.length-1;0<=d;d--)s[c[d].name]=c[d].value}t=M.a.c(t);var u=i.createElement("form");for(var h in u.style.display="none",u.action=o,u.method="post",t)(e=i.createElement("input")).type="hidden",e.name=h,e.value=M.a.Gb(M.a.c(t[h])),u.appendChild(e);b(s,function(e,t){var n=i.createElement("input");n.type="hidden",n.name=e,n.value=t,u.appendChild(n)}),i.body.appendChild(u),n.submitter?n.submitter(u):u.submit(),setTimeout(function(){u.parentNode.removeChild(u)},0)}}}(),M.b("utils",M.a),M.b("utils.arrayForEach",M.a.r),M.b("utils.arrayFirst",M.a.Vb),M.b("utils.arrayFilter",M.a.Ma),M.b("utils.arrayGetDistinctValues",M.a.Wb),M.b("utils.arrayIndexOf",M.a.o),M.b("utils.arrayMap",M.a.ib),M.b("utils.arrayPushAll",M.a.ta),M.b("utils.arrayRemoveItem",M.a.Na),M.b("utils.extend",M.a.extend),M.b("utils.fieldsIncludedWithJsonPost",M.a.gc),M.b("utils.getFormFields",M.a.ic),M.b("utils.peekObservable",M.a.Bb),M.b("utils.postJson",M.a.ld),M.b("utils.parseJson",M.a.kd),M.b("utils.registerEventHandler",M.a.q),M.b("utils.stringifyJson",M.a.Gb),M.b("utils.range",M.a.nd),M.b("utils.toggleDomNodeCssClass",M.a.fb),M.b("utils.triggerEvent",M.a.Fa),M.b("utils.unwrapObservable",M.a.c),M.b("utils.objectForEach",M.a.D),M.b("utils.addOrRemoveItem",M.a.ra),M.b("utils.setTextContent",M.a.bb),M.b("unwrap",M.a.c),Function.prototype.bind||(Function.prototype.bind=function(e){var t=this;if(1===arguments.length)return function(){return t.apply(e,arguments)};var n=Array.prototype.slice.call(arguments,1);return function(){var i=n.slice(0);return i.push.apply(i,arguments),t.apply(e,i)}}),M.a.e=new function(){function a(s,r){var o=s[n];if(!o||"null"===o||!i[o]){if(!r)return t;o=s[n]="ko"+e++,i[o]={}}return i[o]}var e=0,n="__ko__"+(new Date).getTime(),i={};return{get:function(e,n){var i=a(e,!1);return i===t?t:i[n]},set:function(e,n,i){i===t&&a(e,!1)===t||(a(e,!0)[n]=i)},clear:function(e){var t=e[n];return!!t&&(delete i[t],e[n]=null,!0)},J:function(){return e+++n}}},M.b("utils.domData",M.a.e),M.b("utils.domData.clear",M.a.e.clear),M.a.G=new function(){function b(n,i){var s=M.a.e.get(n,e);return s===t&&i&&(s=[],M.a.e.set(n,e,s)),s}function c(e){if(t=b(e,!1))for(var t=t.slice(0),n=0;n<t.length;n++)t[n](e);if(M.a.e.clear(e),M.a.G.cleanExternalData(e),i[e.nodeType])for(t=e.firstChild;e=t;)t=e.nextSibling,8===e.nodeType&&c(e)}var e=M.a.e.J(),n={1:!0,8:!0,9:!0},i={1:!0,9:!0};return{qa:function(e,t){if("function"!=typeof t)throw Error("Callback must be a function");b(e,!0).push(t)},tc:function(n,i){var s=b(n,!1);s&&(M.a.Na(s,i),0==s.length&&M.a.e.set(n,e,t))},ba:function(e){if(n[e.nodeType]&&(c(e),i[e.nodeType])){var t=[];M.a.ta(t,e.getElementsByTagName("*"));for(var s=0,r=t.length;s<r;s++)c(t[s])}return e},removeNode:function(e){M.ba(e),e.parentNode&&e.parentNode.removeChild(e)},cleanExternalData:function(e){o&&"function"==typeof o.cleanData&&o.cleanData([e])}}},M.ba=M.a.G.ba,M.removeNode=M.a.G.removeNode,M.b("cleanNode",M.ba),M.b("removeNode",M.removeNode),M.b("utils.domNodeDisposal",M.a.G),M.b("utils.domNodeDisposal.addDisposeCallback",M.a.G.qa),M.b("utils.domNodeDisposal.removeDisposeCallback",M.a.G.tc),C=[0,"",""],E={thead:P=[1,"<table>","</table>"],tbody:P,tfoot:P,tr:[2,"<table><tbody>","</tbody></table>"],td:x=[3,"<table><tbody><tr>","</tr></tbody></table>"],th:x,option:R=[1,"<select multiple='multiple'>","</select>"],optgroup:R},I=8>=M.a.C,M.a.na=function(e,t){var s;if(o){if(o.parseHTML)s=o.parseHTML(e,t)||[];else if((s=o.clean([e],t))&&s[0]){for(var r=s[0];r.parentNode&&11!==r.parentNode.nodeType;)r=r.parentNode;r.parentNode&&r.parentNode.removeChild(r)}}else{(s=t)||(s=i),r=s.parentWindow||s.defaultView||n;var a,c=M.a.cb(e).toLowerCase(),d=s.createElement("div");for(a=(c=c.match(/^<([a-z]+)[ >]/))&&E[c[1]]||C,c=a[0],a="ignored<div>"+a[1]+e+a[2]+"</div>","function"==typeof r.innerShiv?d.appendChild(r.innerShiv(a)):(I&&s.appendChild(d),d.innerHTML=a,I&&d.parentNode.removeChild(d));c--;)d=d.lastChild;s=M.a.W(d.lastChild.childNodes)}return s},M.a.Eb=function(e,n){if(M.a.rb(e),null!==(n=M.a.c(n))&&n!==t)if("string"!=typeof n&&(n=n.toString()),o)o(e).html(n);else for(var i=M.a.na(n,e.ownerDocument),s=0;s<i.length;s++)e.appendChild(i[s])},M.b("utils.parseHtmlFragment",M.a.na),M.b("utils.setHtml",M.a.Eb),M.N=function(){var e={};return{yb:function(t){if("function"!=typeof t)throw Error("You can only pass a function to ko.memoization.memoize()");var n=(4294967296*(1+Math.random())|0).toString(16).substring(1)+(4294967296*(1+Math.random())|0).toString(16).substring(1);return e[n]=t,"\x3c!--[ko_memo:"+n+"]--\x3e"},Bc:function(n,i){var s=e[n];if(s===t)throw Error("Couldn't find any memo with ID "+n+". Perhaps it's already been unmemoized.");try{return s.apply(null,i||[]),!0}finally{delete e[n]}},Cc:function(e,t){var n=[];!function b(e,t){if(e)if(8==e.nodeType)null!=(n=M.N.pc(e.nodeValue))&&t.push({Qc:e,hd:n});else if(1==e.nodeType)for(var n=0,i=e.childNodes,s=i.length;n<s;n++)b(i[n],t)}(e,n);for(var i=0,s=n.length;i<s;i++){var r=n[i].Qc,o=[r];t&&M.a.ta(o,t),M.N.Bc(n[i].hd,o),r.nodeValue="",r.parentNode&&r.parentNode.removeChild(r)}},pc:function(e){return(e=e.match(/^\[ko_memo\:(.*?)\]$/))?e[1]:null}}}(),M.b("memoization",M.N),M.b("memoization.memoize",M.N.yb),M.b("memoization.unmemoize",M.N.Bc),M.b("memoization.parseMemoText",M.N.pc),M.b("memoization.unmemoizeDomNodeAndDescendants",M.N.Cc),M.Z=function(){function b(){if(t)for(var n,i=t,s=0;r<t;)if(n=e[r++]){if(r>i){if(5e3<=++s){r=t,M.a.dc(Error("'Too much recursion' after processing "+s+" task groups."));break}i=t}try{n()}catch(e){M.a.dc(e)}}}function c(){b(),r=t=e.length=0}var e=[],t=0,s=1,r=0;return{scheduler:n.MutationObserver?function(e){var t=i.createElement("div");return new MutationObserver(e).observe(t,{attributes:!0}),function(){t.classList.toggle("foo")}}(c):i&&"onreadystatechange"in i.createElement("script")?function(e){var t=i.createElement("script");t.onreadystatechange=function(){t.onreadystatechange=null,i.documentElement.removeChild(t),t=null,e()},i.documentElement.appendChild(t)}:function(e){setTimeout(e,0)},Za:function(n){return t||M.Z.scheduler(c),e[t++]=n,s++},cancel:function(n){(n-=s-t)>=r&&n<t&&(e[n]=null)},resetForTesting:function(){var n=t-r;return r=t=e.length=0,n},rd:b}}(),M.b("tasks",M.Z),M.b("tasks.schedule",M.Z.Za),M.b("tasks.runEarly",M.Z.rd),M.Aa={throttle:function(e,t){e.throttleEvaluation=t;var n=null;return M.B({read:e,write:function(i){clearTimeout(n),n=M.a.setTimeout(function(){e(i)},t)}})},rateLimit:function(e,t){var n,i,s;"number"==typeof t?n=t:(n=t.timeout,i=t.method),e.gb=!1,s="notifyWhenChangesStop"==i?T:S,e.Wa(function(e){return s(e,n)})},deferred:function(e,n){if(!0!==n)throw Error("The 'deferred' extender only accepts the value 'true', because it is not supported to turn deferral off once enabled.");e.gb||(e.gb=!0,e.Wa(function(n){var i,s=!1;return function(){if(!s){M.Z.cancel(i),i=M.Z.Za(n);try{s=!0,e.notifySubscribers(t,"dirty")}finally{s=!1}}}}))},notify:function(e,t){e.equalityComparer="always"==t?null:J}};var _={undefined:1,boolean:1,number:1,string:1};M.b("extenders",M.Aa),M.zc=function(e,t,n){this.$=e,this.jb=t,this.Pc=n,this.T=!1,M.H(this,"dispose",this.k)},M.zc.prototype.k=function(){this.T=!0,this.Pc()},M.K=function(){M.a.ab(this,O),O.ub(this)};var D="change",O={ub:function(e){e.F={change:[]},e.Qb=1},Y:function(e,t,n){var i=this;n=n||D;var s=new M.zc(i,t?e.bind(t):e,function(){M.a.Na(i.F[n],s),i.Ka&&i.Ka(n)});return i.ua&&i.ua(n),i.F[n]||(i.F[n]=[]),i.F[n].push(s),s},notifySubscribers:function(e,t){if((t=t||D)===D&&this.Kb(),this.Ra(t)){var n=t===D&&this.Fc||this.F[t].slice(0);try{M.l.Xb();for(var i,s=0;i=n[s];++s)i.T||i.jb(e)}finally{M.l.end()}}},Pa:function(){return this.Qb},Zc:function(e){return this.Pa()!==e},Kb:function(){++this.Qb},Wa:function(e){var t,n,i,s,r=this,o=M.I(r);r.Ja||(r.Ja=r.notifySubscribers,r.notifySubscribers=U);var a=e(function(){r.Ha=!1,o&&s===r&&(s=r.Mb?r.Mb():r());var e=n||r.Ua(i,s);n=t=!1,e&&r.Ja(i=s)});r.Pb=function(e){r.Fc=r.F[D].slice(0),r.Ha=t=!0,s=e,a()},r.Ob=function(e){t||(i=e,r.Ja(e,"beforeChange"))},r.Hc=function(){r.Ua(i,r.p(!0))&&(n=!0)}},Ra:function(e){return this.F[e]&&this.F[e].length},Xc:function(e){if(e)return this.F[e]&&this.F[e].length||0;var t=0;return M.a.D(this.F,function(e,n){"dirty"!==e&&(t+=n.length)}),t},Ua:function(e,t){return!this.equalityComparer||!this.equalityComparer(e,t)},extend:function(e){var t=this;return e&&M.a.D(e,function(e,n){var i=M.Aa[e];"function"==typeof i&&(t=i(t,n)||t)}),t}};M.H(O,"subscribe",O.Y),M.H(O,"extend",O.extend),M.H(O,"getSubscriptionsCount",O.Xc),M.a.la&&M.a.$a(O,Function.prototype),M.K.fn=O,M.lc=function(e){return null!=e&&"function"==typeof e.Y&&"function"==typeof e.notifySubscribers},M.b("subscribable",M.K),M.b("isSubscribable",M.lc),M.xa=M.l=function(){function b(n){t.push(e),e=n}function c(){e=t.pop()}var e,t=[],n=0;return{Xb:b,end:c,sc:function(t){if(e){if(!M.lc(t))throw Error("Only subscribable things can act as dependencies");e.jb.call(e.Lc,t,t.Gc||(t.Gc=++n))}},w:function(e,t,n){try{return b(),e.apply(t,n||[])}finally{c()}},Ca:function(){if(e)return e.m.Ca()},Va:function(){if(e)return e.Va}}}(),M.b("computedContext",M.xa),M.b("computedContext.getDependenciesCount",M.xa.Ca),M.b("computedContext.isInitial",M.xa.Va),M.b("ignoreDependencies",M.wd=M.l.w);var L=M.a.bc("_latestValue");M.O=function(e){function c(){return 0<arguments.length?(c.Ua(c[L],arguments[0])&&(c.ia(),c[L]=arguments[0],c.ha()),this):(M.l.sc(c),c[L])}return c[L]=e,M.a.la||M.a.extend(c,M.K.fn),M.K.fn.ub(c),M.a.ab(c,A),M.options.deferUpdates&&M.Aa.deferred(c,!0),c};var A={equalityComparer:J,p:function(){return this[L]},ha:function(){this.notifySubscribers(this[L])},ia:function(){this.notifySubscribers(this[L],"beforeChange")}};M.a.la&&M.a.$a(A,M.K.fn);var N=M.O.md="__ko_proto__";A[N]=M.O,M.Qa=function(e,n){return null!==e&&e!==t&&e[N]!==t&&(e[N]===n||M.Qa(e[N],n))},M.I=function(e){return M.Qa(e,M.O)},M.Da=function(e){return!!("function"==typeof e&&e[N]===M.O||"function"==typeof e&&e[N]===M.B&&e.$c)},M.b("observable",M.O),M.b("isObservable",M.I),M.b("isWriteableObservable",M.Da),M.b("isWritableObservable",M.Da),M.b("observable.fn",A),M.H(A,"peek",A.p),M.H(A,"valueHasMutated",A.ha),M.H(A,"valueWillMutate",A.ia),M.ma=function(e){if("object"!=typeof(e=e||[])||!("length"in e))throw Error("The argument passed when initializing an observable array must be an array, or null, or undefined.");return e=M.O(e),M.a.ab(e,M.ma.fn),e.extend({trackArrayChanges:!0})},M.ma.fn={remove:function(e){for(var t=this.p(),n=[],i="function"!=typeof e||M.I(e)?function(t){return t===e}:e,s=0;s<t.length;s++){var r=t[s];i(r)&&(0===n.length&&this.ia(),n.push(r),t.splice(s,1),s--)}return n.length&&this.ha(),n},removeAll:function(e){if(e===t){var n=this.p(),i=n.slice(0);return this.ia(),n.splice(0,n.length),this.ha(),i}return e?this.remove(function(t){return 0<=M.a.o(e,t)}):[]},destroy:function(e){var t=this.p(),n="function"!=typeof e||M.I(e)?function(t){return t===e}:e;this.ia();for(var i=t.length-1;0<=i;i--)n(t[i])&&(t[i]._destroy=!0);this.ha()},destroyAll:function(e){return e===t?this.destroy(function(){return!0}):e?this.destroy(function(t){return 0<=M.a.o(e,t)}):[]},indexOf:function(e){var t=this();return M.a.o(t,e)},replace:function(e,t){var n=this.indexOf(e);0<=n&&(this.ia(),this.p()[n]=t,this.ha())}},M.a.la&&M.a.$a(M.ma.fn,M.O.fn),M.a.r("pop push reverse shift sort splice unshift".split(" "),function(e){M.ma.fn[e]=function(){var t=this.p();this.ia(),this.Yb(t,e,arguments);var n=t[e].apply(t,arguments);return this.ha(),n===t?this:n}}),M.a.r(["slice"],function(e){M.ma.fn[e]=function(){var t=this();return t[e].apply(t,arguments)}}),M.b("observableArray",M.ma),M.Aa.trackArrayChanges=function(e,n){function d(){if(!r){r=!0,s=e.notifySubscribers,e.notifySubscribers=function(e,t){return t&&t!==D||++a,s.apply(this,arguments)};var t=[].concat(e.p()||[]);o=null,i=e.Y(function(n){var i;n=[].concat(n||[]),e.Ra("arrayChange")&&((!o||1<a)&&(o=M.a.lb(t,n,e.kb)),i=o),t=n,o=null,a=0,i&&i.length&&e.notifySubscribers(i,"arrayChange")})}}if(e.kb={},n&&"object"==typeof n&&M.a.extend(e.kb,n),e.kb.sparse=!0,!e.Yb){var i,s,r=!1,o=null,a=0,c=e.ua,u=e.Ka;e.ua=function(t){c&&c.call(e,t),"arrayChange"===t&&d()},e.Ka=function(n){u&&u.call(e,n),"arrayChange"!==n||e.Ra("arrayChange")||(s&&(e.notifySubscribers=s,s=t),i.k(),r=!1)},e.Yb=function(e,t,n){function k(e,t,n){return i[i.length]={status:e,value:t,index:n}}if(r&&!a){var i=[],s=e.length,c=n.length,d=0;switch(t){case"push":d=s;case"unshift":for(t=0;t<c;t++)k("added",n[t],d+t);break;case"pop":d=s-1;case"shift":s&&k("deleted",e[d],d);break;case"splice":t=Math.min(Math.max(0,0>n[0]?s+n[0]:n[0]),s),s=1===c?s:Math.min(t+(n[1]||0),s),c=t+c-2,d=Math.max(s,c);for(var u=[],h=[],l=2;t<d;++t,++l)t<s&&h.push(k("deleted",e[t],t)),t<c&&u.push(k("added",n[l],t));M.a.hc(h,u);break;default:return}o=i}}}};var F=M.a.bc("_state");M.m=M.B=function(n,i,s){function e(){if(0<arguments.length){if("function"!=typeof r)throw Error("Cannot write a value to a ko.computed unless you specify a 'write' option. If you wish to read the current value, don't pass any parameters.");return r.apply(o.sb,arguments),this}return M.l.sc(e),(o.V||o.t&&e.Sa())&&e.U(),o.M}if("object"==typeof n?s=n:(s=s||{},n&&(s.read=n)),"function"!=typeof s.read)throw Error("Pass a function that returns the value of the ko.computed");var r=s.write,o={M:t,da:!0,V:!0,Ta:!1,Hb:!1,T:!1,Ya:!1,t:!1,od:s.read,sb:i||s.owner,i:s.disposeWhenNodeIsRemoved||s.i||null,ya:s.disposeWhen||s.ya,pb:null,s:{},L:0,fc:null};return e[F]=o,e.$c="function"==typeof r,M.a.la||M.a.extend(e,M.K.fn),M.K.fn.ub(e),M.a.ab(e,j),s.pure?(o.Ya=!0,o.t=!0,M.a.extend(e,B)):s.deferEvaluation&&M.a.extend(e,H),M.options.deferUpdates&&M.Aa.deferred(e,!0),o.i&&(o.Hb=!0,o.i.nodeType||(o.i=null)),o.t||s.deferEvaluation||e.U(),o.i&&e.ca()&&M.a.G.qa(o.i,o.pb=function(){e.k()}),e};var j={equalityComparer:J,Ca:function(){return this[F].L},Sb:function(e,t,n){if(this[F].Ya&&t===this)throw Error("A 'pure' computed must not be called recursively");this[F].s[e]=n,n.Ia=this[F].L++,n.pa=t.Pa()},Sa:function(){var e,t,n=this[F].s;for(e in n)if(n.hasOwnProperty(e)&&(t=n[e],this.oa&&t.$.Ha||t.$.Zc(t.pa)))return!0},gd:function(){this.oa&&!this[F].Ta&&this.oa(!1)},ca:function(){var e=this[F];return e.V||0<e.L},qd:function(){this.Ha?this[F].V&&(this[F].da=!0):this.ec()},yc:function(e){if(e.gb&&!this[F].i){var t=e.Y(this.gd,this,"dirty"),n=e.Y(this.qd,this);return{$:e,k:function(){t.k(),n.k()}}}return e.Y(this.ec,this)},ec:function(){var e=this,t=e.throttleEvaluation;t&&0<=t?(clearTimeout(this[F].fc),this[F].fc=M.a.setTimeout(function(){e.U(!0)},t)):e.oa?e.oa(!0):e.U(!0)},U:function(e){var t=this[F],n=t.ya,i=!1;if(!t.Ta&&!t.T){if(t.i&&!M.a.qb(t.i)||n&&n()){if(!t.Hb)return void this.k()}else t.Hb=!1;t.Ta=!0;try{i=this.Vc(e)}finally{t.Ta=!1}return t.L||this.k(),i}},Vc:function(e){var n=this[F],i=!1,s=n.Ya?t:!n.L,r={Mc:this,Oa:n.s,ob:n.L};return M.l.Xb({Lc:r,jb:W,m:this,Va:s}),n.s={},n.L=0,r=this.Uc(n,r),this.Ua(n.M,r)&&(n.t||this.notifySubscribers(n.M,"beforeChange"),n.M=r,n.t?this.Kb():e&&this.notifySubscribers(n.M),i=!0),s&&this.notifySubscribers(n.M,"awake"),i},Uc:function(e,t){try{var n=e.od;return e.sb?n.call(e.sb):n()}finally{M.l.end(),t.ob&&!e.t&&M.a.D(t.Oa,V),e.da=e.V=!1}},p:function(e){var t=this[F];return(t.V&&(e||!t.L)||t.t&&this.Sa())&&this.U(),t.M},Wa:function(e){M.K.fn.Wa.call(this,e),this.Mb=function(){return this[F].da?this.U():this[F].V=!1,this[F].M},this.oa=function(e){this.Ob(this[F].M),this[F].V=!0,e&&(this[F].da=!0),this.Pb(this)}},k:function(){var e=this[F];!e.t&&e.s&&M.a.D(e.s,function(e,t){t.k&&t.k()}),e.i&&e.pb&&M.a.G.tc(e.i,e.pb),e.s=null,e.L=0,e.T=!0,e.da=!1,e.V=!1,e.t=!1,e.i=null}},B={ua:function(e){var t=this,n=t[F];if(!n.T&&n.t&&"change"==e){if(n.t=!1,n.da||t.Sa())n.s=null,n.L=0,t.U()&&t.Kb();else{var i=[];M.a.D(n.s,function(e,t){i[t.Ia]=e}),M.a.r(i,function(e,i){var s=n.s[e],r=t.yc(s.$);r.Ia=i,r.pa=s.pa,n.s[e]=r})}n.T||t.notifySubscribers(n.M,"awake")}},Ka:function(e){var n=this[F];n.T||"change"!=e||this.Ra("change")||(M.a.D(n.s,function(e,t){t.k&&(n.s[e]={$:t.$,Ia:t.Ia,pa:t.pa},t.k())}),n.t=!0,this.notifySubscribers(t,"asleep"))},Pa:function(){var e=this[F];return e.t&&(e.da||this.Sa())&&this.U(),M.K.fn.Pa.call(this)}},H={ua:function(e){"change"!=e&&"beforeChange"!=e||this.p()}};M.a.la&&M.a.$a(j,M.K.fn);var q=M.O.md;M.m[q]=M.O,j[q]=M.m,M.bd=function(e){return M.Qa(e,M.m)},M.cd=function(e){return M.Qa(e,M.m)&&e[F]&&e[F].Ya},M.b("computed",M.m),M.b("dependentObservable",M.m),M.b("isComputed",M.bd),M.b("isPureComputed",M.cd),M.b("computed.fn",j),M.H(j,"peek",j.p),M.H(j,"dispose",j.k),M.H(j,"isActive",j.ca),M.H(j,"getDependenciesCount",j.Ca),M.rc=function(e,t){return"function"==typeof e?M.m(e,t,{pure:!0}):((e=M.a.extend({},e)).pure=!0,M.m(e,t))},M.b("pureComputed",M.rc),function(){function b(e,n,i){if(i=i||new d,"object"!=typeof(e=n(e))||null===e||e===t||e instanceof RegExp||e instanceof Date||e instanceof String||e instanceof Number||e instanceof Boolean)return e;var s=e instanceof Array?[]:{};return i.save(e,s),function c(e,t){if(e instanceof Array){for(var n=0;n<e.length;n++)t(n);"function"==typeof e.toJSON&&t("toJSON")}else for(n in e)t(n)}(e,function(r){var o=n(e[r]);switch(typeof o){case"boolean":case"number":case"string":case"function":s[r]=o;break;case"object":case"undefined":var a=i.get(o);s[r]=a!==t?a:b(o,n,i)}}),s}function d(){this.keys=[],this.Lb=[]}M.Ac=function(e){if(0==arguments.length)throw Error("When calling ko.toJS, pass the object you want to convert.");return b(e,function(e){for(var t=0;M.I(e)&&10>t;t++)e=e();return e})},M.toJSON=function(e,t,n){return e=M.Ac(e),M.a.Gb(e,t,n)},d.prototype={save:function(e,t){var n=M.a.o(this.keys,e);0<=n?this.Lb[n]=t:(this.keys.push(e),this.Lb.push(t))},get:function(e){return 0<=(e=M.a.o(this.keys,e))?this.Lb[e]:t}}}(),M.b("toJS",M.Ac),M.b("toJSON",M.toJSON),M.j={u:function(e){switch(M.a.A(e)){case"option":return!0===e.__ko__hasDomDataOptionValue__?M.a.e.get(e,M.d.options.zb):7>=M.a.C?e.getAttributeNode("value")&&e.getAttributeNode("value").specified?e.value:e.text:e.value;case"select":return 0<=e.selectedIndex?M.j.u(e.options[e.selectedIndex]):t;default:return e.value}},ja:function(e,n,i){switch(M.a.A(e)){case"option":switch(typeof n){case"string":M.a.e.set(e,M.d.options.zb,t),"__ko__hasDomDataOptionValue__"in e&&delete e.__ko__hasDomDataOptionValue__,e.value=n;break;default:M.a.e.set(e,M.d.options.zb,n),e.__ko__hasDomDataOptionValue__=!0,e.value="number"==typeof n?n:""}break;case"select":""!==n&&null!==n||(n=t);for(var s,r=-1,o=0,a=e.options.length;o<a;++o)if((s=M.j.u(e.options[o]))==n||""==s&&n===t){r=o;break}(i||0<=r||n===t&&1<e.size)&&(e.selectedIndex=r);break;default:null!==n&&n!==t||(n=""),e.value=n}}},M.b("selectExtensions",M.j),M.b("selectExtensions.readValue",M.j.u),M.b("selectExtensions.writeValue",M.j.ja),M.h=function(){function b(e){123===(e=M.a.cb(e)).charCodeAt(0)&&(e=e.slice(1,-1));var t,r=[],o=e.match(n),a=[],c=0;if(o){o.push(",");for(var d,u=0;d=o[u];++u){var h=d.charCodeAt(0);if(44===h){if(0>=c){r.push(t&&a.length?{key:t,value:a.join("")}:{unknown:t||a.join("")}),t=c=0,a=[];continue}}else if(58===h){if(!c&&!t&&1===a.length){t=a.pop();continue}}else 47===h&&u&&1<d.length?(h=o[u-1].match(i))&&!s[h[0]]&&((o=(e=e.substr(e.indexOf(d)+1)).match(n)).push(","),u=-1,d="/"):40===h||123===h||91===h?++c:41===h||125===h||93===h?--c:t||a.length||34!==h&&39!==h||(d=d.slice(1,-1));a.push(d)}}return r}var e=["true","false","null","undefined"],t=/^(?:[$_a-z][$\w]*|(.+)(\.\s*[$_a-z][$\w]*|\[.+\]))$/i,n=RegExp("\"(?:[^\"\\\\]|\\\\.)*\"|'(?:[^'\\\\]|\\\\.)*'|/(?:[^/\\\\]|\\\\.)*/w*|[^\\s:,/][^,\"'{}()/:[\\]]*[^\\s,\"'{}()/:[\\]]|[^\\s]","g"),i=/[\])"'A-Za-z0-9_$]+$/,s={in:1,return:1,typeof:1},r={};return{va:[],ga:r,Ab:b,Xa:function(n,i){function k(n,i){var d;if(!c){var u=M.getBindingHandler(n);if(u&&u.preprocess&&!(i=u.preprocess(i,n,k)))return;(u=r[n])&&(d=i,0<=M.a.o(e,d)?d=!1:(u=d.match(t),d=null!==u&&(u[1]?"Object("+u[1]+")"+u[2]:d)),u=d),u&&o.push("'"+n+"':function(_z){"+d+"=_z}")}a&&(i="function(){return "+i+" }"),s.push("'"+n+"':"+i)}var s=[],o=[],a=(i=i||{}).valueAccessors,c=i.bindingParams,d="string"==typeof n?b(n):n;return M.a.r(d,function(e){k(e.key||e.unknown,e.value)}),o.length&&k("_ko_property_writers","{"+o.join(",")+" }"),s.join(",")},fd:function(e,t){for(var n=0;n<e.length;n++)if(e[n].key==t)return!0;return!1},Ga:function(e,t,n,i,s){e&&M.I(e)?!M.Da(e)||s&&e.p()===i||e(i):(e=t.get("_ko_property_writers"))&&e[n]&&e[n](i)}}}(),M.b("expressionRewriting",M.h),M.b("expressionRewriting.bindingRewriteValidators",M.h.va),M.b("expressionRewriting.parseObjectLiteral",M.h.Ab),M.b("expressionRewriting.preProcessBindings",M.h.Xa),M.b("expressionRewriting._twoWayBindings",M.h.ga),M.b("jsonExpressionRewriting",M.h),M.b("jsonExpressionRewriting.insertPropertyAccessorsIntoJson",M.h.Xa),function(){function b(e){return 8==e.nodeType&&n.test(t?e.text:e.nodeValue)}function c(e){return 8==e.nodeType&&s.test(t?e.text:e.nodeValue)}function d(e,t){for(var n=e,i=1,s=[];n=n.nextSibling;){if(c(n)&&0==--i)return s;s.push(n),b(n)&&i++}if(!t)throw Error("Cannot find closing comment tag to match: "+e.nodeValue);return null}function e(e,t){var n=d(e,t);return n?0<n.length?n[n.length-1].nextSibling:e.nextSibling:null}var t=i&&"\x3c!--test--\x3e"===i.createComment("test").text,n=t?/^\x3c!--\s*ko(?:\s+([\s\S]+))?\s*--\x3e$/:/^\s*ko(?:\s+([\s\S]+))?\s*$/,s=t?/^\x3c!--\s*\/ko\s*--\x3e$/:/^\s*\/ko\s*$/,r={ul:!0,ol:!0};M.f={aa:{},childNodes:function(e){return b(e)?d(e):e.childNodes},za:function(e){if(b(e))for(var t=0,n=(e=M.f.childNodes(e)).length;t<n;t++)M.removeNode(e[t]);else M.a.rb(e)},fa:function(e,t){if(b(e)){M.f.za(e);for(var n=e.nextSibling,i=0,s=t.length;i<s;i++)n.parentNode.insertBefore(t[i],n)}else M.a.fa(e,t)},qc:function(e,t){b(e)?e.parentNode.insertBefore(t,e.nextSibling):e.firstChild?e.insertBefore(t,e.firstChild):e.appendChild(t)},kc:function(e,t,n){n?b(e)?e.parentNode.insertBefore(t,n.nextSibling):n.nextSibling?e.insertBefore(t,n.nextSibling):e.appendChild(t):M.f.qc(e,t)},firstChild:function(e){return b(e)?!e.nextSibling||c(e.nextSibling)?null:e.nextSibling:e.firstChild},nextSibling:function(t){return b(t)&&(t=e(t)),t.nextSibling&&c(t.nextSibling)?null:t.nextSibling},Yc:b,vd:function(e){return(e=(t?e.text:e.nodeValue).match(n))?e[1]:null},oc:function(t){if(r[M.a.A(t)]){var n=t.firstChild;if(n)do{if(1===n.nodeType){var i,s=null;if(i=n.firstChild)do{if(s)s.push(i);else if(b(i)){var o=e(i,!0);o?i=o:s=[i]}else c(i)&&(s=[i])}while(i=i.nextSibling);if(i=s)for(s=n.nextSibling,o=0;o<i.length;o++)s?t.insertBefore(i[o],s):t.appendChild(i[o])}}while(n=n.nextSibling)}}}}(),M.b("virtualElements",M.f),M.b("virtualElements.allowedBindings",M.f.aa),M.b("virtualElements.emptyNode",M.f.za),M.b("virtualElements.insertAfter",M.f.kc),M.b("virtualElements.prepend",M.f.qc),M.b("virtualElements.setDomNodeChildren",M.f.fa),M.S=function(){this.Kc={}},M.a.extend(M.S.prototype,{nodeHasBindings:function(e){switch(e.nodeType){case 1:return null!=e.getAttribute("data-bind")||M.g.getComponentNameForNode(e);case 8:return M.f.Yc(e);default:return!1}},getBindings:function(e,t){var n=(n=this.getBindingsString(e,t))?this.parseBindingsString(n,t,e):null;return M.g.Rb(n,e,t,!1)},getBindingAccessors:function(e,t){var n=(n=this.getBindingsString(e,t))?this.parseBindingsString(n,t,e,{valueAccessors:!0}):null;return M.g.Rb(n,e,t,!0)},getBindingsString:function(e){switch(e.nodeType){case 1:return e.getAttribute("data-bind");case 8:return M.f.vd(e);default:return null}},parseBindingsString:function(e,t,n,i){try{var s,r=this.Kc,o=e+(i&&i.valueAccessors||"");if(!(s=r[o])){var a,c="with($context){with($data||{}){return{"+M.h.Xa(e,i)+"}}}";a=new Function("$context","$element",c),s=r[o]=a}return s(t,n)}catch(t){throw t.message="Unable to parse bindings.\nBindings value: "+e+"\nMessage: "+t.message,t}}}),M.S.instance=new M.S,M.b("bindingProvider",M.S),function(){function b(e){return function(){return e}}function c(e){return e()}function d(e){return M.a.Ea(M.l.w(e),function(t,n){return function(){return e()[n]}})}function e(e,t,n){return"function"==typeof e?d(e.bind(null,t,n)):M.a.Ea(e,b)}function f(e,t){return d(this.getBindings.bind(this,e,t))}function g(e,t,n){var i,s=M.f.firstChild(t),r=M.S.instance,o=r.preprocessNode;if(o){for(;i=s;)s=M.f.nextSibling(i),o.call(r,i);s=M.f.firstChild(t)}for(;i=s;)s=M.f.nextSibling(i),h(e,i,n)}function h(e,t,n){var s=!0,r=1===t.nodeType;r&&M.f.oc(t),(r&&n||M.S.instance.nodeHasBindings(t))&&(s=m(t,null,e,n).shouldBindDescendants),s&&!i[M.a.A(t)]&&g(e,t,!r)}function m(e,n,i,r){var o,a,d=M.a.e.get(e,s);if(!n){if(d)throw Error("You cannot apply bindings multiple times to the same element.");M.a.e.set(e,s,!0)}if(!d&&r&&M.xc(e,i),n&&"function"!=typeof n)o=n;else{var u=M.S.instance,h=u.getBindingAccessors||f,p=M.B(function(){return(o=n?n(i,e):h.call(u,e,i))&&i.Q&&i.Q(),o},null,{i:e});o&&p.ca()||(p=null)}if(o){var m=p?function(e){return function(){return c(p()[e])}}:function(e){return o[e]},g=function(){return M.a.Ea(p?p():o,c)};g.get=function(e){return o[e]&&c(m(e))},g.has=function(e){return e in o},r=function l(e){var t=[],n={},i=[];return M.a.D(e,function X(s){if(!n[s]){var r=M.getBindingHandler(s);r&&(r.after&&(i.push(s),M.a.r(r.after,function(t){if(e[t]){if(-1!==M.a.o(i,t))throw Error("Cannot combine the following bindings, because they have a cyclic dependency: "+i.join(", "));X(t)}}),i.length--),t.push({key:s,jc:r})),n[s]=!0}}),t}(o),M.a.r(r,function(n){var s=n.jc.init,r=n.jc.update,c=n.key;if(8===e.nodeType&&!M.f.aa[c])throw Error("The binding '"+c+"' cannot be used with virtual elements");try{"function"==typeof s&&M.l.w(function(){var n=s(e,m(c),g,i.$data,i);if(n&&n.controlsDescendantBindings){if(a!==t)throw Error("Multiple bindings ("+a+" and "+c+") are trying to control descendant bindings of the same element. You cannot use these bindings together on the same element.");a=c}}),"function"==typeof r&&M.B(function(){r(e,m(c),g,i.$data,i)},null,{i:e})}catch(e){throw e.message='Unable to process binding "'+c+": "+o[c]+'"\nMessage: '+e.message,e}})}return{shouldBindDescendants:a===t}}function k(e){return e&&e instanceof M.R?e:new M.R(e)}M.d={};var i={script:!0,textarea:!0,template:!0};M.getBindingHandler=function(e){return M.d[e]},M.R=function(e,n,i,s,r){function f(){var t=d?e():e,r=M.a.c(t);return n?(n.Q&&n.Q(),M.a.extend(c,n),c.Q=a):(c.$parents=[],c.$root=r,c.ko=M),c.$rawData=t,c.$data=r,i&&(c[i]=r),s&&s(c,n,r),c.$data}var o,a,c=this,d="function"==typeof e&&!M.I(e);r&&r.exportDependencies?f():(a=M.B(f,null,{ya:function m(){return o&&!M.a.Tb(o)},i:!0})).ca()&&(c.Q=a,a.equalityComparer=null,o=[],a.Dc=function(e){o.push(e),M.a.G.qa(e,function(e){M.a.Na(o,e),o.length||(a.k(),c.Q=a=t)})})},M.R.prototype.createChildContext=function(e,t,n,i){return new M.R(e,this,t,function(e,t){e.$parentContext=t,e.$parent=t.$data,e.$parents=(t.$parents||[]).slice(0),e.$parents.unshift(e.$parent),n&&n(e)},i)},M.R.prototype.extend=function(e){return new M.R(this.Q||this.$data,this,null,function(t,n){t.$rawData=n.$rawData,M.a.extend(t,"function"==typeof e?e():e)})},M.R.prototype.ac=function(e,t){return this.createChildContext(e,t,null,{exportDependencies:!0})};var s=M.a.e.J(),r=M.a.e.J();M.xc=function(e,t){if(2!=arguments.length)return M.a.e.get(e,r);M.a.e.set(e,r,t),t.Q&&t.Q.Dc(e)},M.La=function(e,t,n){return 1===e.nodeType&&M.f.oc(e),m(e,t,k(n),!0)},M.Ic=function(t,n,i){return i=k(i),M.La(t,e(n,i,t),i)},M.hb=function(e,t){1!==t.nodeType&&8!==t.nodeType||g(k(e),t,!0)},M.Ub=function(e,t){if(!o&&n.jQuery&&(o=n.jQuery),t&&1!==t.nodeType&&8!==t.nodeType)throw Error("ko.applyBindings: first parameter should be your view model; second parameter should be a DOM node");t=t||n.document.body,h(k(e),t,!0)},M.nb=function(e){switch(e.nodeType){case 1:case 8:var n=M.xc(e);if(n)return n;if(e.parentNode)return M.nb(e.parentNode)}return t},M.Oc=function(e){return(e=M.nb(e))?e.$data:t},M.b("bindingHandlers",M.d),M.b("applyBindings",M.Ub),M.b("applyBindingsToDescendants",M.hb),M.b("applyBindingAccessorsToNode",M.La),M.b("applyBindingsToNode",M.Ic),M.b("contextFor",M.nb),M.b("dataFor",M.Oc)}(),function(t){function c(e,s){var r,o=n.hasOwnProperty(e)?n[e]:t;o?o.Y(s):((o=n[e]=new M.K).Y(s),d(e,function(t,s){var a=!(!s||!s.synchronous);i[e]={definition:t,dd:a},delete n[e],r||a?o.notifySubscribers(t):M.Z.Za(function(){o.notifySubscribers(t)})}),r=!0)}function d(t,n){e("getConfig",[t],function(i){i?e("loadComponent",[t,i],function(e){n(e,i)}):n(null,null)})}function e(n,i,s,r){r||(r=M.g.loaders.slice(0));var o=r.shift();if(o){var a=o[n];if(a){var c=!1;if(a.apply(o,i.concat(function(t){c?s(null):null!==t?s(t):e(n,i,s,r)}))!==t&&(c=!0,!o.suppressLoaderExceptions))throw Error("Component loaders must supply values by invoking the callback, not by returning values synchronously.")}else e(n,i,s,r)}else s(null)}var n={},i={};M.g={get:function(e,n){var s=i.hasOwnProperty(e)?i[e]:t;s?s.dd?M.l.w(function(){n(s.definition)}):M.Z.Za(function(){n(s.definition)}):c(e,n)},$b:function(e){delete i[e]},Nb:e},M.g.loaders=[],M.b("components",M.g),M.b("components.get",M.g.get),M.b("components.clearCachedDefinition",M.g.$b)}(),function(){function b(e,t,n,i){function g(){0==--o&&i(r)}var r={},o=2,a=n.template;n=n.viewModel,a?f(t,a,function(t){M.g.Nb("loadTemplate",[e,t],function(e){r.template=e,g()})}):g(),n?f(t,n,function(t){M.g.Nb("loadViewModel",[e,t],function(e){r[s]=e,g()})}):g()}function d(t){switch(M.a.A(t)){case"script":return M.a.na(t.text);case"textarea":return M.a.na(t.value);case"template":if(e(t.content))return M.a.wa(t.content.childNodes)}return M.a.wa(t.childNodes)}function e(e){return n.DocumentFragment?e instanceof DocumentFragment:e&&11===e.nodeType}function f(e,t,i){"string"==typeof t.require?w||n.require?(w||n.require)([t.require],i):e("Uses require, but no AMD loader is present"):i(t)}function g(e){return function(t){throw Error("Component '"+e+"': "+t)}}var t={};M.g.register=function(e,n){if(!n)throw Error("Invalid configuration for "+e);if(M.g.wb(e))throw Error("Component "+e+" is already registered");t[e]=n},M.g.wb=function(e){return t.hasOwnProperty(e)},M.g.ud=function(e){delete t[e],M.g.$b(e)},M.g.cc={getConfig:function(e,n){n(t.hasOwnProperty(e)?t[e]:null)},loadComponent:function(e,t,n){var i=g(e);f(i,t,function(t){b(e,i,t,n)})},loadTemplate:function(t,s,r){if(t=g(t),"string"==typeof s)r(M.a.na(s));else if(s instanceof Array)r(s);else if(e(s))r(M.a.W(s.childNodes));else if(s.element)if(s=s.element,n.HTMLElement?s instanceof HTMLElement:s&&s.tagName&&1===s.nodeType)r(d(s));else if("string"==typeof s){var o=i.getElementById(s);o?r(d(o)):t("Cannot find element with ID "+s)}else t("Unknown element type: "+s);else t("Unknown template value: "+s)},loadViewModel:function(e,t,n){!function c(e,t,n){if("function"==typeof t)n(function(e){return new t(e)});else if("function"==typeof t[s])n(t[s]);else if("instance"in t){var i=t.instance;n(function(){return i})}else"viewModel"in t?c(e,t.viewModel,n):e("Unknown viewModel value: "+t)}(g(e),t,n)}};var s="createViewModel";M.b("components.register",M.g.register),M.b("components.isRegistered",M.g.wb),M.b("components.unregister",M.g.ud),M.b("components.defaultLoader",M.g.cc),M.g.loaders.push(M.g.cc),M.g.Ec=t}(),function(){function b(t,n){if(i=t.getAttribute("params")){var i=e.parseBindingsString(i,n,t,{valueAccessors:!0,bindingParams:!0}),s=(i=M.a.Ea(i,function(e){return M.m(e,null,{i:t})}),M.a.Ea(i,function(e){var n=e.p();return e.ca()?M.m({read:function(){return M.a.c(e())},write:M.Da(n)&&function(t){e()(t)},i:t}):n}));return s.hasOwnProperty("$raw")||(s.$raw=i),s}return{$raw:{}}}M.g.getComponentNameForNode=function(e){var t=M.a.A(e);if(M.g.wb(t)&&(-1!=t.indexOf("-")||"[object HTMLUnknownElement]"==""+e||8>=M.a.C&&e.tagName===t))return t},M.g.Rb=function(e,t,n,i){if(1===t.nodeType){var s=M.g.getComponentNameForNode(t);if(s){if((e=e||{}).component)throw Error('Cannot use the "component" binding on a custom element matching a component');var r={name:s,params:b(t,n)};e.component=i?function(){return r}:r}}return e};var e=new M.S;9>M.a.C&&(M.g.register=function(e){return function(t){return i.createElement(t),e.apply(this,arguments)}}(M.g.register),i.createDocumentFragment=function(e){return function(){var t,n=e(),i=M.g.Ec;for(t in i)i.hasOwnProperty(t)&&n.createElement(t);return n}}(i.createDocumentFragment))}(),function(e){var t=0;M.d.component={init:function(e,n,i,s,r){function k(){var e=o&&o.dispose;"function"==typeof e&&e.call(o),a=o=null}var o,a,u=M.a.W(M.f.childNodes(e));return M.a.G.qa(e,k),M.m(function(){var i,s,h=M.a.c(n());if("string"==typeof h?i=h:(i=M.a.c(h.name),s=M.a.c(h.params)),!i)throw Error("No component name specified");var l=a=++t;M.g.get(i,function(t){if(a===l){if(k(),!t)throw Error("Unknown component '"+i+"'");!function c(e,t,n){if(!(t=t.template))throw Error("Component '"+e+"' has no template");e=M.a.wa(t),M.f.fa(n,e)}(i,t,e);var n=function d(e,t,n,i){var s=e.createViewModel;return s?s.call(e,i,{element:t,templateNodes:n}):i}(t,e,u,s);t=r.createChildContext(n,void 0,function(e){e.$component=n,e.$componentTemplateNodes=u}),o=n,M.hb(t,e)}})},null,{i:e}),{controlsDescendantBindings:!0}}},M.f.aa.component=!0}();var G={class:"className",for:"htmlFor"};M.d.attr={update:function(e,n){var i=M.a.c(n())||{};M.a.D(i,function(n,i){var s=!1===(i=M.a.c(i))||null===i||i===t;s&&e.removeAttribute(n),8>=M.a.C&&n in G?(n=G[n],s?e.removeAttribute(n):e[n]=i):s||e.setAttribute(n,i.toString()),"name"===n&&M.a.vc(e,s?"":i.toString())})}},M.d.checked={after:["value","attr"],init:function(n,i,s){function e(){var e=n.checked,t=l?r():e;if(!M.xa.Va()&&(!a||e)){var o=M.l.w(i);if(d){var c=u?o.p():o;h!==t?(e&&(M.a.ra(c,t,!0),M.a.ra(c,h,!1)),h=t):M.a.ra(c,t,e),u&&M.Da(o)&&o(c)}else M.h.Ga(o,s,"checked",t,!0)}}var r=M.rc(function(){return s.has("checkedValue")?M.a.c(s.get("checkedValue")):s.has("value")?M.a.c(s.get("value")):n.value}),o="checkbox"==n.type,a="radio"==n.type;if(o||a){var c=i(),d=o&&M.a.c(c)instanceof Array,u=!(d&&c.push&&c.splice),h=d?r():t,l=a||d;a&&!n.name&&M.d.uniqueName.init(n,function(){return!0}),M.m(e,null,{i:n}),M.a.q(n,"click",e),M.m(function f(){var e=M.a.c(i());n.checked=d?0<=M.a.o(e,r()):o?e:r()===e},null,{i:n}),c=t}}},M.h.ga.checked=!0,M.d.checkedValue={update:function(e,t){e.value=M.a.c(t())}},M.d.css={update:function(e,t){var n=M.a.c(t());null!==n&&"object"==typeof n?M.a.D(n,function(t,n){n=M.a.c(n),M.a.fb(e,t,n)}):(n=M.a.cb(String(n||"")),M.a.fb(e,e.__ko__cssValue,!1),e.__ko__cssValue=n,M.a.fb(e,n,!0))}},M.d.enable={update:function(e,t){var n=M.a.c(t());n&&e.disabled?e.removeAttribute("disabled"):n||e.disabled||(e.disabled=!0)}},M.d.disable={update:function(e,t){M.d.enable.update(e,function(){return!M.a.c(t())})}},M.d.event={init:function(e,t,n,i,s){var r=t()||{};M.a.D(r,function(r){"string"==typeof r&&M.a.q(e,r,function(e){var o,a=t()[r];if(a){try{var c=M.a.W(arguments);i=s.$data,c.unshift(i),o=a.apply(i,c)}finally{!0!==o&&(e.preventDefault?e.preventDefault():e.returnValue=!1)}!1===n.get(r+"Bubble")&&(e.cancelBubble=!0,e.stopPropagation&&e.stopPropagation())}})})}},M.d.foreach={mc:function(e){return function(){var t=e(),n=M.a.Bb(t);return n&&"number"!=typeof n.length?(M.a.c(t),{foreach:n.data,as:n.as,includeDestroyed:n.includeDestroyed,afterAdd:n.afterAdd,beforeRemove:n.beforeRemove,afterRender:n.afterRender,beforeMove:n.beforeMove,afterMove:n.afterMove,templateEngine:M.X.vb}):{foreach:t,templateEngine:M.X.vb}}},init:function(e,t){return M.d.template.init(e,M.d.foreach.mc(t))},update:function(e,t,n,i,s){return M.d.template.update(e,M.d.foreach.mc(t),n,i,s)}},M.h.va.foreach=!1,M.f.aa.foreach=!0,M.d.hasfocus={init:function(t,n,i){function e(e){t.__ko_hasfocusUpdating=!0;var s=t.ownerDocument;if("activeElement"in s){var r;try{r=s.activeElement}catch(e){r=s.body}e=r===t}s=n(),M.h.Ga(s,i,"hasfocus",e,!0),t.__ko_hasfocusLastValue=e,t.__ko_hasfocusUpdating=!1}var s=e.bind(null,!0),r=e.bind(null,!1);M.a.q(t,"focus",s),M.a.q(t,"focusin",s),M.a.q(t,"blur",r),M.a.q(t,"focusout",r)},update:function(e,t){var n=!!M.a.c(t());e.__ko_hasfocusUpdating||e.__ko_hasfocusLastValue===n||(n?e.focus():e.blur(),!n&&e.__ko_hasfocusLastValue&&e.ownerDocument.body.focus(),M.l.w(M.a.Fa,null,[e,n?"focusin":"focusout"]))}},M.h.ga.hasfocus=!0,M.d.hasFocus=M.d.hasfocus,M.h.ga.hasFocus=!0,M.d.html={init:function(){return{controlsDescendantBindings:!0}},update:function(e,t){M.a.Eb(e,t())}},K("if"),K("ifnot",!1,!0),K("with",!0,!1,function(e,t){return e.ac(t)});var z={};M.d.options={init:function(e){if("select"!==M.a.A(e))throw Error("options binding applies only to SELECT elements");for(;0<e.length;)e.remove(0);return{controlsDescendantBindings:!0}},update:function(n,i,s){function e(){return M.a.Ma(n.options,function(e){return e.selected})}function f(e,t,n){var i=typeof t;return"function"==i?t(e):"string"==i?e[t]:n}function g(e,t){if(l&&c)M.j.ja(n,M.a.c(s.get("value")),!0);else if(h.length){var i=0<=M.a.o(h,M.j.u(t[0]));M.a.wc(t[0],i),l&&!i&&M.l.w(M.a.Fa,null,[n,"change"])}}var r=n.multiple,o=0!=n.length&&r?n.scrollTop:null,a=M.a.c(i()),c=s.get("valueAllowUnset")&&s.has("value"),d=s.get("optionsIncludeDestroyed");i={};var u,h=[];c||(r?h=M.a.ib(e(),M.j.u):0<=n.selectedIndex&&h.push(M.j.u(n.options[n.selectedIndex]))),a&&(void 0===a.length&&(a=[a]),u=M.a.Ma(a,function(e){return d||e===t||null===e||!M.a.c(e._destroy)}),s.has("optionsCaption")&&null!==(a=M.a.c(s.get("optionsCaption")))&&a!==t&&u.unshift(z));var l=!1;i.beforeRemove=function(e){n.removeChild(e)},a=g,s.has("optionsAfterRender")&&"function"==typeof s.get("optionsAfterRender")&&(a=function(e,n){g(0,n),M.l.w(s.get("optionsAfterRender"),null,[n[0],e!==z?e:t])}),M.a.Db(n,u,function(e,i,r){return r.length&&(h=!c&&r[0].selected?[M.j.u(r[0])]:[],l=!0),i=n.ownerDocument.createElement("option"),e===z?(M.a.bb(i,s.get("optionsCaption")),M.j.ja(i,t)):(r=f(e,s.get("optionsValue"),e),M.j.ja(i,M.a.c(r)),e=f(e,s.get("optionsText"),r),M.a.bb(i,e)),[i]},i,a),M.l.w(function(){c?M.j.ja(n,M.a.c(s.get("value")),!0):(r?h.length&&e().length<h.length:h.length&&0<=n.selectedIndex?M.j.u(n.options[n.selectedIndex])!==h[0]:h.length||0<=n.selectedIndex)&&M.a.Fa(n,"change")}),M.a.Sc(n),o&&20<Math.abs(o-n.scrollTop)&&(n.scrollTop=o)}},M.d.options.zb=M.a.e.J(),M.d.selectedOptions={after:["options","foreach"],init:function(e,t,n){M.a.q(e,"change",function(){var i=t(),s=[];M.a.r(e.getElementsByTagName("option"),function(e){e.selected&&s.push(M.j.u(e))}),M.h.Ga(i,n,"selectedOptions",s)})},update:function(e,t){if("select"!=M.a.A(e))throw Error("values binding applies only to SELECT elements");var n=M.a.c(t()),i=e.scrollTop;n&&"number"==typeof n.length&&M.a.r(e.getElementsByTagName("option"),function(e){var t=0<=M.a.o(n,M.j.u(e));e.selected!=t&&M.a.wc(e,t)}),e.scrollTop=i}},M.h.ga.selectedOptions=!0,M.d.style={update:function(e,n){var i=M.a.c(n()||{});M.a.D(i,function(n,i){null!==(i=M.a.c(i))&&i!==t&&!1!==i||(i=""),e.style[n]=i})}},M.d.submit={init:function(e,t,n,i,s){if("function"!=typeof t())throw Error("The value for a submit binding must be a function");M.a.q(e,"submit",function(n){var i,r=t();try{i=r.call(s.$data,e)}finally{!0!==i&&(n.preventDefault?n.preventDefault():n.returnValue=!1)}})}},M.d.text={init:function(){return{controlsDescendantBindings:!0}},update:function(e,t){M.a.bb(e,t())}},M.f.aa.text=!0,function(){if(n&&n.navigator)var e=function(e){if(e)return parseFloat(e[1])},i=n.opera&&n.opera.version&&parseInt(n.opera.version()),s=n.navigator.userAgent,r=e(s.match(/^(?:(?!chrome).)*version\/([^ ]*) safari/i)),o=e(s.match(/Firefox\/([^ ]*)/));if(10>M.a.C)var a=M.a.e.J(),c=M.a.e.J(),d=function(e){var t=this.activeElement;(t=t&&M.a.e.get(t,c))&&t(e)},u=function(e,t){var n=e.ownerDocument;M.a.e.get(n,a)||(M.a.e.set(n,a,!0),M.a.q(n,"selectionchange",d)),M.a.e.set(e,c,t)};M.d.textInput={init:function(e,n,s){function l(t,n){M.a.q(e,t,n)}function y(){a||(c=e.value,a=M.a.setTimeout(v,4))}function v(){clearTimeout(a),c=a=t;var i=e.value;d!==i&&(d=i,M.h.Ga(n(),s,"textInput",i))}var a,c,d=e.value,p=9==M.a.C?y:v;10>M.a.C?(l("propertychange",function(e){"value"===e.propertyName&&p(e)}),8==M.a.C&&(l("keyup",v),l("keydown",v)),8<=M.a.C&&(u(e,p),l("dragend",y))):(l("input",v),5>r&&"textarea"===M.a.A(e)?(l("keydown",y),l("paste",y),l("cut",y)):11>i?l("keydown",y):4>o&&(l("DOMAutoComplete",v),l("dragdrop",v),l("drop",v))),l("change",v),M.m(function h(){var i=M.a.c(n());null!==i&&i!==t||(i=""),c!==t&&i===c?M.a.setTimeout(h,4):e.value!==i&&(d=i,e.value=i)},null,{i:e})}},M.h.ga.textInput=!0,M.d.textinput={preprocess:function(e,t,n){n("textInput",e)}}}(),M.d.uniqueName={init:function(e,t){if(t()){var n="ko_unique_"+ ++M.d.uniqueName.Nc;M.a.vc(e,n)}}},M.d.uniqueName.Nc=0,M.d.value={after:["options","foreach"],init:function(e,t,n){if("input"!=e.tagName.toLowerCase()||"checkbox"!=e.type&&"radio"!=e.type){var i=["change"],s=n.get("valueUpdate"),r=!1,o=null;s&&("string"==typeof s&&(s=[s]),M.a.ta(i,s),i=M.a.Wb(i));var a=function(){o=null,r=!1;var i=t(),s=M.j.u(e);M.h.Ga(i,n,"value",s)};!M.a.C||"input"!=e.tagName.toLowerCase()||"text"!=e.type||"off"==e.autocomplete||e.form&&"off"==e.form.autocomplete||-1!=M.a.o(i,"propertychange")||(M.a.q(e,"propertychange",function(){r=!0}),M.a.q(e,"focus",function(){r=!1}),M.a.q(e,"blur",function(){r&&a()})),M.a.r(i,function(t){var n=a;M.a.sd(t,"after")&&(n=function(){o=M.j.u(e),M.a.setTimeout(a,0)},t=t.substring(5)),M.a.q(e,t,n)});var c=function(){var i=M.a.c(t()),s=M.j.u(e);if(null!==o&&i===o)M.a.setTimeout(c,0);else if(i!==s)if("select"===M.a.A(e)){var r=n.get("valueAllowUnset");(s=function(){M.j.ja(e,i,r)})(),r||i===M.j.u(e)?M.a.setTimeout(s,0):M.l.w(M.a.Fa,null,[e,"change"])}else M.j.ja(e,i)};M.m(c,null,{i:e})}else M.La(e,{checkedValue:t})},update:function(){}},M.h.ga.value=!0,M.d.visible={update:function(e,t){var n=M.a.c(t()),i="none"!=e.style.display;n&&!i?e.style.display="":!n&&i&&(e.style.display="none")}},function(e){M.d[e]={init:function(t,n,i,s,r){return M.d.event.init.call(this,t,function(){var t={};return t[e]=n(),t},i,s,r)}}}("click"),M.P=function(){},M.P.prototype.renderTemplateSource=function(){throw Error("Override renderTemplateSource")},M.P.prototype.createJavaScriptEvaluatorBlock=function(){throw Error("Override createJavaScriptEvaluatorBlock")},M.P.prototype.makeTemplateSource=function(e,t){if("string"==typeof e){var n=(t=t||i).getElementById(e);if(!n)throw Error("Cannot find template with ID "+e);return new M.v.n(n)}if(1==e.nodeType||8==e.nodeType)return new M.v.sa(e);throw Error("Unknown template type: "+e)},M.P.prototype.renderTemplate=function(e,t,n,i){return e=this.makeTemplateSource(e,i),this.renderTemplateSource(e,t,n,i)},M.P.prototype.isTemplateRewritten=function(e,t){return!1===this.allowTemplateRewriting||this.makeTemplateSource(e,t).data("isRewritten")},M.P.prototype.rewriteTemplate=function(e,t,n){t=t((e=this.makeTemplateSource(e,n)).text()),e.text(t),e.data("isRewritten",!0)},M.b("templateEngine",M.P),M.Ib=function(){function b(e,t,n,i){e=M.h.Ab(e);for(var s=M.h.va,r=0;r<e.length;r++){var o=e[r].key;if(s.hasOwnProperty(o)){var a=s[o];if("function"==typeof a){if(o=a(e[r].value))throw Error(o)}else if(!a)throw Error("This template engine does not support the '"+o+"' binding within its templates")}}return n="ko.__tr_ambtns(function($context,$element){return(function(){return{ "+M.h.Xa(e,{valueAccessors:!0})+" } })()},'"+n.toLowerCase()+"')",i.createJavaScriptEvaluatorBlock(n)+t}var e=/(<([a-z]+\d*)(?:\s+(?!data-bind\s*=\s*)[a-z0-9\-]+(?:=(?:\"[^\"]*\"|\'[^\']*\'|[^>]*))?)*\s+)data-bind\s*=\s*(["'])([\s\S]*?)\3/gi,t=/\x3c!--\s*ko\b\s*([\s\S]*?)\s*--\x3e/g;return{Tc:function(e,t,n){t.isTemplateRewritten(e,n)||t.rewriteTemplate(e,function(e){return M.Ib.jd(e,t)},n)},jd:function(n,i){return n.replace(e,function(e,t,n,s,r){return b(r,t,n,i)}).replace(t,function(e,t){return b(t,"\x3c!-- ko --\x3e","#comment",i)})},Jc:function(e,t){return M.N.yb(function(n,i){var s=n.nextSibling;s&&s.nodeName.toLowerCase()===t&&M.La(s,e,i)})}}}(),M.b("__tr_ambtns",M.Ib.Jc),function(){M.v={},M.v.n=function(e){if(this.n=e){var t=M.a.A(e);this.eb="script"===t?1:"textarea"===t?2:"template"==t&&e.content&&11===e.content.nodeType?3:4}},M.v.n.prototype.text=function(){var e=1===this.eb?"text":2===this.eb?"value":"innerHTML";if(0==arguments.length)return this.n[e];var t=arguments[0];"innerHTML"===e?M.a.Eb(this.n,t):this.n[e]=t};var e=M.a.e.J()+"_";M.v.n.prototype.data=function(t){if(1===arguments.length)return M.a.e.get(this.n,e+t);M.a.e.set(this.n,e+t,arguments[1])};var n=M.a.e.J();M.v.n.prototype.nodes=function(){var e=this.n;if(0==arguments.length)return(M.a.e.get(e,n)||{}).mb||(3===this.eb?e.content:4===this.eb?e:t);M.a.e.set(e,n,{mb:arguments[0]})},M.v.sa=function(e){this.n=e},M.v.sa.prototype=new M.v.n,M.v.sa.prototype.text=function(){if(0==arguments.length){var e=M.a.e.get(this.n,n)||{};return e.Jb===t&&e.mb&&(e.Jb=e.mb.innerHTML),e.Jb}M.a.e.set(this.n,n,{Jb:arguments[0]})},M.b("templateSources",M.v),M.b("templateSources.domElement",M.v.n),M.b("templateSources.anonymousTemplate",M.v.sa)}(),function(){function b(e,t,n){var i;for(t=M.f.nextSibling(t);e&&(i=e)!==t;)n(i,e=M.f.nextSibling(i))}function c(e,t){if(e.length){var n=e[0],i=e[e.length-1],s=n.parentNode,r=M.S.instance,o=r.preprocessNode;if(o){if(b(n,i,function(e,t){var s=e.previousSibling,a=o.call(r,e);a&&(e===n&&(n=a[0]||t),e===i&&(i=a[a.length-1]||s))}),e.length=0,!n)return;n===i?e.push(n):(e.push(n,i),M.a.Ba(e,s))}b(n,i,function(e){1!==e.nodeType&&8!==e.nodeType||M.Ub(t,e)}),b(n,i,function(e){1!==e.nodeType&&8!==e.nodeType||M.N.Cc(e,[t])}),M.a.Ba(e,s)}}function d(e){return e.nodeType?e:0<e.length?e[0]:null}function e(e,t,i,s,r){r=r||{};var o=(e&&d(e)||i||{}).ownerDocument,a=r.templateEngine||n;if(M.Ib.Tc(i,a,o),"number"!=typeof(i=a.renderTemplate(i,s,r,o)).length||0<i.length&&"number"!=typeof i[0].nodeType)throw Error("Template engine must return an array of DOM nodes");switch(o=!1,t){case"replaceChildren":M.f.fa(e,i),o=!0;break;case"replaceNode":M.a.uc(e,i),o=!0;break;case"ignoreTargetNode":break;default:throw Error("Unknown renderMode: "+t)}return o&&(c(i,s),r.afterRender&&M.l.w(r.afterRender,null,[i,s.$data])),i}function f(e,t,n){return M.I(e)?e():"function"==typeof e?e(t,n):e}var n;M.Fb=function(e){if(e!=t&&!(e instanceof M.P))throw Error("templateEngine must inherit from ko.templateEngine");n=e},M.Cb=function(i,s,r,o,a){if(((r=r||{}).templateEngine||n)==t)throw Error("Set a template engine before calling renderTemplate");if(a=a||"replaceChildren",o){var c=d(o);return M.B(function(){var t=s&&s instanceof M.R?s:new M.R(s,null,null,null,{exportDependencies:!0}),n=f(i,t.$data,t);t=e(o,a,n,t,r),"replaceNode"==a&&(c=d(o=t))},null,{ya:function(){return!c||!M.a.qb(c)},i:c&&"replaceNode"==a?c.parentNode:c})}return M.N.yb(function(e){M.Cb(i,s,r,e,"replaceNode")})},M.pd=function(n,i,r,o,a){function p(e,t){c(t,d),r.afterRender&&r.afterRender(t,e),d=null}function s(t,i){return d=a.createChildContext(t,r.as,function(e){e.$index=i}),e(null,"ignoreTargetNode",f(n,t,d),d,r)}var d;return M.B(function(){var e=M.a.c(i)||[];void 0===e.length&&(e=[e]),e=M.a.Ma(e,function(e){return r.includeDestroyed||e===t||null===e||!M.a.c(e._destroy)}),M.l.w(M.a.Db,null,[o,e,s,r,p])},null,{i:o})};var i=M.a.e.J();M.d.template={init:function(e,t){var n=M.a.c(t());if("string"==typeof n||n.name)M.f.za(e);else{if("nodes"in n){if(n=n.nodes||[],M.I(n))throw Error('The "nodes" option must be a plain, non-observable array.')}else n=M.f.childNodes(e);n=M.a.nc(n),new M.v.sa(e).nodes(n)}return{controlsDescendantBindings:!0}},update:function(e,n,s,r,o){var a=n();s=!0,r=null,"string"==typeof(n=M.a.c(a))?n={}:(a=n.name,"if"in n&&(s=M.a.c(n.if)),s&&"ifnot"in n&&(s=!M.a.c(n.ifnot))),"foreach"in n?r=M.pd(a||e,s&&n.foreach||[],n,e,o):s?(o="data"in n?o.ac(n.data,n.as):o,r=M.Cb(a||e,o,n,e)):M.f.za(e),o=r,(n=M.a.e.get(e,i))&&"function"==typeof n.k&&n.k(),M.a.e.set(e,i,o&&o.ca()?o:t)}},M.h.va.template=function(e){return 1==(e=M.h.Ab(e)).length&&e[0].unknown||M.h.fd(e,"name")?null:"This template engine does not support anonymous templates nested within its templates"},M.f.aa.template=!0}(),M.b("setTemplateEngine",M.Fb),M.b("renderTemplate",M.Cb),M.a.hc=function(e,t,n){var i,s,r,o,a;if(e.length&&t.length)for(i=s=0;(!n||i<n)&&(o=e[s]);++s){for(r=0;a=t[r];++r)if(o.value===a.value){o.moved=a.index,a.moved=o.index,t.splice(r,1),i=r=0;break}i+=r}},M.a.lb=function(){function b(e,t,n,i,s){var r,o,a,c,d,u=Math.min,h=Math.max,l=[],p=e.length,f=t.length,m=f-p||1,g=p+f+1;for(r=0;r<=p;r++)for(c=a,l.push(a=[]),d=u(f,r+m),o=h(0,r-1);o<=d;o++)a[o]=o?r?e[r-1]===t[o-1]?c[o-1]:u(c[o]||g,a[o-1]||g)+1:o+1:r+1;for(u=[],h=[],m=[],r=p,o=f;r||o;)f=l[r][o]-1,o&&f===l[r][o-1]?h.push(u[u.length]={status:n,value:t[--o],index:o}):r&&f===l[r-1][o]?m.push(u[u.length]={status:i,value:e[--r],index:r}):(--o,--r,s.sparse||u.push({status:"retained",value:t[o]}));return M.a.hc(m,h,!s.dontLimitMoves&&10*p),u.reverse()}return function(e,t,n){return n="boolean"==typeof n?{dontLimitMoves:n}:n||{},t=t||[],(e=e||[]).length<t.length?b(e,t,"added","deleted",n):b(t,e,"deleted","added",n)}}(),M.b("utils.compareArrays",M.a.lb),function(){function b(e,n,i,s,r){var o=[],a=M.B(function(){var t=n(i,r,M.a.Ba(o,e))||[];0<o.length&&(M.a.uc(o,t),s&&M.l.w(s,null,[i,t,r])),o.length=0,M.a.ta(o,t)},null,{i:e,ya:function(){return!M.a.Tb(o)}});return{ea:o,B:a.ca()?a:t}}var e=M.a.e.J(),n=M.a.e.J();M.a.Db=function(i,s,r,o,a){function m(e,t){w=u[t],g!==t&&(P[e]=w),w.tb(g++),M.a.Ba(w.ea,i),p.push(w),y.push(w)}function k(e,t){if(e)for(var n=0,i=t.length;n<i;n++)t[n]&&M.a.r(t[n].ea,function(i){e(i,n,t[n].ka)})}s=s||[],o=o||{};var c,d=M.a.e.get(i,e)===t,u=M.a.e.get(i,e)||[],h=M.a.ib(u,function(e){return e.ka}),l=M.a.lb(h,s,o.dontLimitMoves),p=[],f=0,g=0,v=[],y=[];s=[];for(var w,S,C,P=[],x=(h=[],0);S=l[x];x++)switch(C=S.moved,S.status){case"deleted":C===t&&((w=u[f]).B&&(w.B.k(),w.B=t),M.a.Ba(w.ea,i).length&&(o.beforeRemove&&(p.push(w),y.push(w),w.ka===n?w=null:s[x]=w),w&&v.push.apply(v,w.ea))),f++;break;case"retained":m(x,f++);break;case"added":C!==t?m(x,C):(w={ka:S.value,tb:M.O(g++)},p.push(w),y.push(w),d||(h[x]=w))}for(M.a.e.set(i,e,p),k(o.beforeMove,P),M.a.r(v,o.beforeRemove?M.ba:M.removeNode),x=0,d=M.f.firstChild(i);w=y[x];x++){for(w.ea||M.a.extend(w,b(i,r,w.ka,a,w.tb)),f=0;l=w.ea[f];d=l.nextSibling,c=l,f++)l!==d&&M.f.kc(i,l,c);!w.ad&&a&&(a(w.ka,w.ea,w.tb),w.ad=!0)}for(k(o.beforeRemove,s),x=0;x<s.length;++x)s[x]&&(s[x].ka=n);k(o.afterMove,P),k(o.afterAdd,h)}}(),M.b("utils.setDomNodeChildrenFromArrayMapping",M.a.Db),M.X=function(){this.allowTemplateRewriting=!1},M.X.prototype=new M.P,M.X.prototype.renderTemplateSource=function(e,t,n,i){return(t=9>M.a.C||!e.nodes?null:e.nodes())?M.a.W(t.cloneNode(!0).childNodes):(e=e.text(),M.a.na(e,i))},M.X.vb=new M.X,M.Fb(M.X.vb),M.b("nativeTemplateEngine",M.X),function(){M.xb=function(){var e=this.ed=function(){if(!o||!o.tmpl)return 0;try{if(0<=o.tmpl.tag.tmpl.open.toString().indexOf("__"))return 2}catch(e){}return 1}();this.renderTemplateSource=function(t,n,s,r){if(r=r||i,s=s||{},2>e)throw Error("Your version of jQuery.tmpl is too old. Please upgrade to jQuery.tmpl 1.0.0pre or later.");var a=t.data("precompiled");return a||(a=t.text()||"",a=o.template(null,"{{ko_with $item.koBindingContext}}"+a+"{{/ko_with}}"),t.data("precompiled",a)),t=[n.$data],n=o.extend({koBindingContext:n},s.templateOptions),(n=o.tmpl(a,t,n)).appendTo(r.createElement("div")),o.fragments={},n},this.createJavaScriptEvaluatorBlock=function(e){return"{{ko_code ((function() { return "+e+" })()) }}"},this.addTemplate=function(e,t){i.write("<script type='text/html' id='"+e+"'>"+t+"<\/script>")},0<e&&(o.tmpl.tag.ko_code={open:"__.push($1 || '');"},o.tmpl.tag.ko_with={open:"with($1) {",close:"} "})},M.xb.prototype=new M.P;var e=new M.xb;0<e.ed&&M.Fb(e),M.b("jqueryTmplTemplateEngine",M.xb)}()})}(),function(e){"function"==typeof require&&"object"==typeof exports&&"object"==typeof module?e(require("ko"),exports):"function"==typeof define&&define.amd?define("mapping",["ko","exports"],e):e(ko,ko.mapping={})}(function(e,t){function y(e,n){var i,s;for(s in n)if(n.hasOwnProperty(s)&&n[s])if(i=t.getType(e[s]),s&&e[s]&&"array"!==i&&"string"!==i)y(e[s],n[s]);else if("array"===t.getType(e[s])&&"array"===t.getType(n[s])){i=e;for(var r=s,o=e[s],a=n[s],c={},d=o.length-1;0<=d;--d)c[o[d]]=o[d];for(d=a.length-1;0<=d;--d)c[a[d]]=a[d];for(a in o=[],a=void 0,c)o.push(c[a]);i[r]=o}else e[s]=n[s]}function E(e,t){var n={};return y(n,e),y(n,t),n}function z(e,t){for(var n=E({},e),i=a.length-1;0<=i;i--){var s=a[i];n[s]&&(n[""]instanceof Object||(n[""]={}),n[""][s]=n[s],delete n[s])}return t&&(n.ignore=h(t.ignore,n.ignore),n.include=h(t.include,n.include),n.copy=h(t.copy,n.copy),n.observe=h(t.observe,n.observe)),n.ignore=h(n.ignore,u.ignore),n.include=h(n.include,u.include),n.copy=h(n.copy,u.copy),n.observe=h(n.observe,u.observe),n.mappedProperties=n.mappedProperties||{},n.copiedProperties=n.copiedProperties||{},n}function h(n,i){return"array"!==t.getType(n)&&(n="undefined"===t.getType(n)?[]:[n]),"array"!==t.getType(i)&&(i="undefined"===t.getType(i)?[]:[i]),e.utils.arrayGetDistinctValues(n.concat(i))}function F(o,a,d,u,h,l,p){var f="array"===t.getType(e.utils.unwrapObservable(a));if(l=l||"",t.isMapped(o)){var m=e.utils.unwrapObservable(o)[s];d=E(m,d)}var g=p||h,v=function(){return d[u]&&d[u].create instanceof Function},b=function(t){var i=n,s=e.dependentObservable;return e.dependentObservable=function(t,n,s){s=s||{},t&&"object"==typeof t&&(s=t);var o=s.deferEvaluation,a=!1;if(s.deferEvaluation=!0,t=new r(t,n,s),!o){var c=t;o=e.dependentObservable;e.dependentObservable=r,t=e.isWriteableObservable(c),e.dependentObservable=o,(o=r({read:function(){return a||(e.utils.arrayRemoveItem(i,c),a=!0),c.apply(c,arguments)},write:t&&function(e){return c(e)},deferEvaluation:!0})).__DO=c,t=o,i.push(t)}return t},e.dependentObservable.fn=r.fn,e.computed=e.dependentObservable,t=e.utils.unwrapObservable(h)instanceof Array?d[u].create({data:t||a,parent:g,skip:c}):d[u].create({data:t||a,parent:g}),e.dependentObservable=s,e.computed=e.dependentObservable,t},y=function(){return d[u]&&d[u].update instanceof Function},w=function(t,n){var i={data:n||a,parent:g,target:e.utils.unwrapObservable(t)};return e.isWriteableObservable(t)&&(i.observable=t),d[u].update(i)};if(p=i.get(a))return p;if(u=u||"",f){f=[];var S=!1,k=function(e){return e};d[u]&&d[u].key&&(k=d[u].key,S=!0),e.isObservable(o)||((o=e.observableArray([])).mappedRemove=function(e){var t="function"==typeof e?e:function(t){return t===k(e)};return o.remove(function(e){return t(k(e))})},o.mappedRemoveAll=function(t){var n=C(t,k);return o.remove(function(t){return-1!=e.utils.arrayIndexOf(n,k(t))})},o.mappedDestroy=function(e){var t="function"==typeof e?e:function(t){return t===k(e)};return o.destroy(function(e){return t(k(e))})},o.mappedDestroyAll=function(t){var n=C(t,k);return o.destroy(function(t){return-1!=e.utils.arrayIndexOf(n,k(t))})},o.mappedIndexOf=function(t){var n=C(o(),k);return t=k(t),e.utils.arrayIndexOf(n,t)},o.mappedGet=function(e){return o()[o.mappedIndexOf(e)]},o.mappedCreate=function(t){if(-1!==o.mappedIndexOf(t))throw Error("There already is an object with the key that you specified.");var n=v()?b(t):t;return y()&&(t=w(n,t),e.isWriteableObservable(n)?n(t):n=t),o.push(n),n}),p=C(e.utils.unwrapObservable(o),k).sort(),m=C(a,k),S&&m.sort(),S=e.utils.compareArrays(p,m),p={};var x,T={},R=!0;m=0;for(x=(I=e.utils.unwrapObservable(a)).length;m<x;m++){if(void 0===(D=k(I[m]))||D instanceof Object){R=!1;break}T[D]=I[m]}var I=[],M=0;m=0;for(x=S.length;m<x;m++){var _,D=S[m],L=l+"["+m+"]";switch(D.status){case"added":var A=R?T[D.value]:K(e.utils.unwrapObservable(a),D.value,k);_=F(void 0,A,d,u,o,L,h),v()||(_=e.utils.unwrapObservable(_)),L=O(e.utils.unwrapObservable(a),A,p),_===c?M++:I[L-M]=_,p[L]=!0;break;case"retained":A=R?T[D.value]:K(e.utils.unwrapObservable(a),D.value,k),F(_=K(o,D.value,k),A,d,u,o,L,h),I[L=O(e.utils.unwrapObservable(a),A,p)]=_,p[L]=!0;break;case"deleted":_=K(o,D.value,k)}f.push({event:D.status,item:_})}o(I),d[u]&&d[u].arrayChanged&&e.utils.arrayForEach(f,function(e){d[u].arrayChanged(e.event,e.item)})}else if(P(a)){if(!(o=e.utils.unwrapObservable(o))){if(v())return S=b(),y()&&(S=w(S)),S;if(y())return w(S);o={}}if(y()&&(o=w(o)),i.save(a,o),y())return o;Q(a,function(t){var n=l.length?l+"."+t:t;if(-1==e.utils.arrayIndexOf(d.ignore,n))if(-1!=e.utils.arrayIndexOf(d.copy,n))o[t]=a[t];else if("object"!=typeof a[t]&&"array"!=typeof a[t]&&0<d.observe.length&&-1==e.utils.arrayIndexOf(d.observe,n))o[t]=a[t],d.copiedProperties[n]=!0;else{var s=i.get(a[t]),r=F(o[t],a[t],d,t,o,n,o);s=s||r;0<d.observe.length&&-1==e.utils.arrayIndexOf(d.observe,n)?(o[t]=s(),d.copiedProperties[n]=!0):(e.isWriteableObservable(o[t])?(s=e.utils.unwrapObservable(s),o[t]()!==s&&o[t](s)):(s=void 0===o[t]?s:e.utils.unwrapObservable(s),o[t]=s),d.mappedProperties[n]=!0)}})}else switch(t.getType(a)){case"function":y()?e.isWriteableObservable(a)?(a(w(a)),o=a):o=w(a):o=a;break;default:if(e.isWriteableObservable(o))return _=y()?w(o):e.utils.unwrapObservable(a),o(_),_;v()||y(),o=v()?b():e.observable(e.utils.unwrapObservable(a)),y()&&o(w(o))}return o}function O(e,t,n){for(var i=0,s=e.length;i<s;i++)if(!0!==n[i]&&e[i]===t)return i;return null}function R(n,i){var s;return i&&(s=i(n)),"undefined"===t.getType(s)&&(s=n),e.utils.unwrapObservable(s)}function K(t,n,i){for(var s=0,r=(t=e.utils.unwrapObservable(t)).length;s<r;s++){var o=t[s];if(R(o,i)===n)return o}throw Error("When calling ko.update*, the key '"+n+"' was not found!")}function C(t,n){return e.utils.arrayMap(e.utils.unwrapObservable(t),function(e){return n?R(e,n):e})}function Q(e,n){if("array"===t.getType(e))for(var i=0;i<e.length;i++)n(i);else for(i in e)n(i)}function P(e){var n=t.getType(e);return("object"===n||"array"===n)&&null!==e}function T(){var t=[],n=[];this.save=function(i,s){var r=e.utils.arrayIndexOf(t,i);0<=r?n[r]=s:(t.push(i),n.push(s))},this.get=function(i){return 0<=(i=e.utils.arrayIndexOf(t,i))?n[i]:void 0}}function S(){var e={},t=function(t){var n;try{n=t}catch(e){n="$$$"}return void 0===(t=e[n])&&(t=new T,e[n]=t),t};this.save=function(e,n){t(e).save(e,n)},this.get=function(e){return t(e).get(e)}}var n,i,s="__ko_mapping__",r=e.dependentObservable,o=0,a=["create","update","key","arrayChanged"],c={},d={include:["_destroy"],ignore:[],copy:[],observe:[]},u=d;t.isMapped=function(t){return(t=e.utils.unwrapObservable(t))&&t[s]},t.fromJS=function(e){if(0==arguments.length)throw Error("When calling ko.fromJS, pass the object you want to convert.");try{var t,r;o++||(n=[],i=new S),2==arguments.length&&(arguments[1][s]?r=arguments[1]:t=arguments[1]),3==arguments.length&&(t=arguments[1],r=arguments[2]),r&&(t=E(t,r[s]));var a=F(r,e,t=z(t));if(r&&(a=r),!--o)for(;n.length;){var c=n.pop();c&&(c(),c.__DO.throttleEvaluation=c.throttleEvaluation)}return a[s]=E(a[s],t),a}catch(e){throw o=0,e}},t.fromJSON=function(n){var i=e.utils.parseJson(n);return arguments[0]=i,t.fromJS.apply(this,arguments)},t.updateFromJS=function(){throw Error("ko.mapping.updateFromJS, use ko.mapping.fromJS instead. Please note that the order of parameters is different!")},t.updateFromJSON=function(){throw Error("ko.mapping.updateFromJSON, use ko.mapping.fromJSON instead. Please note that the order of parameters is different!")},t.toJS=function(n,i){if(u||t.resetDefaultOptions(),0==arguments.length)throw Error("When calling ko.mapping.toJS, pass the object you want to convert.");if("array"!==t.getType(u.ignore))throw Error("ko.mapping.defaultOptions().ignore should be an array.");if("array"!==t.getType(u.include))throw Error("ko.mapping.defaultOptions().include should be an array.");if("array"!==t.getType(u.copy))throw Error("ko.mapping.defaultOptions().copy should be an array.");return i=z(i,n[s]),t.visitModel(n,function(t){return e.utils.unwrapObservable(t)},i)},t.toJSON=function(n,i){var s=t.toJS(n,i);return e.utils.stringifyJson(s)},t.defaultOptions=function(){if(!(0<arguments.length))return u;u=arguments[0]},t.resetDefaultOptions=function(){u={include:d.include.slice(0),ignore:d.ignore.slice(0),copy:d.copy.slice(0)}},t.getType=function(e){if(e&&"object"==typeof e){if(e.constructor===Date)return"date";if(e.constructor===Array)return"array"}return typeof e},t.visitModel=function(n,i,r){(r=r||{}).visitedObjects=r.visitedObjects||new S;var o,a=e.utils.unwrapObservable(n);if(!P(a))return i(n,r.parentName);r=z(r,a[s]),i(n,r.parentName),o="array"===t.getType(a)?[]:{},r.visitedObjects.save(n,o);var c=r.parentName;return Q(a,function(n){if(!r.ignore||-1==e.utils.arrayIndexOf(r.ignore,n)){var d=a[n],u=r,h=c||"";if("array"===t.getType(a)?c&&(h+="["+n+"]"):(c&&(h+="."),h+=n),u.parentName=h,-1!==e.utils.arrayIndexOf(r.copy,n)||-1!==e.utils.arrayIndexOf(r.include,n)||!a[s]||!a[s].mappedProperties||a[s].mappedProperties[n]||!a[s].copiedProperties||a[s].copiedProperties[n]||"array"===t.getType(a))switch(t.getType(e.utils.unwrapObservable(d))){case"object":case"array":case"undefined":u=r.visitedObjects.get(d),o[n]="undefined"!==t.getType(u)?u:t.visitModel(d,i,r);break;default:o[n]=i(d,r.parentName)}}}),o}}),function(e,t){"use strict";"object"==typeof module&&"object"==typeof module.exports?module.exports=e.document?t(e,!0):function(e){if(!e.document)throw new Error("jQuery requires a window with a document");return t(e)}:t(e)}("undefined"!=typeof window?window:this,function(i,s){"use strict";var r=[],o=i.document,a=Object.getPrototypeOf,c=r.slice,u=r.concat,h=r.push,p=r.indexOf,f={},m=f.toString,g=f.hasOwnProperty,v=g.toString,y=v.call(Object),S={},C=function(e){return"function"==typeof e&&"number"!=typeof e.nodeType},k=function(e){return null!=e&&e===e.window},x={type:!0,src:!0,nonce:!0,noModule:!0};function b(e,t,n){var i,s,r=(n=n||o).createElement("script");if(r.text=e,t)for(i in x)(s=t[i]||t.getAttribute&&t.getAttribute(i))&&r.setAttribute(i,s);n.head.appendChild(r).parentNode.removeChild(r)}function w(e){return null==e?e+"":"object"==typeof e||"function"==typeof e?f[m.call(e)]||"object":typeof e}var T="3.4.1",R=function(e,t){return new R.fn.init(e,t)},E=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g;function d(e){var t=!!e&&"length"in e&&e.length,n=w(e);return!C(e)&&!k(e)&&("array"===n||0===t||"number"==typeof t&&0<t&&t-1 in e)}R.fn=R.prototype={jquery:T,constructor:R,length:0,toArray:function(){return c.call(this)},get:function(e){return null==e?c.call(this):e<0?this[e+this.length]:this[e]},pushStack:function(e){var t=R.merge(this.constructor(),e);return t.prevObject=this,t},each:function(e){return R.each(this,e)},map:function(e){return this.pushStack(R.map(this,function(t,n){return e.call(t,n,t)}))},slice:function(){return this.pushStack(c.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},eq:function(e){var t=this.length,n=+e+(e<0?t:0);return this.pushStack(0<=n&&n<t?[this[n]]:[])},end:function(){return this.prevObject||this.constructor()},push:h,sort:r.sort,splice:r.splice},R.extend=R.fn.extend=function(){var e,t,n,i,s,r,o=arguments[0]||{},a=1,c=arguments.length,d=!1;for("boolean"==typeof o&&(d=o,o=arguments[a]||{},a++),"object"==typeof o||C(o)||(o={}),a===c&&(o=this,a--);a<c;a++)if(null!=(e=arguments[a]))for(t in e)i=e[t],"__proto__"!==t&&o!==i&&(d&&i&&(R.isPlainObject(i)||(s=Array.isArray(i)))?(n=o[t],r=s&&!Array.isArray(n)?[]:s||R.isPlainObject(n)?n:{},s=!1,o[t]=R.extend(d,r,i)):void 0!==i&&(o[t]=i));return o},R.extend({expando:"jQuery"+(T+Math.random()).replace(/\D/g,""),isReady:!0,error:function(e){throw new Error(e)},noop:function(){},isPlainObject:function(e){var t,n;return!(!e||"[object Object]"!==m.call(e)||(t=a(e))&&("function"!=typeof(n=g.call(t,"constructor")&&t.constructor)||v.call(n)!==y))},isEmptyObject:function(e){var t;for(t in e)return!1;return!0},globalEval:function(e,t){b(e,{nonce:t&&t.nonce})},each:function(e,t){var n,i=0;if(d(e))for(n=e.length;i<n&&!1!==t.call(e[i],i,e[i]);i++);else for(i in e)if(!1===t.call(e[i],i,e[i]))break;return e},trim:function(e){return null==e?"":(e+"").replace(E,"")},makeArray:function(e,t){var n=t||[];return null!=e&&(d(Object(e))?R.merge(n,"string"==typeof e?[e]:e):h.call(n,e)),n},inArray:function(e,t,n){return null==t?-1:p.call(t,e,n)},merge:function(e,t){for(var n=+t.length,i=0,s=e.length;i<n;i++)e[s++]=t[i];return e.length=s,e},grep:function(e,t,n){for(var i=[],s=0,r=e.length,o=!n;s<r;s++)!t(e[s],s)!==o&&i.push(e[s]);return i},map:function(e,t,n){var i,s,r=0,o=[];if(d(e))for(i=e.length;r<i;r++)null!=(s=t(e[r],r,n))&&o.push(s);else for(r in e)null!=(s=t(e[r],r,n))&&o.push(s);return u.apply([],o)},guid:1,support:S}),"function"==typeof Symbol&&(R.fn[Symbol.iterator]=r[Symbol.iterator]),R.each("Boolean Number String Function Array Date RegExp Object Error Symbol".split(" "),function(e,t){f["[object "+t+"]"]=t.toLowerCase()});var _=function(t){var n,i,s,r,o,a,c,d,u,h,l,p,f,m,g,v,b,y,w,S="sizzle"+1*new Date,C=t.document,k=0,P=0,x=ue(),T=ue(),R=ue(),E=ue(),I=function(e,t){return e===t&&(l=!0),0},M={}.hasOwnProperty,_=[],D=_.pop,O=_.push,L=_.push,A=_.slice,N=function(e,t){for(var n=0,i=e.length;n<i;n++)if(e[n]===t)return n;return-1},F="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",j="[\\x20\\t\\r\\n\\f]",V="(?:\\\\.|[\\w-]|[^\0-\\xa0])+",B="\\["+j+"*("+V+")(?:"+j+"*([*^$|!~]?=)"+j+"*(?:'((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\"|("+V+"))|)"+j+"*\\]",U=":("+V+")(?:\\((('((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\")|((?:\\\\.|[^\\\\()[\\]]|"+B+")*)|.*)\\)|)",H=new RegExp(j+"+","g"),q=new RegExp("^"+j+"+|((?:^|[^\\\\])(?:\\\\.)*)"+j+"+$","g"),G=new RegExp("^"+j+"*,"+j+"*"),W=new RegExp("^"+j+"*([>+~]|"+j+")"+j+"*"),z=new RegExp(j+"|>"),$=new RegExp(U),Y=new RegExp("^"+V+"$"),J={ID:new RegExp("^#("+V+")"),CLASS:new RegExp("^\\.("+V+")"),TAG:new RegExp("^("+V+"|[*])"),ATTR:new RegExp("^"+B),PSEUDO:new RegExp("^"+U),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+j+"*(even|odd|(([+-]|)(\\d*)n|)"+j+"*(?:([+-]|)"+j+"*(\\d+)|))"+j+"*\\)|)","i"),bool:new RegExp("^(?:"+F+")$","i"),needsContext:new RegExp("^"+j+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+j+"*((?:-\\d)?\\d*)"+j+"*\\)|)(?=[^-]|$)","i")},X=/HTML$/i,K=/^(?:input|select|textarea|button)$/i,Z=/^h\d$/i,Q=/^[^{]+\{\s*\[native \w/,ee=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,te=/[+~]/,ne=new RegExp("\\\\([\\da-f]{1,6}"+j+"?|("+j+")|.)","ig"),ie=function(e,t,n){var i="0x"+t-65536;return i!=i||n?t:i<0?String.fromCharCode(i+65536):String.fromCharCode(i>>10|55296,1023&i|56320)},re=/([\0-\x1f\x7f]|^-?\d)|^-$|[^\0-\x1f\x7f-\uFFFF\w-]/g,oe=function(e,t){return t?"\0"===e?"�":e.slice(0,-1)+"\\"+e.charCodeAt(e.length-1).toString(16)+" ":"\\"+e},ae=function(){p()},Se=be(function(e){return!0===e.disabled&&"fieldset"===e.nodeName.toLowerCase()},{dir:"parentNode",next:"legend"});try{L.apply(_=A.call(C.childNodes),C.childNodes),_[C.childNodes.length].nodeType}catch(n){L={apply:_.length?function(e,t){O.apply(e,A.call(t))}:function(e,t){for(var n=e.length,i=0;e[n++]=t[i++];);e.length=n-1}}}function se(e,t,n,s){var r,o,c,u,h,l,m,b=t&&t.ownerDocument,y=t?t.nodeType:9;if(n=n||[],"string"!=typeof e||!e||1!==y&&9!==y&&11!==y)return n;if(!s&&((t?t.ownerDocument||t:C)!==f&&p(t),t=t||f,g)){if(11!==y&&(h=ee.exec(e)))if(r=h[1]){if(9===y){if(!(c=t.getElementById(r)))return n;if(c.id===r)return n.push(c),n}else if(b&&(c=b.getElementById(r))&&w(t,c)&&c.id===r)return n.push(c),n}else{if(h[2])return L.apply(n,t.getElementsByTagName(e)),n;if((r=h[3])&&i.getElementsByClassName&&t.getElementsByClassName)return L.apply(n,t.getElementsByClassName(r)),n}if(i.qsa&&!E[e+" "]&&(!v||!v.test(e))&&(1!==y||"object"!==t.nodeName.toLowerCase())){if(m=e,b=t,1===y&&z.test(e)){for((u=t.getAttribute("id"))?u=u.replace(re,oe):t.setAttribute("id",u=S),o=(l=a(e)).length;o--;)l[o]="#"+u+" "+xe(l[o]);m=l.join(","),b=te.test(e)&&ye(t.parentNode)||t}try{return L.apply(n,b.querySelectorAll(m)),n}catch(t){E(e,!0)}finally{u===S&&t.removeAttribute("id")}}}return d(e.replace(q,"$1"),t,n,s)}function ue(){var t=[];return function e(n,i){return t.push(n+" ")>s.cacheLength&&delete e[t.shift()],e[n+" "]=i}}function le(e){return e[S]=!0,e}function ce(e){var t=f.createElement("fieldset");try{return!!e(t)}catch(e){return!1}finally{t.parentNode&&t.parentNode.removeChild(t),t=null}}function fe(e,t){for(var n=e.split("|"),i=n.length;i--;)s.attrHandle[n[i]]=t}function pe(e,t){var n=t&&e,i=n&&1===e.nodeType&&1===t.nodeType&&e.sourceIndex-t.sourceIndex;if(i)return i;if(n)for(;n=n.nextSibling;)if(n===t)return-1;return e?1:-1}function de(e){return function(t){return"input"===t.nodeName.toLowerCase()&&t.type===e}}function he(e){return function(t){var n=t.nodeName.toLowerCase();return("input"===n||"button"===n)&&t.type===e}}function ge(e){return function(t){return"form"in t?t.parentNode&&!1===t.disabled?"label"in t?"label"in t.parentNode?t.parentNode.disabled===e:t.disabled===e:t.isDisabled===e||t.isDisabled!==!e&&Se(t)===e:t.disabled===e:"label"in t&&t.disabled===e}}function ve(e){return le(function(t){return t=+t,le(function(n,i){for(var s,r=e([],n.length,t),o=r.length;o--;)n[s=r[o]]&&(n[s]=!(i[s]=n[s]))})})}function ye(e){return e&&void 0!==e.getElementsByTagName&&e}for(n in i=se.support={},o=se.isXML=function(e){var t=e.namespaceURI,n=(e.ownerDocument||e).documentElement;return!X.test(t||n&&n.nodeName||"HTML")},p=se.setDocument=function(e){var t,n,r=e?e.ownerDocument||e:C;return r!==f&&9===r.nodeType&&r.documentElement&&(m=(f=r).documentElement,g=!o(f),C!==f&&(n=f.defaultView)&&n.top!==n&&(n.addEventListener?n.addEventListener("unload",ae,!1):n.attachEvent&&n.attachEvent("onunload",ae)),i.attributes=ce(function(e){return e.className="i",!e.getAttribute("className")}),i.getElementsByTagName=ce(function(e){return e.appendChild(f.createComment("")),!e.getElementsByTagName("*").length}),i.getElementsByClassName=Q.test(f.getElementsByClassName),i.getById=ce(function(e){return m.appendChild(e).id=S,!f.getElementsByName||!f.getElementsByName(S).length}),i.getById?(s.filter.ID=function(e){var t=e.replace(ne,ie);return function(e){return e.getAttribute("id")===t}},s.find.ID=function(e,t){if(void 0!==t.getElementById&&g){var n=t.getElementById(e);return n?[n]:[]}}):(s.filter.ID=function(e){var t=e.replace(ne,ie);return function(e){var n=void 0!==e.getAttributeNode&&e.getAttributeNode("id");return n&&n.value===t}},s.find.ID=function(e,t){if(void 0!==t.getElementById&&g){var n,i,s,r=t.getElementById(e);if(r){if((n=r.getAttributeNode("id"))&&n.value===e)return[r];for(s=t.getElementsByName(e),i=0;r=s[i++];)if((n=r.getAttributeNode("id"))&&n.value===e)return[r]}return[]}}),s.find.TAG=i.getElementsByTagName?function(e,t){return void 0!==t.getElementsByTagName?t.getElementsByTagName(e):i.qsa?t.querySelectorAll(e):void 0}:function(e,t){var n,i=[],s=0,r=t.getElementsByTagName(e);if("*"===e){for(;n=r[s++];)1===n.nodeType&&i.push(n);return i}return r},s.find.CLASS=i.getElementsByClassName&&function(e,t){if(void 0!==t.getElementsByClassName&&g)return t.getElementsByClassName(e)},b=[],v=[],(i.qsa=Q.test(f.querySelectorAll))&&(ce(function(e){m.appendChild(e).innerHTML="<a id='"+S+"'></a><select id='"+S+"-\r\\' msallowcapture=''><option selected=''></option></select>",e.querySelectorAll("[msallowcapture^='']").length&&v.push("[*^$]="+j+"*(?:''|\"\")"),e.querySelectorAll("[selected]").length||v.push("\\["+j+"*(?:value|"+F+")"),e.querySelectorAll("[id~="+S+"-]").length||v.push("~="),e.querySelectorAll(":checked").length||v.push(":checked"),e.querySelectorAll("a#"+S+"+*").length||v.push(".#.+[+~]")}),ce(function(e){e.innerHTML="<a href='' disabled='disabled'></a><select disabled='disabled'><option/></select>";var t=f.createElement("input");t.setAttribute("type","hidden"),e.appendChild(t).setAttribute("name","D"),e.querySelectorAll("[name=d]").length&&v.push("name"+j+"*[*^$|!~]?="),2!==e.querySelectorAll(":enabled").length&&v.push(":enabled",":disabled"),m.appendChild(e).disabled=!0,2!==e.querySelectorAll(":disabled").length&&v.push(":enabled",":disabled"),e.querySelectorAll("*,:x"),v.push(",.*:")})),(i.matchesSelector=Q.test(y=m.matches||m.webkitMatchesSelector||m.mozMatchesSelector||m.oMatchesSelector||m.msMatchesSelector))&&ce(function(e){i.disconnectedMatch=y.call(e,"*"),y.call(e,"[s!='']:x"),b.push("!=",U)}),v=v.length&&new RegExp(v.join("|")),b=b.length&&new RegExp(b.join("|")),t=Q.test(m.compareDocumentPosition),w=t||Q.test(m.contains)?function(e,t){var n=9===e.nodeType?e.documentElement:e,i=t&&t.parentNode;return e===i||!(!i||1!==i.nodeType||!(n.contains?n.contains(i):e.compareDocumentPosition&&16&e.compareDocumentPosition(i)))}:function(e,t){if(t)for(;t=t.parentNode;)if(t===e)return!0;return!1},I=t?function(e,t){if(e===t)return l=!0,0;var n=!e.compareDocumentPosition-!t.compareDocumentPosition;return n||(1&(n=(e.ownerDocument||e)===(t.ownerDocument||t)?e.compareDocumentPosition(t):1)||!i.sortDetached&&t.compareDocumentPosition(e)===n?e===f||e.ownerDocument===C&&w(C,e)?-1:t===f||t.ownerDocument===C&&w(C,t)?1:h?N(h,e)-N(h,t):0:4&n?-1:1)}:function(e,t){if(e===t)return l=!0,0;var n,i=0,s=e.parentNode,r=t.parentNode,o=[e],a=[t];if(!s||!r)return e===f?-1:t===f?1:s?-1:r?1:h?N(h,e)-N(h,t):0;if(s===r)return pe(e,t);for(n=e;n=n.parentNode;)o.unshift(n);for(n=t;n=n.parentNode;)a.unshift(n);for(;o[i]===a[i];)i++;return i?pe(o[i],a[i]):o[i]===C?-1:a[i]===C?1:0}),f},se.matches=function(e,t){return se(e,null,null,t)},se.matchesSelector=function(e,t){if((e.ownerDocument||e)!==f&&p(e),i.matchesSelector&&g&&!E[t+" "]&&(!b||!b.test(t))&&(!v||!v.test(t)))try{var n=y.call(e,t);if(n||i.disconnectedMatch||e.document&&11!==e.document.nodeType)return n}catch(e){E(t,!0)}return 0<se(t,f,null,[e]).length},se.contains=function(e,t){return(e.ownerDocument||e)!==f&&p(e),w(e,t)},se.attr=function(e,t){(e.ownerDocument||e)!==f&&p(e);var n=s.attrHandle[t.toLowerCase()],r=n&&M.call(s.attrHandle,t.toLowerCase())?n(e,t,!g):void 0;return void 0!==r?r:i.attributes||!g?e.getAttribute(t):(r=e.getAttributeNode(t))&&r.specified?r.value:null},se.escape=function(e){return(e+"").replace(re,oe)},se.error=function(e){throw new Error("Syntax error, unrecognized expression: "+e)},se.uniqueSort=function(e){var t,n=[],s=0,r=0;if(l=!i.detectDuplicates,h=!i.sortStable&&e.slice(0),e.sort(I),l){for(;t=e[r++];)t===e[r]&&(s=n.push(r));for(;s--;)e.splice(n[s],1)}return h=null,e},r=se.getText=function(e){var t,n="",i=0,s=e.nodeType;if(s){if(1===s||9===s||11===s){if("string"==typeof e.textContent)return e.textContent;for(e=e.firstChild;e;e=e.nextSibling)n+=r(e)}else if(3===s||4===s)return e.nodeValue}else for(;t=e[i++];)n+=r(t);return n},(s=se.selectors={cacheLength:50,createPseudo:le,match:J,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(e){return e[1]=e[1].replace(ne,ie),e[3]=(e[3]||e[4]||e[5]||"").replace(ne,ie),"~="===e[2]&&(e[3]=" "+e[3]+" "),e.slice(0,4)},CHILD:function(e){return e[1]=e[1].toLowerCase(),"nth"===e[1].slice(0,3)?(e[3]||se.error(e[0]),e[4]=+(e[4]?e[5]+(e[6]||1):2*("even"===e[3]||"odd"===e[3])),e[5]=+(e[7]+e[8]||"odd"===e[3])):e[3]&&se.error(e[0]),e},PSEUDO:function(e){var t,n=!e[6]&&e[2];return J.CHILD.test(e[0])?null:(e[3]?e[2]=e[4]||e[5]||"":n&&$.test(n)&&(t=a(n,!0))&&(t=n.indexOf(")",n.length-t)-n.length)&&(e[0]=e[0].slice(0,t),e[2]=n.slice(0,t)),e.slice(0,3))}},filter:{TAG:function(e){var t=e.replace(ne,ie).toLowerCase();return"*"===e?function(){return!0}:function(e){return e.nodeName&&e.nodeName.toLowerCase()===t}},CLASS:function(e){var t=x[e+" "];return t||(t=new RegExp("(^|"+j+")"+e+"("+j+"|$)"))&&x(e,function(e){return t.test("string"==typeof e.className&&e.className||void 0!==e.getAttribute&&e.getAttribute("class")||"")})},ATTR:function(e,t,n){return function(i){var s=se.attr(i,e);return null==s?"!="===t:!t||(s+="","="===t?s===n:"!="===t?s!==n:"^="===t?n&&0===s.indexOf(n):"*="===t?n&&-1<s.indexOf(n):"$="===t?n&&s.slice(-n.length)===n:"~="===t?-1<(" "+s.replace(H," ")+" ").indexOf(n):"|="===t&&(s===n||s.slice(0,n.length+1)===n+"-"))}},CHILD:function(e,t,n,i,s){var r="nth"!==e.slice(0,3),o="last"!==e.slice(-4),a="of-type"===t;return 1===i&&0===s?function(e){return!!e.parentNode}:function(t,n,c){var d,u,h,l,p,f,m=r!==o?"nextSibling":"previousSibling",g=t.parentNode,v=a&&t.nodeName.toLowerCase(),b=!c&&!a,y=!1;if(g){if(r){for(;m;){for(l=t;l=l[m];)if(a?l.nodeName.toLowerCase()===v:1===l.nodeType)return!1;f=m="only"===e&&!f&&"nextSibling"}return!0}if(f=[o?g.firstChild:g.lastChild],o&&b){for(y=(p=(d=(u=(h=(l=g)[S]||(l[S]={}))[l.uniqueID]||(h[l.uniqueID]={}))[e]||[])[0]===k&&d[1])&&d[2],l=p&&g.childNodes[p];l=++p&&l&&l[m]||(y=p=0)||f.pop();)if(1===l.nodeType&&++y&&l===t){u[e]=[k,p,y];break}}else if(b&&(y=p=(d=(u=(h=(l=t)[S]||(l[S]={}))[l.uniqueID]||(h[l.uniqueID]={}))[e]||[])[0]===k&&d[1]),!1===y)for(;(l=++p&&l&&l[m]||(y=p=0)||f.pop())&&((a?l.nodeName.toLowerCase()!==v:1!==l.nodeType)||!++y||(b&&((u=(h=l[S]||(l[S]={}))[l.uniqueID]||(h[l.uniqueID]={}))[e]=[k,y]),l!==t)););return(y-=s)===i||y%i==0&&0<=y/i}}},PSEUDO:function(e,t){var n,i=s.pseudos[e]||s.setFilters[e.toLowerCase()]||se.error("unsupported pseudo: "+e);return i[S]?i(t):1<i.length?(n=[e,e,"",t],s.setFilters.hasOwnProperty(e.toLowerCase())?le(function(e,n){for(var s,r=i(e,t),o=r.length;o--;)e[s=N(e,r[o])]=!(n[s]=r[o])}):function(e){return i(e,0,n)}):i}},pseudos:{not:le(function(e){var t=[],n=[],i=c(e.replace(q,"$1"));return i[S]?le(function(e,t,n,s){for(var r,o=i(e,null,s,[]),a=e.length;a--;)(r=o[a])&&(e[a]=!(t[a]=r))}):function(e,s,r){return t[0]=e,i(t,null,r,n),t[0]=null,!n.pop()}}),has:le(function(e){return function(t){return 0<se(e,t).length}}),contains:le(function(e){return e=e.replace(ne,ie),function(t){return-1<(t.textContent||r(t)).indexOf(e)}}),lang:le(function(e){return Y.test(e||"")||se.error("unsupported lang: "+e),e=e.replace(ne,ie).toLowerCase(),function(t){var n;do{if(n=g?t.lang:t.getAttribute("xml:lang")||t.getAttribute("lang"))return(n=n.toLowerCase())===e||0===n.indexOf(e+"-")}while((t=t.parentNode)&&1===t.nodeType);return!1}}),target:function(e){var n=t.location&&t.location.hash;return n&&n.slice(1)===e.id},root:function(e){return e===m},focus:function(e){return e===f.activeElement&&(!f.hasFocus||f.hasFocus())&&!!(e.type||e.href||~e.tabIndex)},enabled:ge(!1),disabled:ge(!0),checked:function(e){var t=e.nodeName.toLowerCase();return"input"===t&&!!e.checked||"option"===t&&!!e.selected},selected:function(e){return e.parentNode&&e.parentNode.selectedIndex,!0===e.selected},empty:function(e){for(e=e.firstChild;e;e=e.nextSibling)if(e.nodeType<6)return!1;return!0},parent:function(e){return!s.pseudos.empty(e)},header:function(e){return Z.test(e.nodeName)},input:function(e){return K.test(e.nodeName)},button:function(e){var t=e.nodeName.toLowerCase();return"input"===t&&"button"===e.type||"button"===t},text:function(e){var t;return"input"===e.nodeName.toLowerCase()&&"text"===e.type&&(null==(t=e.getAttribute("type"))||"text"===t.toLowerCase())},first:ve(function(){return[0]}),last:ve(function(e,t){return[t-1]}),eq:ve(function(e,t,n){return[n<0?n+t:n]}),even:ve(function(e,t){for(var n=0;n<t;n+=2)e.push(n);return e}),odd:ve(function(e,t){for(var n=1;n<t;n+=2)e.push(n);return e}),lt:ve(function(e,t,n){for(var i=n<0?n+t:t<n?t:n;0<=--i;)e.push(i);return e}),gt:ve(function(e,t,n){for(var i=n<0?n+t:n;++i<t;)e.push(i);return e})}}).pseudos.nth=s.pseudos.eq,{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})s.pseudos[n]=de(n);for(n in{submit:!0,reset:!0})s.pseudos[n]=he(n);function me(){}function xe(e){for(var t=0,n=e.length,i="";t<n;t++)i+=e[t].value;return i}function be(e,t,n){var i=t.dir,s=t.next,r=s||i,o=n&&"parentNode"===r,a=P++;return t.first?function(t,n,s){for(;t=t[i];)if(1===t.nodeType||o)return e(t,n,s);return!1}:function(t,n,c){var d,u,h,l=[k,a];if(c){for(;t=t[i];)if((1===t.nodeType||o)&&e(t,n,c))return!0}else for(;t=t[i];)if(1===t.nodeType||o)if(u=(h=t[S]||(t[S]={}))[t.uniqueID]||(h[t.uniqueID]={}),s&&s===t.nodeName.toLowerCase())t=t[i]||t;else{if((d=u[r])&&d[0]===k&&d[1]===a)return l[2]=d[2];if((u[r]=l)[2]=e(t,n,c))return!0}return!1}}function we(e){return 1<e.length?function(t,n,i){for(var s=e.length;s--;)if(!e[s](t,n,i))return!1;return!0}:e[0]}function Te(e,t,n,i,s){for(var r,o=[],a=0,c=e.length,d=null!=t;a<c;a++)(r=e[a])&&(n&&!n(r,i,s)||(o.push(r),d&&t.push(a)));return o}function Ce(e,t,n,i,s,r){return i&&!i[S]&&(i=Ce(i)),s&&!s[S]&&(s=Ce(s,r)),le(function(r,o,a,c){var d,u,h,l=[],p=[],f=o.length,m=r||function(e,t,n){for(var i=0,s=t.length;i<s;i++)se(e,t[i],n);return n}(t||"*",a.nodeType?[a]:a,[]),g=!e||!r&&t?m:Te(m,l,e,a,c),v=n?s||(r?e:f||i)?[]:o:g;if(n&&n(g,v,a,c),i)for(d=Te(v,p),i(d,[],a,c),u=d.length;u--;)(h=d[u])&&(v[p[u]]=!(g[p[u]]=h));if(r){if(s||e){if(s){for(d=[],u=v.length;u--;)(h=v[u])&&d.push(g[u]=h);s(null,v=[],d,c)}for(u=v.length;u--;)(h=v[u])&&-1<(d=s?N(r,h):l[u])&&(r[d]=!(o[d]=h))}}else v=Te(v===o?v.splice(f,v.length):v),s?s(null,o,v,c):L.apply(o,v)})}function Ee(e){for(var t,n,i,r=e.length,o=s.relative[e[0].type],a=o||s.relative[" "],c=o?1:0,d=be(function(e){return e===t},a,!0),h=be(function(e){return-1<N(t,e)},a,!0),l=[function(e,n,i){var s=!o&&(i||n!==u)||((t=n).nodeType?d(e,n,i):h(e,n,i));return t=null,s}];c<r;c++)if(n=s.relative[e[c].type])l=[be(we(l),n)];else{if((n=s.filter[e[c].type].apply(null,e[c].matches))[S]){for(i=++c;i<r&&!s.relative[e[i].type];i++);return Ce(1<c&&we(l),1<c&&xe(e.slice(0,c-1).concat({value:" "===e[c-2].type?"*":""})).replace(q,"$1"),n,c<i&&Ee(e.slice(c,i)),i<r&&Ee(e=e.slice(i)),i<r&&xe(e))}l.push(n)}return we(l)}return me.prototype=s.filters=s.pseudos,s.setFilters=new me,a=se.tokenize=function(e,t){var n,i,r,o,a,c,d,u=T[e+" "];if(u)return t?0:u.slice(0);for(a=e,c=[],d=s.preFilter;a;){for(o in n&&!(i=G.exec(a))||(i&&(a=a.slice(i[0].length)||a),c.push(r=[])),n=!1,(i=W.exec(a))&&(n=i.shift(),r.push({value:n,type:i[0].replace(q," ")}),a=a.slice(n.length)),s.filter)!(i=J[o].exec(a))||d[o]&&!(i=d[o](i))||(n=i.shift(),r.push({value:n,type:o,matches:i}),a=a.slice(n.length));if(!n)break}return t?a.length:a?se.error(e):T(e,c).slice(0)},c=se.compile=function(e,t){var n,i,r,o,c,d,h=[],l=[],m=R[e+" "];if(!m){for(t||(t=a(e)),n=t.length;n--;)(m=Ee(t[n]))[S]?h.push(m):l.push(m);(m=R(e,(i=l,o=0<(r=h).length,c=0<i.length,d=function(e,t,n,a,d){var h,l,m,v=0,b="0",y=e&&[],w=[],S=u,C=e||c&&s.find.TAG("*",d),P=k+=null==S?1:Math.random()||.1,x=C.length;for(d&&(u=t===f||t||d);b!==x&&null!=(h=C[b]);b++){if(c&&h){for(l=0,t||h.ownerDocument===f||(p(h),n=!g);m=i[l++];)if(m(h,t||f,n)){a.push(h);break}d&&(k=P)}o&&((h=!m&&h)&&v--,e&&y.push(h))}if(v+=b,o&&b!==v){for(l=0;m=r[l++];)m(y,w,t,n);if(e){if(0<v)for(;b--;)y[b]||w[b]||(w[b]=D.call(a));w=Te(w)}L.apply(a,w),d&&!e&&0<w.length&&1<v+r.length&&se.uniqueSort(a)}return d&&(k=P,u=S),y},o?le(d):d))).selector=e}return m},d=se.select=function(e,t,n,i){var r,o,d,u,h,l="function"==typeof e&&e,p=!i&&a(e=l.selector||e);if(n=n||[],1===p.length){if(2<(o=p[0]=p[0].slice(0)).length&&"ID"===(d=o[0]).type&&9===t.nodeType&&g&&s.relative[o[1].type]){if(!(t=(s.find.ID(d.matches[0].replace(ne,ie),t)||[])[0]))return n;l&&(t=t.parentNode),e=e.slice(o.shift().value.length)}for(r=J.needsContext.test(e)?0:o.length;r--&&(d=o[r],!s.relative[u=d.type]);)if((h=s.find[u])&&(i=h(d.matches[0].replace(ne,ie),te.test(o[0].type)&&ye(t.parentNode)||t))){if(o.splice(r,1),!(e=i.length&&xe(o)))return L.apply(n,i),n;break}}return(l||c(e,p))(i,t,!g,n,!t||te.test(e)&&ye(t.parentNode)||t),n},i.sortStable=S.split("").sort(I).join("")===S,i.detectDuplicates=!!l,p(),i.sortDetached=ce(function(e){return 1&e.compareDocumentPosition(f.createElement("fieldset"))}),ce(function(e){return e.innerHTML="<a href='#'></a>","#"===e.firstChild.getAttribute("href")})||fe("type|href|height|width",function(e,t,n){if(!n)return e.getAttribute(t,"type"===t.toLowerCase()?1:2)}),i.attributes&&ce(function(e){return e.innerHTML="<input/>",e.firstChild.setAttribute("value",""),""===e.firstChild.getAttribute("value")})||fe("value",function(e,t,n){if(!n&&"input"===e.nodeName.toLowerCase())return e.defaultValue}),ce(function(e){return null==e.getAttribute("disabled")})||fe(F,function(e,t,n){var i;if(!n)return!0===e[t]?t.toLowerCase():(i=e.getAttributeNode(t))&&i.specified?i.value:null}),se}(i);R.find=_,R.expr=_.selectors,R.expr[":"]=R.expr.pseudos,R.uniqueSort=R.unique=_.uniqueSort,R.text=_.getText,R.isXMLDoc=_.isXML,R.contains=_.contains,R.escapeSelector=_.escape;var D=function(e,t,n){for(var i=[],s=void 0!==n;(e=e[t])&&9!==e.nodeType;)if(1===e.nodeType){if(s&&R(e).is(n))break;i.push(e)}return i},O=function(e,t){for(var n=[];e;e=e.nextSibling)1===e.nodeType&&e!==t&&n.push(e);return n},L=R.expr.match.needsContext;function A(e,t){return e.nodeName&&e.nodeName.toLowerCase()===t.toLowerCase()}var N=/^<([a-z][^\/\0>:\x20\t\r\n\f]*)[\x20\t\r\n\f]*\/?>(?:<\/\1>|)$/i;function j(e,t,n){return C(t)?R.grep(e,function(e,i){return!!t.call(e,i,e)!==n}):t.nodeType?R.grep(e,function(e){return e===t!==n}):"string"!=typeof t?R.grep(e,function(e){return-1<p.call(t,e)!==n}):R.filter(t,e,n)}R.filter=function(e,t,n){var i=t[0];return n&&(e=":not("+e+")"),1===t.length&&1===i.nodeType?R.find.matchesSelector(i,e)?[i]:[]:R.find.matches(e,R.grep(t,function(e){return 1===e.nodeType}))},R.fn.extend({find:function(e){var t,n,i=this.length,s=this;if("string"!=typeof e)return this.pushStack(R(e).filter(function(){for(t=0;t<i;t++)if(R.contains(s[t],this))return!0}));for(n=this.pushStack([]),t=0;t<i;t++)R.find(e,s[t],n);return 1<i?R.uniqueSort(n):n},filter:function(e){return this.pushStack(j(this,e||[],!1))},not:function(e){return this.pushStack(j(this,e||[],!0))},is:function(e){return!!j(this,"string"==typeof e&&L.test(e)?R(e):e||[],!1).length}});var F,U=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]+))$/;(R.fn.init=function(e,t,n){var i,s;if(!e)return this;if(n=n||F,"string"==typeof e){if(!(i="<"===e[0]&&">"===e[e.length-1]&&3<=e.length?[null,e,null]:U.exec(e))||!i[1]&&t)return!t||t.jquery?(t||n).find(e):this.constructor(t).find(e);if(i[1]){if(t=t instanceof R?t[0]:t,R.merge(this,R.parseHTML(i[1],t&&t.nodeType?t.ownerDocument||t:o,!0)),N.test(i[1])&&R.isPlainObject(t))for(i in t)C(this[i])?this[i](t[i]):this.attr(i,t[i]);return this}return(s=o.getElementById(i[2]))&&(this[0]=s,this.length=1),this}return e.nodeType?(this[0]=e,this.length=1,this):C(e)?void 0!==n.ready?n.ready(e):e(R):R.makeArray(e,this)}).prototype=R.fn,F=R(o);var H=/^(?:parents|prev(?:Until|All))/,q={children:!0,contents:!0,next:!0,prev:!0};function P(e,t){for(;(e=e[t])&&1!==e.nodeType;);return e}R.fn.extend({has:function(e){var t=R(e,this),n=t.length;return this.filter(function(){for(var e=0;e<n;e++)if(R.contains(this,t[e]))return!0})},closest:function(e,t){var n,i=0,s=this.length,r=[],o="string"!=typeof e&&R(e);if(!L.test(e))for(;i<s;i++)for(n=this[i];n&&n!==t;n=n.parentNode)if(n.nodeType<11&&(o?-1<o.index(n):1===n.nodeType&&R.find.matchesSelector(n,e))){r.push(n);break}return this.pushStack(1<r.length?R.uniqueSort(r):r)},index:function(e){return e?"string"==typeof e?p.call(R(e),this[0]):p.call(this,e.jquery?e[0]:e):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(e,t){return this.pushStack(R.uniqueSort(R.merge(this.get(),R(e,t))))},addBack:function(e){return this.add(null==e?this.prevObject:this.prevObject.filter(e))}}),R.each({parent:function(e){var t=e.parentNode;return t&&11!==t.nodeType?t:null},parents:function(e){return D(e,"parentNode")},parentsUntil:function(e,t,n){return D(e,"parentNode",n)},next:function(e){return P(e,"nextSibling")},prev:function(e){return P(e,"previousSibling")},nextAll:function(e){return D(e,"nextSibling")},prevAll:function(e){return D(e,"previousSibling")},nextUntil:function(e,t,n){return D(e,"nextSibling",n)},prevUntil:function(e,t,n){return D(e,"previousSibling",n)},siblings:function(e){return O((e.parentNode||{}).firstChild,e)},children:function(e){return O(e.firstChild)},contents:function(e){return void 0!==e.contentDocument?e.contentDocument:(A(e,"template")&&(e=e.content||e),R.merge([],e.childNodes))}},function(e,t){R.fn[e]=function(n,i){var s=R.map(this,t,n);return"Until"!==e.slice(-5)&&(i=n),i&&"string"==typeof i&&(s=R.filter(i,s)),1<this.length&&(q[e]||R.uniqueSort(s),H.test(e)&&s.reverse()),this.pushStack(s)}});var G=/[^\x20\t\r\n\f]+/g;function M(e){return e}function I(e){throw e}function W(e,t,n,i){var s;try{e&&C(s=e.promise)?s.call(e).done(t).fail(n):e&&C(s=e.then)?s.call(e,t,n):t.apply(void 0,[e].slice(i))}catch(e){n.apply(void 0,[e])}}R.Callbacks=function(e){var t,i;e="string"==typeof e?(t=e,i={},R.each(t.match(G)||[],function(e,t){i[t]=!0}),i):R.extend({},e);var s,r,o,a,c=[],d=[],u=-1,h=function(){for(a=a||e.once,o=s=!0;d.length;u=-1)for(r=d.shift();++u<c.length;)!1===c[u].apply(r[0],r[1])&&e.stopOnFalse&&(u=c.length,r=!1);e.memory||(r=!1),s=!1,a&&(c=r?[]:"")},l={add:function(){return c&&(r&&!s&&(u=c.length-1,d.push(r)),function n(t){R.each(t,function(t,i){C(i)?e.unique&&l.has(i)||c.push(i):i&&i.length&&"string"!==w(i)&&n(i)})}(arguments),r&&!s&&h()),this},remove:function(){return R.each(arguments,function(e,t){for(var n;-1<(n=R.inArray(t,c,n));)c.splice(n,1),n<=u&&u--}),this},has:function(e){return e?-1<R.inArray(e,c):0<c.length},empty:function(){return c&&(c=[]),this},disable:function(){return a=d=[],c=r="",this},disabled:function(){return!c},lock:function(){return a=d=[],r||s||(c=r=""),this},locked:function(){return!!a},fireWith:function(e,t){return a||(t=[e,(t=t||[]).slice?t.slice():t],d.push(t),s||h()),this},fire:function(){return l.fireWith(this,arguments),this},fired:function(){return!!o}};return l},R.extend({Deferred:function(e){var t=[["notify","progress",R.Callbacks("memory"),R.Callbacks("memory"),2],["resolve","done",R.Callbacks("once memory"),R.Callbacks("once memory"),0,"resolved"],["reject","fail",R.Callbacks("once memory"),R.Callbacks("once memory"),1,"rejected"]],n="pending",s={state:function(){return n},always:function(){return r.done(arguments).fail(arguments),this},catch:function(e){return s.then(null,e)},pipe:function(){var e=arguments;return R.Deferred(function(n){R.each(t,function(t,i){var s=C(e[i[4]])&&e[i[4]];r[i[1]](function(){var e=s&&s.apply(this,arguments);e&&C(e.promise)?e.promise().progress(n.notify).done(n.resolve).fail(n.reject):n[i[0]+"With"](this,s?[e]:arguments)})}),e=null}).promise()},then:function(e,n,s){var r=0;function l(e,t,n,s){return function(){var o=this,a=arguments,c=function(){var i,c;if(!(e<r)){if((i=n.apply(o,a))===t.promise())throw new TypeError("Thenable self-resolution");c=i&&("object"==typeof i||"function"==typeof i)&&i.then,C(c)?s?c.call(i,l(r,t,M,s),l(r,t,I,s)):(r++,c.call(i,l(r,t,M,s),l(r,t,I,s),l(r,t,M,t.notifyWith))):(n!==M&&(o=void 0,a=[i]),(s||t.resolveWith)(o,a))}},d=s?c:function(){try{c()}catch(i){R.Deferred.exceptionHook&&R.Deferred.exceptionHook(i,d.stackTrace),r<=e+1&&(n!==I&&(o=void 0,a=[i]),t.rejectWith(o,a))}};e?d():(R.Deferred.getStackHook&&(d.stackTrace=R.Deferred.getStackHook()),i.setTimeout(d))}}return R.Deferred(function(i){t[0][3].add(l(0,i,C(s)?s:M,i.notifyWith)),t[1][3].add(l(0,i,C(e)?e:M)),t[2][3].add(l(0,i,C(n)?n:I))}).promise()},promise:function(e){return null!=e?R.extend(e,s):s}},r={};return R.each(t,function(e,i){var o=i[2],a=i[5];s[i[1]]=o.add,a&&o.add(function(){n=a},t[3-e][2].disable,t[3-e][3].disable,t[0][2].lock,t[0][3].lock),o.add(i[3].fire),r[i[0]]=function(){return r[i[0]+"With"](this===r?void 0:this,arguments),this},r[i[0]+"With"]=o.fireWith}),s.promise(r),e&&e.call(r,r),r},when:function(e){var t=arguments.length,n=t,i=Array(n),s=c.call(arguments),r=R.Deferred(),o=function(e){return function(n){i[e]=this,s[e]=1<arguments.length?c.call(arguments):n,--t||r.resolveWith(i,s)}};if(t<=1&&(W(e,r.done(o(n)).resolve,r.reject,!t),"pending"===r.state()||C(s[n]&&s[n].then)))return r.then();for(;n--;)W(s[n],o(n),r.reject);return r.promise()}});var z=/^(Eval|Internal|Range|Reference|Syntax|Type|URI)Error$/;R.Deferred.exceptionHook=function(e,t){i.console&&i.console.warn&&e&&z.test(e.name)&&i.console.warn("jQuery.Deferred exception: "+e.message,e.stack,t)},R.readyException=function(e){i.setTimeout(function(){throw e})};var $=R.Deferred();function B(){o.removeEventListener("DOMContentLoaded",B),i.removeEventListener("load",B),R.ready()}R.fn.ready=function(e){return $.then(e).catch(function(e){R.readyException(e)}),this},R.extend({isReady:!1,readyWait:1,ready:function(e){(!0===e?--R.readyWait:R.isReady)||(R.isReady=!0)!==e&&0<--R.readyWait||$.resolveWith(o,[R])}}),R.ready.then=$.then,"complete"===o.readyState||"loading"!==o.readyState&&!o.documentElement.doScroll?i.setTimeout(R.ready):(o.addEventListener("DOMContentLoaded",B),i.addEventListener("load",B));var J=function(e,t,n,i,s,r,o){var a=0,c=e.length,d=null==n;if("object"===w(n))for(a in s=!0,n)J(e,t,a,n[a],!0,r,o);else if(void 0!==i&&(s=!0,C(i)||(o=!0),d&&(o?(t.call(e,i),t=null):(d=t,t=function(e,t,n){return d.call(R(e),n)})),t))for(;a<c;a++)t(e[a],n,o?i:i.call(e[a],a,t(e[a],n)));return s?e:d?t.call(e):c?t(e[0],n):r},K=/^-ms-/,Z=/-([a-z])/g;function X(e,t){return t.toUpperCase()}function V(e){return e.replace(K,"ms-").replace(Z,X)}var Q=function(e){return 1===e.nodeType||9===e.nodeType||!+e.nodeType};function Y(){this.expando=R.expando+Y.uid++}Y.uid=1,Y.prototype={cache:function(e){var t=e[this.expando];return t||(t={},Q(e)&&(e.nodeType?e[this.expando]=t:Object.defineProperty(e,this.expando,{value:t,configurable:!0}))),t},set:function(e,t,n){var i,s=this.cache(e);if("string"==typeof t)s[V(t)]=n;else for(i in t)s[V(i)]=t[i];return s},get:function(e,t){return void 0===t?this.cache(e):e[this.expando]&&e[this.expando][V(t)]},access:function(e,t,n){return void 0===t||t&&"string"==typeof t&&void 0===n?this.get(e,t):(this.set(e,t,n),void 0!==n?n:t)},remove:function(e,t){var n,i=e[this.expando];if(void 0!==i){if(void 0!==t){n=(t=Array.isArray(t)?t.map(V):(t=V(t))in i?[t]:t.match(G)||[]).length;for(;n--;)delete i[t[n]]}(void 0===t||R.isEmptyObject(i))&&(e.nodeType?e[this.expando]=void 0:delete e[this.expando])}},hasData:function(e){var t=e[this.expando];return void 0!==t&&!R.isEmptyObject(t)}};var te=new Y,ne=new Y,ie=/^(?:\{[\w\W]*\}|\[[\w\W]*\])$/,se=/[A-Z]/g;function ee(e,t,n){var i,s;if(void 0===n&&1===e.nodeType)if(i="data-"+t.replace(se,"-$&").toLowerCase(),"string"==typeof(n=e.getAttribute(i))){try{n="true"===(s=n)||"false"!==s&&("null"===s?null:s===+s+""?+s:ie.test(s)?JSON.parse(s):s)}catch(e){}ne.set(e,t,n)}else n=void 0;return n}R.extend({hasData:function(e){return ne.hasData(e)||te.hasData(e)},data:function(e,t,n){return ne.access(e,t,n)},removeData:function(e,t){ne.remove(e,t)},_data:function(e,t,n){return te.access(e,t,n)},_removeData:function(e,t){te.remove(e,t)}}),R.fn.extend({data:function(e,t){var n,i,s,r=this[0],o=r&&r.attributes;if(void 0===e){if(this.length&&(s=ne.get(r),1===r.nodeType&&!te.get(r,"hasDataAttrs"))){for(n=o.length;n--;)o[n]&&0===(i=o[n].name).indexOf("data-")&&(i=V(i.slice(5)),ee(r,i,s[i]));te.set(r,"hasDataAttrs",!0)}return s}return"object"==typeof e?this.each(function(){ne.set(this,e)}):J(this,function(t){var n;if(r&&void 0===t)return void 0!==(n=ne.get(r,e))?n:void 0!==(n=ee(r,e))?n:void 0;this.each(function(){ne.set(this,e,t)})},null,t,1<arguments.length,null,!0)},removeData:function(e){return this.each(function(){ne.remove(this,e)})}}),R.extend({queue:function(e,t,n){var i;if(e)return t=(t||"fx")+"queue",i=te.get(e,t),n&&(!i||Array.isArray(n)?i=te.access(e,t,R.makeArray(n)):i.push(n)),i||[]},dequeue:function(e,t){t=t||"fx";var n=R.queue(e,t),i=n.length,s=n.shift(),r=R._queueHooks(e,t);"inprogress"===s&&(s=n.shift(),i--),s&&("fx"===t&&n.unshift("inprogress"),delete r.stop,s.call(e,function(){R.dequeue(e,t)},r)),!i&&r&&r.empty.fire()},_queueHooks:function(e,t){var n=t+"queueHooks";return te.get(e,n)||te.access(e,n,{empty:R.Callbacks("once memory").add(function(){te.remove(e,[t+"queue",n])})})}}),R.fn.extend({queue:function(e,t){var n=2;return"string"!=typeof e&&(t=e,e="fx",n--),arguments.length<n?R.queue(this[0],e):void 0===t?this:this.each(function(){var n=R.queue(this,e,t);R._queueHooks(this,e),"fx"===e&&"inprogress"!==n[0]&&R.dequeue(this,e)})},dequeue:function(e){return this.each(function(){R.dequeue(this,e)})},clearQueue:function(e){return this.queue(e||"fx",[])},promise:function(e,t){var n,i=1,s=R.Deferred(),r=this,o=this.length,a=function(){--i||s.resolveWith(r,[r])};for("string"!=typeof e&&(t=e,e=void 0),e=e||"fx";o--;)(n=te.get(r[o],e+"queueHooks"))&&n.empty&&(i++,n.empty.add(a));return a(),s.promise(t)}});var re=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,oe=new RegExp("^(?:([+-])=|)("+re+")([a-z%]*)$","i"),ae=["Top","Right","Bottom","Left"],ce=o.documentElement,de=function(e){return R.contains(e.ownerDocument,e)},ue={composed:!0};ce.getRootNode&&(de=function(e){return R.contains(e.ownerDocument,e)||e.getRootNode(ue)===e.ownerDocument});var he=function(e,t){return"none"===(e=t||e).style.display||""===e.style.display&&de(e)&&"none"===R.css(e,"display")},pe=function(e,t,n,i){var s,r,o={};for(r in t)o[r]=e.style[r],e.style[r]=t[r];for(r in s=n.apply(e,i||[]),t)e.style[r]=o[r];return s};function le(e,t,n,i){var s,r,o=20,a=i?function(){return i.cur()}:function(){return R.css(e,t,"")},c=a(),d=n&&n[3]||(R.cssNumber[t]?"":"px"),u=e.nodeType&&(R.cssNumber[t]||"px"!==d&&+c)&&oe.exec(R.css(e,t));if(u&&u[3]!==d){for(c/=2,d=d||u[3],u=+c||1;o--;)R.style(e,t,u+d),(1-r)*(1-(r=a()/c||.5))<=0&&(o=0),u/=r;u*=2,R.style(e,t,u+d),n=n||[]}return n&&(u=+u||+c||0,s=n[1]?u+(n[1]+1)*n[2]:+n[2],i&&(i.unit=d,i.start=u,i.end=s)),s}var me={};function fe(e,t){for(var n,i,s,r,o,a,c,d=[],u=0,h=e.length;u<h;u++)(i=e[u]).style&&(n=i.style.display,t?("none"===n&&(d[u]=te.get(i,"display")||null,d[u]||(i.style.display="")),""===i.style.display&&he(i)&&(d[u]=(c=o=r=void 0,o=(s=i).ownerDocument,a=s.nodeName,(c=me[a])||(r=o.body.appendChild(o.createElement(a)),c=R.css(r,"display"),r.parentNode.removeChild(r),"none"===c&&(c="block"),me[a]=c)))):"none"!==n&&(d[u]="none",te.set(i,"display",n)));for(u=0;u<h;u++)null!=d[u]&&(e[u].style.display=d[u]);return e}R.fn.extend({show:function(){return fe(this,!0)},hide:function(){return fe(this)},toggle:function(e){return"boolean"==typeof e?e?this.show():this.hide():this.each(function(){he(this)?R(this).show():R(this).hide()})}});var ge=/^(?:checkbox|radio)$/i,be=/<([a-z][^\/\0>\x20\t\r\n\f]*)/i,Ce=/^$|^module$|\/(?:java|ecma)script/i,xe={option:[1,"<select multiple='multiple'>","</select>"],thead:[1,"<table>","</table>"],col:[2,"<table><colgroup>","</colgroup></table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:[0,"",""]};function ve(e,t){var n;return n=void 0!==e.getElementsByTagName?e.getElementsByTagName(t||"*"):void 0!==e.querySelectorAll?e.querySelectorAll(t||"*"):[],void 0===t||t&&A(e,t)?R.merge([e],n):n}function ye(e,t){for(var n=0,i=e.length;n<i;n++)te.set(e[n],"globalEval",!t||te.get(t[n],"globalEval"))}xe.optgroup=xe.option,xe.tbody=xe.tfoot=xe.colgroup=xe.caption=xe.thead,xe.th=xe.td;var Te,Ee,Le=/<|&#?\w+;/;function we(e,t,n,i,s){for(var r,o,a,c,d,u,h=t.createDocumentFragment(),l=[],p=0,f=e.length;p<f;p++)if((r=e[p])||0===r)if("object"===w(r))R.merge(l,r.nodeType?[r]:r);else if(Le.test(r)){for(o=o||h.appendChild(t.createElement("div")),a=(be.exec(r)||["",""])[1].toLowerCase(),c=xe[a]||xe._default,o.innerHTML=c[1]+R.htmlPrefilter(r)+c[2],u=c[0];u--;)o=o.lastChild;R.merge(l,o.childNodes),(o=h.firstChild).textContent=""}else l.push(t.createTextNode(r));for(h.textContent="",p=0;r=l[p++];)if(i&&-1<R.inArray(r,i))s&&s.push(r);else if(d=de(r),o=ve(h.appendChild(r),"script"),d&&ye(o),n)for(u=0;r=o[u++];)Ce.test(r.type||"")&&n.push(r);return h}Te=o.createDocumentFragment().appendChild(o.createElement("div")),(Ee=o.createElement("input")).setAttribute("type","radio"),Ee.setAttribute("checked","checked"),Ee.setAttribute("name","t"),Te.appendChild(Ee),S.checkClone=Te.cloneNode(!0).cloneNode(!0).lastChild.checked,Te.innerHTML="<textarea>x</textarea>",S.noCloneChecked=!!Te.cloneNode(!0).lastChild.defaultValue;var Fe=/^key/,je=/^(?:mouse|pointer|contextmenu|drag|drop)|click/,Ve=/^([^.]*)(?:\.(.+)|)/;function ke(){return!0}function Se(){return!1}function Ne(e,t){return e===function(){try{return o.activeElement}catch(e){}}()==("focus"===t)}function Ae(e,t,n,i,s,r){var o,a;if("object"==typeof t){for(a in"string"!=typeof n&&(i=i||n,n=void 0),t)Ae(e,a,n,i,t[a],r);return e}if(null==i&&null==s?(s=n,i=n=void 0):null==s&&("string"==typeof n?(s=i,i=void 0):(s=i,i=n,n=void 0)),!1===s)s=Se;else if(!s)return e;return 1===r&&(o=s,(s=function(e){return R().off(e),o.apply(this,arguments)}).guid=o.guid||(o.guid=R.guid++)),e.each(function(){R.event.add(this,t,s,i,n)})}function De(e,t,n){n?(te.set(e,t,!1),R.event.add(e,t,{namespace:!1,handler:function(e){var i,s,r=te.get(this,t);if(1&e.isTrigger&&this[t]){if(r.length)(R.event.special[t]||{}).delegateType&&e.stopPropagation();else if(r=c.call(arguments),te.set(this,t,r),i=n(this,t),this[t](),r!==(s=te.get(this,t))||i?te.set(this,t,!1):s={},r!==s)return e.stopImmediatePropagation(),e.preventDefault(),s.value}else r.length&&(te.set(this,t,{value:R.event.trigger(R.extend(r[0],R.Event.prototype),r.slice(1),this)}),e.stopImmediatePropagation())}})):void 0===te.get(e,t)&&R.event.add(e,t,ke)}R.event={global:{},add:function(e,t,n,i,s){var r,o,a,c,d,u,h,l,p,f,m,g=te.get(e);if(g)for(n.handler&&(n=(r=n).handler,s=r.selector),s&&R.find.matchesSelector(ce,s),n.guid||(n.guid=R.guid++),(c=g.events)||(c=g.events={}),(o=g.handle)||(o=g.handle=function(t){return void 0!==R&&R.event.triggered!==t.type?R.event.dispatch.apply(e,arguments):void 0}),d=(t=(t||"").match(G)||[""]).length;d--;)p=m=(a=Ve.exec(t[d])||[])[1],f=(a[2]||"").split(".").sort(),p&&(h=R.event.special[p]||{},p=(s?h.delegateType:h.bindType)||p,h=R.event.special[p]||{},u=R.extend({type:p,origType:m,data:i,handler:n,guid:n.guid,selector:s,needsContext:s&&R.expr.match.needsContext.test(s),namespace:f.join(".")},r),(l=c[p])||((l=c[p]=[]).delegateCount=0,h.setup&&!1!==h.setup.call(e,i,f,o)||e.addEventListener&&e.addEventListener(p,o)),h.add&&(h.add.call(e,u),u.handler.guid||(u.handler.guid=n.guid)),s?l.splice(l.delegateCount++,0,u):l.push(u),R.event.global[p]=!0)},remove:function(e,t,n,i,s){var r,o,a,c,d,u,h,l,p,f,m,g=te.hasData(e)&&te.get(e);if(g&&(c=g.events)){for(d=(t=(t||"").match(G)||[""]).length;d--;)if(p=m=(a=Ve.exec(t[d])||[])[1],f=(a[2]||"").split(".").sort(),p){for(h=R.event.special[p]||{},l=c[p=(i?h.delegateType:h.bindType)||p]||[],a=a[2]&&new RegExp("(^|\\.)"+f.join("\\.(?:.*\\.|)")+"(\\.|$)"),o=r=l.length;r--;)u=l[r],!s&&m!==u.origType||n&&n.guid!==u.guid||a&&!a.test(u.namespace)||i&&i!==u.selector&&("**"!==i||!u.selector)||(l.splice(r,1),u.selector&&l.delegateCount--,h.remove&&h.remove.call(e,u));o&&!l.length&&(h.teardown&&!1!==h.teardown.call(e,f,g.handle)||R.removeEvent(e,p,g.handle),delete c[p])}else for(p in c)R.event.remove(e,p+t[d],n,i,!0);R.isEmptyObject(c)&&te.remove(e,"handle events")}},dispatch:function(e){var t,n,i,s,r,o,a=R.event.fix(e),c=new Array(arguments.length),d=(te.get(this,"events")||{})[a.type]||[],u=R.event.special[a.type]||{};for(c[0]=a,t=1;t<arguments.length;t++)c[t]=arguments[t];if(a.delegateTarget=this,!u.preDispatch||!1!==u.preDispatch.call(this,a)){for(o=R.event.handlers.call(this,a,d),t=0;(s=o[t++])&&!a.isPropagationStopped();)for(a.currentTarget=s.elem,n=0;(r=s.handlers[n++])&&!a.isImmediatePropagationStopped();)a.rnamespace&&!1!==r.namespace&&!a.rnamespace.test(r.namespace)||(a.handleObj=r,a.data=r.data,void 0!==(i=((R.event.special[r.origType]||{}).handle||r.handler).apply(s.elem,c))&&!1===(a.result=i)&&(a.preventDefault(),a.stopPropagation()));return u.postDispatch&&u.postDispatch.call(this,a),a.result}},handlers:function(e,t){var n,i,s,r,o,a=[],c=t.delegateCount,d=e.target;if(c&&d.nodeType&&!("click"===e.type&&1<=e.button))for(;d!==this;d=d.parentNode||this)if(1===d.nodeType&&("click"!==e.type||!0!==d.disabled)){for(r=[],o={},n=0;n<c;n++)void 0===o[s=(i=t[n]).selector+" "]&&(o[s]=i.needsContext?-1<R(s,this).index(d):R.find(s,this,null,[d]).length),o[s]&&r.push(i);r.length&&a.push({elem:d,handlers:r})}return d=this,c<t.length&&a.push({elem:d,handlers:t.slice(c)}),a},addProp:function(e,t){Object.defineProperty(R.Event.prototype,e,{enumerable:!0,configurable:!0,get:C(t)?function(){if(this.originalEvent)return t(this.originalEvent)}:function(){if(this.originalEvent)return this.originalEvent[e]},set:function(t){Object.defineProperty(this,e,{enumerable:!0,configurable:!0,writable:!0,value:t})}})},fix:function(e){return e[R.expando]?e:new R.Event(e)},special:{load:{noBubble:!0},click:{setup:function(e){var t=this||e;return ge.test(t.type)&&t.click&&A(t,"input")&&De(t,"click",ke),!1},trigger:function(e){var t=this||e;return ge.test(t.type)&&t.click&&A(t,"input")&&De(t,"click"),!0},_default:function(e){var t=e.target;return ge.test(t.type)&&t.click&&A(t,"input")&&te.get(t,"click")||A(t,"a")}},beforeunload:{postDispatch:function(e){void 0!==e.result&&e.originalEvent&&(e.originalEvent.returnValue=e.result)}}}},R.removeEvent=function(e,t,n){e.removeEventListener&&e.removeEventListener(t,n)},R.Event=function(e,t){if(!(this instanceof R.Event))return new R.Event(e,t);e&&e.type?(this.originalEvent=e,this.type=e.type,this.isDefaultPrevented=e.defaultPrevented||void 0===e.defaultPrevented&&!1===e.returnValue?ke:Se,this.target=e.target&&3===e.target.nodeType?e.target.parentNode:e.target,this.currentTarget=e.currentTarget,this.relatedTarget=e.relatedTarget):this.type=e,t&&R.extend(this,t),this.timeStamp=e&&e.timeStamp||Date.now(),this[R.expando]=!0},R.Event.prototype={constructor:R.Event,isDefaultPrevented:Se,isPropagationStopped:Se,isImmediatePropagationStopped:Se,isSimulated:!1,preventDefault:function(){var e=this.originalEvent;this.isDefaultPrevented=ke,e&&!this.isSimulated&&e.preventDefault()},stopPropagation:function(){var e=this.originalEvent;this.isPropagationStopped=ke,e&&!this.isSimulated&&e.stopPropagation()},stopImmediatePropagation:function(){var e=this.originalEvent;this.isImmediatePropagationStopped=ke,e&&!this.isSimulated&&e.stopImmediatePropagation(),this.stopPropagation()}},R.each({altKey:!0,bubbles:!0,cancelable:!0,changedTouches:!0,ctrlKey:!0,detail:!0,eventPhase:!0,metaKey:!0,pageX:!0,pageY:!0,shiftKey:!0,view:!0,char:!0,code:!0,charCode:!0,key:!0,keyCode:!0,button:!0,buttons:!0,clientX:!0,clientY:!0,offsetX:!0,offsetY:!0,pointerId:!0,pointerType:!0,screenX:!0,screenY:!0,targetTouches:!0,toElement:!0,touches:!0,which:function(e){var t=e.button;return null==e.which&&Fe.test(e.type)?null!=e.charCode?e.charCode:e.keyCode:!e.which&&void 0!==t&&je.test(e.type)?1&t?1:2&t?3:4&t?2:0:e.which}},R.event.addProp),R.each({focus:"focusin",blur:"focusout"},function(e,t){R.event.special[e]={setup:function(){return De(this,e,Ne),!1},trigger:function(){return De(this,e),!0},delegateType:t}}),R.each({mouseenter:"mouseover",mouseleave:"mouseout",pointerenter:"pointerover",pointerleave:"pointerout"},function(e,t){R.event.special[e]={delegateType:t,bindType:t,handle:function(e){var n,i=e.relatedTarget,s=e.handleObj;return i&&(i===this||R.contains(this,i))||(e.type=s.origType,n=s.handler.apply(this,arguments),e.type=t),n}}}),R.fn.extend({on:function(e,t,n,i){return Ae(this,e,t,n,i)},one:function(e,t,n,i){return Ae(this,e,t,n,i,1)},off:function(e,t,n){var i,s;if(e&&e.preventDefault&&e.handleObj)return i=e.handleObj,R(e.delegateTarget).off(i.namespace?i.origType+"."+i.namespace:i.origType,i.selector,i.handler),this;if("object"==typeof e){for(s in e)this.off(s,t,e[s]);return this}return!1!==t&&"function"!=typeof t||(n=t,t=void 0),!1===n&&(n=Se),this.each(function(){R.event.remove(this,e,n,t)})}});var Be=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([a-z][^\/\0>\x20\t\r\n\f]*)[^>]*)\/>/gi,Ue=/<script|<style|<link/i,He=/checked\s*(?:[^=]|=\s*.checked.)/i,qe=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g;function Oe(e,t){return A(e,"table")&&A(11!==t.nodeType?t:t.firstChild,"tr")&&R(e).children("tbody")[0]||e}function Pe(e){return e.type=(null!==e.getAttribute("type"))+"/"+e.type,e}function Re(e){return"true/"===(e.type||"").slice(0,5)?e.type=e.type.slice(5):e.removeAttribute("type"),e}function Me(e,t){var n,i,s,r,o,a,c,d;if(1===t.nodeType){if(te.hasData(e)&&(r=te.access(e),o=te.set(t,r),d=r.events))for(s in delete o.handle,o.events={},d)for(n=0,i=d[s].length;n<i;n++)R.event.add(t,s,d[s][n]);ne.hasData(e)&&(a=ne.access(e),c=R.extend({},a),ne.set(t,c))}}function Ie(e,t,n,i){t=u.apply([],t);var s,r,o,a,c,d,h=0,l=e.length,p=l-1,f=t[0],m=C(f);if(m||1<l&&"string"==typeof f&&!S.checkClone&&He.test(f))return e.each(function(s){var r=e.eq(s);m&&(t[0]=f.call(this,s,r.html())),Ie(r,t,n,i)});if(l&&(r=(s=we(t,e[0].ownerDocument,!1,e,i)).firstChild,1===s.childNodes.length&&(s=r),r||i)){for(a=(o=R.map(ve(s,"script"),Pe)).length;h<l;h++)c=s,h!==p&&(c=R.clone(c,!0,!0),a&&R.merge(o,ve(c,"script"))),n.call(e[h],c,h);if(a)for(d=o[o.length-1].ownerDocument,R.map(o,Re),h=0;h<a;h++)c=o[h],Ce.test(c.type||"")&&!te.access(c,"globalEval")&&R.contains(d,c)&&(c.src&&"module"!==(c.type||"").toLowerCase()?R._evalUrl&&!c.noModule&&R._evalUrl(c.src,{nonce:c.nonce||c.getAttribute("nonce")}):b(c.textContent.replace(qe,""),c,d))}return e}function We(e,t,n){for(var i,s=t?R.filter(t,e):e,r=0;null!=(i=s[r]);r++)n||1!==i.nodeType||R.cleanData(ve(i)),i.parentNode&&(n&&de(i)&&ye(ve(i,"script")),i.parentNode.removeChild(i));return e}R.extend({htmlPrefilter:function(e){return e.replace(Be,"<$1></$2>")},clone:function(e,t,n){var i,s,r,o,a,c,d,u=e.cloneNode(!0),h=de(e);if(!(S.noCloneChecked||1!==e.nodeType&&11!==e.nodeType||R.isXMLDoc(e)))for(o=ve(u),i=0,s=(r=ve(e)).length;i<s;i++)a=r[i],"input"===(d=(c=o[i]).nodeName.toLowerCase())&&ge.test(a.type)?c.checked=a.checked:"input"!==d&&"textarea"!==d||(c.defaultValue=a.defaultValue);if(t)if(n)for(r=r||ve(e),o=o||ve(u),i=0,s=r.length;i<s;i++)Me(r[i],o[i]);else Me(e,u);return 0<(o=ve(u,"script")).length&&ye(o,!h&&ve(e,"script")),u},cleanData:function(e){for(var t,n,i,s=R.event.special,r=0;void 0!==(n=e[r]);r++)if(Q(n)){if(t=n[te.expando]){if(t.events)for(i in t.events)s[i]?R.event.remove(n,i):R.removeEvent(n,i,t.handle);n[te.expando]=void 0}n[ne.expando]&&(n[ne.expando]=void 0)}}}),R.fn.extend({detach:function(e){return We(this,e,!0)},remove:function(e){return We(this,e)},text:function(e){return J(this,function(e){return void 0===e?R.text(this):this.empty().each(function(){1!==this.nodeType&&11!==this.nodeType&&9!==this.nodeType||(this.textContent=e)})},null,e,arguments.length)},append:function(){return Ie(this,arguments,function(e){1!==this.nodeType&&11!==this.nodeType&&9!==this.nodeType||Oe(this,e).appendChild(e)})},prepend:function(){return Ie(this,arguments,function(e){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var t=Oe(this,e);t.insertBefore(e,t.firstChild)}})},before:function(){return Ie(this,arguments,function(e){this.parentNode&&this.parentNode.insertBefore(e,this)})},after:function(){return Ie(this,arguments,function(e){this.parentNode&&this.parentNode.insertBefore(e,this.nextSibling)})},empty:function(){for(var e,t=0;null!=(e=this[t]);t++)1===e.nodeType&&(R.cleanData(ve(e,!1)),e.textContent="");return this},clone:function(e,t){return e=null!=e&&e,t=null==t?e:t,this.map(function(){return R.clone(this,e,t)})},html:function(e){return J(this,function(e){var t=this[0]||{},n=0,i=this.length;if(void 0===e&&1===t.nodeType)return t.innerHTML;if("string"==typeof e&&!Ue.test(e)&&!xe[(be.exec(e)||["",""])[1].toLowerCase()]){e=R.htmlPrefilter(e);try{for(;n<i;n++)1===(t=this[n]||{}).nodeType&&(R.cleanData(ve(t,!1)),t.innerHTML=e);t=0}catch(e){}}t&&this.empty().append(e)},null,e,arguments.length)},replaceWith:function(){var e=[];return Ie(this,arguments,function(t){var n=this.parentNode;R.inArray(this,e)<0&&(R.cleanData(ve(this)),n&&n.replaceChild(t,this))},e)}}),R.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(e,t){R.fn[e]=function(e){for(var n,i=[],s=R(e),r=s.length-1,o=0;o<=r;o++)n=o===r?this:this.clone(!0),R(s[o])[t](n),h.apply(i,n.get());return this.pushStack(i)}});var $e=new RegExp("^("+re+")(?!px)[a-z%]+$","i"),Ye=function(e){var t=e.ownerDocument.defaultView;return t&&t.opener||(t=i),t.getComputedStyle(e)},Je=new RegExp(ae.join("|"),"i");function _e(e,t,n){var i,s,r,o,a=e.style;return(n=n||Ye(e))&&(""!==(o=n.getPropertyValue(t)||n[t])||de(e)||(o=R.style(e,t)),!S.pixelBoxStyles()&&$e.test(o)&&Je.test(t)&&(i=a.width,s=a.minWidth,r=a.maxWidth,a.minWidth=a.maxWidth=a.width=o,o=n.width,a.width=i,a.minWidth=s,a.maxWidth=r)),void 0!==o?o+"":o}function ze(e,t){return{get:function(){if(!e())return(this.get=t).apply(this,arguments);delete this.get}}}!function(){function e(){if(u){d.style.cssText="position:absolute;left:-11111px;width:60px;margin-top:1px;padding:0;border:0",u.style.cssText="position:relative;display:block;box-sizing:border-box;overflow:scroll;margin:auto;border:1px;padding:1px;width:60%;top:1%",ce.appendChild(d).appendChild(u);var e=i.getComputedStyle(u);n="1%"!==e.top,c=12===t(e.marginLeft),u.style.right="60%",a=36===t(e.right),s=36===t(e.width),u.style.position="absolute",r=12===t(u.offsetWidth/3),ce.removeChild(d),u=null}}function t(e){return Math.round(parseFloat(e))}var n,s,r,a,c,d=o.createElement("div"),u=o.createElement("div");u.style&&(u.style.backgroundClip="content-box",u.cloneNode(!0).style.backgroundClip="",S.clearCloneStyle="content-box"===u.style.backgroundClip,R.extend(S,{boxSizingReliable:function(){return e(),s},pixelBoxStyles:function(){return e(),a},pixelPosition:function(){return e(),n},reliableMarginLeft:function(){return e(),c},scrollboxSize:function(){return e(),r}}))}();var Xe=["Webkit","Moz","ms"],Ke=o.createElement("div").style,Qe={};function Ge(e){return R.cssProps[e]||Qe[e]||(e in Ke?e:Qe[e]=function(e){for(var t=e[0].toUpperCase()+e.slice(1),n=Xe.length;n--;)if((e=Xe[n]+t)in Ke)return e}(e)||e)}var it=/^(none|table(?!-c[ea]).+)/,st=/^--/,rt={position:"absolute",visibility:"hidden",display:"block"},ot={letterSpacing:"0",fontWeight:"400"};function Ze(e,t,n){var i=oe.exec(t);return i?Math.max(0,i[2]-(n||0))+(i[3]||"px"):t}function et(e,t,n,i,s,r){var o="width"===t?1:0,a=0,c=0;if(n===(i?"border":"content"))return 0;for(;o<4;o+=2)"margin"===n&&(c+=R.css(e,n+ae[o],!0,s)),i?("content"===n&&(c-=R.css(e,"padding"+ae[o],!0,s)),"margin"!==n&&(c-=R.css(e,"border"+ae[o]+"Width",!0,s))):(c+=R.css(e,"padding"+ae[o],!0,s),"padding"!==n?c+=R.css(e,"border"+ae[o]+"Width",!0,s):a+=R.css(e,"border"+ae[o]+"Width",!0,s));return!i&&0<=r&&(c+=Math.max(0,Math.ceil(e["offset"+t[0].toUpperCase()+t.slice(1)]-r-c-a-.5))||0),c}function tt(e,t,n){var i=Ye(e),s=(!S.boxSizingReliable()||n)&&"border-box"===R.css(e,"boxSizing",!1,i),r=s,o=_e(e,t,i),a="offset"+t[0].toUpperCase()+t.slice(1);if($e.test(o)){if(!n)return o;o="auto"}return(!S.boxSizingReliable()&&s||"auto"===o||!parseFloat(o)&&"inline"===R.css(e,"display",!1,i))&&e.getClientRects().length&&(s="border-box"===R.css(e,"boxSizing",!1,i),(r=a in e)&&(o=e[a])),(o=parseFloat(o)||0)+et(e,t,n||(s?"border":"content"),r,i,o)+"px"}function nt(e,t,n,i,s){return new nt.prototype.init(e,t,n,i,s)}R.extend({cssHooks:{opacity:{get:function(e,t){if(t){var n=_e(e,"opacity");return""===n?"1":n}}}},cssNumber:{animationIterationCount:!0,columnCount:!0,fillOpacity:!0,flexGrow:!0,flexShrink:!0,fontWeight:!0,gridArea:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnStart:!0,gridRow:!0,gridRowEnd:!0,gridRowStart:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{},style:function(e,t,n,i){if(e&&3!==e.nodeType&&8!==e.nodeType&&e.style){var s,r,o,a=V(t),c=st.test(t),d=e.style;if(c||(t=Ge(a)),o=R.cssHooks[t]||R.cssHooks[a],void 0===n)return o&&"get"in o&&void 0!==(s=o.get(e,!1,i))?s:d[t];"string"==(r=typeof n)&&(s=oe.exec(n))&&s[1]&&(n=le(e,t,s),r="number"),null!=n&&n==n&&("number"!==r||c||(n+=s&&s[3]||(R.cssNumber[a]?"":"px")),S.clearCloneStyle||""!==n||0!==t.indexOf("background")||(d[t]="inherit"),o&&"set"in o&&void 0===(n=o.set(e,n,i))||(c?d.setProperty(t,n):d[t]=n))}},css:function(e,t,n,i){var s,r,o,a=V(t);return st.test(t)||(t=Ge(a)),(o=R.cssHooks[t]||R.cssHooks[a])&&"get"in o&&(s=o.get(e,!0,n)),void 0===s&&(s=_e(e,t,i)),"normal"===s&&t in ot&&(s=ot[t]),""===n||n?(r=parseFloat(s),!0===n||isFinite(r)?r||0:s):s}}),R.each(["height","width"],function(e,t){R.cssHooks[t]={get:function(e,n,i){if(n)return!it.test(R.css(e,"display"))||e.getClientRects().length&&e.getBoundingClientRect().width?tt(e,t,i):pe(e,rt,function(){return tt(e,t,i)})},set:function(e,n,i){var s,r=Ye(e),o=!S.scrollboxSize()&&"absolute"===r.position,a=(o||i)&&"border-box"===R.css(e,"boxSizing",!1,r),c=i?et(e,t,i,a,r):0;return a&&o&&(c-=Math.ceil(e["offset"+t[0].toUpperCase()+t.slice(1)]-parseFloat(r[t])-et(e,t,"border",!1,r)-.5)),c&&(s=oe.exec(n))&&"px"!==(s[3]||"px")&&(e.style[t]=n,n=R.css(e,t)),Ze(0,n,c)}}}),R.cssHooks.marginLeft=ze(S.reliableMarginLeft,function(e,t){if(t)return(parseFloat(_e(e,"marginLeft"))||e.getBoundingClientRect().left-pe(e,{marginLeft:0},function(){return e.getBoundingClientRect().left}))+"px"}),R.each({margin:"",padding:"",border:"Width"},function(e,t){R.cssHooks[e+t]={expand:function(n){for(var i=0,s={},r="string"==typeof n?n.split(" "):[n];i<4;i++)s[e+ae[i]+t]=r[i]||r[i-2]||r[0];return s}},"margin"!==e&&(R.cssHooks[e+t].set=Ze)}),R.fn.extend({css:function(e,t){return J(this,function(e,t,n){var i,s,r={},o=0;if(Array.isArray(t)){for(i=Ye(e),s=t.length;o<s;o++)r[t[o]]=R.css(e,t[o],!1,i);return r}return void 0!==n?R.style(e,t,n):R.css(e,t)},e,t,1<arguments.length)}}),((R.Tween=nt).prototype={constructor:nt,init:function(e,t,n,i,s,r){this.elem=e,this.prop=n,this.easing=s||R.easing._default,this.options=t,this.start=this.now=this.cur(),this.end=i,this.unit=r||(R.cssNumber[n]?"":"px")},cur:function(){var e=nt.propHooks[this.prop];return e&&e.get?e.get(this):nt.propHooks._default.get(this)},run:function(e){var t,n=nt.propHooks[this.prop];return this.options.duration?this.pos=t=R.easing[this.easing](e,this.options.duration*e,0,1,this.options.duration):this.pos=t=e,this.now=(this.end-this.start)*t+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),n&&n.set?n.set(this):nt.propHooks._default.set(this),this}}).init.prototype=nt.prototype,(nt.propHooks={_default:{get:function(e){var t;return 1!==e.elem.nodeType||null!=e.elem[e.prop]&&null==e.elem.style[e.prop]?e.elem[e.prop]:(t=R.css(e.elem,e.prop,""))&&"auto"!==t?t:0},set:function(e){R.fx.step[e.prop]?R.fx.step[e.prop](e):1!==e.elem.nodeType||!R.cssHooks[e.prop]&&null==e.elem.style[Ge(e.prop)]?e.elem[e.prop]=e.now:R.style(e.elem,e.prop,e.now+e.unit)}}}).scrollTop=nt.propHooks.scrollLeft={set:function(e){e.elem.nodeType&&e.elem.parentNode&&(e.elem[e.prop]=e.now)}},R.easing={linear:function(e){return e},swing:function(e){return.5-Math.cos(e*Math.PI)/2},_default:"swing"},R.fx=nt.prototype.init,R.fx.step={};var at,ut,ht,gt,vt=/^(?:toggle|show|hide)$/,yt=/queueHooks$/;function lt(){ut&&(!1===o.hidden&&i.requestAnimationFrame?i.requestAnimationFrame(lt):i.setTimeout(lt,R.fx.interval),R.fx.tick())}function ct(){return i.setTimeout(function(){at=void 0}),at=Date.now()}function ft(e,t){var n,i=0,s={height:e};for(t=t?1:0;i<4;i+=2-t)s["margin"+(n=ae[i])]=s["padding"+n]=e;return t&&(s.opacity=s.width=e),s}function pt(e,t,n){for(var i,s=(dt.tweeners[t]||[]).concat(dt.tweeners["*"]),r=0,o=s.length;r<o;r++)if(i=s[r].call(n,t,e))return i}function dt(e,t,n){var i,s,r=0,o=dt.prefilters.length,a=R.Deferred().always(function(){delete c.elem}),c=function(){if(s)return!1;for(var t=at||ct(),n=Math.max(0,d.startTime+d.duration-t),i=1-(n/d.duration||0),r=0,o=d.tweens.length;r<o;r++)d.tweens[r].run(i);return a.notifyWith(e,[d,i,n]),i<1&&o?n:(o||a.notifyWith(e,[d,1,0]),a.resolveWith(e,[d]),!1)},d=a.promise({elem:e,props:R.extend({},t),opts:R.extend(!0,{specialEasing:{},easing:R.easing._default},n),originalProperties:t,originalOptions:n,startTime:at||ct(),duration:n.duration,tweens:[],createTween:function(t,n){var i=R.Tween(e,d.opts,t,n,d.opts.specialEasing[t]||d.opts.easing);return d.tweens.push(i),i},stop:function(t){var n=0,i=t?d.tweens.length:0;if(s)return this;for(s=!0;n<i;n++)d.tweens[n].run(1);return t?(a.notifyWith(e,[d,1,0]),a.resolveWith(e,[d,t])):a.rejectWith(e,[d,t]),this}}),u=d.props;for(function(e,t){var n,i,s,r,o;for(n in e)if(s=t[i=V(n)],r=e[n],Array.isArray(r)&&(s=r[1],r=e[n]=r[0]),n!==i&&(e[i]=r,delete e[n]),(o=R.cssHooks[i])&&"expand"in o)for(n in r=o.expand(r),delete e[i],r)n in e||(e[n]=r[n],t[n]=s);else t[i]=s}(u,d.opts.specialEasing);r<o;r++)if(i=dt.prefilters[r].call(d,e,u,d.opts))return C(i.stop)&&(R._queueHooks(d.elem,d.opts.queue).stop=i.stop.bind(i)),i;return R.map(u,pt,d),C(d.opts.start)&&d.opts.start.call(e,d),d.progress(d.opts.progress).done(d.opts.done,d.opts.complete).fail(d.opts.fail).always(d.opts.always),R.fx.timer(R.extend(c,{elem:e,anim:d,queue:d.opts.queue})),d}R.Animation=R.extend(dt,{tweeners:{"*":[function(e,t){var n=this.createTween(e,t);return le(n.elem,e,oe.exec(t),n),n}]},tweener:function(e,t){C(e)?(t=e,e=["*"]):e=e.match(G);for(var n,i=0,s=e.length;i<s;i++)n=e[i],dt.tweeners[n]=dt.tweeners[n]||[],dt.tweeners[n].unshift(t)},prefilters:[function(e,t,n){var i,s,r,o,a,c,d,u,h="width"in t||"height"in t,l=this,p={},f=e.style,m=e.nodeType&&he(e),g=te.get(e,"fxshow");for(i in n.queue||(null==(o=R._queueHooks(e,"fx")).unqueued&&(o.unqueued=0,a=o.empty.fire,o.empty.fire=function(){o.unqueued||a()}),o.unqueued++,l.always(function(){l.always(function(){o.unqueued--,R.queue(e,"fx").length||o.empty.fire()})})),t)if(s=t[i],vt.test(s)){if(delete t[i],r=r||"toggle"===s,s===(m?"hide":"show")){if("show"!==s||!g||void 0===g[i])continue;m=!0}p[i]=g&&g[i]||R.style(e,i)}if((c=!R.isEmptyObject(t))||!R.isEmptyObject(p))for(i in h&&1===e.nodeType&&(n.overflow=[f.overflow,f.overflowX,f.overflowY],null==(d=g&&g.display)&&(d=te.get(e,"display")),"none"===(u=R.css(e,"display"))&&(d?u=d:(fe([e],!0),d=e.style.display||d,u=R.css(e,"display"),fe([e]))),("inline"===u||"inline-block"===u&&null!=d)&&"none"===R.css(e,"float")&&(c||(l.done(function(){f.display=d}),null==d&&(u=f.display,d="none"===u?"":u)),f.display="inline-block")),n.overflow&&(f.overflow="hidden",l.always(function(){f.overflow=n.overflow[0],f.overflowX=n.overflow[1],f.overflowY=n.overflow[2]})),c=!1,p)c||(g?"hidden"in g&&(m=g.hidden):g=te.access(e,"fxshow",{display:d}),r&&(g.hidden=!m),m&&fe([e],!0),l.done(function(){for(i in m||fe([e]),te.remove(e,"fxshow"),p)R.style(e,i,p[i])})),c=pt(m?g[i]:0,i,l),i in g||(g[i]=c.start,m&&(c.end=c.start,c.start=0))}],prefilter:function(e,t){t?dt.prefilters.unshift(e):dt.prefilters.push(e)}}),R.speed=function(e,t,n){var i=e&&"object"==typeof e?R.extend({},e):{complete:n||!n&&t||C(e)&&e,duration:e,easing:n&&t||t&&!C(t)&&t};return R.fx.off?i.duration=0:"number"!=typeof i.duration&&(i.duration in R.fx.speeds?i.duration=R.fx.speeds[i.duration]:i.duration=R.fx.speeds._default),null!=i.queue&&!0!==i.queue||(i.queue="fx"),i.old=i.complete,i.complete=function(){C(i.old)&&i.old.call(this),i.queue&&R.dequeue(this,i.queue)},i},R.fn.extend({fadeTo:function(e,t,n,i){return this.filter(he).css("opacity",0).show().end().animate({opacity:t},e,n,i)},animate:function(e,t,n,i){var s=R.isEmptyObject(e),r=R.speed(t,n,i),o=function(){var t=dt(this,R.extend({},e),r);(s||te.get(this,"finish"))&&t.stop(!0)};return o.finish=o,s||!1===r.queue?this.each(o):this.queue(r.queue,o)},stop:function(e,t,n){var i=function(e){var t=e.stop;delete e.stop,t(n)};return"string"!=typeof e&&(n=t,t=e,e=void 0),t&&!1!==e&&this.queue(e||"fx",[]),this.each(function(){var t=!0,s=null!=e&&e+"queueHooks",r=R.timers,o=te.get(this);if(s)o[s]&&o[s].stop&&i(o[s]);else for(s in o)o[s]&&o[s].stop&&yt.test(s)&&i(o[s]);for(s=r.length;s--;)r[s].elem!==this||null!=e&&r[s].queue!==e||(r[s].anim.stop(n),t=!1,r.splice(s,1));!t&&n||R.dequeue(this,e)})},finish:function(e){return!1!==e&&(e=e||"fx"),this.each(function(){var t,n=te.get(this),i=n[e+"queue"],s=n[e+"queueHooks"],r=R.timers,o=i?i.length:0;for(n.finish=!0,R.queue(this,e,[]),s&&s.stop&&s.stop.call(this,!0),t=r.length;t--;)r[t].elem===this&&r[t].queue===e&&(r[t].anim.stop(!0),r.splice(t,1));for(t=0;t<o;t++)i[t]&&i[t].finish&&i[t].finish.call(this);delete n.finish})}}),R.each(["toggle","show","hide"],function(e,t){var n=R.fn[t];R.fn[t]=function(e,i,s){return null==e||"boolean"==typeof e?n.apply(this,arguments):this.animate(ft(t,!0),e,i,s)}}),R.each({slideDown:ft("show"),slideUp:ft("hide"),slideToggle:ft("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(e,t){R.fn[e]=function(e,n,i){return this.animate(t,e,n,i)}}),R.timers=[],R.fx.tick=function(){var e,t=0,n=R.timers;for(at=Date.now();t<n.length;t++)(e=n[t])()||n[t]!==e||n.splice(t--,1);n.length||R.fx.stop(),at=void 0},R.fx.timer=function(e){R.timers.push(e),R.fx.start()},R.fx.interval=13,R.fx.start=function(){ut||(ut=!0,lt())},R.fx.stop=function(){ut=null},R.fx.speeds={slow:600,fast:200,_default:400},R.fn.delay=function(e,t){return e=R.fx&&R.fx.speeds[e]||e,t=t||"fx",this.queue(t,function(t,n){var s=i.setTimeout(t,e);n.stop=function(){i.clearTimeout(s)}})},ht=o.createElement("input"),gt=o.createElement("select").appendChild(o.createElement("option")),ht.type="checkbox",S.checkOn=""!==ht.value,S.optSelected=gt.selected,(ht=o.createElement("input")).value="t",ht.type="radio",S.radioValue="t"===ht.value;var wt,St=R.expr.attrHandle;R.fn.extend({attr:function(e,t){return J(this,R.attr,e,t,1<arguments.length)},removeAttr:function(e){return this.each(function(){R.removeAttr(this,e)})}}),R.extend({attr:function(e,t,n){var i,s,r=e.nodeType;if(3!==r&&8!==r&&2!==r)return void 0===e.getAttribute?R.prop(e,t,n):(1===r&&R.isXMLDoc(e)||(s=R.attrHooks[t.toLowerCase()]||(R.expr.match.bool.test(t)?wt:void 0)),void 0!==n?null===n?void R.removeAttr(e,t):s&&"set"in s&&void 0!==(i=s.set(e,n,t))?i:(e.setAttribute(t,n+""),n):s&&"get"in s&&null!==(i=s.get(e,t))?i:null==(i=R.find.attr(e,t))?void 0:i)},attrHooks:{type:{set:function(e,t){if(!S.radioValue&&"radio"===t&&A(e,"input")){var n=e.value;return e.setAttribute("type",t),n&&(e.value=n),t}}}},removeAttr:function(e,t){var n,i=0,s=t&&t.match(G);if(s&&1===e.nodeType)for(;n=s[i++];)e.removeAttribute(n)}}),wt={set:function(e,t,n){return!1===t?R.removeAttr(e,n):e.setAttribute(n,n),n}},R.each(R.expr.match.bool.source.match(/\w+/g),function(e,t){var n=St[t]||R.find.attr;St[t]=function(e,t,i){var s,r,o=t.toLowerCase();return i||(r=St[o],St[o]=s,s=null!=n(e,t,i)?o:null,St[o]=r),s}});var Ct=/^(?:input|select|textarea|button)$/i,kt=/^(?:a|area)$/i;function mt(e){return(e.match(G)||[]).join(" ")}function xt(e){return e.getAttribute&&e.getAttribute("class")||""}function bt(e){return Array.isArray(e)?e:"string"==typeof e&&e.match(G)||[]}R.fn.extend({prop:function(e,t){return J(this,R.prop,e,t,1<arguments.length)},removeProp:function(e){return this.each(function(){delete this[R.propFix[e]||e]})}}),R.extend({prop:function(e,t,n){var i,s,r=e.nodeType;if(3!==r&&8!==r&&2!==r)return 1===r&&R.isXMLDoc(e)||(t=R.propFix[t]||t,s=R.propHooks[t]),void 0!==n?s&&"set"in s&&void 0!==(i=s.set(e,n,t))?i:e[t]=n:s&&"get"in s&&null!==(i=s.get(e,t))?i:e[t]},propHooks:{tabIndex:{get:function(e){var t=R.find.attr(e,"tabindex");return t?parseInt(t,10):Ct.test(e.nodeName)||kt.test(e.nodeName)&&e.href?0:-1}}},propFix:{for:"htmlFor",class:"className"}}),S.optSelected||(R.propHooks.selected={get:function(e){var t=e.parentNode;return t&&t.parentNode&&t.parentNode.selectedIndex,null},set:function(e){var t=e.parentNode;t&&(t.selectedIndex,t.parentNode&&t.parentNode.selectedIndex)}}),R.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],function(){R.propFix[this.toLowerCase()]=this}),R.fn.extend({addClass:function(e){var t,n,i,s,r,o,a,c=0;if(C(e))return this.each(function(t){R(this).addClass(e.call(this,t,xt(this)))});if((t=bt(e)).length)for(;n=this[c++];)if(s=xt(n),i=1===n.nodeType&&" "+mt(s)+" "){for(o=0;r=t[o++];)i.indexOf(" "+r+" ")<0&&(i+=r+" ");s!==(a=mt(i))&&n.setAttribute("class",a)}return this},removeClass:function(e){var t,n,i,s,r,o,a,c=0;if(C(e))return this.each(function(t){R(this).removeClass(e.call(this,t,xt(this)))});if(!arguments.length)return this.attr("class","");if((t=bt(e)).length)for(;n=this[c++];)if(s=xt(n),i=1===n.nodeType&&" "+mt(s)+" "){for(o=0;r=t[o++];)for(;-1<i.indexOf(" "+r+" ");)i=i.replace(" "+r+" "," ");s!==(a=mt(i))&&n.setAttribute("class",a)}return this},toggleClass:function(e,t){var n=typeof e,i="string"===n||Array.isArray(e);return"boolean"==typeof t&&i?t?this.addClass(e):this.removeClass(e):C(e)?this.each(function(n){R(this).toggleClass(e.call(this,n,xt(this),t),t)}):this.each(function(){var t,s,r,o;if(i)for(s=0,r=R(this),o=bt(e);t=o[s++];)r.hasClass(t)?r.removeClass(t):r.addClass(t);else void 0!==e&&"boolean"!==n||((t=xt(this))&&te.set(this,"__className__",t),this.setAttribute&&this.setAttribute("class",t||!1===e?"":te.get(this,"__className__")||""))})},hasClass:function(e){var t,n,i=0;for(t=" "+e+" ";n=this[i++];)if(1===n.nodeType&&-1<(" "+mt(xt(n))+" ").indexOf(t))return!0;return!1}});var Pt=/\r/g;R.fn.extend({val:function(e){var t,n,i,s=this[0];return arguments.length?(i=C(e),this.each(function(n){var s;1===this.nodeType&&(null==(s=i?e.call(this,n,R(this).val()):e)?s="":"number"==typeof s?s+="":Array.isArray(s)&&(s=R.map(s,function(e){return null==e?"":e+""})),(t=R.valHooks[this.type]||R.valHooks[this.nodeName.toLowerCase()])&&"set"in t&&void 0!==t.set(this,s,"value")||(this.value=s))})):s?(t=R.valHooks[s.type]||R.valHooks[s.nodeName.toLowerCase()])&&"get"in t&&void 0!==(n=t.get(s,"value"))?n:"string"==typeof(n=s.value)?n.replace(Pt,""):null==n?"":n:void 0}}),R.extend({valHooks:{option:{get:function(e){var t=R.find.attr(e,"value");return null!=t?t:mt(R.text(e))}},select:{get:function(e){var t,n,i,s=e.options,r=e.selectedIndex,o="select-one"===e.type,a=o?null:[],c=o?r+1:s.length;for(i=r<0?c:o?r:0;i<c;i++)if(((n=s[i]).selected||i===r)&&!n.disabled&&(!n.parentNode.disabled||!A(n.parentNode,"optgroup"))){if(t=R(n).val(),o)return t;a.push(t)}return a},set:function(e,t){for(var n,i,s=e.options,r=R.makeArray(t),o=s.length;o--;)((i=s[o]).selected=-1<R.inArray(R.valHooks.option.get(i),r))&&(n=!0);return n||(e.selectedIndex=-1),r}}}}),R.each(["radio","checkbox"],function(){R.valHooks[this]={set:function(e,t){if(Array.isArray(t))return e.checked=-1<R.inArray(R(e).val(),t)}},S.checkOn||(R.valHooks[this].get=function(e){return null===e.getAttribute("value")?"on":e.value})}),S.focusin="onfocusin"in i;var Tt=/^(?:focusinfocus|focusoutblur)$/,Rt=function(e){e.stopPropagation()};R.extend(R.event,{trigger:function(e,t,n,s){var r,a,c,d,u,h,l,p,f=[n||o],m=g.call(e,"type")?e.type:e,v=g.call(e,"namespace")?e.namespace.split("."):[];if(a=p=c=n=n||o,3!==n.nodeType&&8!==n.nodeType&&!Tt.test(m+R.event.triggered)&&(-1<m.indexOf(".")&&(m=(v=m.split(".")).shift(),v.sort()),u=m.indexOf(":")<0&&"on"+m,(e=e[R.expando]?e:new R.Event(m,"object"==typeof e&&e)).isTrigger=s?2:3,e.namespace=v.join("."),e.rnamespace=e.namespace?new RegExp("(^|\\.)"+v.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,e.result=void 0,e.target||(e.target=n),t=null==t?[e]:R.makeArray(t,[e]),l=R.event.special[m]||{},s||!l.trigger||!1!==l.trigger.apply(n,t))){if(!s&&!l.noBubble&&!k(n)){for(d=l.delegateType||m,Tt.test(d+m)||(a=a.parentNode);a;a=a.parentNode)f.push(a),c=a;c===(n.ownerDocument||o)&&f.push(c.defaultView||c.parentWindow||i)}for(r=0;(a=f[r++])&&!e.isPropagationStopped();)p=a,e.type=1<r?d:l.bindType||m,(h=(te.get(a,"events")||{})[e.type]&&te.get(a,"handle"))&&h.apply(a,t),(h=u&&a[u])&&h.apply&&Q(a)&&(e.result=h.apply(a,t),!1===e.result&&e.preventDefault());return e.type=m,s||e.isDefaultPrevented()||l._default&&!1!==l._default.apply(f.pop(),t)||!Q(n)||u&&C(n[m])&&!k(n)&&((c=n[u])&&(n[u]=null),R.event.triggered=m,e.isPropagationStopped()&&p.addEventListener(m,Rt),n[m](),e.isPropagationStopped()&&p.removeEventListener(m,Rt),R.event.triggered=void 0,c&&(n[u]=c)),e.result}},simulate:function(e,t,n){var i=R.extend(new R.Event,n,{type:e,isSimulated:!0});R.event.trigger(i,null,t)}}),R.fn.extend({trigger:function(e,t){return this.each(function(){R.event.trigger(e,t,this)})},triggerHandler:function(e,t){var n=this[0];if(n)return R.event.trigger(e,t,n,!0)}}),S.focusin||R.each({focus:"focusin",blur:"focusout"},function(e,t){var n=function(e){R.event.simulate(t,e.target,R.event.fix(e))};R.event.special[t]={setup:function(){var i=this.ownerDocument||this,s=te.access(i,t);s||i.addEventListener(e,n,!0),te.access(i,t,(s||0)+1)},teardown:function(){var i=this.ownerDocument||this,s=te.access(i,t)-1;s?te.access(i,t,s):(i.removeEventListener(e,n,!0),te.remove(i,t))}}});var Et=i.location,It=Date.now(),Mt=/\?/;R.parseXML=function(e){var t;if(!e||"string"!=typeof e)return null;try{t=(new i.DOMParser).parseFromString(e,"text/xml")}catch(e){t=void 0}return t&&!t.getElementsByTagName("parsererror").length||R.error("Invalid XML: "+e),t};var Dt=/\[\]$/,Ot=/\r?\n/g,Lt=/^(?:submit|button|image|reset|file)$/i,At=/^(?:input|select|textarea|keygen)/i;function qt(e,t,n,i){var s;if(Array.isArray(t))R.each(t,function(t,s){n||Dt.test(e)?i(e,s):qt(e+"["+("object"==typeof s&&null!=s?t:"")+"]",s,n,i)});else if(n||"object"!==w(t))i(e,t);else for(s in t)qt(e+"["+s+"]",t[s],n,i)}R.param=function(e,t){var n,i=[],s=function(e,t){var n=C(t)?t():t;i[i.length]=encodeURIComponent(e)+"="+encodeURIComponent(null==n?"":n)};if(null==e)return"";if(Array.isArray(e)||e.jquery&&!R.isPlainObject(e))R.each(e,function(){s(this.name,this.value)});else for(n in e)qt(n,e[n],t,s);return i.join("&")},R.fn.extend({serialize:function(){return R.param(this.serializeArray())},serializeArray:function(){return this.map(function(){var e=R.prop(this,"elements");return e?R.makeArray(e):this}).filter(function(){var e=this.type;return this.name&&!R(this).is(":disabled")&&At.test(this.nodeName)&&!Lt.test(e)&&(this.checked||!ge.test(e))}).map(function(e,t){var n=R(this).val();return null==n?null:Array.isArray(n)?R.map(n,function(e){return{name:t.name,value:e.replace(Ot,"\r\n")}}):{name:t.name,value:n.replace(Ot,"\r\n")}}).get()}});var Nt=/%20/g,Ft=/#.*$/,jt=/([?&])_=[^&]*/,Vt=/^(.*?):[ \t]*([^\r\n]*)$/gm,Ut=/^(?:GET|HEAD)$/,Ht=/^\/\//,Gt={},Wt={},$t="*/".concat("*"),Yt=o.createElement("a");function Bt(e){return function(t,n){"string"!=typeof t&&(n=t,t="*");var i,s=0,r=t.toLowerCase().match(G)||[];if(C(n))for(;i=r[s++];)"+"===i[0]?(i=i.slice(1)||"*",(e[i]=e[i]||[]).unshift(n)):(e[i]=e[i]||[]).push(n)}}function _t(e,t,n,i){var s={},r=e===Wt;function l(o){var a;return s[o]=!0,R.each(e[o]||[],function(e,o){var c=o(t,n,i);return"string"!=typeof c||r||s[c]?r?!(a=c):void 0:(t.dataTypes.unshift(c),l(c),!1)}),a}return l(t.dataTypes[0])||!s["*"]&&l("*")}function zt(e,t){var n,i,s=R.ajaxSettings.flatOptions||{};for(n in t)void 0!==t[n]&&((s[n]?e:i||(i={}))[n]=t[n]);return i&&R.extend(!0,e,i),e}Yt.href=Et.href,R.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:Et.href,type:"GET",isLocal:/^(?:about|app|app-storage|.+-extension|file|res|widget):$/.test(Et.protocol),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":$t,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/\bxml\b/,html:/\bhtml/,json:/\bjson\b/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":JSON.parse,"text xml":R.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(e,t){return t?zt(zt(e,R.ajaxSettings),t):zt(R.ajaxSettings,e)},ajaxPrefilter:Bt(Gt),ajaxTransport:Bt(Wt),ajax:function(e,t){"object"==typeof e&&(t=e,e=void 0),t=t||{};var n,s,r,a,c,d,u,h,p,f,m=R.ajaxSetup({},t),g=m.context||m,v=m.context&&(g.nodeType||g.jquery)?R(g):R.event,b=R.Deferred(),y=R.Callbacks("once memory"),w=m.statusCode||{},S={},C={},k="canceled",P={readyState:0,getResponseHeader:function(e){var t;if(u){if(!a)for(a={};t=Vt.exec(r);)a[t[1].toLowerCase()+" "]=(a[t[1].toLowerCase()+" "]||[]).concat(t[2]);t=a[e.toLowerCase()+" "]}return null==t?null:t.join(", ")},getAllResponseHeaders:function(){return u?r:null},setRequestHeader:function(e,t){return null==u&&(e=C[e.toLowerCase()]=C[e.toLowerCase()]||e,S[e]=t),this},overrideMimeType:function(e){return null==u&&(m.mimeType=e),this},statusCode:function(e){var t;if(e)if(u)P.always(e[P.status]);else for(t in e)w[t]=[w[t],e[t]];return this},abort:function(e){var t=e||k;return n&&n.abort(t),l(0,t),this}};if(b.promise(P),m.url=((e||m.url||Et.href)+"").replace(Ht,Et.protocol+"//"),m.type=t.method||t.type||m.method||m.type,m.dataTypes=(m.dataType||"*").toLowerCase().match(G)||[""],null==m.crossDomain){d=o.createElement("a");try{d.href=m.url,d.href=d.href,m.crossDomain=Yt.protocol+"//"+Yt.host!=d.protocol+"//"+d.host}catch(e){m.crossDomain=!0}}if(m.data&&m.processData&&"string"!=typeof m.data&&(m.data=R.param(m.data,m.traditional)),_t(Gt,m,t,P),u)return P;for(p in(h=R.event&&m.global)&&0==R.active++&&R.event.trigger("ajaxStart"),m.type=m.type.toUpperCase(),m.hasContent=!Ut.test(m.type),s=m.url.replace(Ft,""),m.hasContent?m.data&&m.processData&&0===(m.contentType||"").indexOf("application/x-www-form-urlencoded")&&(m.data=m.data.replace(Nt,"+")):(f=m.url.slice(s.length),m.data&&(m.processData||"string"==typeof m.data)&&(s+=(Mt.test(s)?"&":"?")+m.data,delete m.data),!1===m.cache&&(s=s.replace(jt,"$1"),f=(Mt.test(s)?"&":"?")+"_="+It+++f),m.url=s+f),m.ifModified&&(R.lastModified[s]&&P.setRequestHeader("If-Modified-Since",R.lastModified[s]),R.etag[s]&&P.setRequestHeader("If-None-Match",R.etag[s])),(m.data&&m.hasContent&&!1!==m.contentType||t.contentType)&&P.setRequestHeader("Content-Type",m.contentType),P.setRequestHeader("Accept",m.dataTypes[0]&&m.accepts[m.dataTypes[0]]?m.accepts[m.dataTypes[0]]+("*"!==m.dataTypes[0]?", "+$t+"; q=0.01":""):m.accepts["*"]),m.headers)P.setRequestHeader(p,m.headers[p]);if(m.beforeSend&&(!1===m.beforeSend.call(g,P,m)||u))return P.abort();if(k="abort",y.add(m.complete),P.done(m.success),P.fail(m.error),n=_t(Wt,m,t,P)){if(P.readyState=1,h&&v.trigger("ajaxSend",[P,m]),u)return P;m.async&&0<m.timeout&&(c=i.setTimeout(function(){P.abort("timeout")},m.timeout));try{u=!1,n.send(S,l)}catch(e){if(u)throw e;l(-1,e)}}else l(-1,"No Transport");function l(e,t,o,a){var d,l,p,f,S,C=t;u||(u=!0,c&&i.clearTimeout(c),n=void 0,r=a||"",P.readyState=0<e?4:0,d=200<=e&&e<300||304===e,o&&(f=function(e,t,n){for(var i,s,r,o,a=e.contents,c=e.dataTypes;"*"===c[0];)c.shift(),void 0===i&&(i=e.mimeType||t.getResponseHeader("Content-Type"));if(i)for(s in a)if(a[s]&&a[s].test(i)){c.unshift(s);break}if(c[0]in n)r=c[0];else{for(s in n){if(!c[0]||e.converters[s+" "+c[0]]){r=s;break}o||(o=s)}r=r||o}if(r)return r!==c[0]&&c.unshift(r),n[r]}(m,P,o)),f=function(e,t,n,i){var s,r,o,a,c,d={},u=e.dataTypes.slice();if(u[1])for(o in e.converters)d[o.toLowerCase()]=e.converters[o];for(r=u.shift();r;)if(e.responseFields[r]&&(n[e.responseFields[r]]=t),!c&&i&&e.dataFilter&&(t=e.dataFilter(t,e.dataType)),c=r,r=u.shift())if("*"===r)r=c;else if("*"!==c&&c!==r){if(!(o=d[c+" "+r]||d["* "+r]))for(s in d)if((a=s.split(" "))[1]===r&&(o=d[c+" "+a[0]]||d["* "+a[0]])){!0===o?o=d[s]:!0!==d[s]&&(r=a[0],u.unshift(a[1]));break}if(!0!==o)if(o&&e.throws)t=o(t);else try{t=o(t)}catch(e){return{state:"parsererror",error:o?e:"No conversion from "+c+" to "+r}}}return{state:"success",data:t}}(m,f,P,d),d?(m.ifModified&&((S=P.getResponseHeader("Last-Modified"))&&(R.lastModified[s]=S),(S=P.getResponseHeader("etag"))&&(R.etag[s]=S)),204===e||"HEAD"===m.type?C="nocontent":304===e?C="notmodified":(C=f.state,l=f.data,d=!(p=f.error))):(p=C,!e&&C||(C="error",e<0&&(e=0))),P.status=e,P.statusText=(t||C)+"",d?b.resolveWith(g,[l,C,P]):b.rejectWith(g,[P,C,p]),P.statusCode(w),w=void 0,h&&v.trigger(d?"ajaxSuccess":"ajaxError",[P,m,d?l:p]),y.fireWith(g,[P,C]),h&&(v.trigger("ajaxComplete",[P,m]),--R.active||R.event.trigger("ajaxStop")))}return P},getJSON:function(e,t,n){return R.get(e,t,n,"json")},getScript:function(e,t){return R.get(e,void 0,t,"script")}}),R.each(["get","post"],function(e,t){R[t]=function(e,n,i,s){return C(n)&&(s=s||i,i=n,n=void 0),R.ajax(R.extend({url:e,type:t,dataType:s,data:n,success:i},R.isPlainObject(e)&&e))}}),R._evalUrl=function(e,t){return R.ajax({url:e,type:"GET",dataType:"script",cache:!0,async:!1,global:!1,converters:{"text script":function(){}},dataFilter:function(e){R.globalEval(e,t)}})},R.fn.extend({wrapAll:function(e){var t;return this[0]&&(C(e)&&(e=e.call(this[0])),t=R(e,this[0].ownerDocument).eq(0).clone(!0),this[0].parentNode&&t.insertBefore(this[0]),t.map(function(){for(var e=this;e.firstElementChild;)e=e.firstElementChild;return e}).append(this)),this},wrapInner:function(e){return C(e)?this.each(function(t){R(this).wrapInner(e.call(this,t))}):this.each(function(){var t=R(this),n=t.contents();n.length?n.wrapAll(e):t.append(e)})},wrap:function(e){var t=C(e);return this.each(function(n){R(this).wrapAll(t?e.call(this,n):e)})},unwrap:function(e){return this.parent(e).not("body").each(function(){R(this).replaceWith(this.childNodes)}),this}}),R.expr.pseudos.hidden=function(e){return!R.expr.pseudos.visible(e)},R.expr.pseudos.visible=function(e){return!!(e.offsetWidth||e.offsetHeight||e.getClientRects().length)},R.ajaxSettings.xhr=function(){try{return new i.XMLHttpRequest}catch(e){}};var Jt={0:200,1223:204},Xt=R.ajaxSettings.xhr();S.cors=!!Xt&&"withCredentials"in Xt,S.ajax=Xt=!!Xt,R.ajaxTransport(function(e){var t,n;if(S.cors||Xt&&!e.crossDomain)return{send:function(s,r){var o,a=e.xhr();if(a.open(e.type,e.url,e.async,e.username,e.password),e.xhrFields)for(o in e.xhrFields)a[o]=e.xhrFields[o];for(o in e.mimeType&&a.overrideMimeType&&a.overrideMimeType(e.mimeType),e.crossDomain||s["X-Requested-With"]||(s["X-Requested-With"]="XMLHttpRequest"),s)a.setRequestHeader(o,s[o]);t=function(e){return function(){t&&(t=n=a.onload=a.onerror=a.onabort=a.ontimeout=a.onreadystatechange=null,"abort"===e?a.abort():"error"===e?"number"!=typeof a.status?r(0,"error"):r(a.status,a.statusText):r(Jt[a.status]||a.status,a.statusText,"text"!==(a.responseType||"text")||"string"!=typeof a.responseText?{binary:a.response}:{text:a.responseText},a.getAllResponseHeaders()))}},a.onload=t(),n=a.onerror=a.ontimeout=t("error"),void 0!==a.onabort?a.onabort=n:a.onreadystatechange=function(){4===a.readyState&&i.setTimeout(function(){t&&n()})},t=t("abort");try{a.send(e.hasContent&&e.data||null)}catch(s){if(t)throw s}},abort:function(){t&&t()}}}),R.ajaxPrefilter(function(e){e.crossDomain&&(e.contents.script=!1)}),R.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/\b(?:java|ecma)script\b/},converters:{"text script":function(e){return R.globalEval(e),e}}}),R.ajaxPrefilter("script",function(e){void 0===e.cache&&(e.cache=!1),e.crossDomain&&(e.type="GET")}),R.ajaxTransport("script",function(e){var t,n;if(e.crossDomain||e.scriptAttrs)return{send:function(i,s){t=R("<script>").attr(e.scriptAttrs||{}).prop({charset:e.scriptCharset,src:e.url}).on("load error",n=function(e){t.remove(),n=null,e&&s("error"===e.type?404:200,e.type)}),o.head.appendChild(t[0])},abort:function(){n&&n()}}});var Kt,Zt=[],Qt=/(=)\?(?=&|$)|\?\?/;R.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var e=Zt.pop()||R.expando+"_"+It++;return this[e]=!0,e}}),R.ajaxPrefilter("json jsonp",function(e,t,n){var s,r,o,a=!1!==e.jsonp&&(Qt.test(e.url)?"url":"string"==typeof e.data&&0===(e.contentType||"").indexOf("application/x-www-form-urlencoded")&&Qt.test(e.data)&&"data");if(a||"jsonp"===e.dataTypes[0])return s=e.jsonpCallback=C(e.jsonpCallback)?e.jsonpCallback():e.jsonpCallback,a?e[a]=e[a].replace(Qt,"$1"+s):!1!==e.jsonp&&(e.url+=(Mt.test(e.url)?"&":"?")+e.jsonp+"="+s),e.converters["script json"]=function(){return o||R.error(s+" was not called"),o[0]},e.dataTypes[0]="json",r=i[s],i[s]=function(){o=arguments},n.always(function(){void 0===r?R(i).removeProp(s):i[s]=r,e[s]&&(e.jsonpCallback=t.jsonpCallback,Zt.push(s)),o&&C(r)&&r(o[0]),o=r=void 0}),"script"}),S.createHTMLDocument=((Kt=o.implementation.createHTMLDocument("").body).innerHTML="<form></form><form></form>",2===Kt.childNodes.length),R.parseHTML=function(e,t,n){return"string"!=typeof e?[]:("boolean"==typeof t&&(n=t,t=!1),t||(S.createHTMLDocument?((i=(t=o.implementation.createHTMLDocument("")).createElement("base")).href=o.location.href,t.head.appendChild(i)):t=o),r=!n&&[],(s=N.exec(e))?[t.createElement(s[1])]:(s=we([e],t,r),r&&r.length&&R(r).remove(),R.merge([],s.childNodes)));var i,s,r},R.fn.load=function(e,t,n){var i,s,r,o=this,a=e.indexOf(" ");return-1<a&&(i=mt(e.slice(a)),e=e.slice(0,a)),C(t)?(n=t,t=void 0):t&&"object"==typeof t&&(s="POST"),0<o.length&&R.ajax({url:e,type:s||"GET",dataType:"html",data:t}).done(function(e){r=arguments,o.html(i?R("<div>").append(R.parseHTML(e)).find(i):e)}).always(n&&function(e,t){o.each(function(){n.apply(this,r||[e.responseText,t,e])})}),this},R.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],function(e,t){R.fn[t]=function(e){return this.on(t,e)}}),R.expr.pseudos.animated=function(e){return R.grep(R.timers,function(t){return e===t.elem}).length},R.offset={setOffset:function(e,t,n){var i,s,r,o,a,c,d=R.css(e,"position"),u=R(e),h={};"static"===d&&(e.style.position="relative"),a=u.offset(),r=R.css(e,"top"),c=R.css(e,"left"),("absolute"===d||"fixed"===d)&&-1<(r+c).indexOf("auto")?(o=(i=u.position()).top,s=i.left):(o=parseFloat(r)||0,s=parseFloat(c)||0),C(t)&&(t=t.call(e,n,R.extend({},a))),null!=t.top&&(h.top=t.top-a.top+o),null!=t.left&&(h.left=t.left-a.left+s),"using"in t?t.using.call(e,h):u.css(h)}},R.fn.extend({offset:function(e){if(arguments.length)return void 0===e?this:this.each(function(t){R.offset.setOffset(this,e,t)});var t,n,i=this[0];return i?i.getClientRects().length?(t=i.getBoundingClientRect(),n=i.ownerDocument.defaultView,{top:t.top+n.pageYOffset,left:t.left+n.pageXOffset}):{top:0,left:0}:void 0},position:function(){if(this[0]){var e,t,n,i=this[0],s={top:0,left:0};if("fixed"===R.css(i,"position"))t=i.getBoundingClientRect();else{for(t=this.offset(),n=i.ownerDocument,e=i.offsetParent||n.documentElement;e&&(e===n.body||e===n.documentElement)&&"static"===R.css(e,"position");)e=e.parentNode;e&&e!==i&&1===e.nodeType&&((s=R(e).offset()).top+=R.css(e,"borderTopWidth",!0),s.left+=R.css(e,"borderLeftWidth",!0))}return{top:t.top-s.top-R.css(i,"marginTop",!0),left:t.left-s.left-R.css(i,"marginLeft",!0)}}},offsetParent:function(){return this.map(function(){for(var e=this.offsetParent;e&&"static"===R.css(e,"position");)e=e.offsetParent;return e||ce})}}),R.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(e,t){var n="pageYOffset"===t;R.fn[e]=function(i){return J(this,function(e,i,s){var r;if(k(e)?r=e:9===e.nodeType&&(r=e.defaultView),void 0===s)return r?r[t]:e[i];r?r.scrollTo(n?r.pageXOffset:s,n?s:r.pageYOffset):e[i]=s},e,i,arguments.length)}}),R.each(["top","left"],function(e,t){R.cssHooks[t]=ze(S.pixelPosition,function(e,n){if(n)return n=_e(e,t),$e.test(n)?R(e).position()[t]+"px":n})}),R.each({Height:"height",Width:"width"},function(e,t){R.each({padding:"inner"+e,content:t,"":"outer"+e},function(n,i){R.fn[i]=function(s,r){var o=arguments.length&&(n||"boolean"!=typeof s),a=n||(!0===s||!0===r?"margin":"border");return J(this,function(t,n,s){var r;return k(t)?0===i.indexOf("outer")?t["inner"+e]:t.document.documentElement["client"+e]:9===t.nodeType?(r=t.documentElement,Math.max(t.body["scroll"+e],r["scroll"+e],t.body["offset"+e],r["offset"+e],r["client"+e])):void 0===s?R.css(t,n,a):R.style(t,n,s,a)},t,o?s:void 0,o)}})}),R.each("blur focus focusin focusout resize scroll click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup contextmenu".split(" "),function(e,t){R.fn[t]=function(e,n){return 0<arguments.length?this.on(t,null,e,n):this.trigger(t)}}),R.fn.extend({hover:function(e,t){return this.mouseenter(e).mouseleave(t||e)}}),R.fn.extend({bind:function(e,t,n){return this.on(e,null,t,n)},unbind:function(e,t){return this.off(e,null,t)},delegate:function(e,t,n,i){return this.on(t,e,n,i)},undelegate:function(e,t,n){return 1===arguments.length?this.off(e,"**"):this.off(t,e||"**",n)}}),R.proxy=function(e,t){var n,i,s;if("string"==typeof t&&(n=e[t],t=e,e=n),C(e))return i=c.call(arguments,2),(s=function(){return e.apply(t||this,i.concat(c.call(arguments)))}).guid=e.guid=e.guid||R.guid++,s},R.holdReady=function(e){e?R.readyWait++:R.ready(!0)},R.isArray=Array.isArray,R.parseJSON=JSON.parse,R.nodeName=A,R.isFunction=C,R.isWindow=k,R.camelCase=V,R.type=w,R.now=Date.now,R.isNumeric=function(e){var t=R.type(e);return("number"===t||"string"===t)&&!isNaN(e-parseFloat(e))},"function"==typeof define&&define.amd&&define("jquery",[],function(){return R});var en=i.jQuery,tn=i.$;return R.noConflict=function(e){return i.$===R&&(i.$=tn),e&&i.jQuery===R&&(i.jQuery=en),R},s||(i.jQuery=i.$=R),R}),function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define("socketio",[],t):"object"==typeof exports?exports.io=t():e.io=t()}(this,function(){return function(t){function e(i){if(n[i])return n[i].exports;var s=n[i]={exports:{},id:i,loaded:!1};return t[i].call(s.exports,s,s.exports,e),s.loaded=!0,s.exports}var n={};return e.m=t,e.c=n,e.p="",e(0)}([function(e,t,i){"use strict";function n(e,t){"object"===(void 0===e?"undefined":s(e))&&(t=e,e=void 0),t=t||{};var n,i=r(e),o=i.source,d=i.id,u=i.path,h=c[d]&&u in c[d].nsps;return t.forceNew||t["force new connection"]||!1===t.multiplex||h?n=a(o,t):(c[d]||(c[d]=a(o,t)),n=c[d]),i.query&&!t.query&&(t.query=i.query),n.socket(i.path,t)}var s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r=i(1),o=i(4),a=i(9);i(3)("socket.io-client"),e.exports=t=n;var c=t.managers={};t.protocol=o.protocol,t.connect=n,t.Manager=i(9),t.Socket=i(34)},function(e,t,i){(function(t){"use strict";var s=i(2);i(3)("socket.io-client:url"),e.exports=function n(e,i){var r=e;i=i||t.location,null==e&&(e=i.protocol+"//"+i.host),"string"==typeof e&&("/"===e.charAt(0)&&(e="/"===e.charAt(1)?i.protocol+e:i.host+e),/^(https?|wss?):\/\//.test(e)||(e=void 0!==i?i.protocol+"//"+e:"https://"+e),r=s(e)),r.port||(/^(http|ws)$/.test(r.protocol)?r.port="80":/^(http|ws)s$/.test(r.protocol)&&(r.port="443")),r.path=r.path||"/";var o=-1!==r.host.indexOf(":")?"["+r.host+"]":r.host;return r.id=r.protocol+"://"+o+":"+r.port,r.href=r.protocol+"://"+o+(i&&i.port===r.port?"":":"+r.port),r}}).call(t,function(){return this}())},function(e,t){var n=/^(?:(?![^:@]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,i=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];e.exports=function(e){var t=e,s=e.indexOf("["),r=e.indexOf("]");-1!=s&&-1!=r&&(e=e.substring(0,s)+e.substring(s,r).replace(/:/g,";")+e.substring(r,e.length));for(var o=n.exec(e||""),a={},c=14;c--;)a[i[c]]=o[c]||"";return-1!=s&&-1!=r&&(a.source=t,a.host=a.host.substring(1,a.host.length-1).replace(/;/g,":"),a.authority=a.authority.replace("[","").replace("]","").replace(/;/g,":"),a.ipv6uri=!0),a}},function(e,t){"use strict";e.exports=function(){return function(){}}},function(e,t,d){function n(){}function o(e){var n=""+e.type;if(t.BINARY_EVENT!==e.type&&t.BINARY_ACK!==e.type||(n+=e.attachments+"-"),e.nsp&&"/"!==e.nsp&&(n+=e.nsp+","),null!=e.id&&(n+=e.id),null!=e.data){var s=function i(e){try{return JSON.stringify(e)}catch(e){return!1}}(e.data);if(!1===s)return v;n+=s}return n}function a(){this.reconstructor=null}function c(e){var n=0,i={type:Number(e.charAt(0))};if(null==t.types[i.type])return u("unknown packet type "+i.type);if(t.BINARY_EVENT===i.type||t.BINARY_ACK===i.type){for(var s="";"-"!==e.charAt(++n)&&(s+=e.charAt(n),n!=e.length););if(s!=Number(s)||"-"!==e.charAt(n))throw new Error("Illegal attachments");i.attachments=Number(s)}if("/"===e.charAt(n+1))for(i.nsp="";++n;){if(","===(o=e.charAt(n)))break;if(i.nsp+=o,n===e.length)break}else i.nsp="/";var r=e.charAt(n+1);if(""!==r&&Number(r)==r){for(i.id="";++n;){var o;if(null==(o=e.charAt(n))||Number(o)!=o){--n;break}if(i.id+=e.charAt(n),n===e.length)break}i.id=Number(i.id)}if(e.charAt(++n)){var a=function h(e){try{return JSON.parse(e)}catch(e){return!1}}(e.substr(n));if(!(!1!==a&&(i.type===t.ERROR||m(a))))return u("invalid payload");i.data=a}return i}function p(e){this.reconPack=e,this.buffers=[]}function u(e){return{type:t.ERROR,data:"parser error: "+e}}var l=(d(3)("socket.io-parser"),d(5)),f=d(6),m=d(7),g=d(8);t.protocol=4,t.types=["CONNECT","DISCONNECT","EVENT","ACK","ERROR","BINARY_EVENT","BINARY_ACK"],t.CONNECT=0,t.DISCONNECT=1,t.EVENT=2,t.ACK=3,t.ERROR=4,t.BINARY_EVENT=5,t.BINARY_ACK=6,t.Encoder=n,t.Decoder=a;var v=t.ERROR+'"encode error"';n.prototype.encode=function(e,n){t.BINARY_EVENT===e.type||t.BINARY_ACK===e.type?function s(e,t){f.removeBlobs(e,function r(e){var n=f.deconstructPacket(e),i=o(n.packet),s=n.buffers;s.unshift(i),t(s)})}(e,n):n([o(e)])},l(a.prototype),a.prototype.add=function(e){var n;if("string"==typeof e)n=c(e),t.BINARY_EVENT===n.type||t.BINARY_ACK===n.type?(this.reconstructor=new p(n),0===this.reconstructor.reconPack.attachments&&this.emit("decoded",n)):this.emit("decoded",n);else{if(!g(e)&&!e.base64)throw new Error("Unknown type: "+e);if(!this.reconstructor)throw new Error("got binary data when not reconstructing a packet");(n=this.reconstructor.takeBinaryData(e))&&(this.reconstructor=null,this.emit("decoded",n))}},a.prototype.destroy=function(){this.reconstructor&&this.reconstructor.finishedReconstruction()},p.prototype.takeBinaryData=function(e){if(this.buffers.push(e),this.buffers.length===this.reconPack.attachments){var t=f.reconstructPacket(this.reconPack,this.buffers);return this.finishedReconstruction(),t}return null},p.prototype.finishedReconstruction=function(){this.reconPack=null,this.buffers=[]}},function(e,t,i){function n(e){if(e)return function o(e){for(var t in n.prototype)e[t]=n.prototype[t];return e}(e)}e.exports=n,n.prototype.on=n.prototype.addEventListener=function(e,t){return this._callbacks=this._callbacks||{},(this._callbacks["$"+e]=this._callbacks["$"+e]||[]).push(t),this},n.prototype.once=function(e,t){function r(){this.off(e,r),t.apply(this,arguments)}return r.fn=t,this.on(e,r),this},n.prototype.off=n.prototype.removeListener=n.prototype.removeAllListeners=n.prototype.removeEventListener=function(e,t){if(this._callbacks=this._callbacks||{},0==arguments.length)return this._callbacks={},this;var n=this._callbacks["$"+e];if(!n)return this;if(1==arguments.length)return delete this._callbacks["$"+e],this;for(var i,s=0;s<n.length;s++)if((i=n[s])===t||i.fn===t){n.splice(s,1);break}return this},n.prototype.emit=function(e){this._callbacks=this._callbacks||{};var t=[].slice.call(arguments,1),n=this._callbacks["$"+e];if(n)for(var i=0,s=(n=n.slice(0)).length;i<s;++i)n[i].apply(this,t);return this},n.prototype.listeners=function(e){return this._callbacks=this._callbacks||{},this._callbacks["$"+e]||[]},n.prototype.hasListeners=function(e){return!!this.listeners(e).length}},function(e,t,n){(function(e){var i=n(7),s=n(8),a=Object.prototype.toString,c="function"==typeof e.Blob||"[object BlobConstructor]"===a.call(e.Blob),d="function"==typeof e.File||"[object FileConstructor]"===a.call(e.File);t.deconstructPacket=function(e){var t=[],n=e.data,r=e;return r.data=function n(e,t){if(!e)return e;if(s(e)){var r={_placeholder:!0,num:t.length};return t.push(e),r}if(i(e)){for(var o=new Array(e.length),a=0;a<e.length;a++)o[a]=n(e[a],t);return o}if("object"==typeof e&&!(e instanceof Date)){for(var c in o={},e)o[c]=n(e[c],t);return o}return e}(n,t),r.attachments=t.length,{packet:r,buffers:t}},t.reconstructPacket=function(e,t){return e.data=function o(e,t){if(!e)return e;if(e&&e._placeholder)return t[e.num];if(i(e))for(var n=0;n<e.length;n++)e[n]=o(e[n],t);else if("object"==typeof e)for(var s in e)e[s]=o(e[s],t);return e}(e.data,t),e.attachments=void 0,e},t.removeBlobs=function(e,t){var n=0,o=e;(function r(e,a,u){if(!e)return e;if(c&&e instanceof Blob||d&&e instanceof File){n++;var h=new FileReader;h.onload=function(){u?u[a]=this.result:o=this.result,--n||t(o)},h.readAsArrayBuffer(e)}else if(i(e))for(var l=0;l<e.length;l++)r(e[l],l,e);else if("object"==typeof e&&!s(e))for(var p in e)r(e[p],p,e)})(o),n||t(o)}}).call(t,function(){return this}())},function(e,t){var n={}.toString;e.exports=Array.isArray||function(e){return"[object Array]"==n.call(e)}},function(e,t){(function(t){e.exports=function r(e){return n&&t.Buffer.isBuffer(e)||i&&(e instanceof t.ArrayBuffer||s(e))};var n="function"==typeof t.Buffer&&"function"==typeof t.Buffer.isBuffer,i="function"==typeof t.ArrayBuffer,s=i&&"function"==typeof t.ArrayBuffer.isView?t.ArrayBuffer.isView:function(e){return e.buffer instanceof t.ArrayBuffer}}).call(t,function(){return this}())},function(e,t,i){"use strict";function n(e,t){if(!(this instanceof n))return new n(e,t);e&&"object"===(void 0===e?"undefined":s(e))&&(t=e,e=void 0),(t=t||{}).path=t.path||"/socket.io",this.nsps={},this.subs=[],this.opts=t,this.reconnection(!1!==t.reconnection),this.reconnectionAttempts(t.reconnectionAttempts||1/0),this.reconnectionDelay(t.reconnectionDelay||1e3),this.reconnectionDelayMax(t.reconnectionDelayMax||5e3),this.randomizationFactor(t.randomizationFactor||.5),this.backoff=new p({min:this.reconnectionDelay(),max:this.reconnectionDelayMax(),jitter:this.randomizationFactor()}),this.timeout(null==t.timeout?2e4:t.timeout),this.readyState="closed",this.uri=e,this.connecting=[],this.lastPing=null,this.encoding=!1,this.packetBuffer=[];var i=t.parser||d;this.encoder=new i.Encoder,this.decoder=new i.Decoder,this.autoConnect=!1!==t.autoConnect,this.autoConnect&&this.open()}var s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o=i(10),a=i(34),c=i(5),d=i(4),u=i(36),h=i(37),l=(i(3)("socket.io-client:manager"),i(33)),p=i(38),f=Object.prototype.hasOwnProperty;e.exports=n,n.prototype.emitAll=function(){for(var e in this.emit.apply(this,arguments),this.nsps)f.call(this.nsps,e)&&this.nsps[e].emit.apply(this.nsps[e],arguments)},n.prototype.updateSocketIds=function(){for(var e in this.nsps)f.call(this.nsps,e)&&(this.nsps[e].id=this.generateId(e))},n.prototype.generateId=function(e){return("/"===e?"":e+"#")+this.engine.id},c(n.prototype),n.prototype.reconnection=function(e){return arguments.length?(this._reconnection=!!e,this):this._reconnection},n.prototype.reconnectionAttempts=function(e){return arguments.length?(this._reconnectionAttempts=e,this):this._reconnectionAttempts},n.prototype.reconnectionDelay=function(e){return arguments.length?(this._reconnectionDelay=e,this.backoff&&this.backoff.setMin(e),this):this._reconnectionDelay},n.prototype.randomizationFactor=function(e){return arguments.length?(this._randomizationFactor=e,this.backoff&&this.backoff.setJitter(e),this):this._randomizationFactor},n.prototype.reconnectionDelayMax=function(e){return arguments.length?(this._reconnectionDelayMax=e,this.backoff&&this.backoff.setMax(e),this):this._reconnectionDelayMax},n.prototype.timeout=function(e){return arguments.length?(this._timeout=e,this):this._timeout},n.prototype.maybeReconnectOnOpen=function(){!this.reconnecting&&this._reconnection&&0===this.backoff.attempts&&this.reconnect()},n.prototype.open=n.prototype.connect=function(e,t){if(~this.readyState.indexOf("open"))return this;this.engine=o(this.uri,this.opts);var n=this.engine,i=this;this.readyState="opening",this.skipReconnect=!1;var s=u(n,"open",function(){i.onopen(),e&&e()}),r=u(n,"error",function(t){if(i.cleanup(),i.readyState="closed",i.emitAll("connect_error",t),e){var n=new Error("Connection error");n.data=t,e(n)}else i.maybeReconnectOnOpen()});if(!1!==this._timeout){var a=this._timeout,c=setTimeout(function(){s.destroy(),n.close(),n.emit("error","timeout"),i.emitAll("connect_timeout",a)},a);this.subs.push({destroy:function(){clearTimeout(c)}})}return this.subs.push(s),this.subs.push(r),this},n.prototype.onopen=function(){this.cleanup(),this.readyState="open",this.emit("open");var e=this.engine;this.subs.push(u(e,"data",h(this,"ondata"))),this.subs.push(u(e,"ping",h(this,"onping"))),this.subs.push(u(e,"pong",h(this,"onpong"))),this.subs.push(u(e,"error",h(this,"onerror"))),this.subs.push(u(e,"close",h(this,"onclose"))),this.subs.push(u(this.decoder,"decoded",h(this,"ondecoded")))},n.prototype.onping=function(){this.lastPing=new Date,this.emitAll("ping")},n.prototype.onpong=function(){this.emitAll("pong",new Date-this.lastPing)},n.prototype.ondata=function(e){this.decoder.add(e)},n.prototype.ondecoded=function(e){this.emit("packet",e)},n.prototype.onerror=function(e){this.emitAll("error",e)},n.prototype.socket=function(e,t){function r(){~l(i.connecting,n)||i.connecting.push(n)}var n=this.nsps[e];if(!n){n=new a(this,e,t),this.nsps[e]=n;var i=this;n.on("connecting",r),n.on("connect",function(){n.id=i.generateId(e)}),this.autoConnect&&r()}return n},n.prototype.destroy=function(e){var t=l(this.connecting,e);~t&&this.connecting.splice(t,1),this.connecting.length||this.close()},n.prototype.packet=function(e){var t=this;e.query&&0===e.type&&(e.nsp+="?"+e.query),t.encoding?t.packetBuffer.push(e):(t.encoding=!0,this.encoder.encode(e,function(n){for(var i=0;i<n.length;i++)t.engine.write(n[i],e.options);t.encoding=!1,t.processPacketQueue()}))},n.prototype.processPacketQueue=function(){if(this.packetBuffer.length>0&&!this.encoding){var e=this.packetBuffer.shift();this.packet(e)}},n.prototype.cleanup=function(){for(var e=this.subs.length,t=0;t<e;t++){this.subs.shift().destroy()}this.packetBuffer=[],this.encoding=!1,this.lastPing=null,this.decoder.destroy()},n.prototype.close=n.prototype.disconnect=function(){this.skipReconnect=!0,this.reconnecting=!1,"opening"===this.readyState&&this.cleanup(),this.backoff.reset(),this.readyState="closed",this.engine&&this.engine.close()},n.prototype.onclose=function(e){this.cleanup(),this.backoff.reset(),this.readyState="closed",this.emit("close",e),this._reconnection&&!this.skipReconnect&&this.reconnect()},n.prototype.reconnect=function(){if(this.reconnecting||this.skipReconnect)return this;var e=this;if(this.backoff.attempts>=this._reconnectionAttempts)this.backoff.reset(),this.emitAll("reconnect_failed"),this.reconnecting=!1;else{var t=this.backoff.duration();this.reconnecting=!0;var n=setTimeout(function(){e.skipReconnect||(e.emitAll("reconnect_attempt",e.backoff.attempts),e.emitAll("reconnecting",e.backoff.attempts),e.skipReconnect||e.open(function(t){t?(e.reconnecting=!1,e.reconnect(),e.emitAll("reconnect_error",t.data)):e.onreconnect()}))},t);this.subs.push({destroy:function(){clearTimeout(n)}})}},n.prototype.onreconnect=function(){var e=this.backoff.attempts;this.reconnecting=!1,this.backoff.reset(),this.updateSocketIds(),this.emitAll("reconnect",e)}},function(e,t,n){e.exports=n(11),e.exports.parser=n(18)},function(e,t,i){(function(t){function n(e,i){if(!(this instanceof n))return new n(e,i);i=i||{},e&&"object"==typeof e&&(i=e,e=null),e?(e=p(e),i.hostname=e.host,i.secure="https"===e.protocol||"wss"===e.protocol,i.port=e.port,e.query&&(i.query=e.query)):i.host&&(i.hostname=p(i.host).host),this.secure=null!=i.secure?i.secure:t.location&&"https:"===location.protocol,i.hostname&&!i.port&&(i.port=this.secure?"443":"80"),this.agent=i.agent||!1,this.hostname=i.hostname||(t.location?location.hostname:"localhost"),this.port=i.port||(t.location&&location.port?location.port:this.secure?443:80),this.query=i.query||{},"string"==typeof this.query&&(this.query=f.decode(this.query)),this.upgrade=!1!==i.upgrade,this.path=(i.path||"/engine.io").replace(/\/$/,"")+"/",this.forceJSONP=!!i.forceJSONP,this.jsonp=!1!==i.jsonp,this.forceBase64=!!i.forceBase64,this.enablesXDR=!!i.enablesXDR,this.timestampParam=i.timestampParam||"t",this.timestampRequests=i.timestampRequests,this.transports=i.transports||["polling","websocket"],this.transportOptions=i.transportOptions||{},this.readyState="",this.writeBuffer=[],this.prevBufferLen=0,this.policyPort=i.policyPort||843,this.rememberUpgrade=i.rememberUpgrade||!1,this.binaryType=null,this.onlyBinaryUpgrades=i.onlyBinaryUpgrades,this.perMessageDeflate=!1!==i.perMessageDeflate&&(i.perMessageDeflate||{}),!0===this.perMessageDeflate&&(this.perMessageDeflate={}),this.perMessageDeflate&&null==this.perMessageDeflate.threshold&&(this.perMessageDeflate.threshold=1024),this.pfx=i.pfx||null,this.key=i.key||null,this.passphrase=i.passphrase||null,this.cert=i.cert||null,this.ca=i.ca||null,this.ciphers=i.ciphers||null,this.rejectUnauthorized=void 0===i.rejectUnauthorized||i.rejectUnauthorized,this.forceNode=!!i.forceNode;var s="object"==typeof t&&t;s.global===s&&(i.extraHeaders&&Object.keys(i.extraHeaders).length>0&&(this.extraHeaders=i.extraHeaders),i.localAddress&&(this.localAddress=i.localAddress)),this.id=null,this.upgrades=null,this.pingInterval=null,this.pingTimeout=null,this.pingIntervalTimer=null,this.pingTimeoutTimer=null,this.open()}var d=i(12),u=i(5),h=(i(3)("engine.io-client:socket"),i(33)),l=i(18),p=i(2),f=i(27);e.exports=n,n.priorWebsocketSuccess=!1,u(n.prototype),n.protocol=l.protocol,n.Socket=n,n.Transport=i(17),n.transports=i(12),n.parser=i(18),n.prototype.createTransport=function(e){var t=function o(e){var t={};for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);return t}(this.query);t.EIO=l.protocol,t.transport=e;var n=this.transportOptions[e]||{};return this.id&&(t.sid=this.id),new d[e]({query:t,socket:this,agent:n.agent||this.agent,hostname:n.hostname||this.hostname,port:n.port||this.port,secure:n.secure||this.secure,path:n.path||this.path,forceJSONP:n.forceJSONP||this.forceJSONP,jsonp:n.jsonp||this.jsonp,forceBase64:n.forceBase64||this.forceBase64,enablesXDR:n.enablesXDR||this.enablesXDR,timestampRequests:n.timestampRequests||this.timestampRequests,timestampParam:n.timestampParam||this.timestampParam,policyPort:n.policyPort||this.policyPort,pfx:n.pfx||this.pfx,key:n.key||this.key,passphrase:n.passphrase||this.passphrase,cert:n.cert||this.cert,ca:n.ca||this.ca,ciphers:n.ciphers||this.ciphers,rejectUnauthorized:n.rejectUnauthorized||this.rejectUnauthorized,perMessageDeflate:n.perMessageDeflate||this.perMessageDeflate,extraHeaders:n.extraHeaders||this.extraHeaders,forceNode:n.forceNode||this.forceNode,localAddress:n.localAddress||this.localAddress,requestTimeout:n.requestTimeout||this.requestTimeout,protocols:n.protocols||void 0})},n.prototype.open=function(){var e;if(this.rememberUpgrade&&n.priorWebsocketSuccess&&-1!==this.transports.indexOf("websocket"))e="websocket";else{if(0===this.transports.length){var t=this;return void setTimeout(function(){t.emit("error","No transports available")},0)}e=this.transports[0]}this.readyState="opening";try{e=this.createTransport(e)}catch(e){return this.transports.shift(),void this.open()}e.open(),this.setTransport(e)},n.prototype.setTransport=function(e){var t=this;this.transport&&this.transport.removeAllListeners(),this.transport=e,e.on("drain",function(){t.onDrain()}).on("packet",function(e){t.onPacket(e)}).on("error",function(e){t.onError(e)}).on("close",function(){t.onClose("transport close")})},n.prototype.probe=function(t){function e(){if(h.onlyBinaryUpgrades){var e=!this.supportsBinary&&h.transport.supportsBinary;u=u||e}u||(d.send([{type:"ping",data:"probe"}]),d.once("packet",function(e){if(!u)if("pong"===e.type&&"probe"===e.data){if(h.upgrading=!0,h.emit("upgrading",d),!d)return;n.priorWebsocketSuccess="websocket"===d.name,h.transport.pause(function(){u||"closed"!==h.readyState&&(c(),h.setTransport(d),d.send([{type:"upgrade"}]),h.emit("upgrade",d),d=null,h.upgrading=!1,h.flush())})}else{var t=new Error("probe error");t.transport=d.name,h.emit("upgradeError",t)}}))}function r(){u||(u=!0,c(),d.close(),d=null)}function o(e){var t=new Error("probe error: "+e);t.transport=d.name,r(),h.emit("upgradeError",t)}function i(){o("transport closed")}function s(){o("socket closed")}function a(e){d&&e.name!==d.name&&r()}function c(){d.removeListener("open",e),d.removeListener("error",o),d.removeListener("close",i),h.removeListener("close",s),h.removeListener("upgrading",a)}var d=this.createTransport(t,{probe:1}),u=!1,h=this;n.priorWebsocketSuccess=!1,d.once("open",e),d.once("error",o),d.once("close",i),this.once("close",s),this.once("upgrading",a),d.open()},n.prototype.onOpen=function(){if(this.readyState="open",n.priorWebsocketSuccess="websocket"===this.transport.name,this.emit("open"),this.flush(),"open"===this.readyState&&this.upgrade&&this.transport.pause)for(var e=0,t=this.upgrades.length;e<t;e++)this.probe(this.upgrades[e])},n.prototype.onPacket=function(e){if("opening"===this.readyState||"open"===this.readyState||"closing"===this.readyState)switch(this.emit("packet",e),this.emit("heartbeat"),e.type){case"open":this.onHandshake(JSON.parse(e.data));break;case"pong":this.setPing(),this.emit("pong");break;case"error":var t=new Error("server error");t.code=e.data,this.onError(t);break;case"message":this.emit("data",e.data),this.emit("message",e.data)}},n.prototype.onHandshake=function(e){this.emit("handshake",e),this.id=e.sid,this.transport.query.sid=e.sid,this.upgrades=this.filterUpgrades(e.upgrades),this.pingInterval=e.pingInterval,this.pingTimeout=e.pingTimeout,this.onOpen(),"closed"!==this.readyState&&(this.setPing(),this.removeListener("heartbeat",this.onHeartbeat),this.on("heartbeat",this.onHeartbeat))},n.prototype.onHeartbeat=function(e){clearTimeout(this.pingTimeoutTimer);var t=this;t.pingTimeoutTimer=setTimeout(function(){"closed"!==t.readyState&&t.onClose("ping timeout")},e||t.pingInterval+t.pingTimeout)},n.prototype.setPing=function(){var e=this;clearTimeout(e.pingIntervalTimer),e.pingIntervalTimer=setTimeout(function(){e.ping(),e.onHeartbeat(e.pingTimeout)},e.pingInterval)},n.prototype.ping=function(){var e=this;this.sendPacket("ping",function(){e.emit("ping")})},n.prototype.onDrain=function(){this.writeBuffer.splice(0,this.prevBufferLen),this.prevBufferLen=0,0===this.writeBuffer.length?this.emit("drain"):this.flush()},n.prototype.flush=function(){"closed"!==this.readyState&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length&&(this.transport.send(this.writeBuffer),this.prevBufferLen=this.writeBuffer.length,this.emit("flush"))},n.prototype.write=n.prototype.send=function(e,t,n){return this.sendPacket("message",e,t,n),this},n.prototype.sendPacket=function(e,t,n,i){if("function"==typeof t&&(i=t,t=void 0),"function"==typeof n&&(i=n,n=null),"closing"!==this.readyState&&"closed"!==this.readyState){(n=n||{}).compress=!1!==n.compress;var s={type:e,data:t,options:n};this.emit("packetCreate",s),this.writeBuffer.push(s),i&&this.once("flush",i),this.flush()}},n.prototype.close=function(){function t(){n.onClose("forced close"),n.transport.close()}function e(){n.removeListener("upgrade",e),n.removeListener("upgradeError",e),t()}function r(){n.once("upgrade",e),n.once("upgradeError",e)}if("opening"===this.readyState||"open"===this.readyState){this.readyState="closing";var n=this;this.writeBuffer.length?this.once("drain",function(){this.upgrading?r():t()}):this.upgrading?r():t()}return this},n.prototype.onError=function(e){n.priorWebsocketSuccess=!1,this.emit("error",e),this.onClose("transport error",e)},n.prototype.onClose=function(e,t){if("opening"===this.readyState||"open"===this.readyState||"closing"===this.readyState){clearTimeout(this.pingIntervalTimer),clearTimeout(this.pingTimeoutTimer),this.transport.removeAllListeners("close"),this.transport.close(),this.transport.removeAllListeners(),this.readyState="closed",this.id=null,this.emit("close",e,t),this.writeBuffer=[],this.prevBufferLen=0}},n.prototype.filterUpgrades=function(e){for(var t=[],n=0,i=e.length;n<i;n++)~h(this.transports,e[n])&&t.push(e[n]);return t}}).call(t,function(){return this}())},function(e,t,i){(function(e){var s=i(13),r=i(15),o=i(30),a=i(31);t.polling=function n(t){var n=!1,i=!1,a=!1!==t.jsonp;if(e.location){var c="https:"===location.protocol,d=location.port;d||(d=c?443:80),n=t.hostname!==location.hostname||d!==t.port,i=t.secure!==c}if(t.xdomain=n,t.xscheme=i,"open"in new s(t)&&!t.forceJSONP)return new r(t);if(!a)throw new Error("JSONP disabled");return new o(t)},t.websocket=a}).call(t,function(){return this}())},function(e,t,n){(function(t){var i=n(14);e.exports=function(e){var n=e.xdomain,s=e.xscheme,r=e.enablesXDR;try{if("undefined"!=typeof XMLHttpRequest&&(!n||i))return new XMLHttpRequest}catch(e){}try{if("undefined"!=typeof XDomainRequest&&!s&&r)return new XDomainRequest}catch(e){}if(!n)try{return new(t[["Active"].concat("Object").join("X")])("Microsoft.XMLHTTP")}catch(e){}}}).call(t,function(){return this}())},function(e,t){try{e.exports="undefined"!=typeof XMLHttpRequest&&"withCredentials"in new XMLHttpRequest}catch(t){e.exports=!1}},function(e,t,r){(function(t){function n(){}function o(e){if(c.call(this,e),this.requestTimeout=e.requestTimeout,this.extraHeaders=e.extraHeaders,t.location){var n="https:"===location.protocol,i=location.port;i||(i=n?443:80),this.xd=e.hostname!==t.location.hostname||i!==e.port,this.xs=e.secure!==n}}function i(e){this.method=e.method||"GET",this.uri=e.uri,this.xd=!!e.xd,this.xs=!!e.xs,this.async=!1!==e.async,this.data=void 0!==e.data?e.data:null,this.agent=e.agent,this.isBinary=e.isBinary,this.supportsBinary=e.supportsBinary,this.enablesXDR=e.enablesXDR,this.requestTimeout=e.requestTimeout,this.pfx=e.pfx,this.key=e.key,this.passphrase=e.passphrase,this.cert=e.cert,this.ca=e.ca,this.ciphers=e.ciphers,this.rejectUnauthorized=e.rejectUnauthorized,this.extraHeaders=e.extraHeaders,this.create()}function s(){for(var e in i.requests)i.requests.hasOwnProperty(e)&&i.requests[e].abort()}var a=r(13),c=r(16),d=r(5),u=r(28);r(3)("engine.io-client:polling-xhr"),e.exports=o,e.exports.Request=i,u(o,c),o.prototype.supportsBinary=!0,o.prototype.request=function(e){return(e=e||{}).uri=this.uri(),e.xd=this.xd,e.xs=this.xs,e.agent=this.agent||!1,e.supportsBinary=this.supportsBinary,e.enablesXDR=this.enablesXDR,e.pfx=this.pfx,e.key=this.key,e.passphrase=this.passphrase,e.cert=this.cert,e.ca=this.ca,e.ciphers=this.ciphers,e.rejectUnauthorized=this.rejectUnauthorized,e.requestTimeout=this.requestTimeout,e.extraHeaders=this.extraHeaders,new i(e)},o.prototype.doWrite=function(e,t){var n="string"!=typeof e&&void 0!==e,i=this.request({method:"POST",data:e,isBinary:n}),s=this;i.on("success",t),i.on("error",function(e){s.onError("xhr post error",e)}),this.sendXhr=i},o.prototype.doPoll=function(){var e=this.request(),t=this;e.on("data",function(e){t.onData(e)}),e.on("error",function(e){t.onError("xhr poll error",e)}),this.pollXhr=e},d(i.prototype),i.prototype.create=function(){var e={agent:this.agent,xdomain:this.xd,xscheme:this.xs,enablesXDR:this.enablesXDR};e.pfx=this.pfx,e.key=this.key,e.passphrase=this.passphrase,e.cert=this.cert,e.ca=this.ca,e.ciphers=this.ciphers,e.rejectUnauthorized=this.rejectUnauthorized;var n=this.xhr=new a(e),s=this;try{n.open(this.method,this.uri,this.async);try{if(this.extraHeaders)for(var r in n.setDisableHeaderCheck&&n.setDisableHeaderCheck(!0),this.extraHeaders)this.extraHeaders.hasOwnProperty(r)&&n.setRequestHeader(r,this.extraHeaders[r])}catch(e){}if("POST"===this.method)try{this.isBinary?n.setRequestHeader("Content-type","application/octet-stream"):n.setRequestHeader("Content-type","text/plain;charset=UTF-8")}catch(e){}try{n.setRequestHeader("Accept","*/*")}catch(e){}"withCredentials"in n&&(n.withCredentials=!0),this.requestTimeout&&(n.timeout=this.requestTimeout),this.hasXDR()?(n.onload=function(){s.onLoad()},n.onerror=function(){s.onError(n.responseText)}):n.onreadystatechange=function(){if(2===n.readyState)try{var e=n.getResponseHeader("Content-Type");s.supportsBinary&&"application/octet-stream"===e&&(n.responseType="arraybuffer")}catch(e){}4===n.readyState&&(200===n.status||1223===n.status?s.onLoad():setTimeout(function(){s.onError(n.status)},0))},n.send(this.data)}catch(e){return void setTimeout(function(){s.onError(e)},0)}t.document&&(this.index=i.requestsCount++,i.requests[this.index]=this)},i.prototype.onSuccess=function(){this.emit("success"),this.cleanup()},i.prototype.onData=function(e){this.emit("data",e),this.onSuccess()},i.prototype.onError=function(e){this.emit("error",e),this.cleanup(!0)},i.prototype.cleanup=function(e){if(void 0!==this.xhr&&null!==this.xhr){if(this.hasXDR()?this.xhr.onload=this.xhr.onerror=n:this.xhr.onreadystatechange=n,e)try{this.xhr.abort()}catch(e){}t.document&&delete i.requests[this.index],this.xhr=null}},i.prototype.onLoad=function(){var e;try{var t;try{t=this.xhr.getResponseHeader("Content-Type")}catch(e){}e="application/octet-stream"===t&&this.xhr.response||this.xhr.responseText}catch(e){this.onError(e)}null!=e&&this.onData(e)},i.prototype.hasXDR=function(){return void 0!==t.XDomainRequest&&!this.xs&&this.enablesXDR},i.prototype.abort=function(){this.cleanup()},i.requestsCount=0,i.requests={},t.document&&(t.attachEvent?t.attachEvent("onunload",s):t.addEventListener&&t.addEventListener("beforeunload",s,!1))}).call(t,function(){return this}())},function(e,t,i){function n(e){var t=e&&e.forceBase64;d&&!t||(this.supportsBinary=!1),s.call(this,e)}var s=i(17),r=i(27),o=i(18),a=i(28),c=i(29);i(3)("engine.io-client:polling"),e.exports=n;var d=null!=new(i(13))({xdomain:!1}).responseType;a(n,s),n.prototype.name="polling",n.prototype.doOpen=function(){this.poll()},n.prototype.pause=function(t){function e(){n.readyState="paused",t()}var n=this;if(this.readyState="pausing",this.polling||!this.writable){var i=0;this.polling&&(i++,this.once("pollComplete",function(){--i||e()})),this.writable||(i++,this.once("drain",function(){--i||e()}))}else e()},n.prototype.poll=function(){this.polling=!0,this.doPoll(),this.emit("poll")},n.prototype.onData=function(e){var t=this;o.decodePayload(e,this.socket.binaryType,function(e,n,i){return"opening"===t.readyState&&t.onOpen(),"close"===e.type?(t.onClose(),!1):void t.onPacket(e)}),"closed"!==this.readyState&&(this.polling=!1,this.emit("pollComplete"),"open"===this.readyState&&this.poll())},n.prototype.doClose=function(){function t(){e.write([{type:"close"}])}var e=this;"open"===this.readyState?t():this.once("open",t)},n.prototype.write=function(e){var t=this;this.writable=!1;var n=function(){t.writable=!0,t.emit("drain")};o.encodePayload(e,this.supportsBinary,function(e){t.doWrite(e,n)})},n.prototype.uri=function(){var e=this.query||{},t=this.secure?"https":"http",n="";return!1!==this.timestampRequests&&(e[this.timestampParam]=c()),this.supportsBinary||e.sid||(e.b64=1),e=r.encode(e),this.port&&("https"===t&&443!==Number(this.port)||"http"===t&&80!==Number(this.port))&&(n=":"+this.port),e.length&&(e="?"+e),t+"://"+(-1!==this.hostname.indexOf(":")?"["+this.hostname+"]":this.hostname)+n+this.path+e}},function(e,t,i){function n(e){this.path=e.path,this.hostname=e.hostname,this.port=e.port,this.secure=e.secure,this.query=e.query,this.timestampParam=e.timestampParam,this.timestampRequests=e.timestampRequests,this.readyState="",this.agent=e.agent||!1,this.socket=e.socket,this.enablesXDR=e.enablesXDR,this.pfx=e.pfx,this.key=e.key,this.passphrase=e.passphrase,this.cert=e.cert,this.ca=e.ca,this.ciphers=e.ciphers,this.rejectUnauthorized=e.rejectUnauthorized,this.forceNode=e.forceNode,this.extraHeaders=e.extraHeaders,this.localAddress=e.localAddress}var s=i(18),r=i(5);e.exports=n,r(n.prototype),n.prototype.onError=function(e,t){var n=new Error(e);return n.type="TransportError",n.description=t,this.emit("error",n),this},n.prototype.open=function(){return"closed"!==this.readyState&&""!==this.readyState||(this.readyState="opening",this.doOpen()),this},n.prototype.close=function(){return"opening"!==this.readyState&&"open"!==this.readyState||(this.doClose(),this.onClose()),this},n.prototype.send=function(e){if("open"!==this.readyState)throw new Error("Transport not open");this.write(e)},n.prototype.onOpen=function(){this.readyState="open",this.writable=!0,this.emit("open")},n.prototype.onData=function(e){var t=s.decodePacket(e,this.socket.binaryType);this.onPacket(t)},n.prototype.onPacket=function(e){this.emit("packet",e)},n.prototype.onClose=function(){this.readyState="closed",this.emit("close")}},function(e,t,r){(function(e){function n(e,n){return n("b"+t.packets[e.type]+e.data.data)}function o(e,n,i){if(!n)return t.encodeBase64Packet(e,i);var s=e.data,r=new Uint8Array(s),o=new Uint8Array(1+s.byteLength);o[0]=b[e.type];for(var a=0;a<r.length;a++)o[a+1]=r[a];return i(o.buffer)}function s(e,n,s){if(!n)return t.encodeBase64Packet(e,s);if(v)return function i(e,n,s){if(!n)return t.encodeBase64Packet(e,s);var r=new FileReader;return r.onload=function(){e.data=r.result,t.encodePacket(e,n,!0,s)},r.readAsArrayBuffer(e.data)}(e,n,s);var r=new Uint8Array(1);return r[0]=b[e.type],s(new S([r.buffer,e.data]))}function c(e,t,n){for(var i=new Array(e.length),s=p(e.length,n),r=function(e,n,s){t(n,function(t,n){i[e]=n,s(t,i)})},o=0;o<e.length;o++)r(o,e[o],s)}var d,u=r(19),h=r(20),l=r(21),p=r(22),f=r(23);e&&e.ArrayBuffer&&(d=r(25));var m="undefined"!=typeof navigator&&/Android/i.test(navigator.userAgent),g="undefined"!=typeof navigator&&/PhantomJS/i.test(navigator.userAgent),v=m||g;t.protocol=3;var b=t.packets={open:0,close:1,ping:2,pong:3,message:4,upgrade:5,noop:6},y=u(b),w={type:"error",data:"parser error"},S=r(26);t.encodePacket=function(t,i,r,a){"function"==typeof i&&(a=i,i=!1),"function"==typeof r&&(a=r,r=null);var c=void 0===t.data?void 0:t.data.buffer||t.data;if(e.ArrayBuffer&&c instanceof ArrayBuffer)return o(t,i,a);if(S&&c instanceof e.Blob)return s(t,i,a);if(c&&c.base64)return n(t,a);var d=b[t.type];return void 0!==t.data&&(d+=r?f.encode(String(t.data),{strict:!1}):String(t.data)),a(""+d)},t.encodeBase64Packet=function(n,i){var s,r="b"+t.packets[n.type];if(S&&n.data instanceof e.Blob){var o=new FileReader;return o.onload=function(){var e=o.result.split(",")[1];i(r+e)},o.readAsDataURL(n.data)}try{s=String.fromCharCode.apply(null,new Uint8Array(n.data))}catch(e){for(var a=new Uint8Array(n.data),c=new Array(a.length),d=0;d<a.length;d++)c[d]=a[d];s=String.fromCharCode.apply(null,c)}return r+=e.btoa(s),i(r)},t.decodePacket=function(e,n,i){if(void 0===e)return w;if("string"==typeof e){if("b"===e.charAt(0))return t.decodeBase64Packet(e.substr(1),n);if(i&&!1===(e=function a(e){try{e=f.decode(e,{strict:!1})}catch(e){return!1}return e}(e)))return w;var s=e.charAt(0);return Number(s)==s&&y[s]?e.length>1?{type:y[s],data:e.substring(1)}:{type:y[s]}:w}s=new Uint8Array(e)[0];var r=l(e,1);return S&&"blob"===n&&(r=new S([r])),{type:y[s],data:r}},t.decodeBase64Packet=function(e,t){var n=y[e.charAt(0)];if(!d)return{type:n,data:{base64:!0,data:e.substr(1)}};var i=d.decode(e.substr(1));return"blob"===t&&S&&(i=new S([i])),{type:n,data:i}},t.encodePayload=function(e,n,s){"function"==typeof n&&(s=n,n=null);var r=h(e);return n&&r?S&&!v?t.encodePayloadAsBlob(e,s):t.encodePayloadAsArrayBuffer(e,s):e.length?void c(e,function i(e,s){t.encodePacket(e,!!r&&n,!1,function(e){s(null,function o(e){return e.length+":"+e}(e))})},function(e,t){return s(t.join(""))}):s("0:")},t.decodePayload=function(e,n,i){if("string"!=typeof e)return t.decodePayloadAsBinary(e,n,i);var s;if("function"==typeof n&&(i=n,n=null),""===e)return i(w,0,1);for(var r,o,a="",c=0,d=e.length;c<d;c++){var u=e.charAt(c);if(":"===u){if(""===a||a!=(r=Number(a)))return i(w,0,1);if(a!=(o=e.substr(c+1,r)).length)return i(w,0,1);if(o.length){if(s=t.decodePacket(o,n,!1),w.type===s.type&&w.data===s.data)return i(w,0,1);if(!1===i(s,c+r,d))return}c+=r,a=""}else a+=u}return""!==a?i(w,0,1):void 0},t.encodePayloadAsArrayBuffer=function(e,i){return e.length?void c(e,function n(e,i){t.encodePacket(e,!0,!0,function(e){return i(null,e)})},function(e,t){var n=t.reduce(function(e,t){var n;return e+(n="string"==typeof t?t.length:t.byteLength).toString().length+n+2},0),s=new Uint8Array(n),r=0;return t.forEach(function(e){var t="string"==typeof e,n=e;if(t){for(var i=new Uint8Array(e.length),o=0;o<e.length;o++)i[o]=e.charCodeAt(o);n=i.buffer}s[r++]=t?0:1;var a=n.byteLength.toString();for(o=0;o<a.length;o++)s[r++]=parseInt(a[o]);s[r++]=255;for(i=new Uint8Array(n),o=0;o<i.length;o++)s[r++]=i[o]}),i(s.buffer)}):i(new ArrayBuffer(0))},t.encodePayloadAsBlob=function(e,i){c(e,function n(e,i){t.encodePacket(e,!0,!0,function(e){var t=new Uint8Array(1);if(t[0]=1,"string"==typeof e){for(var n=new Uint8Array(e.length),s=0;s<e.length;s++)n[s]=e.charCodeAt(s);e=n.buffer,t[0]=0}var r=(e instanceof ArrayBuffer?e.byteLength:e.size).toString(),o=new Uint8Array(r.length+1);for(s=0;s<r.length;s++)o[s]=parseInt(r[s]);if(o[r.length]=255,S){var a=new S([t.buffer,o.buffer,e]);i(null,a)}})},function(e,t){return i(new S(t))})},t.decodePayloadAsBinary=function(e,n,i){"function"==typeof n&&(i=n,n=null);for(var s=e,r=[];s.byteLength>0;){for(var o=new Uint8Array(s),a=0===o[0],c="",d=1;255!==o[d];d++){if(c.length>310)return i(w,0,1);c+=o[d]}s=l(s,2+c.length),c=parseInt(c);var u=l(s,0,c);if(a)try{u=String.fromCharCode.apply(null,new Uint8Array(u))}catch(e){var h=new Uint8Array(u);u="";for(d=0;d<h.length;d++)u+=String.fromCharCode(h[d])}r.push(u),s=l(s,c)}var p=r.length;r.forEach(function(e,s){i(t.decodePacket(e,n,!0),s,p)})}}).call(t,function(){return this}())},function(e,t){e.exports=Object.keys||function(e){var t=[],n=Object.prototype.hasOwnProperty;for(var i in e)n.call(e,i)&&t.push(i);return t}},function(e,t,n){(function(t){var i=n(7),s=Object.prototype.toString,r="function"==typeof t.Blob||"[object BlobConstructor]"===s.call(t.Blob),o="function"==typeof t.File||"[object FileConstructor]"===s.call(t.File);e.exports=function n(e){if(!e||"object"!=typeof e)return!1;if(i(e)){for(var s=0,a=e.length;s<a;s++)if(n(e[s]))return!0;return!1}if("function"==typeof t.Buffer&&t.Buffer.isBuffer&&t.Buffer.isBuffer(e)||"function"==typeof t.ArrayBuffer&&e instanceof ArrayBuffer||r&&e instanceof Blob||o&&e instanceof File)return!0;if(e.toJSON&&"function"==typeof e.toJSON&&1===arguments.length)return n(e.toJSON(),!0);for(var c in e)if(Object.prototype.hasOwnProperty.call(e,c)&&n(e[c]))return!0;return!1}}).call(t,function(){return this}())},function(e,t){e.exports=function(e,t,n){var i=e.byteLength;if(t=t||0,n=n||i,e.slice)return e.slice(t,n);if(t<0&&(t+=i),n<0&&(n+=i),n>i&&(n=i),t>=i||t>=n||0===i)return new ArrayBuffer(0);for(var s=new Uint8Array(e),r=new Uint8Array(n-t),o=t,a=0;o<n;o++,a++)r[a]=s[o];return r.buffer}},function(e,t){function n(){}e.exports=function r(e,t,i){function o(e,n){if(o.count<=0)throw new Error("after called too many times");--o.count,e?(s=!0,t(e),t=i):0!==o.count||s||t(null,n)}var s=!1;return i=i||n,o.count=e,0===e?t():o}},function(e,t,n){var i;(function(e,r){!function(o){function s(e){for(var t,n,i=[],s=0,r=e.length;s<r;)(t=e.charCodeAt(s++))>=55296&&t<=56319&&s<r?56320==(64512&(n=e.charCodeAt(s++)))?i.push(((1023&t)<<10)+(1023&n)+65536):(i.push(t),s--):i.push(t);return i}function c(e,t){if(e>=55296&&e<=57343){if(t)throw Error("Lone surrogate U+"+e.toString(16).toUpperCase()+" is not a scalar value");return!1}return!0}function h(e,t){return y(e>>t&63|128)}function p(e,t){if(0==(4294967168&e))return y(e);var n="";return 0==(4294965248&e)?n=y(e>>6&31|192):0==(4294901760&e)?(c(e,t)||(e=65533),n=y(e>>12&15|224),n+=h(e,6)):0==(4292870144&e)&&(n=y(e>>18&7|240),n+=h(e,12),n+=h(e,6)),n+y(63&e|128)}function f(){if(b>=v)throw Error("Invalid byte index");var e=255&g[b];if(b++,128==(192&e))return 63&e;throw Error("Invalid continuation byte")}function l(e){var t,n;if(b>v)throw Error("Invalid byte index");if(b==v)return!1;if(t=255&g[b],b++,0==(128&t))return t;if(192==(224&t)){if((n=(31&t)<<6|f())>=128)return n;throw Error("Invalid continuation byte")}if(224==(240&t)){if((n=(15&t)<<12|f()<<6|f())>=2048)return c(n,e)?n:65533;throw Error("Invalid continuation byte")}if(240==(248&t)&&((n=(7&t)<<18|f()<<12|f()<<6|f())>=65536&&n<=1114111))return n;throw Error("Invalid UTF-8 detected")}var m=("object"==typeof e&&e&&e.exports,"object"==typeof r&&r);m.global!==m&&m.window;var g,v,b,y=String.fromCharCode,w={version:"2.1.2",encode:function u(e,t){for(var n=!1!==(t=t||{}).strict,i=s(e),r=i.length,o=-1,a="";++o<r;)a+=p(i[o],n);return a},decode:function d(e,t){var n=!1!==(t=t||{}).strict;g=s(e),v=g.length,b=0;for(var i,r=[];!1!==(i=l(n));)r.push(i);return function a(e){for(var t,n=e.length,i=-1,s="";++i<n;)(t=e[i])>65535&&(s+=y((t-=65536)>>>10&1023|55296),t=56320|1023&t),s+=y(t);return s}(r)}};void 0===(i=function(){return w}.call(t,n,t,e))||(e.exports=i)}()}).call(t,n(24)(e),function(){return this}())},function(e,t){e.exports=function(e){return e.webpackPolyfill||(e.deprecate=function(){},e.paths=[],e.children=[],e.webpackPolyfill=1),e}},function(e,t){!function(){"use strict";for(var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",n=new Uint8Array(256),i=0;i<e.length;i++)n[e.charCodeAt(i)]=i;t.encode=function(t){var n,i=new Uint8Array(t),s=i.length,r="";for(n=0;n<s;n+=3)r+=e[i[n]>>2],r+=e[(3&i[n])<<4|i[n+1]>>4],r+=e[(15&i[n+1])<<2|i[n+2]>>6],r+=e[63&i[n+2]];return s%3==2?r=r.substring(0,r.length-1)+"=":s%3==1&&(r=r.substring(0,r.length-2)+"=="),r},t.decode=function(e){var t,i,s,r,o,a=.75*e.length,c=e.length,d=0;"="===e[e.length-1]&&(a--,"="===e[e.length-2]&&a--);var u=new ArrayBuffer(a),h=new Uint8Array(u);for(t=0;t<c;t+=4)i=n[e.charCodeAt(t)],s=n[e.charCodeAt(t+1)],r=n[e.charCodeAt(t+2)],o=n[e.charCodeAt(t+3)],h[d++]=i<<2|s>>4,h[d++]=(15&s)<<4|r>>2,h[d++]=(3&r)<<6|63&o;return u}}()},function(e,t){(function(t){function r(e){for(var t=0;t<e.length;t++){var n=e[t];if(n.buffer instanceof ArrayBuffer){var i=n.buffer;if(n.byteLength!==i.byteLength){var s=new Uint8Array(n.byteLength);s.set(new Uint8Array(i,n.byteOffset,n.byteLength)),i=s.buffer}e[t]=i}}}function n(e,t){t=t||{};var n=new i;r(e);for(var s=0;s<e.length;s++)n.append(e[s]);return t.type?n.getBlob(t.type):n.getBlob()}function o(e,t){return r(e),new Blob(e,t||{})}var i=t.BlobBuilder||t.WebKitBlobBuilder||t.MSBlobBuilder||t.MozBlobBuilder,s=function(){try{return 2===new Blob(["hi"]).size}catch(e){return!1}}(),a=s&&function(){try{return 2===new Blob([new Uint8Array([1,2])]).size}catch(e){return!1}}(),c=i&&i.prototype.append&&i.prototype.getBlob;e.exports=s?a?t.Blob:o:c?n:void 0}).call(t,function(){return this}())},function(e,t){t.encode=function(e){var t="";for(var n in e)e.hasOwnProperty(n)&&(t.length&&(t+="&"),t+=encodeURIComponent(n)+"="+encodeURIComponent(e[n]));return t},t.decode=function(e){for(var t={},n=e.split("&"),i=0,s=n.length;i<s;i++){var r=n[i].split("=");t[decodeURIComponent(r[0])]=decodeURIComponent(r[1])}return t}},function(e,t){e.exports=function(e,t){var n=function(){};n.prototype=t.prototype,e.prototype=new n,e.prototype.constructor=e}},function(e,t){"use strict";function r(e){var t="";do{t=s[e%a]+t,e=Math.floor(e/a)}while(e>0);return t}function o(){var e=r(+new Date);return e!==i?(d=0,i=e):e+"."+r(d++)}for(var i,s="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz-_".split(""),a=64,c={},d=0,u=0;u<a;u++)c[s[u]]=u;o.encode=r,o.decode=function n(e){var t=0;for(u=0;u<e.length;u++)t=t*a+c[e.charAt(u)];return t},e.exports=o},function(e,t,i){(function(t){function n(){}function o(e){s.call(this,e),this.query=this.query||{},c||(t.___eio||(t.___eio=[]),c=t.___eio),this.index=c.length;var i=this;c.push(function(e){i.onData(e)}),this.query.j=this.index,t.document&&t.addEventListener&&t.addEventListener("beforeunload",function(){i.script&&(i.script.onerror=n)},!1)}var s=i(16),a=i(28);e.exports=o;var c,d=/\n/g,u=/\\n/g;a(o,s),o.prototype.supportsBinary=!1,o.prototype.doClose=function(){this.script&&(this.script.parentNode.removeChild(this.script),this.script=null),this.form&&(this.form.parentNode.removeChild(this.form),this.form=null,this.iframe=null),s.prototype.doClose.call(this)},o.prototype.doPoll=function(){var e=this,t=document.createElement("script");this.script&&(this.script.parentNode.removeChild(this.script),this.script=null),t.async=!0,t.src=this.uri(),t.onerror=function(t){e.onError("jsonp poll error",t)};var n=document.getElementsByTagName("script")[0];n?n.parentNode.insertBefore(t,n):(document.head||document.body).appendChild(t),this.script=t,"undefined"!=typeof navigator&&/gecko/i.test(navigator.userAgent)&&setTimeout(function(){var e=document.createElement("iframe");document.body.appendChild(e),document.body.removeChild(e)},100)},o.prototype.doWrite=function(e,t){function r(){n(),t()}function n(){if(i.iframe)try{i.form.removeChild(i.iframe)}catch(e){i.onError("jsonp polling iframe removal error",e)}try{var e='<iframe src="javascript:0" name="'+i.iframeId+'">';s=document.createElement(e)}catch(e){(s=document.createElement("iframe")).name=i.iframeId,s.src="javascript:0"}s.id=i.iframeId,i.form.appendChild(s),i.iframe=s}var i=this;if(!this.form){var s,o=document.createElement("form"),a=document.createElement("textarea"),c=this.iframeId="eio_iframe_"+this.index;o.className="socketio",o.style.position="absolute",o.style.top="-1000px",o.style.left="-1000px",o.target=c,o.method="POST",o.setAttribute("accept-charset","utf-8"),a.name="d",o.appendChild(a),document.body.appendChild(o),this.form=o,this.area=a}this.form.action=this.uri(),n(),e=e.replace(u,"\\\n"),this.area.value=e.replace(d,"\\n");try{this.form.submit()}catch(e){}this.iframe.attachEvent?this.iframe.onreadystatechange=function(){"complete"===i.iframe.readyState&&r()}:this.iframe.onload=r}}).call(t,function(){return this}())},function(e,t,i){(function(t){function n(e){e&&e.forceBase64&&(this.supportsBinary=!1),this.perMessageDeflate=e.perMessageDeflate,this.usingBrowserWebSocket=u&&!e.forceNode,this.protocols=e.protocols,this.usingBrowserWebSocket||(h=s),r.call(this,e)}var s,r=i(17),o=i(18),a=i(27),c=i(28),d=i(29),u=(i(3)("engine.io-client:websocket"),t.WebSocket||t.MozWebSocket);if("undefined"==typeof window)try{s=i(32)}catch(e){}var h=u;h||"undefined"!=typeof window||(h=s),e.exports=n,c(n,r),n.prototype.name="websocket",n.prototype.supportsBinary=!0,n.prototype.doOpen=function(){if(this.check()){var e=this.uri(),t=this.protocols,n={agent:this.agent,perMessageDeflate:this.perMessageDeflate};n.pfx=this.pfx,n.key=this.key,n.passphrase=this.passphrase,n.cert=this.cert,n.ca=this.ca,n.ciphers=this.ciphers,n.rejectUnauthorized=this.rejectUnauthorized,this.extraHeaders&&(n.headers=this.extraHeaders),this.localAddress&&(n.localAddress=this.localAddress);try{this.ws=this.usingBrowserWebSocket?t?new h(e,t):new h(e):new h(e,t,n)}catch(e){return this.emit("error",e)}void 0===this.ws.binaryType&&(this.supportsBinary=!1),this.ws.supports&&this.ws.supports.binary?(this.supportsBinary=!0,this.ws.binaryType="nodebuffer"):this.ws.binaryType="arraybuffer",this.addEventListeners()}},n.prototype.addEventListeners=function(){var e=this;this.ws.onopen=function(){e.onOpen()},this.ws.onclose=function(){e.onClose()},this.ws.onmessage=function(t){e.onData(t.data)},this.ws.onerror=function(t){e.onError("websocket error",t)}},n.prototype.write=function(e){var n=this;this.writable=!1;for(var i=e.length,s=0,r=i;s<r;s++)!function(e){o.encodePacket(e,n.supportsBinary,function(s){if(!n.usingBrowserWebSocket){var r={};if(e.options&&(r.compress=e.options.compress),n.perMessageDeflate)("string"==typeof s?t.Buffer.byteLength(s):s.length)<n.perMessageDeflate.threshold&&(r.compress=!1)}try{n.usingBrowserWebSocket?n.ws.send(s):n.ws.send(s,r)}catch(e){}--i||(n.emit("flush"),setTimeout(function(){n.writable=!0,n.emit("drain")},0))})}(e[s])},n.prototype.onClose=function(){r.prototype.onClose.call(this)},n.prototype.doClose=function(){void 0!==this.ws&&this.ws.close()},n.prototype.uri=function(){var e=this.query||{},t=this.secure?"wss":"ws",n="";return this.port&&("wss"===t&&443!==Number(this.port)||"ws"===t&&80!==Number(this.port))&&(n=":"+this.port),this.timestampRequests&&(e[this.timestampParam]=d()),this.supportsBinary||(e.b64=1),(e=a.encode(e)).length&&(e="?"+e),t+"://"+(-1!==this.hostname.indexOf(":")?"["+this.hostname+"]":this.hostname)+n+this.path+e},n.prototype.check=function(){return!(!h||"__initialize"in h&&this.name===n.prototype.name)}}).call(t,function(){return this}())},function(e,t){},function(e,t){var n=[].indexOf;e.exports=function(e,t){if(n)return e.indexOf(t);for(var i=0;i<e.length;++i)if(e[i]===t)return i;return-1}},function(e,t,i){"use strict";function n(e,t,n){this.io=e,this.nsp=t,this.json=this,this.ids=0,this.acks={},this.receiveBuffer=[],this.sendBuffer=[],this.connected=!1,this.disconnected=!0,this.flags={},n&&n.query&&(this.query=n.query),this.io.autoConnect&&this.open()}var s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r=i(4),o=i(5),a=i(35),c=i(36),d=i(37),u=(i(3)("socket.io-client:socket"),i(27)),h=i(20);e.exports=n;var l={connect:1,connect_error:1,connect_timeout:1,connecting:1,disconnect:1,error:1,reconnect:1,reconnect_attempt:1,reconnect_failed:1,reconnect_error:1,reconnecting:1,ping:1,pong:1},p=o.prototype.emit;o(n.prototype),n.prototype.subEvents=function(){if(!this.subs){var e=this.io;this.subs=[c(e,"open",d(this,"onopen")),c(e,"packet",d(this,"onpacket")),c(e,"close",d(this,"onclose"))]}},n.prototype.open=n.prototype.connect=function(){return this.connected?this:(this.subEvents(),this.io.open(),"open"===this.io.readyState&&this.onopen(),this.emit("connecting"),this)},n.prototype.send=function(){var e=a(arguments);return e.unshift("message"),this.emit.apply(this,e),this},n.prototype.emit=function(e){if(l.hasOwnProperty(e))return p.apply(this,arguments),this;var t=a(arguments),n={type:(void 0!==this.flags.binary?this.flags.binary:h(t))?r.BINARY_EVENT:r.EVENT,data:t,options:{}};return n.options.compress=!this.flags||!1!==this.flags.compress,"function"==typeof t[t.length-1]&&(this.acks[this.ids]=t.pop(),n.id=this.ids++),this.connected?this.packet(n):this.sendBuffer.push(n),this.flags={},this},n.prototype.packet=function(e){e.nsp=this.nsp,this.io.packet(e)},n.prototype.onopen=function(){if("/"!==this.nsp)if(this.query){var e="object"===s(this.query)?u.encode(this.query):this.query;this.packet({type:r.CONNECT,query:e})}else this.packet({type:r.CONNECT})},n.prototype.onclose=function(e){this.connected=!1,this.disconnected=!0,delete this.id,this.emit("disconnect",e)},n.prototype.onpacket=function(e){var t=e.nsp===this.nsp,n=e.type===r.ERROR&&"/"===e.nsp;if(t||n)switch(e.type){case r.CONNECT:this.onconnect();break;case r.EVENT:case r.BINARY_EVENT:this.onevent(e);break;case r.ACK:case r.BINARY_ACK:this.onack(e);break;case r.DISCONNECT:this.ondisconnect();break;case r.ERROR:this.emit("error",e.data)}},n.prototype.onevent=function(e){var t=e.data||[];null!=e.id&&t.push(this.ack(e.id)),this.connected?p.apply(this,t):this.receiveBuffer.push(t)},n.prototype.ack=function(e){var t=this,n=!1;return function(){if(!n){n=!0;var i=a(arguments);t.packet({type:h(i)?r.BINARY_ACK:r.ACK,id:e,data:i})}}},n.prototype.onack=function(e){var t=this.acks[e.id];"function"==typeof t&&(t.apply(this,e.data),delete this.acks[e.id])},n.prototype.onconnect=function(){this.connected=!0,this.disconnected=!1,this.emit("connect"),this.emitBuffered()},n.prototype.emitBuffered=function(){var e;for(e=0;e<this.receiveBuffer.length;e++)p.apply(this,this.receiveBuffer[e]);for(this.receiveBuffer=[],e=0;e<this.sendBuffer.length;e++)this.packet(this.sendBuffer[e]);this.sendBuffer=[]},n.prototype.ondisconnect=function(){this.destroy(),this.onclose("io server disconnect")},n.prototype.destroy=function(){if(this.subs){for(var e=0;e<this.subs.length;e++)this.subs[e].destroy();this.subs=null}this.io.destroy(this)},n.prototype.close=n.prototype.disconnect=function(){return this.connected&&this.packet({type:r.DISCONNECT}),this.destroy(),this.connected&&this.onclose("io client disconnect"),this},n.prototype.compress=function(e){return this.flags.compress=e,this},n.prototype.binary=function(e){return this.flags.binary=e,this}},function(e,t){e.exports=function r(e,t){for(var n=[],i=(t=t||0)||0;i<e.length;i++)n[i-t]=e[i];return n}},function(e,t){"use strict";e.exports=function r(e,t,n){return e.on(t,n),{destroy:function(){e.removeListener(t,n)}}}},function(e,t){var n=[].slice;e.exports=function(e,t){if("string"==typeof t&&(t=e[t]),"function"!=typeof t)throw new Error("bind() requires a function");var i=n.call(arguments,2);return function(){return t.apply(e,i.concat(n.call(arguments)))}}},function(e,t){function r(e){e=e||{},this.ms=e.min||100,this.max=e.max||1e4,this.factor=e.factor||2,this.jitter=e.jitter>0&&e.jitter<=1?e.jitter:0,this.attempts=0}e.exports=r,r.prototype.duration=function(){var e=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var t=Math.random(),n=Math.floor(t*this.jitter*e);e=0==(1&Math.floor(10*t))?e-n:e+n}return 0|Math.min(e,this.max)},r.prototype.reset=function(){this.attempts=0},r.prototype.setMin=function(e){this.ms=e},r.prototype.setMax=function(e){this.max=e},r.prototype.setJitter=function(e){this.jitter=e}}])}),function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define("adapter",[],e);else{("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).adapter=e()}}(function(){return function e(t,n,i){function s(o,a){if(!n[o]){if(!t[o]){var c="function"==typeof require&&require;if(!a&&c)return c(o,!0);if(r)return r(o,!0);var d=new Error("Cannot find module '"+o+"'");throw d.code="MODULE_NOT_FOUND",d}var u=n[o]={exports:{}};t[o][0].call(u.exports,function(e){var n=t[o][1][e];return s(n||e)},u,u.exports,e,t,n,i)}return n[o].exports}for(var r="function"==typeof require&&require,o=0;o<i.length;o++)s(i[o]);return s}({1:[function(e,t,n){var i=e("sdp");function writeMediaSection(e,t,n,s,r){var o=i.writeRtpDescription(e.kind,t);if(o+=i.writeIceParameters(e.iceGatherer.getLocalParameters()),o+=i.writeDtlsParameters(e.dtlsTransport.getLocalParameters(),"offer"===n?"actpass":r||"active"),o+="a=mid:"+e.mid+"\r\n",e.rtpSender&&e.rtpReceiver?o+="a=sendrecv\r\n":e.rtpSender?o+="a=sendonly\r\n":e.rtpReceiver?o+="a=recvonly\r\n":o+="a=inactive\r\n",e.rtpSender){var a=e.rtpSender._initialTrackId||e.rtpSender.track.id;e.rtpSender._initialTrackId=a;var c="msid:"+(s?s.id:"-")+" "+a+"\r\n";o+="a="+c,o+="a=ssrc:"+e.sendEncodingParameters[0].ssrc+" "+c,e.sendEncodingParameters[0].rtx&&(o+="a=ssrc:"+e.sendEncodingParameters[0].rtx.ssrc+" "+c,o+="a=ssrc-group:FID "+e.sendEncodingParameters[0].ssrc+" "+e.sendEncodingParameters[0].rtx.ssrc+"\r\n")}return o+="a=ssrc:"+e.sendEncodingParameters[0].ssrc+" cname:"+i.localCName+"\r\n",e.rtpSender&&e.sendEncodingParameters[0].rtx&&(o+="a=ssrc:"+e.sendEncodingParameters[0].rtx.ssrc+" cname:"+i.localCName+"\r\n"),o}function getCommonCapabilities(e,t){var n={codecs:[],headerExtensions:[],fecMechanisms:[]},i=function(e,t){e=parseInt(e,10);for(var n=0;n<t.length;n++)if(t[n].payloadType===e||t[n].preferredPayloadType===e)return t[n]},s=function(e,t,n,s){var r=i(e.parameters.apt,n),o=i(t.parameters.apt,s);return r&&o&&r.name.toLowerCase()===o.name.toLowerCase()};return e.codecs.forEach(function(i){for(var r=0;r<t.codecs.length;r++){var o=t.codecs[r];if(i.name.toLowerCase()===o.name.toLowerCase()&&i.clockRate===o.clockRate){if("rtx"===i.name.toLowerCase()&&i.parameters&&o.parameters.apt&&!s(i,o,e.codecs,t.codecs))continue;(o=JSON.parse(JSON.stringify(o))).numChannels=Math.min(i.numChannels,o.numChannels),n.codecs.push(o),o.rtcpFeedback=o.rtcpFeedback.filter(function(e){for(var t=0;t<i.rtcpFeedback.length;t++)if(i.rtcpFeedback[t].type===e.type&&i.rtcpFeedback[t].parameter===e.parameter)return!0;return!1});break}}}),e.headerExtensions.forEach(function(e){for(var i=0;i<t.headerExtensions.length;i++){var s=t.headerExtensions[i];if(e.uri===s.uri){n.headerExtensions.push(s);break}}}),n}function isActionAllowedInSignalingState(e,t,n){return-1!=={offer:{setLocalDescription:["stable","have-local-offer"],setRemoteDescription:["stable","have-remote-offer"]},answer:{setLocalDescription:["have-remote-offer","have-local-pranswer"],setRemoteDescription:["have-local-offer","have-remote-pranswer"]}}[t][e].indexOf(n)}function maybeAddCandidate(e,t){var n=e.getRemoteCandidates().find(function(e){return t.foundation===e.foundation&&t.ip===e.ip&&t.port===e.port&&t.priority===e.priority&&t.protocol===e.protocol&&t.type===e.type});return n||e.addRemoteCandidate(t),!n}function makeError(e,t){var n=new Error(t);return n.name=e,n.code={NotSupportedError:9,InvalidStateError:11,InvalidAccessError:15,TypeError:void 0,OperationError:void 0}[e],n}t.exports=function(e,t){function addTrackToStreamAndFireEvent(t,n){n.addTrack(t),n.dispatchEvent(new e.MediaStreamTrackEvent("addtrack",{track:t}))}function fireAddTrack(t,n,i,s){var r=new Event("track");r.track=n,r.receiver=i,r.transceiver={receiver:i},r.streams=s,e.setTimeout(function(){t._dispatchEvent("track",r)})}var n=function(n){var s=this,r=document.createDocumentFragment();if(["addEventListener","removeEventListener","dispatchEvent"].forEach(function(e){s[e]=r[e].bind(r)}),this.canTrickleIceCandidates=null,this.needNegotiation=!1,this.localStreams=[],this.remoteStreams=[],this._localDescription=null,this._remoteDescription=null,this.signalingState="stable",this.iceConnectionState="new",this.connectionState="new",this.iceGatheringState="new",n=JSON.parse(JSON.stringify(n||{})),this.usingBundle="max-bundle"===n.bundlePolicy,"negotiate"===n.rtcpMuxPolicy)throw makeError("NotSupportedError","rtcpMuxPolicy 'negotiate' is not supported");switch(n.rtcpMuxPolicy||(n.rtcpMuxPolicy="require"),n.iceTransportPolicy){case"all":case"relay":break;default:n.iceTransportPolicy="all"}switch(n.bundlePolicy){case"balanced":case"max-compat":case"max-bundle":break;default:n.bundlePolicy="balanced"}if(n.iceServers=function filterIceServers(e,t){var n=!1;return(e=JSON.parse(JSON.stringify(e))).filter(function(e){if(e&&(e.urls||e.url)){var i=e.urls||e.url;e.url&&!e.urls&&console.warn("RTCIceServer.url is deprecated! Use urls instead.");var s="string"==typeof i;return s&&(i=[i]),i=i.filter(function(e){return 0!==e.indexOf("turn:")||-1===e.indexOf("transport=udp")||-1!==e.indexOf("turn:[")||n?0===e.indexOf("stun:")&&t>=14393&&-1===e.indexOf("?transport=udp"):(n=!0,!0)}),delete e.url,e.urls=s?i[0]:i,!!i.length}})}(n.iceServers||[],t),this._iceGatherers=[],n.iceCandidatePoolSize)for(var o=n.iceCandidatePoolSize;o>0;o--)this._iceGatherers.push(new e.RTCIceGatherer({iceServers:n.iceServers,gatherPolicy:n.iceTransportPolicy}));else n.iceCandidatePoolSize=0;this._config=n,this.transceivers=[],this._sdpSessionId=i.generateSessionId(),this._sdpSessionVersion=0,this._dtlsRole=void 0,this._isClosed=!1};Object.defineProperty(n.prototype,"localDescription",{configurable:!0,get:function(){return this._localDescription}}),Object.defineProperty(n.prototype,"remoteDescription",{configurable:!0,get:function(){return this._remoteDescription}}),n.prototype.onicecandidate=null,n.prototype.onaddstream=null,n.prototype.ontrack=null,n.prototype.onremovestream=null,n.prototype.onsignalingstatechange=null,n.prototype.oniceconnectionstatechange=null,n.prototype.onconnectionstatechange=null,n.prototype.onicegatheringstatechange=null,n.prototype.onnegotiationneeded=null,n.prototype.ondatachannel=null,n.prototype._dispatchEvent=function(e,t){this._isClosed||(this.dispatchEvent(t),"function"==typeof this["on"+e]&&this["on"+e](t))},n.prototype._emitGatheringStateChange=function(){var e=new Event("icegatheringstatechange");this._dispatchEvent("icegatheringstatechange",e)},n.prototype.getConfiguration=function(){return this._config},n.prototype.getLocalStreams=function(){return this.localStreams},n.prototype.getRemoteStreams=function(){return this.remoteStreams},n.prototype._createTransceiver=function(e,t){var n=this.transceivers.length>0,i={track:null,iceGatherer:null,iceTransport:null,dtlsTransport:null,localCapabilities:null,remoteCapabilities:null,rtpSender:null,rtpReceiver:null,kind:e,mid:null,sendEncodingParameters:null,recvEncodingParameters:null,stream:null,associatedRemoteMediaStreams:[],wantReceive:!0};if(this.usingBundle&&n)i.iceTransport=this.transceivers[0].iceTransport,i.dtlsTransport=this.transceivers[0].dtlsTransport;else{var s=this._createIceAndDtlsTransports();i.iceTransport=s.iceTransport,i.dtlsTransport=s.dtlsTransport}return t||this.transceivers.push(i),i},n.prototype.addTrack=function(t,n){if(this._isClosed)throw makeError("InvalidStateError","Attempted to call addTrack on a closed peerconnection.");var i;if(this.transceivers.find(function(e){return e.track===t}))throw makeError("InvalidAccessError","Track already exists.");for(var s=0;s<this.transceivers.length;s++)this.transceivers[s].track||this.transceivers[s].kind!==t.kind||(i=this.transceivers[s]);return i||(i=this._createTransceiver(t.kind)),this._maybeFireNegotiationNeeded(),-1===this.localStreams.indexOf(n)&&this.localStreams.push(n),i.track=t,i.stream=n,i.rtpSender=new e.RTCRtpSender(t,i.dtlsTransport),i.rtpSender},n.prototype.addStream=function(e){var n=this;if(t>=15025)e.getTracks().forEach(function(t){n.addTrack(t,e)});else{var i=e.clone();e.getTracks().forEach(function(e,t){var n=i.getTracks()[t];e.addEventListener("enabled",function(e){n.enabled=e.enabled})}),i.getTracks().forEach(function(e){n.addTrack(e,i)})}},n.prototype.removeTrack=function(t){if(this._isClosed)throw makeError("InvalidStateError","Attempted to call removeTrack on a closed peerconnection.");if(!(t instanceof e.RTCRtpSender))throw new TypeError("Argument 1 of RTCPeerConnection.removeTrack does not implement interface RTCRtpSender.");var n=this.transceivers.find(function(e){return e.rtpSender===t});if(!n)throw makeError("InvalidAccessError","Sender was not created by this connection.");var i=n.stream;n.rtpSender.stop(),n.rtpSender=null,n.track=null,n.stream=null,-1===this.transceivers.map(function(e){return e.stream}).indexOf(i)&&this.localStreams.indexOf(i)>-1&&this.localStreams.splice(this.localStreams.indexOf(i),1),this._maybeFireNegotiationNeeded()},n.prototype.removeStream=function(e){var t=this;e.getTracks().forEach(function(e){var n=t.getSenders().find(function(t){return t.track===e});n&&t.removeTrack(n)})},n.prototype.getSenders=function(){return this.transceivers.filter(function(e){return!!e.rtpSender}).map(function(e){return e.rtpSender})},n.prototype.getReceivers=function(){return this.transceivers.filter(function(e){return!!e.rtpReceiver}).map(function(e){return e.rtpReceiver})},n.prototype._createIceGatherer=function(t,n){var i=this;if(n&&t>0)return this.transceivers[0].iceGatherer;if(this._iceGatherers.length)return this._iceGatherers.shift();var s=new e.RTCIceGatherer({iceServers:this._config.iceServers,gatherPolicy:this._config.iceTransportPolicy});return Object.defineProperty(s,"state",{value:"new",writable:!0}),this.transceivers[t].bufferedCandidateEvents=[],this.transceivers[t].bufferCandidates=function(e){var n=!e.candidate||0===Object.keys(e.candidate).length;s.state=n?"completed":"gathering",null!==i.transceivers[t].bufferedCandidateEvents&&i.transceivers[t].bufferedCandidateEvents.push(e)},s.addEventListener("localcandidate",this.transceivers[t].bufferCandidates),s},n.prototype._gather=function(t,n){var s=this,r=this.transceivers[n].iceGatherer;if(!r.onlocalcandidate){var o=this.transceivers[n].bufferedCandidateEvents;this.transceivers[n].bufferedCandidateEvents=null,r.removeEventListener("localcandidate",this.transceivers[n].bufferCandidates),r.onlocalcandidate=function(e){if(!(s.usingBundle&&n>0)){var o=new Event("icecandidate");o.candidate={sdpMid:t,sdpMLineIndex:n};var a=e.candidate,c=!a||0===Object.keys(a).length;if(c)"new"!==r.state&&"gathering"!==r.state||(r.state="completed");else{"new"===r.state&&(r.state="gathering"),a.component=1,a.ufrag=r.getLocalParameters().usernameFragment;var d=i.writeCandidate(a);o.candidate=Object.assign(o.candidate,i.parseCandidate(d)),o.candidate.candidate=d,o.candidate.toJSON=function(){return{candidate:o.candidate.candidate,sdpMid:o.candidate.sdpMid,sdpMLineIndex:o.candidate.sdpMLineIndex,usernameFragment:o.candidate.usernameFragment}}}var u=i.getMediaSections(s._localDescription.sdp);u[o.candidate.sdpMLineIndex]+=c?"a=end-of-candidates\r\n":"a="+o.candidate.candidate+"\r\n",s._localDescription.sdp=i.getDescription(s._localDescription.sdp)+u.join("");var h=s.transceivers.every(function(e){return e.iceGatherer&&"completed"===e.iceGatherer.state});"gathering"!==s.iceGatheringState&&(s.iceGatheringState="gathering",s._emitGatheringStateChange()),c||s._dispatchEvent("icecandidate",o),h&&(s._dispatchEvent("icecandidate",new Event("icecandidate")),s.iceGatheringState="complete",s._emitGatheringStateChange())}},e.setTimeout(function(){o.forEach(function(e){r.onlocalcandidate(e)})},0)}},n.prototype._createIceAndDtlsTransports=function(){var t=this,n=new e.RTCIceTransport(null);n.onicestatechange=function(){t._updateIceConnectionState(),t._updateConnectionState()};var i=new e.RTCDtlsTransport(n);return i.ondtlsstatechange=function(){t._updateConnectionState()},i.onerror=function(){Object.defineProperty(i,"state",{value:"failed",writable:!0}),t._updateConnectionState()},{iceTransport:n,dtlsTransport:i}},n.prototype._disposeIceAndDtlsTransports=function(e){var t=this.transceivers[e].iceGatherer;t&&(delete t.onlocalcandidate,delete this.transceivers[e].iceGatherer);var n=this.transceivers[e].iceTransport;n&&(delete n.onicestatechange,delete this.transceivers[e].iceTransport);var i=this.transceivers[e].dtlsTransport;i&&(delete i.ondtlsstatechange,delete i.onerror,delete this.transceivers[e].dtlsTransport)},n.prototype._transceive=function(e,n,s){var r=getCommonCapabilities(e.localCapabilities,e.remoteCapabilities);n&&e.rtpSender&&(r.encodings=e.sendEncodingParameters,r.rtcp={cname:i.localCName,compound:e.rtcpParameters.compound},e.recvEncodingParameters.length&&(r.rtcp.ssrc=e.recvEncodingParameters[0].ssrc),e.rtpSender.send(r)),s&&e.rtpReceiver&&r.codecs.length>0&&("video"===e.kind&&e.recvEncodingParameters&&t<15019&&e.recvEncodingParameters.forEach(function(e){delete e.rtx}),e.recvEncodingParameters.length?r.encodings=e.recvEncodingParameters:r.encodings=[{}],r.rtcp={compound:e.rtcpParameters.compound},e.rtcpParameters.cname&&(r.rtcp.cname=e.rtcpParameters.cname),e.sendEncodingParameters.length&&(r.rtcp.ssrc=e.sendEncodingParameters[0].ssrc),e.rtpReceiver.receive(r))},n.prototype.setLocalDescription=function(e){var t,n,s=this;if(-1===["offer","answer"].indexOf(e.type))return Promise.reject(makeError("TypeError",'Unsupported type "'+e.type+'"'));if(!isActionAllowedInSignalingState("setLocalDescription",e.type,s.signalingState)||s._isClosed)return Promise.reject(makeError("InvalidStateError","Can not set local "+e.type+" in state "+s.signalingState));if("offer"===e.type)t=i.splitSections(e.sdp),n=t.shift(),t.forEach(function(e,t){var n=i.parseRtpParameters(e);s.transceivers[t].localCapabilities=n}),s.transceivers.forEach(function(e,t){s._gather(e.mid,t)});else if("answer"===e.type){t=i.splitSections(s._remoteDescription.sdp),n=t.shift();var r=i.matchPrefix(n,"a=ice-lite").length>0;t.forEach(function(e,t){var o=s.transceivers[t],a=o.iceGatherer,c=o.iceTransport,d=o.dtlsTransport,u=o.localCapabilities,h=o.remoteCapabilities;if(!(i.isRejected(e)&&0===i.matchPrefix(e,"a=bundle-only").length)&&!o.rejected){var l=i.getIceParameters(e,n),p=i.getDtlsParameters(e,n);r&&(p.role="server"),s.usingBundle&&0!==t||(s._gather(o.mid,t),"new"===c.state&&c.start(a,l,r?"controlling":"controlled"),"new"===d.state&&d.start(p));var f=getCommonCapabilities(u,h);s._transceive(o,f.codecs.length>0,!1)}})}return s._localDescription={type:e.type,sdp:e.sdp},"offer"===e.type?s._updateSignalingState("have-local-offer"):s._updateSignalingState("stable"),Promise.resolve()},n.prototype.setRemoteDescription=function(n){var s=this;if(-1===["offer","answer"].indexOf(n.type))return Promise.reject(makeError("TypeError",'Unsupported type "'+n.type+'"'));if(!isActionAllowedInSignalingState("setRemoteDescription",n.type,s.signalingState)||s._isClosed)return Promise.reject(makeError("InvalidStateError","Can not set remote "+n.type+" in state "+s.signalingState));var r={};s.remoteStreams.forEach(function(e){r[e.id]=e});var o=[],a=i.splitSections(n.sdp),c=a.shift(),d=i.matchPrefix(c,"a=ice-lite").length>0,u=i.matchPrefix(c,"a=group:BUNDLE ").length>0;s.usingBundle=u;var h=i.matchPrefix(c,"a=ice-options:")[0];return s.canTrickleIceCandidates=!!h&&h.substr(14).split(" ").indexOf("trickle")>=0,a.forEach(function(a,h){var l=i.splitLines(a),p=i.getKind(a),f=i.isRejected(a)&&0===i.matchPrefix(a,"a=bundle-only").length,m=l[0].substr(2).split(" ")[2],g=i.getDirection(a,c),v=i.parseMsid(a),b=i.getMid(a)||i.generateIdentifier();if(f||"application"===p&&("DTLS/SCTP"===m||"UDP/DTLS/SCTP"===m))s.transceivers[h]={mid:b,kind:p,protocol:m,rejected:!0};else{var y,w,S,C,k,P,x,T,R;!f&&s.transceivers[h]&&s.transceivers[h].rejected&&(s.transceivers[h]=s._createTransceiver(p,!0));var E,I,M=i.parseRtpParameters(a);f||(E=i.getIceParameters(a,c),(I=i.getDtlsParameters(a,c)).role="client"),x=i.parseRtpEncodingParameters(a);var _=i.parseRtcpParameters(a),D=i.matchPrefix(a,"a=end-of-candidates",c).length>0,O=i.matchPrefix(a,"a=candidate:").map(function(e){return i.parseCandidate(e)}).filter(function(e){return 1===e.component});if(("offer"===n.type||"answer"===n.type)&&!f&&u&&h>0&&s.transceivers[h]&&(s._disposeIceAndDtlsTransports(h),s.transceivers[h].iceGatherer=s.transceivers[0].iceGatherer,s.transceivers[h].iceTransport=s.transceivers[0].iceTransport,s.transceivers[h].dtlsTransport=s.transceivers[0].dtlsTransport,s.transceivers[h].rtpSender&&s.transceivers[h].rtpSender.setTransport(s.transceivers[0].dtlsTransport),s.transceivers[h].rtpReceiver&&s.transceivers[h].rtpReceiver.setTransport(s.transceivers[0].dtlsTransport)),"offer"!==n.type||f)"answer"!==n.type||f||(w=(y=s.transceivers[h]).iceGatherer,S=y.iceTransport,C=y.dtlsTransport,k=y.rtpReceiver,P=y.sendEncodingParameters,T=y.localCapabilities,s.transceivers[h].recvEncodingParameters=x,s.transceivers[h].remoteCapabilities=M,s.transceivers[h].rtcpParameters=_,O.length&&"new"===S.state&&(!d&&!D||u&&0!==h?O.forEach(function(e){maybeAddCandidate(y.iceTransport,e)}):S.setRemoteCandidates(O)),u&&0!==h||("new"===S.state&&S.start(w,E,"controlling"),"new"===C.state&&C.start(I)),s._transceive(y,"sendrecv"===g||"recvonly"===g,"sendrecv"===g||"sendonly"===g),!k||"sendrecv"!==g&&"sendonly"!==g?delete y.rtpReceiver:(R=k.track,v?(r[v.stream]||(r[v.stream]=new e.MediaStream),addTrackToStreamAndFireEvent(R,r[v.stream]),o.push([R,k,r[v.stream]])):(r.default||(r.default=new e.MediaStream),addTrackToStreamAndFireEvent(R,r.default),o.push([R,k,r.default]))));else{(y=s.transceivers[h]||s._createTransceiver(p)).mid=b,y.iceGatherer||(y.iceGatherer=s._createIceGatherer(h,u)),O.length&&"new"===y.iceTransport.state&&(!D||u&&0!==h?O.forEach(function(e){maybeAddCandidate(y.iceTransport,e)}):y.iceTransport.setRemoteCandidates(O)),T=e.RTCRtpReceiver.getCapabilities(p),t<15019&&(T.codecs=T.codecs.filter(function(e){return"rtx"!==e.name})),P=y.sendEncodingParameters||[{ssrc:1001*(2*h+2)}];var L,A=!1;if("sendrecv"===g||"sendonly"===g){if(A=!y.rtpReceiver,k=y.rtpReceiver||new e.RTCRtpReceiver(y.dtlsTransport,p),A)R=k.track,v&&"-"===v.stream||(v?(r[v.stream]||(r[v.stream]=new e.MediaStream,Object.defineProperty(r[v.stream],"id",{get:function(){return v.stream}})),Object.defineProperty(R,"id",{get:function(){return v.track}}),L=r[v.stream]):(r.default||(r.default=new e.MediaStream),L=r.default)),L&&(addTrackToStreamAndFireEvent(R,L),y.associatedRemoteMediaStreams.push(L)),o.push([R,k,L])}else y.rtpReceiver&&y.rtpReceiver.track&&(y.associatedRemoteMediaStreams.forEach(function(t){var n=t.getTracks().find(function(e){return e.id===y.rtpReceiver.track.id});n&&function removeTrackFromStreamAndFireEvent(t,n){n.removeTrack(t),n.dispatchEvent(new e.MediaStreamTrackEvent("removetrack",{track:t}))}(n,t)}),y.associatedRemoteMediaStreams=[]);y.localCapabilities=T,y.remoteCapabilities=M,y.rtpReceiver=k,y.rtcpParameters=_,y.sendEncodingParameters=P,y.recvEncodingParameters=x,s._transceive(s.transceivers[h],!1,A)}}}),void 0===s._dtlsRole&&(s._dtlsRole="offer"===n.type?"active":"passive"),s._remoteDescription={type:n.type,sdp:n.sdp},"offer"===n.type?s._updateSignalingState("have-remote-offer"):s._updateSignalingState("stable"),Object.keys(r).forEach(function(t){var n=r[t];if(n.getTracks().length){if(-1===s.remoteStreams.indexOf(n)){s.remoteStreams.push(n);var i=new Event("addstream");i.stream=n,e.setTimeout(function(){s._dispatchEvent("addstream",i)})}o.forEach(function(e){var t=e[0],i=e[1];n.id===e[2].id&&fireAddTrack(s,t,i,[n])})}}),o.forEach(function(e){e[2]||fireAddTrack(s,e[0],e[1],[])}),e.setTimeout(function(){s&&s.transceivers&&s.transceivers.forEach(function(e){e.iceTransport&&"new"===e.iceTransport.state&&e.iceTransport.getRemoteCandidates().length>0&&(console.warn("Timeout for addRemoteCandidate. Consider sending an end-of-candidates notification"),e.iceTransport.addRemoteCandidate({}))})},4e3),Promise.resolve()},n.prototype.close=function(){this.transceivers.forEach(function(e){e.iceTransport&&e.iceTransport.stop(),e.dtlsTransport&&e.dtlsTransport.stop(),e.rtpSender&&e.rtpSender.stop(),e.rtpReceiver&&e.rtpReceiver.stop()}),this._isClosed=!0,this._updateSignalingState("closed")},n.prototype._updateSignalingState=function(e){this.signalingState=e;var t=new Event("signalingstatechange");this._dispatchEvent("signalingstatechange",t)},n.prototype._maybeFireNegotiationNeeded=function(){var t=this;"stable"===this.signalingState&&!0!==this.needNegotiation&&(this.needNegotiation=!0,e.setTimeout(function(){if(t.needNegotiation){t.needNegotiation=!1;var e=new Event("negotiationneeded");t._dispatchEvent("negotiationneeded",e)}},0))},n.prototype._updateIceConnectionState=function(){var e,t={new:0,closed:0,checking:0,connected:0,completed:0,disconnected:0,failed:0};if(this.transceivers.forEach(function(e){t[e.iceTransport.state]++}),e="new",t.failed>0?e="failed":t.checking>0?e="checking":t.disconnected>0?e="disconnected":t.new>0?e="new":t.connected>0?e="connected":t.completed>0&&(e="completed"),e!==this.iceConnectionState){this.iceConnectionState=e;var n=new Event("iceconnectionstatechange");this._dispatchEvent("iceconnectionstatechange",n)}},n.prototype._updateConnectionState=function(){var e,t={new:0,closed:0,connecting:0,connected:0,completed:0,disconnected:0,failed:0};if(this.transceivers.forEach(function(e){t[e.iceTransport.state]++,t[e.dtlsTransport.state]++}),t.connected+=t.completed,e="new",t.failed>0?e="failed":t.connecting>0?e="connecting":t.disconnected>0?e="disconnected":t.new>0?e="new":t.connected>0&&(e="connected"),e!==this.connectionState){this.connectionState=e;var n=new Event("connectionstatechange");this._dispatchEvent("connectionstatechange",n)}},n.prototype.createOffer=function(){var n=this;if(n._isClosed)return Promise.reject(makeError("InvalidStateError","Can not call createOffer after close"));var s=n.transceivers.filter(function(e){return"audio"===e.kind}).length,r=n.transceivers.filter(function(e){return"video"===e.kind}).length,o=arguments[0];if(o){if(o.mandatory||o.optional)throw new TypeError("Legacy mandatory/optional constraints not supported.");void 0!==o.offerToReceiveAudio&&(s=!0===o.offerToReceiveAudio?1:!1===o.offerToReceiveAudio?0:o.offerToReceiveAudio),void 0!==o.offerToReceiveVideo&&(r=!0===o.offerToReceiveVideo?1:!1===o.offerToReceiveVideo?0:o.offerToReceiveVideo)}for(n.transceivers.forEach(function(e){"audio"===e.kind?--s<0&&(e.wantReceive=!1):"video"===e.kind&&--r<0&&(e.wantReceive=!1)});s>0||r>0;)s>0&&(n._createTransceiver("audio"),s--),r>0&&(n._createTransceiver("video"),r--);var a=i.writeSessionBoilerplate(n._sdpSessionId,n._sdpSessionVersion++);n.transceivers.forEach(function(s,r){var o=s.track,a=s.kind,c=s.mid||i.generateIdentifier();s.mid=c,s.iceGatherer||(s.iceGatherer=n._createIceGatherer(r,n.usingBundle));var d=e.RTCRtpSender.getCapabilities(a);t<15019&&(d.codecs=d.codecs.filter(function(e){return"rtx"!==e.name})),d.codecs.forEach(function(e){"H264"===e.name&&void 0===e.parameters["level-asymmetry-allowed"]&&(e.parameters["level-asymmetry-allowed"]="1"),s.remoteCapabilities&&s.remoteCapabilities.codecs&&s.remoteCapabilities.codecs.forEach(function(t){e.name.toLowerCase()===t.name.toLowerCase()&&e.clockRate===t.clockRate&&(e.preferredPayloadType=t.payloadType)})}),d.headerExtensions.forEach(function(e){(s.remoteCapabilities&&s.remoteCapabilities.headerExtensions||[]).forEach(function(t){e.uri===t.uri&&(e.id=t.id)})});var u=s.sendEncodingParameters||[{ssrc:1001*(2*r+1)}];o&&t>=15019&&"video"===a&&!u[0].rtx&&(u[0].rtx={ssrc:u[0].ssrc+1}),s.wantReceive&&(s.rtpReceiver=new e.RTCRtpReceiver(s.dtlsTransport,a)),s.localCapabilities=d,s.sendEncodingParameters=u}),"max-compat"!==n._config.bundlePolicy&&(a+="a=group:BUNDLE "+n.transceivers.map(function(e){return e.mid}).join(" ")+"\r\n"),a+="a=ice-options:trickle\r\n",n.transceivers.forEach(function(e,t){a+=writeMediaSection(e,e.localCapabilities,"offer",e.stream,n._dtlsRole),a+="a=rtcp-rsize\r\n",!e.iceGatherer||"new"===n.iceGatheringState||0!==t&&n.usingBundle||(e.iceGatherer.getLocalCandidates().forEach(function(e){e.component=1,a+="a="+i.writeCandidate(e)+"\r\n"}),"completed"===e.iceGatherer.state&&(a+="a=end-of-candidates\r\n"))});var c=new e.RTCSessionDescription({type:"offer",sdp:a});return Promise.resolve(c)},n.prototype.createAnswer=function(){var n=this;if(n._isClosed)return Promise.reject(makeError("InvalidStateError","Can not call createAnswer after close"));if("have-remote-offer"!==n.signalingState&&"have-local-pranswer"!==n.signalingState)return Promise.reject(makeError("InvalidStateError","Can not call createAnswer in signalingState "+n.signalingState));var s=i.writeSessionBoilerplate(n._sdpSessionId,n._sdpSessionVersion++);n.usingBundle&&(s+="a=group:BUNDLE "+n.transceivers.map(function(e){return e.mid}).join(" ")+"\r\n");var r=i.getMediaSections(n._remoteDescription.sdp).length;n.transceivers.forEach(function(e,i){if(!(i+1>r)){if(e.rejected)return"application"===e.kind?"DTLS/SCTP"===e.protocol?s+="m=application 0 DTLS/SCTP 5000\r\n":s+="m=application 0 "+e.protocol+" webrtc-datachannel\r\n":"audio"===e.kind?s+="m=audio 0 UDP/TLS/RTP/SAVPF 0\r\na=rtpmap:0 PCMU/8000\r\n":"video"===e.kind&&(s+="m=video 0 UDP/TLS/RTP/SAVPF 120\r\na=rtpmap:120 VP8/90000\r\n"),void(s+="c=IN IP4 0.0.0.0\r\na=inactive\r\na=mid:"+e.mid+"\r\n");var o;if(e.stream)"audio"===e.kind?o=e.stream.getAudioTracks()[0]:"video"===e.kind&&(o=e.stream.getVideoTracks()[0]),o&&t>=15019&&"video"===e.kind&&!e.sendEncodingParameters[0].rtx&&(e.sendEncodingParameters[0].rtx={ssrc:e.sendEncodingParameters[0].ssrc+1});var a=getCommonCapabilities(e.localCapabilities,e.remoteCapabilities);!a.codecs.filter(function(e){return"rtx"===e.name.toLowerCase()}).length&&e.sendEncodingParameters[0].rtx&&delete e.sendEncodingParameters[0].rtx,s+=writeMediaSection(e,a,"answer",e.stream,n._dtlsRole),e.rtcpParameters&&e.rtcpParameters.reducedSize&&(s+="a=rtcp-rsize\r\n")}});var o=new e.RTCSessionDescription({type:"answer",sdp:s});return Promise.resolve(o)},n.prototype.addIceCandidate=function(e){var t,n=this;return e&&void 0===e.sdpMLineIndex&&!e.sdpMid?Promise.reject(new TypeError("sdpMLineIndex or sdpMid required")):new Promise(function(s,r){if(!n._remoteDescription)return r(makeError("InvalidStateError","Can not add ICE candidate without a remote description"));if(e&&""!==e.candidate){var o=e.sdpMLineIndex;if(e.sdpMid)for(var a=0;a<n.transceivers.length;a++)if(n.transceivers[a].mid===e.sdpMid){o=a;break}var c=n.transceivers[o];if(!c)return r(makeError("OperationError","Can not add ICE candidate"));if(c.rejected)return s();var d=Object.keys(e.candidate).length>0?i.parseCandidate(e.candidate):{};if("tcp"===d.protocol&&(0===d.port||9===d.port))return s();if(d.component&&1!==d.component)return s();if((0===o||o>0&&c.iceTransport!==n.transceivers[0].iceTransport)&&!maybeAddCandidate(c.iceTransport,d))return r(makeError("OperationError","Can not add ICE candidate"));var u=e.candidate.trim();0===u.indexOf("a=")&&(u=u.substr(2)),(t=i.getMediaSections(n._remoteDescription.sdp))[o]+="a="+(d.type?u:"end-of-candidates")+"\r\n",n._remoteDescription.sdp=i.getDescription(n._remoteDescription.sdp)+t.join("")}else for(var h=0;h<n.transceivers.length&&(n.transceivers[h].rejected||(n.transceivers[h].iceTransport.addRemoteCandidate({}),(t=i.getMediaSections(n._remoteDescription.sdp))[h]+="a=end-of-candidates\r\n",n._remoteDescription.sdp=i.getDescription(n._remoteDescription.sdp)+t.join(""),!n.usingBundle));h++);s()})},n.prototype.getStats=function(t){if(t&&t instanceof e.MediaStreamTrack){var n=null;if(this.transceivers.forEach(function(e){e.rtpSender&&e.rtpSender.track===t?n=e.rtpSender:e.rtpReceiver&&e.rtpReceiver.track===t&&(n=e.rtpReceiver)}),!n)throw makeError("InvalidAccessError","Invalid selector.");return n.getStats()}var i=[];return this.transceivers.forEach(function(e){["rtpSender","rtpReceiver","iceGatherer","iceTransport","dtlsTransport"].forEach(function(t){e[t]&&i.push(e[t].getStats())})}),Promise.all(i).then(function(e){var t=new Map;return e.forEach(function(e){e.forEach(function(e){t.set(e.id,e)})}),t})};["RTCRtpSender","RTCRtpReceiver","RTCIceGatherer","RTCIceTransport","RTCDtlsTransport"].forEach(function(t){var n=e[t];if(n&&n.prototype&&n.prototype.getStats){var i=n.prototype.getStats;n.prototype.getStats=function(){return i.apply(this).then(function(e){var t=new Map;return Object.keys(e).forEach(function(n){e[n].type=function fixStatsType(e){return{inboundrtp:"inbound-rtp",outboundrtp:"outbound-rtp",candidatepair:"candidate-pair",localcandidate:"local-candidate",remotecandidate:"remote-candidate"}[e.type]||e.type}(e[n]),t.set(n,e[n])}),t})}}});var s=["createOffer","createAnswer"];return s.forEach(function(e){var t=n.prototype[e];n.prototype[e]=function(){var e=arguments;return"function"==typeof e[0]||"function"==typeof e[1]?t.apply(this,[arguments[2]]).then(function(t){"function"==typeof e[0]&&e[0].apply(null,[t])},function(t){"function"==typeof e[1]&&e[1].apply(null,[t])}):t.apply(this,arguments)}}),(s=["setLocalDescription","setRemoteDescription","addIceCandidate"]).forEach(function(e){var t=n.prototype[e];n.prototype[e]=function(){var e=arguments;return"function"==typeof e[1]||"function"==typeof e[2]?t.apply(this,arguments).then(function(){"function"==typeof e[1]&&e[1].apply(null)},function(t){"function"==typeof e[2]&&e[2].apply(null,[t])}):t.apply(this,arguments)}}),["getStats"].forEach(function(e){var t=n.prototype[e];n.prototype[e]=function(){var e=arguments;return"function"==typeof e[1]?t.apply(this,arguments).then(function(){"function"==typeof e[1]&&e[1].apply(null)}):t.apply(this,arguments)}}),n}},{sdp:2}],2:[function(e,t,n){var i={generateIdentifier:function(){return Math.random().toString(36).substr(2,10)}};i.localCName=i.generateIdentifier(),i.splitLines=function(e){return e.trim().split("\n").map(function(e){return e.trim()})},i.splitSections=function(e){return e.split("\nm=").map(function(e,t){return(t>0?"m="+e:e).trim()+"\r\n"})},i.getDescription=function(e){var t=i.splitSections(e);return t&&t[0]},i.getMediaSections=function(e){var t=i.splitSections(e);return t.shift(),t},i.matchPrefix=function(e,t){return i.splitLines(e).filter(function(e){return 0===e.indexOf(t)})},i.parseCandidate=function(e){for(var t,n={foundation:(t=0===e.indexOf("a=candidate:")?e.substring(12).split(" "):e.substring(10).split(" "))[0],component:parseInt(t[1],10),protocol:t[2].toLowerCase(),priority:parseInt(t[3],10),ip:t[4],port:parseInt(t[5],10),type:t[7]},i=8;i<t.length;i+=2)switch(t[i]){case"raddr":n.relatedAddress=t[i+1];break;case"rport":n.relatedPort=parseInt(t[i+1],10);break;case"tcptype":n.tcpType=t[i+1];break;case"ufrag":n.ufrag=t[i+1],n.usernameFragment=t[i+1];break;default:n[t[i]]=t[i+1]}return n},i.writeCandidate=function(e){var t=[];t.push(e.foundation),t.push(e.component),t.push(e.protocol.toUpperCase()),t.push(e.priority),t.push(e.ip),t.push(e.port);var n=e.type;return t.push("typ"),t.push(n),"host"!==n&&e.relatedAddress&&e.relatedPort&&(t.push("raddr"),t.push(e.relatedAddress),t.push("rport"),t.push(e.relatedPort)),e.tcpType&&"tcp"===e.protocol.toLowerCase()&&(t.push("tcptype"),t.push(e.tcpType)),(e.usernameFragment||e.ufrag)&&(t.push("ufrag"),t.push(e.usernameFragment||e.ufrag)),"candidate:"+t.join(" ")},i.parseIceOptions=function(e){return e.substr(14).split(" ")},i.parseRtpMap=function(e){var t=e.substr(9).split(" "),n={payloadType:parseInt(t.shift(),10)};return t=t[0].split("/"),n.name=t[0],n.clockRate=parseInt(t[1],10),n.channels=3===t.length?parseInt(t[2],10):1,n.numChannels=n.channels,n},i.writeRtpMap=function(e){var t=e.payloadType;void 0!==e.preferredPayloadType&&(t=e.preferredPayloadType);var n=e.channels||e.numChannels||1;return"a=rtpmap:"+t+" "+e.name+"/"+e.clockRate+(1!==n?"/"+n:"")+"\r\n"},i.parseExtmap=function(e){var t=e.substr(9).split(" ");return{id:parseInt(t[0],10),direction:t[0].indexOf("/")>0?t[0].split("/")[1]:"sendrecv",uri:t[1]}},i.writeExtmap=function(e){return"a=extmap:"+(e.id||e.preferredId)+(e.direction&&"sendrecv"!==e.direction?"/"+e.direction:"")+" "+e.uri+"\r\n"},i.parseFmtp=function(e){for(var t,n={},i=e.substr(e.indexOf(" ")+1).split(";"),s=0;s<i.length;s++)n[(t=i[s].trim().split("="))[0].trim()]=t[1];return n},i.writeFmtp=function(e){var t="",n=e.payloadType;if(void 0!==e.preferredPayloadType&&(n=e.preferredPayloadType),e.parameters&&Object.keys(e.parameters).length){var i=[];Object.keys(e.parameters).forEach(function(t){e.parameters[t]?i.push(t+"="+e.parameters[t]):i.push(t)}),t+="a=fmtp:"+n+" "+i.join(";")+"\r\n"}return t},i.parseRtcpFb=function(e){var t=e.substr(e.indexOf(" ")+1).split(" ");return{type:t.shift(),parameter:t.join(" ")}},i.writeRtcpFb=function(e){var t="",n=e.payloadType;return void 0!==e.preferredPayloadType&&(n=e.preferredPayloadType),e.rtcpFeedback&&e.rtcpFeedback.length&&e.rtcpFeedback.forEach(function(e){t+="a=rtcp-fb:"+n+" "+e.type+(e.parameter&&e.parameter.length?" "+e.parameter:"")+"\r\n"}),t},i.parseSsrcMedia=function(e){var t=e.indexOf(" "),n={ssrc:parseInt(e.substr(7,t-7),10)},i=e.indexOf(":",t);return i>-1?(n.attribute=e.substr(t+1,i-t-1),n.value=e.substr(i+1)):n.attribute=e.substr(t+1),n},i.getMid=function(e){var t=i.matchPrefix(e,"a=mid:")[0];if(t)return t.substr(6)},i.parseFingerprint=function(e){var t=e.substr(14).split(" ");return{algorithm:t[0].toLowerCase(),value:t[1]}},i.getDtlsParameters=function(e,t){return{role:"auto",fingerprints:i.matchPrefix(e+t,"a=fingerprint:").map(i.parseFingerprint)}},i.writeDtlsParameters=function(e,t){var n="a=setup:"+t+"\r\n";return e.fingerprints.forEach(function(e){n+="a=fingerprint:"+e.algorithm+" "+e.value+"\r\n"}),n},i.getIceParameters=function(e,t){var n=i.splitLines(e);return{usernameFragment:(n=n.concat(i.splitLines(t))).filter(function(e){return 0===e.indexOf("a=ice-ufrag:")})[0].substr(12),password:n.filter(function(e){return 0===e.indexOf("a=ice-pwd:")})[0].substr(10)}},i.writeIceParameters=function(e){return"a=ice-ufrag:"+e.usernameFragment+"\r\na=ice-pwd:"+e.password+"\r\n"},i.parseRtpParameters=function(e){for(var t={codecs:[],headerExtensions:[],fecMechanisms:[],rtcp:[]},n=i.splitLines(e)[0].split(" "),s=3;s<n.length;s++){var r=n[s],o=i.matchPrefix(e,"a=rtpmap:"+r+" ")[0];if(o){var a=i.parseRtpMap(o),c=i.matchPrefix(e,"a=fmtp:"+r+" ");switch(a.parameters=c.length?i.parseFmtp(c[0]):{},a.rtcpFeedback=i.matchPrefix(e,"a=rtcp-fb:"+r+" ").map(i.parseRtcpFb),t.codecs.push(a),a.name.toUpperCase()){case"RED":case"ULPFEC":t.fecMechanisms.push(a.name.toUpperCase())}}}return i.matchPrefix(e,"a=extmap:").forEach(function(e){t.headerExtensions.push(i.parseExtmap(e))}),t},i.writeRtpDescription=function(e,t){var n="";n+="m="+e+" ",n+=t.codecs.length>0?"9":"0",n+=" UDP/TLS/RTP/SAVPF ",n+=t.codecs.map(function(e){return void 0!==e.preferredPayloadType?e.preferredPayloadType:e.payloadType}).join(" ")+"\r\n",n+="c=IN IP4 0.0.0.0\r\n",n+="a=rtcp:9 IN IP4 0.0.0.0\r\n",t.codecs.forEach(function(e){n+=i.writeRtpMap(e),n+=i.writeFmtp(e),n+=i.writeRtcpFb(e)});var s=0;return t.codecs.forEach(function(e){e.maxptime>s&&(s=e.maxptime)}),s>0&&(n+="a=maxptime:"+s+"\r\n"),n+="a=rtcp-mux\r\n",t.headerExtensions&&t.headerExtensions.forEach(function(e){n+=i.writeExtmap(e)}),n},i.parseRtpEncodingParameters=function(e){var t,n=[],s=i.parseRtpParameters(e),r=-1!==s.fecMechanisms.indexOf("RED"),o=-1!==s.fecMechanisms.indexOf("ULPFEC"),a=i.matchPrefix(e,"a=ssrc:").map(function(e){return i.parseSsrcMedia(e)}).filter(function(e){return"cname"===e.attribute}),c=a.length>0&&a[0].ssrc,d=i.matchPrefix(e,"a=ssrc-group:FID").map(function(e){return e.substr(17).split(" ").map(function(e){return parseInt(e,10)})});d.length>0&&d[0].length>1&&d[0][0]===c&&(t=d[0][1]),s.codecs.forEach(function(e){if("RTX"===e.name.toUpperCase()&&e.parameters.apt){var i={ssrc:c,codecPayloadType:parseInt(e.parameters.apt,10)};c&&t&&(i.rtx={ssrc:t}),n.push(i),r&&((i=JSON.parse(JSON.stringify(i))).fec={ssrc:t,mechanism:o?"red+ulpfec":"red"},n.push(i))}}),0===n.length&&c&&n.push({ssrc:c});var u=i.matchPrefix(e,"b=");return u.length&&(u=0===u[0].indexOf("b=TIAS:")?parseInt(u[0].substr(7),10):0===u[0].indexOf("b=AS:")?1e3*parseInt(u[0].substr(5),10)*.95-16e3:void 0,n.forEach(function(e){e.maxBitrate=u})),n},i.parseRtcpParameters=function(e){var t={},n=i.matchPrefix(e,"a=ssrc:").map(function(e){return i.parseSsrcMedia(e)}).filter(function(e){return"cname"===e.attribute})[0];n&&(t.cname=n.value,t.ssrc=n.ssrc);var s=i.matchPrefix(e,"a=rtcp-rsize");t.reducedSize=s.length>0,t.compound=0===s.length;var r=i.matchPrefix(e,"a=rtcp-mux");return t.mux=r.length>0,t},i.parseMsid=function(e){var t,n=i.matchPrefix(e,"a=msid:");if(1===n.length)return{stream:(t=n[0].substr(7).split(" "))[0],track:t[1]};var s=i.matchPrefix(e,"a=ssrc:").map(function(e){return i.parseSsrcMedia(e)}).filter(function(e){return"msid"===e.attribute});return s.length>0?{stream:(t=s[0].value.split(" "))[0],track:t[1]}:void 0},i.generateSessionId=function(){return Math.random().toString().substr(2,21)},i.writeSessionBoilerplate=function(e,t){var n=void 0!==t?t:2;return"v=0\r\no=thisisadapterortc "+(e||i.generateSessionId())+" "+n+" IN IP4 127.0.0.1\r\ns=-\r\nt=0 0\r\n"},i.writeMediaSection=function(e,t,n,s){var r=i.writeRtpDescription(e.kind,t);if(r+=i.writeIceParameters(e.iceGatherer.getLocalParameters()),r+=i.writeDtlsParameters(e.dtlsTransport.getLocalParameters(),"offer"===n?"actpass":"active"),r+="a=mid:"+e.mid+"\r\n",e.direction?r+="a="+e.direction+"\r\n":e.rtpSender&&e.rtpReceiver?r+="a=sendrecv\r\n":e.rtpSender?r+="a=sendonly\r\n":e.rtpReceiver?r+="a=recvonly\r\n":r+="a=inactive\r\n",e.rtpSender){var o="msid:"+s.id+" "+e.rtpSender.track.id+"\r\n";r+="a="+o,r+="a=ssrc:"+e.sendEncodingParameters[0].ssrc+" "+o,e.sendEncodingParameters[0].rtx&&(r+="a=ssrc:"+e.sendEncodingParameters[0].rtx.ssrc+" "+o,r+="a=ssrc-group:FID "+e.sendEncodingParameters[0].ssrc+" "+e.sendEncodingParameters[0].rtx.ssrc+"\r\n")}return r+="a=ssrc:"+e.sendEncodingParameters[0].ssrc+" cname:"+i.localCName+"\r\n",e.rtpSender&&e.sendEncodingParameters[0].rtx&&(r+="a=ssrc:"+e.sendEncodingParameters[0].rtx.ssrc+" cname:"+i.localCName+"\r\n"),r},i.getDirection=function(e,t){for(var n=i.splitLines(e),s=0;s<n.length;s++)switch(n[s]){case"a=sendrecv":case"a=sendonly":case"a=recvonly":case"a=inactive":return n[s].substr(2)}return t?i.getDirection(t):"sendrecv"},i.getKind=function(e){return i.splitLines(e)[0].split(" ")[0].substr(2)},i.isRejected=function(e){return"0"===e.split(" ",2)[1]},i.parseMLine=function(e){var t=i.splitLines(e)[0].substr(2).split(" ");return{kind:t[0],port:parseInt(t[1],10),protocol:t[2],fmt:t.slice(3).join(" ")}},i.parseOLine=function(e){var t=i.matchPrefix(e,"o=")[0].substr(2).split(" ");return{username:t[0],sessionId:t[1],sessionVersion:parseInt(t[2],10),netType:t[3],addressType:t[4],address:t[5]}},"object"==typeof t&&(t.exports=i)},{}],3:[function(e,t,n){(function(n){var i=e("./adapter_factory.js");t.exports=i({window:n.window})}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./adapter_factory.js":4}],4:[function(e,t,n){var i=e("./utils");t.exports=function(t,n){var s=t&&t.window,r={shimChrome:!0,shimFirefox:!0,shimEdge:!0,shimSafari:!0};for(var o in n)hasOwnProperty.call(n,o)&&(r[o]=n[o]);var a=i.log,c=i.detectBrowser(s),d=e("./chrome/chrome_shim")||null,u=e("./edge/edge_shim")||null,h=e("./firefox/firefox_shim")||null,l=e("./safari/safari_shim")||null,p=e("./common_shim")||null,f={browserDetails:c,commonShim:p,extractVersion:i.extractVersion,disableLog:i.disableLog,disableWarnings:i.disableWarnings};switch(c.browser){case"chrome":if(!d||!d.shimPeerConnection||!r.shimChrome)return a("Chrome shim is not included in this adapter release."),f;a("adapter.js shimming chrome."),f.browserShim=d,p.shimCreateObjectURL(s),d.shimGetUserMedia(s),d.shimMediaStream(s),d.shimSourceObject(s),d.shimPeerConnection(s),d.shimOnTrack(s),d.shimAddTrackRemoveTrack(s),d.shimGetSendersWithDtmf(s),d.shimSenderReceiverGetStats(s),d.fixNegotiationNeeded(s),p.shimRTCIceCandidate(s),p.shimMaxMessageSize(s),p.shimSendThrowTypeError(s);break;case"firefox":if(!h||!h.shimPeerConnection||!r.shimFirefox)return a("Firefox shim is not included in this adapter release."),f;a("adapter.js shimming firefox."),f.browserShim=h,p.shimCreateObjectURL(s),h.shimGetUserMedia(s),h.shimSourceObject(s),h.shimPeerConnection(s),h.shimOnTrack(s),h.shimRemoveStream(s),h.shimSenderGetStats(s),h.shimReceiverGetStats(s),h.shimRTCDataChannel(s),p.shimRTCIceCandidate(s),p.shimMaxMessageSize(s),p.shimSendThrowTypeError(s);break;case"edge":if(!u||!u.shimPeerConnection||!r.shimEdge)return a("MS edge shim is not included in this adapter release."),f;a("adapter.js shimming edge."),f.browserShim=u,p.shimCreateObjectURL(s),u.shimGetUserMedia(s),u.shimPeerConnection(s),u.shimReplaceTrack(s),p.shimMaxMessageSize(s),p.shimSendThrowTypeError(s);break;case"safari":if(!l||!r.shimSafari)return a("Safari shim is not included in this adapter release."),f;a("adapter.js shimming safari."),f.browserShim=l,p.shimCreateObjectURL(s),l.shimRTCIceServerUrls(s),l.shimCallbacksAPI(s),l.shimLocalStreamsAPI(s),l.shimRemoteStreamsAPI(s),l.shimTrackEventTransceiver(s),l.shimGetUserMedia(s),l.shimCreateOfferLegacy(s),p.shimRTCIceCandidate(s),p.shimMaxMessageSize(s),p.shimSendThrowTypeError(s);break;default:a("Unsupported browser!")}return f}},{"./chrome/chrome_shim":5,"./common_shim":7,"./edge/edge_shim":8,"./firefox/firefox_shim":11,"./safari/safari_shim":13,"./utils":14}],5:[function(e,t,n){var i=e("../utils.js"),s=i.log;function filterStats(e,t,n){var i=n?"outbound-rtp":"inbound-rtp",s=new Map;if(null===t)return s;var r=[];return e.forEach(function(e){"track"===e.type&&e.trackIdentifier===t.id&&r.push(e)}),r.forEach(function(t){e.forEach(function(n){n.type===i&&n.trackId===t.id&&function walkStats(e,t,n){t&&!n.has(t.id)&&(n.set(t.id,t),Object.keys(t).forEach(function(i){i.endsWith("Id")?walkStats(e,e.get(t[i]),n):i.endsWith("Ids")&&t[i].forEach(function(t){walkStats(e,e.get(t),n)})}))}(e,n,s)})}),s}t.exports={shimGetUserMedia:e("./getusermedia"),shimMediaStream:function(e){e.MediaStream=e.MediaStream||e.webkitMediaStream},shimOnTrack:function(e){if("object"!=typeof e||!e.RTCPeerConnection||"ontrack"in e.RTCPeerConnection.prototype)"RTCRtpTransceiver"in e||i.wrapPeerConnectionEvent(e,"track",function(e){return e.transceiver||(e.transceiver={receiver:e.receiver}),e});else{Object.defineProperty(e.RTCPeerConnection.prototype,"ontrack",{get:function(){return this._ontrack},set:function(e){this._ontrack&&this.removeEventListener("track",this._ontrack),this.addEventListener("track",this._ontrack=e)},enumerable:!0,configurable:!0});var t=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(){var n=this;return n._ontrackpoly||(n._ontrackpoly=function(t){t.stream.addEventListener("addtrack",function(i){var s;s=e.RTCPeerConnection.prototype.getReceivers?n.getReceivers().find(function(e){return e.track&&e.track.id===i.track.id}):{track:i.track};var r=new Event("track");r.track=i.track,r.receiver=s,r.transceiver={receiver:s},r.streams=[t.stream],n.dispatchEvent(r)}),t.stream.getTracks().forEach(function(i){var s;s=e.RTCPeerConnection.prototype.getReceivers?n.getReceivers().find(function(e){return e.track&&e.track.id===i.id}):{track:i};var r=new Event("track");r.track=i,r.receiver=s,r.transceiver={receiver:s},r.streams=[t.stream],n.dispatchEvent(r)})},n.addEventListener("addstream",n._ontrackpoly)),t.apply(n,arguments)}}},shimGetSendersWithDtmf:function(e){if("object"==typeof e&&e.RTCPeerConnection&&!("getSenders"in e.RTCPeerConnection.prototype)&&"createDTMFSender"in e.RTCPeerConnection.prototype){var t=function(e,t){return{track:t,get dtmf(){return void 0===this._dtmf&&("audio"===t.kind?this._dtmf=e.createDTMFSender(t):this._dtmf=null),this._dtmf},_pc:e}};if(!e.RTCPeerConnection.prototype.getSenders){e.RTCPeerConnection.prototype.getSenders=function(){return this._senders=this._senders||[],this._senders.slice()};var n=e.RTCPeerConnection.prototype.addTrack;e.RTCPeerConnection.prototype.addTrack=function(e,i){var s=this,r=n.apply(s,arguments);return r||(r=t(s,e),s._senders.push(r)),r};var i=e.RTCPeerConnection.prototype.removeTrack;e.RTCPeerConnection.prototype.removeTrack=function(e){var t=this;i.apply(t,arguments);var n=t._senders.indexOf(e);-1!==n&&t._senders.splice(n,1)}}var s=e.RTCPeerConnection.prototype.addStream;e.RTCPeerConnection.prototype.addStream=function(e){var n=this;n._senders=n._senders||[],s.apply(n,[e]),e.getTracks().forEach(function(e){n._senders.push(t(n,e))})};var r=e.RTCPeerConnection.prototype.removeStream;e.RTCPeerConnection.prototype.removeStream=function(e){var t=this;t._senders=t._senders||[],r.apply(t,[e]),e.getTracks().forEach(function(e){var n=t._senders.find(function(t){return t.track===e});n&&t._senders.splice(t._senders.indexOf(n),1)})}}else if("object"==typeof e&&e.RTCPeerConnection&&"getSenders"in e.RTCPeerConnection.prototype&&"createDTMFSender"in e.RTCPeerConnection.prototype&&e.RTCRtpSender&&!("dtmf"in e.RTCRtpSender.prototype)){var o=e.RTCPeerConnection.prototype.getSenders;e.RTCPeerConnection.prototype.getSenders=function(){var e=this,t=o.apply(e,[]);return t.forEach(function(t){t._pc=e}),t},Object.defineProperty(e.RTCRtpSender.prototype,"dtmf",{get:function(){return void 0===this._dtmf&&("audio"===this.track.kind?this._dtmf=this._pc.createDTMFSender(this.track):this._dtmf=null),this._dtmf}})}},shimSenderReceiverGetStats:function(e){if("object"==typeof e&&e.RTCPeerConnection&&e.RTCRtpSender&&e.RTCRtpReceiver){if(!("getStats"in e.RTCRtpSender.prototype)){var t=e.RTCPeerConnection.prototype.getSenders;t&&(e.RTCPeerConnection.prototype.getSenders=function(){var e=this,n=t.apply(e,[]);return n.forEach(function(t){t._pc=e}),n});var n=e.RTCPeerConnection.prototype.addTrack;n&&(e.RTCPeerConnection.prototype.addTrack=function(){var e=n.apply(this,arguments);return e._pc=this,e}),e.RTCRtpSender.prototype.getStats=function(){var e=this;return this._pc.getStats().then(function(t){return filterStats(t,e.track,!0)})}}if(!("getStats"in e.RTCRtpReceiver.prototype)){var s=e.RTCPeerConnection.prototype.getReceivers;s&&(e.RTCPeerConnection.prototype.getReceivers=function(){var e=this,t=s.apply(e,[]);return t.forEach(function(t){t._pc=e}),t}),i.wrapPeerConnectionEvent(e,"track",function(e){return e.receiver._pc=e.srcElement,e}),e.RTCRtpReceiver.prototype.getStats=function(){var e=this;return this._pc.getStats().then(function(t){return filterStats(t,e.track,!1)})}}if("getStats"in e.RTCRtpSender.prototype&&"getStats"in e.RTCRtpReceiver.prototype){var r=e.RTCPeerConnection.prototype.getStats;e.RTCPeerConnection.prototype.getStats=function(){var t=this;if(arguments.length>0&&arguments[0]instanceof e.MediaStreamTrack){var n,i,s,o=arguments[0];return t.getSenders().forEach(function(e){e.track===o&&(n?s=!0:n=e)}),t.getReceivers().forEach(function(e){return e.track===o&&(i?s=!0:i=e),e.track===o}),s||n&&i?Promise.reject(new DOMException("There are more than one sender or receiver for the track.","InvalidAccessError")):n?n.getStats():i?i.getStats():Promise.reject(new DOMException("There is no sender or receiver for the track.","InvalidAccessError"))}return r.apply(t,arguments)}}}},shimSourceObject:function(e){var t=e&&e.URL;"object"==typeof e&&(!e.HTMLMediaElement||"srcObject"in e.HTMLMediaElement.prototype||Object.defineProperty(e.HTMLMediaElement.prototype,"srcObject",{get:function(){return this._srcObject},set:function(e){var n=this;this._srcObject=e,this.src&&t.revokeObjectURL(this.src),e?(this.src=t.createObjectURL(e),e.addEventListener("addtrack",function(){n.src&&t.revokeObjectURL(n.src),n.src=t.createObjectURL(e)}),e.addEventListener("removetrack",function(){n.src&&t.revokeObjectURL(n.src),n.src=t.createObjectURL(e)})):this.src=""}}))},shimAddTrackRemoveTrackWithNative:function(e){e.RTCPeerConnection.prototype.getLocalStreams=function(){var e=this;return this._shimmedLocalStreams=this._shimmedLocalStreams||{},Object.keys(this._shimmedLocalStreams).map(function(t){return e._shimmedLocalStreams[t][0]})};var t=e.RTCPeerConnection.prototype.addTrack;e.RTCPeerConnection.prototype.addTrack=function(e,n){if(!n)return t.apply(this,arguments);this._shimmedLocalStreams=this._shimmedLocalStreams||{};var i=t.apply(this,arguments);return this._shimmedLocalStreams[n.id]?-1===this._shimmedLocalStreams[n.id].indexOf(i)&&this._shimmedLocalStreams[n.id].push(i):this._shimmedLocalStreams[n.id]=[n,i],i};var n=e.RTCPeerConnection.prototype.addStream;e.RTCPeerConnection.prototype.addStream=function(e){var t=this;this._shimmedLocalStreams=this._shimmedLocalStreams||{},e.getTracks().forEach(function(e){if(t.getSenders().find(function(t){return t.track===e}))throw new DOMException("Track already exists.","InvalidAccessError")});var i=t.getSenders();n.apply(this,arguments);var s=t.getSenders().filter(function(e){return-1===i.indexOf(e)});this._shimmedLocalStreams[e.id]=[e].concat(s)};var i=e.RTCPeerConnection.prototype.removeStream;e.RTCPeerConnection.prototype.removeStream=function(e){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},delete this._shimmedLocalStreams[e.id],i.apply(this,arguments)};var s=e.RTCPeerConnection.prototype.removeTrack;e.RTCPeerConnection.prototype.removeTrack=function(e){var t=this;return this._shimmedLocalStreams=this._shimmedLocalStreams||{},e&&Object.keys(this._shimmedLocalStreams).forEach(function(n){var i=t._shimmedLocalStreams[n].indexOf(e);-1!==i&&t._shimmedLocalStreams[n].splice(i,1),1===t._shimmedLocalStreams[n].length&&delete t._shimmedLocalStreams[n]}),s.apply(this,arguments)}},shimAddTrackRemoveTrack:function(e){var t=i.detectBrowser(e);if(e.RTCPeerConnection.prototype.addTrack&&t.version>=65)return this.shimAddTrackRemoveTrackWithNative(e);var n=e.RTCPeerConnection.prototype.getLocalStreams;e.RTCPeerConnection.prototype.getLocalStreams=function(){var e=this,t=n.apply(this);return e._reverseStreams=e._reverseStreams||{},t.map(function(t){return e._reverseStreams[t.id]})};var s=e.RTCPeerConnection.prototype.addStream;e.RTCPeerConnection.prototype.addStream=function(t){var n=this;if(n._streams=n._streams||{},n._reverseStreams=n._reverseStreams||{},t.getTracks().forEach(function(e){if(n.getSenders().find(function(t){return t.track===e}))throw new DOMException("Track already exists.","InvalidAccessError")}),!n._reverseStreams[t.id]){var i=new e.MediaStream(t.getTracks());n._streams[t.id]=i,n._reverseStreams[i.id]=t,t=i}s.apply(n,[t])};var r=e.RTCPeerConnection.prototype.removeStream;function replaceInternalStreamId(e,t){var n=t.sdp;return Object.keys(e._reverseStreams||[]).forEach(function(t){var i=e._reverseStreams[t],s=e._streams[i.id];n=n.replace(new RegExp(s.id,"g"),i.id)}),new RTCSessionDescription({type:t.type,sdp:n})}function replaceExternalStreamId(e,t){var n=t.sdp;return Object.keys(e._reverseStreams||[]).forEach(function(t){var i=e._reverseStreams[t],s=e._streams[i.id];n=n.replace(new RegExp(i.id,"g"),s.id)}),new RTCSessionDescription({type:t.type,sdp:n})}e.RTCPeerConnection.prototype.removeStream=function(e){var t=this;t._streams=t._streams||{},t._reverseStreams=t._reverseStreams||{},r.apply(t,[t._streams[e.id]||e]),delete t._reverseStreams[t._streams[e.id]?t._streams[e.id].id:e.id],delete t._streams[e.id]},e.RTCPeerConnection.prototype.addTrack=function(t,n){var i=this;if("closed"===i.signalingState)throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");var s=[].slice.call(arguments,1);if(1!==s.length||!s[0].getTracks().find(function(e){return e===t}))throw new DOMException("The adapter.js addTrack polyfill only supports a single  stream which is associated with the specified track.","NotSupportedError");var r=i.getSenders().find(function(e){return e.track===t});if(r)throw new DOMException("Track already exists.","InvalidAccessError");i._streams=i._streams||{},i._reverseStreams=i._reverseStreams||{};var o=i._streams[n.id];if(o)o.addTrack(t),Promise.resolve().then(function(){i.dispatchEvent(new Event("negotiationneeded"))});else{var a=new e.MediaStream([t]);i._streams[n.id]=a,i._reverseStreams[a.id]=n,i.addStream(a)}return i.getSenders().find(function(e){return e.track===t})},["createOffer","createAnswer"].forEach(function(t){var n=e.RTCPeerConnection.prototype[t];e.RTCPeerConnection.prototype[t]=function(){var e=this,t=arguments,i=arguments.length&&"function"==typeof arguments[0];return i?n.apply(e,[function(n){var i=replaceInternalStreamId(e,n);t[0].apply(null,[i])},function(e){t[1]&&t[1].apply(null,e)},arguments[2]]):n.apply(e,arguments).then(function(t){return replaceInternalStreamId(e,t)})}});var o=e.RTCPeerConnection.prototype.setLocalDescription;e.RTCPeerConnection.prototype.setLocalDescription=function(){var e=this;return arguments.length&&arguments[0].type?(arguments[0]=replaceExternalStreamId(e,arguments[0]),o.apply(e,arguments)):o.apply(e,arguments)};var a=Object.getOwnPropertyDescriptor(e.RTCPeerConnection.prototype,"localDescription");Object.defineProperty(e.RTCPeerConnection.prototype,"localDescription",{get:function(){var e=a.get.apply(this);return""===e.type?e:replaceInternalStreamId(this,e)}}),e.RTCPeerConnection.prototype.removeTrack=function(e){var t,n=this;if("closed"===n.signalingState)throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");if(!e._pc)throw new DOMException("Argument 1 of RTCPeerConnection.removeTrack does not implement interface RTCRtpSender.","TypeError");if(!(e._pc===n))throw new DOMException("Sender was not created by this connection.","InvalidAccessError");n._streams=n._streams||{},Object.keys(n._streams).forEach(function(i){n._streams[i].getTracks().find(function(t){return e.track===t})&&(t=n._streams[i])}),t&&(1===t.getTracks().length?n.removeStream(n._reverseStreams[t.id]):t.removeTrack(e.track),n.dispatchEvent(new Event("negotiationneeded")))}},shimPeerConnection:function(e){var t=i.detectBrowser(e);if(!e.RTCPeerConnection&&e.webkitRTCPeerConnection)e.RTCPeerConnection=function(t,n){return s("PeerConnection"),t&&t.iceTransportPolicy&&(t.iceTransports=t.iceTransportPolicy),new e.webkitRTCPeerConnection(t,n)},e.RTCPeerConnection.prototype=e.webkitRTCPeerConnection.prototype,e.webkitRTCPeerConnection.generateCertificate&&Object.defineProperty(e.RTCPeerConnection,"generateCertificate",{get:function(){return e.webkitRTCPeerConnection.generateCertificate}});else{var n=e.RTCPeerConnection;e.RTCPeerConnection=function(e,t){if(e&&e.iceServers){for(var s=[],r=0;r<e.iceServers.length;r++){var o=e.iceServers[r];!o.hasOwnProperty("urls")&&o.hasOwnProperty("url")?(i.deprecated("RTCIceServer.url","RTCIceServer.urls"),(o=JSON.parse(JSON.stringify(o))).urls=o.url,s.push(o)):s.push(e.iceServers[r])}e.iceServers=s}return new n(e,t)},e.RTCPeerConnection.prototype=n.prototype,Object.defineProperty(e.RTCPeerConnection,"generateCertificate",{get:function(){return n.generateCertificate}})}var r=e.RTCPeerConnection.prototype.getStats;e.RTCPeerConnection.prototype.getStats=function(e,t,n){var i=this,s=arguments;if(arguments.length>0&&"function"==typeof e)return r.apply(this,arguments);if(0===r.length&&(0===arguments.length||"function"!=typeof arguments[0]))return r.apply(this,[]);var o=function(e){var t={};return e.result().forEach(function(e){var n={id:e.id,timestamp:e.timestamp,type:{localcandidate:"local-candidate",remotecandidate:"remote-candidate"}[e.type]||e.type};e.names().forEach(function(t){n[t]=e.stat(t)}),t[n.id]=n}),t},a=function(e){return new Map(Object.keys(e).map(function(t){return[t,e[t]]}))};if(arguments.length>=2){var c=function(e){s[1](a(o(e)))};return r.apply(this,[c,arguments[0]])}return new Promise(function(e,t){r.apply(i,[function(t){e(a(o(t)))},t])}).then(t,n)},t.version<51&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(t){var n=e.RTCPeerConnection.prototype[t];e.RTCPeerConnection.prototype[t]=function(){var e=arguments,t=this,i=new Promise(function(i,s){n.apply(t,[e[0],i,s])});return e.length<2?i:i.then(function(){e[1].apply(null,[])},function(t){e.length>=3&&e[2].apply(null,[t])})}}),t.version<52&&["createOffer","createAnswer"].forEach(function(t){var n=e.RTCPeerConnection.prototype[t];e.RTCPeerConnection.prototype[t]=function(){var e=this;if(arguments.length<1||1===arguments.length&&"object"==typeof arguments[0]){var t=1===arguments.length?arguments[0]:void 0;return new Promise(function(i,s){n.apply(e,[i,s,t])})}return n.apply(this,arguments)}}),["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(t){var n=e.RTCPeerConnection.prototype[t];e.RTCPeerConnection.prototype[t]=function(){return arguments[0]=new("addIceCandidate"===t?e.RTCIceCandidate:e.RTCSessionDescription)(arguments[0]),n.apply(this,arguments)}});var o=e.RTCPeerConnection.prototype.addIceCandidate;e.RTCPeerConnection.prototype.addIceCandidate=function(){return arguments[0]?o.apply(this,arguments):(arguments[1]&&arguments[1].apply(null),Promise.resolve())}},fixNegotiationNeeded:function(e){i.wrapPeerConnectionEvent(e,"negotiationneeded",function(e){if("stable"===e.target.signalingState)return e})},shimGetDisplayMedia:function(e,t){"getDisplayMedia"in e.navigator||("function"==typeof t?navigator.getDisplayMedia=function(e){return t(e).then(function(t){return e.video={mandatory:{chromeMediaSource:"desktop",chromeMediaSourceId:t,maxFrameRate:e.video.frameRate||3}},navigator.mediaDevices.getUserMedia(e)})}:console.error("shimGetDisplayMedia: getSourceId argument is not a function"))}}},{"../utils.js":14,"./getusermedia":6}],6:[function(e,t,n){var i=e("../utils.js"),s=i.log;t.exports=function(e){var t=i.detectBrowser(e),n=e&&e.navigator,r=function(e){if("object"!=typeof e||e.mandatory||e.optional)return e;var t={};return Object.keys(e).forEach(function(n){if("require"!==n&&"advanced"!==n&&"mediaSource"!==n){var i="object"==typeof e[n]?e[n]:{ideal:e[n]};void 0!==i.exact&&"number"==typeof i.exact&&(i.min=i.max=i.exact);var s=function(e,t){return e?e+t.charAt(0).toUpperCase()+t.slice(1):"deviceId"===t?"sourceId":t};if(void 0!==i.ideal){t.optional=t.optional||[];var r={};"number"==typeof i.ideal?(r[s("min",n)]=i.ideal,t.optional.push(r),(r={})[s("max",n)]=i.ideal,t.optional.push(r)):(r[s("",n)]=i.ideal,t.optional.push(r))}void 0!==i.exact&&"number"!=typeof i.exact?(t.mandatory=t.mandatory||{},t.mandatory[s("",n)]=i.exact):["min","max"].forEach(function(e){void 0!==i[e]&&(t.mandatory=t.mandatory||{},t.mandatory[s(e,n)]=i[e])})}}),e.advanced&&(t.optional=(t.optional||[]).concat(e.advanced)),t},o=function(e,i){if(t.version>=61)return i(e);if((e=JSON.parse(JSON.stringify(e)))&&"object"==typeof e.audio){var o=function(e,t,n){t in e&&!(n in e)&&(e[n]=e[t],delete e[t])};o((e=JSON.parse(JSON.stringify(e))).audio,"autoGainControl","googAutoGainControl"),o(e.audio,"noiseSuppression","googNoiseSuppression"),e.audio=r(e.audio)}if(e&&"object"==typeof e.video){var a=e.video.facingMode;a=a&&("object"==typeof a?a:{ideal:a});var c,d=t.version<66;if(a&&("user"===a.exact||"environment"===a.exact||"user"===a.ideal||"environment"===a.ideal)&&(!n.mediaDevices.getSupportedConstraints||!n.mediaDevices.getSupportedConstraints().facingMode||d))if(delete e.video.facingMode,"environment"===a.exact||"environment"===a.ideal?c=["back","rear"]:"user"!==a.exact&&"user"!==a.ideal||(c=["front"]),c)return n.mediaDevices.enumerateDevices().then(function(t){var n=(t=t.filter(function(e){return"videoinput"===e.kind})).find(function(e){return c.some(function(t){return-1!==e.label.toLowerCase().indexOf(t)})});return!n&&t.length&&-1!==c.indexOf("back")&&(n=t[t.length-1]),n&&(e.video.deviceId=a.exact?{exact:n.deviceId}:{ideal:n.deviceId}),e.video=r(e.video),s("chrome: "+JSON.stringify(e)),i(e)});e.video=r(e.video)}return s("chrome: "+JSON.stringify(e)),i(e)},a=function(e){return{name:{PermissionDeniedError:"NotAllowedError",PermissionDismissedError:"NotAllowedError",InvalidStateError:"NotAllowedError",DevicesNotFoundError:"NotFoundError",ConstraintNotSatisfiedError:"OverconstrainedError",TrackStartError:"NotReadableError",MediaDeviceFailedDueToShutdown:"NotAllowedError",MediaDeviceKillSwitchOn:"NotAllowedError",TabCaptureError:"AbortError",ScreenCaptureError:"AbortError",DeviceCaptureError:"AbortError"}[e.name]||e.name,message:e.message,constraint:e.constraint||e.constraintName,toString:function(){return this.name+(this.message&&": ")+this.message}}};n.getUserMedia=function(e,t,i){o(e,function(e){n.webkitGetUserMedia(e,t,function(e){i&&i(a(e))})})};var c=function(e){return new Promise(function(t,i){n.getUserMedia(e,t,i)})};if(n.mediaDevices||(n.mediaDevices={getUserMedia:c,enumerateDevices:function(){return new Promise(function(t){var n={audio:"audioinput",video:"videoinput"};return e.MediaStreamTrack.getSources(function(e){t(e.map(function(e){return{label:e.label,kind:n[e.kind],deviceId:e.id,groupId:""}}))})})},getSupportedConstraints:function(){return{deviceId:!0,echoCancellation:!0,facingMode:!0,frameRate:!0,height:!0,width:!0}}}),n.mediaDevices.getUserMedia){var d=n.mediaDevices.getUserMedia.bind(n.mediaDevices);n.mediaDevices.getUserMedia=function(e){return o(e,function(e){return d(e).then(function(t){if(e.audio&&!t.getAudioTracks().length||e.video&&!t.getVideoTracks().length)throw t.getTracks().forEach(function(e){e.stop()}),new DOMException("","NotFoundError");return t},function(e){return Promise.reject(a(e))})})}}else n.mediaDevices.getUserMedia=function(e){return c(e)};void 0===n.mediaDevices.addEventListener&&(n.mediaDevices.addEventListener=function(){s("Dummy mediaDevices.addEventListener called.")}),void 0===n.mediaDevices.removeEventListener&&(n.mediaDevices.removeEventListener=function(){s("Dummy mediaDevices.removeEventListener called.")})}},{"../utils.js":14}],7:[function(e,t,n){var i=e("sdp"),s=e("./utils");t.exports={shimRTCIceCandidate:function(e){if(e.RTCIceCandidate&&!(e.RTCIceCandidate&&"foundation"in e.RTCIceCandidate.prototype)){var t=e.RTCIceCandidate;e.RTCIceCandidate=function(e){if("object"==typeof e&&e.candidate&&0===e.candidate.indexOf("a=")&&((e=JSON.parse(JSON.stringify(e))).candidate=e.candidate.substr(2)),e.candidate&&e.candidate.length){var n=new t(e),s=i.parseCandidate(e.candidate),r=Object.assign(n,s);return r.toJSON=function(){return{candidate:r.candidate,sdpMid:r.sdpMid,sdpMLineIndex:r.sdpMLineIndex,usernameFragment:r.usernameFragment}},r}return new t(e)},e.RTCIceCandidate.prototype=t.prototype,s.wrapPeerConnectionEvent(e,"icecandidate",function(t){return t.candidate&&Object.defineProperty(t,"candidate",{value:new e.RTCIceCandidate(t.candidate),writable:"false"}),t})}},shimCreateObjectURL:function(e){var t=e&&e.URL;if("object"==typeof e&&e.HTMLMediaElement&&"srcObject"in e.HTMLMediaElement.prototype&&t.createObjectURL&&t.revokeObjectURL){var n=t.createObjectURL.bind(t),i=t.revokeObjectURL.bind(t),r=new Map,o=0;t.createObjectURL=function(e){if("getTracks"in e){var t="polyblob:"+ ++o;return r.set(t,e),s.deprecated("URL.createObjectURL(stream)","elem.srcObject = stream"),t}return n(e)},t.revokeObjectURL=function(e){i(e),r.delete(e)};var a=Object.getOwnPropertyDescriptor(e.HTMLMediaElement.prototype,"src");Object.defineProperty(e.HTMLMediaElement.prototype,"src",{get:function(){return a.get.apply(this)},set:function(e){return this.srcObject=r.get(e)||null,a.set.apply(this,[e])}});var c=e.HTMLMediaElement.prototype.setAttribute;e.HTMLMediaElement.prototype.setAttribute=function(){return 2===arguments.length&&"src"===(""+arguments[0]).toLowerCase()&&(this.srcObject=r.get(arguments[1])||null),c.apply(this,arguments)}}},shimMaxMessageSize:function(e){if(!e.RTCSctpTransport&&e.RTCPeerConnection){var t=s.detectBrowser(e);"sctp"in e.RTCPeerConnection.prototype||Object.defineProperty(e.RTCPeerConnection.prototype,"sctp",{get:function(){return void 0===this._sctp?null:this._sctp}});var n=function(e){var t=i.splitSections(e.sdp);return t.shift(),t.some(function(e){var t=i.parseMLine(e);return t&&"application"===t.kind&&-1!==t.protocol.indexOf("SCTP")})},r=function(e){var t=e.sdp.match(/mozilla...THIS_IS_SDPARTA-(\d+)/);if(null===t||t.length<2)return-1;var n=parseInt(t[1],10);return n!=n?-1:n},o=function(e){var n=65536;return"firefox"===t.browser&&(n=t.version<57?-1===e?16384:2147483637:t.version<60?57===t.version?65535:65536:2147483637),n},a=function(e,n){var s=65536;"firefox"===t.browser&&57===t.version&&(s=65535);var r=i.matchPrefix(e.sdp,"a=max-message-size:");return r.length>0?s=parseInt(r[0].substr(19),10):"firefox"===t.browser&&-1!==n&&(s=2147483637),s},c=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(){var e=this;if(e._sctp=null,n(arguments[0])){var t,i=r(arguments[0]),s=o(i),d=a(arguments[0],i);t=0===s&&0===d?Number.POSITIVE_INFINITY:0===s||0===d?Math.max(s,d):Math.min(s,d);var u={};Object.defineProperty(u,"maxMessageSize",{get:function(){return t}}),e._sctp=u}return c.apply(e,arguments)}}},shimSendThrowTypeError:function(e){if(e.RTCPeerConnection&&"createDataChannel"in e.RTCPeerConnection.prototype){var t=e.RTCPeerConnection.prototype.createDataChannel;e.RTCPeerConnection.prototype.createDataChannel=function(){var e=this,n=t.apply(e,arguments);return wrapDcSend(n,e),n},s.wrapPeerConnectionEvent(e,"datachannel",function(e){return wrapDcSend(e.channel,e.target),e})}function wrapDcSend(e,t){var n=e.send;e.send=function(){var i=arguments[0],s=i.length||i.size||i.byteLength;if("open"===e.readyState&&t.sctp&&s>t.sctp.maxMessageSize)throw new TypeError("Message too large (can send a maximum of "+t.sctp.maxMessageSize+" bytes)");return n.apply(e,arguments)}}}}},{"./utils":14,sdp:2}],8:[function(e,t,n){var i=e("../utils"),s=e("./filtericeservers"),r=e("rtcpeerconnection-shim");t.exports={shimGetUserMedia:e("./getusermedia"),shimPeerConnection:function(e){var t=i.detectBrowser(e);if(e.RTCIceGatherer&&(e.RTCIceCandidate||(e.RTCIceCandidate=function(e){return e}),e.RTCSessionDescription||(e.RTCSessionDescription=function(e){return e}),t.version<15025)){var n=Object.getOwnPropertyDescriptor(e.MediaStreamTrack.prototype,"enabled");Object.defineProperty(e.MediaStreamTrack.prototype,"enabled",{set:function(e){n.set.call(this,e);var t=new Event("enabled");t.enabled=e,this.dispatchEvent(t)}})}!e.RTCRtpSender||"dtmf"in e.RTCRtpSender.prototype||Object.defineProperty(e.RTCRtpSender.prototype,"dtmf",{get:function(){return void 0===this._dtmf&&("audio"===this.track.kind?this._dtmf=new e.RTCDtmfSender(this):"video"===this.track.kind&&(this._dtmf=null)),this._dtmf}}),e.RTCDtmfSender&&!e.RTCDTMFSender&&(e.RTCDTMFSender=e.RTCDtmfSender);var o=r(e,t.version);e.RTCPeerConnection=function(e){return e&&e.iceServers&&(e.iceServers=s(e.iceServers)),new o(e)},e.RTCPeerConnection.prototype=o.prototype},shimReplaceTrack:function(e){!e.RTCRtpSender||"replaceTrack"in e.RTCRtpSender.prototype||(e.RTCRtpSender.prototype.replaceTrack=e.RTCRtpSender.prototype.setTrack)}}},{"../utils":14,"./filtericeservers":9,"./getusermedia":10,"rtcpeerconnection-shim":1}],9:[function(e,t,n){var i=e("../utils");t.exports=function(e,t){var n=!1;return(e=JSON.parse(JSON.stringify(e))).filter(function(e){if(e&&(e.urls||e.url)){var s=e.urls||e.url;e.url&&!e.urls&&i.deprecated("RTCIceServer.url","RTCIceServer.urls");var r="string"==typeof s;return r&&(s=[s]),s=s.filter(function(e){return 0===e.indexOf("turn:")&&-1!==e.indexOf("transport=udp")&&-1===e.indexOf("turn:[")&&!n?(n=!0,!0):0===e.indexOf("stun:")&&t>=14393&&-1===e.indexOf("?transport=udp")}),delete e.url,e.urls=r?s[0]:s,!!s.length}})}},{"../utils":14}],10:[function(e,t,n){t.exports=function(e){var t=e&&e.navigator,n=t.mediaDevices.getUserMedia.bind(t.mediaDevices);t.mediaDevices.getUserMedia=function(e){return n(e).catch(function(e){return Promise.reject(function(e){return{name:{PermissionDeniedError:"NotAllowedError"}[e.name]||e.name,message:e.message,constraint:e.constraint,toString:function(){return this.name}}}(e))})}}},{}],11:[function(e,t,n){var i=e("../utils");t.exports={shimGetUserMedia:e("./getusermedia"),shimOnTrack:function(e){"object"!=typeof e||!e.RTCPeerConnection||"ontrack"in e.RTCPeerConnection.prototype||Object.defineProperty(e.RTCPeerConnection.prototype,"ontrack",{get:function(){return this._ontrack},set:function(e){this._ontrack&&(this.removeEventListener("track",this._ontrack),this.removeEventListener("addstream",this._ontrackpoly)),this.addEventListener("track",this._ontrack=e),this.addEventListener("addstream",this._ontrackpoly=function(e){e.stream.getTracks().forEach(function(t){var n=new Event("track");n.track=t,n.receiver={track:t},n.transceiver={receiver:n.receiver},n.streams=[e.stream],this.dispatchEvent(n)}.bind(this))}.bind(this))}}),"object"==typeof e&&e.RTCTrackEvent&&"receiver"in e.RTCTrackEvent.prototype&&!("transceiver"in e.RTCTrackEvent.prototype)&&Object.defineProperty(e.RTCTrackEvent.prototype,"transceiver",{get:function(){return{receiver:this.receiver}}})},shimSourceObject:function(e){"object"==typeof e&&(!e.HTMLMediaElement||"srcObject"in e.HTMLMediaElement.prototype||Object.defineProperty(e.HTMLMediaElement.prototype,"srcObject",{get:function(){return this.mozSrcObject},set:function(e){this.mozSrcObject=e}}))},shimPeerConnection:function(e){var t=i.detectBrowser(e);if("object"==typeof e&&(e.RTCPeerConnection||e.mozRTCPeerConnection)){e.RTCPeerConnection||(e.RTCPeerConnection=function(n,i){if(t.version<38&&n&&n.iceServers){for(var s=[],r=0;r<n.iceServers.length;r++){var o=n.iceServers[r];if(o.hasOwnProperty("urls"))for(var a=0;a<o.urls.length;a++){var c={url:o.urls[a]};0===o.urls[a].indexOf("turn")&&(c.username=o.username,c.credential=o.credential),s.push(c)}else s.push(n.iceServers[r])}n.iceServers=s}return new e.mozRTCPeerConnection(n,i)},e.RTCPeerConnection.prototype=e.mozRTCPeerConnection.prototype,e.mozRTCPeerConnection.generateCertificate&&Object.defineProperty(e.RTCPeerConnection,"generateCertificate",{get:function(){return e.mozRTCPeerConnection.generateCertificate}}),e.RTCSessionDescription=e.mozRTCSessionDescription,e.RTCIceCandidate=e.mozRTCIceCandidate),["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(t){var n=e.RTCPeerConnection.prototype[t];e.RTCPeerConnection.prototype[t]=function(){return arguments[0]=new("addIceCandidate"===t?e.RTCIceCandidate:e.RTCSessionDescription)(arguments[0]),n.apply(this,arguments)}});var n=e.RTCPeerConnection.prototype.addIceCandidate;e.RTCPeerConnection.prototype.addIceCandidate=function(){return arguments[0]?n.apply(this,arguments):(arguments[1]&&arguments[1].apply(null),Promise.resolve())};var s={inboundrtp:"inbound-rtp",outboundrtp:"outbound-rtp",candidatepair:"candidate-pair",localcandidate:"local-candidate",remotecandidate:"remote-candidate"},r=e.RTCPeerConnection.prototype.getStats;e.RTCPeerConnection.prototype.getStats=function(e,n,i){return r.apply(this,[e||null]).then(function(e){if(t.version<48&&(e=function(e){var t=new Map;return Object.keys(e).forEach(function(n){t.set(n,e[n]),t[n]=e[n]}),t}(e)),t.version<53&&!n)try{e.forEach(function(e){e.type=s[e.type]||e.type})}catch(t){if("TypeError"!==t.name)throw t;e.forEach(function(t,n){e.set(n,Object.assign({},t,{type:s[t.type]||t.type}))})}return e}).then(n,i)}}},shimSenderGetStats:function(e){if("object"==typeof e&&e.RTCPeerConnection&&e.RTCRtpSender&&!(e.RTCRtpSender&&"getStats"in e.RTCRtpSender.prototype)){var t=e.RTCPeerConnection.prototype.getSenders;t&&(e.RTCPeerConnection.prototype.getSenders=function(){var e=this,n=t.apply(e,[]);return n.forEach(function(t){t._pc=e}),n});var n=e.RTCPeerConnection.prototype.addTrack;n&&(e.RTCPeerConnection.prototype.addTrack=function(){var e=n.apply(this,arguments);return e._pc=this,e}),e.RTCRtpSender.prototype.getStats=function(){return this.track?this._pc.getStats(this.track):Promise.resolve(new Map)}}},shimReceiverGetStats:function(e){if("object"==typeof e&&e.RTCPeerConnection&&e.RTCRtpSender&&!(e.RTCRtpSender&&"getStats"in e.RTCRtpReceiver.prototype)){var t=e.RTCPeerConnection.prototype.getReceivers;t&&(e.RTCPeerConnection.prototype.getReceivers=function(){var e=this,n=t.apply(e,[]);return n.forEach(function(t){t._pc=e}),n}),i.wrapPeerConnectionEvent(e,"track",function(e){return e.receiver._pc=e.srcElement,e}),e.RTCRtpReceiver.prototype.getStats=function(){return this._pc.getStats(this.track)}}},shimRemoveStream:function(e){!e.RTCPeerConnection||"removeStream"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.removeStream=function(e){var t=this;i.deprecated("removeStream","removeTrack"),this.getSenders().forEach(function(n){n.track&&-1!==e.getTracks().indexOf(n.track)&&t.removeTrack(n)})})},shimRTCDataChannel:function(e){e.DataChannel&&!e.RTCDataChannel&&(e.RTCDataChannel=e.DataChannel)},shimGetDisplayMedia:function(e,t){"getDisplayMedia"in e.navigator||(navigator.getDisplayMedia=function(e){if(!e||!e.video){var n=new DOMException("getDisplayMedia without video constraints is undefined");return n.name="NotFoundError",n.code=8,Promise.reject(n)}return!0===e.video?e.video={mediaSource:t}:e.video.mediaSource=t,navigator.mediaDevices.getUserMedia(e)})}}},{"../utils":14,"./getusermedia":12}],12:[function(e,t,n){var i=e("../utils"),s=i.log;t.exports=function(e){var t=i.detectBrowser(e),n=e&&e.navigator,r=e&&e.MediaStreamTrack,o=function(e){return{name:{InternalError:"NotReadableError",NotSupportedError:"TypeError",PermissionDeniedError:"NotAllowedError",SecurityError:"NotAllowedError"}[e.name]||e.name,message:{"The operation is insecure.":"The request is not allowed by the user agent or the platform in the current context."}[e.message]||e.message,constraint:e.constraint,toString:function(){return this.name+(this.message&&": ")+this.message}}},a=function(e,i,r){var a=function(e){if("object"!=typeof e||e.require)return e;var t=[];return Object.keys(e).forEach(function(n){if("require"!==n&&"advanced"!==n&&"mediaSource"!==n){var i=e[n]="object"==typeof e[n]?e[n]:{ideal:e[n]};if(void 0===i.min&&void 0===i.max&&void 0===i.exact||t.push(n),void 0!==i.exact&&("number"==typeof i.exact?i.min=i.max=i.exact:e[n]=i.exact,delete i.exact),void 0!==i.ideal){e.advanced=e.advanced||[];var s={};"number"==typeof i.ideal?s[n]={min:i.ideal,max:i.ideal}:s[n]=i.ideal,e.advanced.push(s),delete i.ideal,Object.keys(i).length||delete e[n]}}}),t.length&&(e.require=t),e};return e=JSON.parse(JSON.stringify(e)),t.version<38&&(s("spec: "+JSON.stringify(e)),e.audio&&(e.audio=a(e.audio)),e.video&&(e.video=a(e.video)),s("ff37: "+JSON.stringify(e))),n.mozGetUserMedia(e,i,function(e){r(o(e))})};if(n.mediaDevices||(n.mediaDevices={getUserMedia:function(e){return new Promise(function(t,n){a(e,t,n)})},addEventListener:function(){},removeEventListener:function(){}}),n.mediaDevices.enumerateDevices=n.mediaDevices.enumerateDevices||function(){return new Promise(function(e){e([{kind:"audioinput",deviceId:"default",label:"",groupId:""},{kind:"videoinput",deviceId:"default",label:"",groupId:""}])})},t.version<41){var c=n.mediaDevices.enumerateDevices.bind(n.mediaDevices);n.mediaDevices.enumerateDevices=function(){return c().then(void 0,function(e){if("NotFoundError"===e.name)return[];throw e})}}if(t.version<49){var d=n.mediaDevices.getUserMedia.bind(n.mediaDevices);n.mediaDevices.getUserMedia=function(e){return d(e).then(function(t){if(e.audio&&!t.getAudioTracks().length||e.video&&!t.getVideoTracks().length)throw t.getTracks().forEach(function(e){e.stop()}),new DOMException("The object can not be found here.","NotFoundError");return t},function(e){return Promise.reject(o(e))})}}if(!(t.version>55&&"autoGainControl"in n.mediaDevices.getSupportedConstraints())){var u=function(e,t,n){t in e&&!(n in e)&&(e[n]=e[t],delete e[t])},h=n.mediaDevices.getUserMedia.bind(n.mediaDevices);if(n.mediaDevices.getUserMedia=function(e){return"object"==typeof e&&"object"==typeof e.audio&&(e=JSON.parse(JSON.stringify(e)),u(e.audio,"autoGainControl","mozAutoGainControl"),u(e.audio,"noiseSuppression","mozNoiseSuppression")),h(e)},r&&r.prototype.getSettings){var l=r.prototype.getSettings;r.prototype.getSettings=function(){var e=l.apply(this,arguments);return u(e,"mozAutoGainControl","autoGainControl"),u(e,"mozNoiseSuppression","noiseSuppression"),e}}if(r&&r.prototype.applyConstraints){var p=r.prototype.applyConstraints;r.prototype.applyConstraints=function(e){return"audio"===this.kind&&"object"==typeof e&&(e=JSON.parse(JSON.stringify(e)),u(e,"autoGainControl","mozAutoGainControl"),u(e,"noiseSuppression","mozNoiseSuppression")),p.apply(this,[e])}}}n.getUserMedia=function(e,s,r){if(t.version<44)return a(e,s,r);i.deprecated("navigator.getUserMedia","navigator.mediaDevices.getUserMedia"),n.mediaDevices.getUserMedia(e).then(s,r)}}},{"../utils":14}],13:[function(e,t,n){var i=e("../utils");t.exports={shimLocalStreamsAPI:function(e){if("object"==typeof e&&e.RTCPeerConnection){if("getLocalStreams"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.getLocalStreams=function(){return this._localStreams||(this._localStreams=[]),this._localStreams}),"getStreamById"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.getStreamById=function(e){var t=null;return this._localStreams&&this._localStreams.forEach(function(n){n.id===e&&(t=n)}),this._remoteStreams&&this._remoteStreams.forEach(function(n){n.id===e&&(t=n)}),t}),!("addStream"in e.RTCPeerConnection.prototype)){var t=e.RTCPeerConnection.prototype.addTrack;e.RTCPeerConnection.prototype.addStream=function(e){this._localStreams||(this._localStreams=[]),-1===this._localStreams.indexOf(e)&&this._localStreams.push(e);var n=this;e.getTracks().forEach(function(i){t.call(n,i,e)})},e.RTCPeerConnection.prototype.addTrack=function(e,n){return n&&(this._localStreams?-1===this._localStreams.indexOf(n)&&this._localStreams.push(n):this._localStreams=[n]),t.call(this,e,n)}}"removeStream"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.removeStream=function(e){this._localStreams||(this._localStreams=[]);var t=this._localStreams.indexOf(e);if(-1!==t){this._localStreams.splice(t,1);var n=this,i=e.getTracks();this.getSenders().forEach(function(e){-1!==i.indexOf(e.track)&&n.removeTrack(e)})}})}},shimRemoteStreamsAPI:function(e){"object"==typeof e&&e.RTCPeerConnection&&("getRemoteStreams"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.getRemoteStreams=function(){return this._remoteStreams?this._remoteStreams:[]}),"onaddstream"in e.RTCPeerConnection.prototype||Object.defineProperty(e.RTCPeerConnection.prototype,"onaddstream",{get:function(){return this._onaddstream},set:function(e){var t=this;this._onaddstream&&(this.removeEventListener("addstream",this._onaddstream),this.removeEventListener("track",this._onaddstreampoly)),this.addEventListener("addstream",this._onaddstream=e),this.addEventListener("track",this._onaddstreampoly=function(e){e.streams.forEach(function(e){if(t._remoteStreams||(t._remoteStreams=[]),!(t._remoteStreams.indexOf(e)>=0)){t._remoteStreams.push(e);var n=new Event("addstream");n.stream=e,t.dispatchEvent(n)}})})}}))},shimCallbacksAPI:function(e){if("object"==typeof e&&e.RTCPeerConnection){var t=e.RTCPeerConnection.prototype,n=t.createOffer,i=t.createAnswer,s=t.setLocalDescription,r=t.setRemoteDescription,o=t.addIceCandidate;t.createOffer=function(e,t){var i=arguments.length>=2?arguments[2]:arguments[0],s=n.apply(this,[i]);return t?(s.then(e,t),Promise.resolve()):s},t.createAnswer=function(e,t){var n=arguments.length>=2?arguments[2]:arguments[0],s=i.apply(this,[n]);return t?(s.then(e,t),Promise.resolve()):s};var a=function(e,t,n){var i=s.apply(this,[e]);return n?(i.then(t,n),Promise.resolve()):i};t.setLocalDescription=a,a=function(e,t,n){var i=r.apply(this,[e]);return n?(i.then(t,n),Promise.resolve()):i},t.setRemoteDescription=a,a=function(e,t,n){var i=o.apply(this,[e]);return n?(i.then(t,n),Promise.resolve()):i},t.addIceCandidate=a}},shimGetUserMedia:function(e){var t=e&&e.navigator;t.getUserMedia||(t.webkitGetUserMedia?t.getUserMedia=t.webkitGetUserMedia.bind(t):t.mediaDevices&&t.mediaDevices.getUserMedia&&(t.getUserMedia=function(e,n,i){t.mediaDevices.getUserMedia(e).then(n,i)}.bind(t)))},shimRTCIceServerUrls:function(e){var t=e.RTCPeerConnection;e.RTCPeerConnection=function(e,n){if(e&&e.iceServers){for(var s=[],r=0;r<e.iceServers.length;r++){var o=e.iceServers[r];!o.hasOwnProperty("urls")&&o.hasOwnProperty("url")?(i.deprecated("RTCIceServer.url","RTCIceServer.urls"),(o=JSON.parse(JSON.stringify(o))).urls=o.url,delete o.url,s.push(o)):s.push(e.iceServers[r])}e.iceServers=s}return new t(e,n)},e.RTCPeerConnection.prototype=t.prototype,"generateCertificate"in e.RTCPeerConnection&&Object.defineProperty(e.RTCPeerConnection,"generateCertificate",{get:function(){return t.generateCertificate}})},shimTrackEventTransceiver:function(e){"object"==typeof e&&e.RTCPeerConnection&&"receiver"in e.RTCTrackEvent.prototype&&!e.RTCTransceiver&&Object.defineProperty(e.RTCTrackEvent.prototype,"transceiver",{get:function(){return{receiver:this.receiver}}})},shimCreateOfferLegacy:function(e){var t=e.RTCPeerConnection.prototype.createOffer;e.RTCPeerConnection.prototype.createOffer=function(e){var n=this;if(e){void 0!==e.offerToReceiveAudio&&(e.offerToReceiveAudio=!!e.offerToReceiveAudio);var i=n.getTransceivers().find(function(e){return e.sender.track&&"audio"===e.sender.track.kind});!1===e.offerToReceiveAudio&&i?"sendrecv"===i.direction?i.setDirection?i.setDirection("sendonly"):i.direction="sendonly":"recvonly"===i.direction&&(i.setDirection?i.setDirection("inactive"):i.direction="inactive"):!0!==e.offerToReceiveAudio||i||n.addTransceiver("audio"),void 0!==e.offerToReceiveAudio&&(e.offerToReceiveVideo=!!e.offerToReceiveVideo);var s=n.getTransceivers().find(function(e){return e.sender.track&&"video"===e.sender.track.kind});!1===e.offerToReceiveVideo&&s?"sendrecv"===s.direction?s.setDirection("sendonly"):"recvonly"===s.direction&&s.setDirection("inactive"):!0!==e.offerToReceiveVideo||s||n.addTransceiver("video")}return t.apply(n,arguments)}}}},{"../utils":14}],14:[function(e,t,n){var i=!0,s=!0;function extractVersion(e,t,n){var i=e.match(t);return i&&i.length>=n&&parseInt(i[n],10)}t.exports={extractVersion:extractVersion,wrapPeerConnectionEvent:function wrapPeerConnectionEvent(e,t,n){if(e.RTCPeerConnection){var i=e.RTCPeerConnection.prototype,s=i.addEventListener;i.addEventListener=function(e,i){if(e!==t)return s.apply(this,arguments);var r=function(e){var t=n(e);t&&i(t)};return this._eventMap=this._eventMap||{},this._eventMap[i]=r,s.apply(this,[e,r])};var r=i.removeEventListener;i.removeEventListener=function(e,n){if(e!==t||!this._eventMap||!this._eventMap[n])return r.apply(this,arguments);var i=this._eventMap[n];return delete this._eventMap[n],r.apply(this,[e,i])},Object.defineProperty(i,"on"+t,{get:function(){return this["_on"+t]},set:function(e){this["_on"+t]&&(this.removeEventListener(t,this["_on"+t]),delete this["_on"+t]),e&&this.addEventListener(t,this["_on"+t]=e)},enumerable:!0,configurable:!0})}},disableLog:function(e){return"boolean"!=typeof e?new Error("Argument type: "+typeof e+". Please use a boolean."):(i=e,e?"adapter.js logging disabled":"adapter.js logging enabled")},disableWarnings:function(e){return"boolean"!=typeof e?new Error("Argument type: "+typeof e+". Please use a boolean."):(s=!e,"adapter.js deprecation warnings "+(e?"disabled":"enabled"))},log:function(){if("object"==typeof window){if(i)return;"undefined"!=typeof console&&"function"==typeof console.log&&console.log.apply(console,arguments)}},deprecated:function(e,t){s&&console.warn(e+" is deprecated, please use "+t+" instead.")},detectBrowser:function(e){var t=e&&e.navigator,n={browser:null,version:null};if(void 0===e||!e.navigator)return n.browser="Not a browser.",n;if(t.mozGetUserMedia)n.browser="firefox",n.version=extractVersion(t.userAgent,/Firefox\/(\d+)\./,1);else if(t.webkitGetUserMedia)n.browser="chrome",n.version=extractVersion(t.userAgent,/Chrom(e|ium)\/(\d+)\./,2);else if(t.mediaDevices&&t.userAgent.match(/Edge\/(\d+).(\d+)$/))n.browser="edge",n.version=extractVersion(t.userAgent,/Edge\/(\d+).(\d+)$/,2);else{if(!e.RTCPeerConnection||!t.userAgent.match(/AppleWebKit\/(\d+)\./))return n.browser="Not a supported browser.",n;n.browser="safari",n.version=extractVersion(t.userAgent,/AppleWebKit\/(\d+)\./,1)}return n}}},{}]},{},[3])(3)}),function(){function retry(e,t){var n=0,i=!1,s=window.setInterval(function(){e()&&(window.clearInterval(s),t(i)),n++>50&&(window.clearInterval(s),t(i=!0))},10)}var e,t="Fake/5.0 (FakeOS) AppleWebKit/123 (KHTML, like Gecko) Fake/12.3.4567.89 Fake/123.45";if(m="object"==typeof process&&"object"==typeof process.versions&&process.versions.node&&!process.browser){var n=process.versions.node.toString().replace("v","");t="Nodejs/"+n+" (NodeOS) AppleWebKit/"+n+" (KHTML, like Gecko) Nodejs/"+n+" Nodejs/"+n}e="undefined"!=typeof global?global:window,"undefined"==typeof window&&("undefined"==typeof window&&"undefined"!=typeof global&&(global.navigator={userAgent:t,getUserMedia:function(){}},e.window=global),"undefined"==typeof location&&(e.location={protocol:"file:",href:"",hash:""}),"undefined"==typeof screen&&(e.screen={width:0,height:0}));var i=window.navigator;void 0!==i?(void 0!==i.webkitGetUserMedia&&(i.getUserMedia=i.webkitGetUserMedia),void 0!==i.mozGetUserMedia&&(i.getUserMedia=i.mozGetUserMedia)):i={getUserMedia:function(){},userAgent:t};var s=!!/Android|webOS|iPhone|iPad|iPod|BB10|BlackBerry|IEMobile|Opera Mini|Mobile|mobile/i.test(i.userAgent||""),r=!(-1===i.userAgent.indexOf("Edge")||!i.msSaveOrOpenBlob&&!i.msSaveBlob),o=!!window.opera||i.userAgent.indexOf(" OPR/")>=0,a=i.userAgent.toLowerCase().indexOf("firefox")>-1&&"netscape"in window&&/ rv:/.test(i.userAgent),c=/^((?!chrome|android).)*safari/i.test(i.userAgent),d=!!window.chrome&&!o,u="undefined"!=typeof document&&!!document.documentMode&&!r,h={Android:function(){return i.userAgent.match(/Android/i)},BlackBerry:function(){return i.userAgent.match(/BlackBerry|BB10/i)},iOS:function(){return i.userAgent.match(/iPhone|iPad|iPod/i)},Opera:function(){return i.userAgent.match(/Opera Mini/i)},Windows:function(){return i.userAgent.match(/IEMobile/i)},any:function(){return h.Android()||h.BlackBerry()||h.iOS()||h.Opera()||h.Windows()},getOsName:function(){var e="Unknown OS";return h.Android()&&(e="Android"),h.BlackBerry()&&(e="BlackBerry"),h.iOS()&&(e="iOS"),h.Opera()&&(e="Opera Mini"),h.Windows()&&(e="Windows"),e}},l="Unknown OS",p="Unknown OS Version",f=function detectDesktopOS(){for(var e,t=i.appVersion,n=i.userAgent,s="-",r=[{s:"Chrome OS",r:/CrOS/},{s:"Windows 10",r:/(Windows 10.0|Windows NT 10.0)/},{s:"Windows 8.1",r:/(Windows 8.1|Windows NT 6.3)/},{s:"Windows 8",r:/(Windows 8|Windows NT 6.2)/},{s:"Windows 7",r:/(Windows 7|Windows NT 6.1)/},{s:"Windows Vista",r:/Windows NT 6.0/},{s:"Windows Server 2003",r:/Windows NT 5.2/},{s:"Windows XP",r:/(Windows NT 5.1|Windows XP)/},{s:"Windows 2000",r:/(Windows NT 5.0|Windows 2000)/},{s:"Windows ME",r:/(Win 9x 4.90|Windows ME)/},{s:"Windows 98",r:/(Windows 98|Win98)/},{s:"Windows 95",r:/(Windows 95|Win95|Windows_95)/},{s:"Windows NT 4.0",r:/(Windows NT 4.0|WinNT4.0|WinNT|Windows NT)/},{s:"Windows CE",r:/Windows CE/},{s:"Windows 3.11",r:/Win16/},{s:"Android",r:/Android/},{s:"Open BSD",r:/OpenBSD/},{s:"Sun OS",r:/SunOS/},{s:"Linux",r:/(Linux|X11)/},{s:"iOS",r:/(iPhone|iPad|iPod)/},{s:"Mac OS X",r:/Mac OS X/},{s:"Mac OS",r:/(MacPPC|MacIntel|Mac_PowerPC|Macintosh)/},{s:"QNX",r:/QNX/},{s:"UNIX",r:/UNIX/},{s:"BeOS",r:/BeOS/},{s:"OS/2",r:/OS\/2/},{s:"Search Bot",r:/(nuhk|Googlebot|Yammybot|Openbot|Slurp|MSNBot|Ask Jeeves\/Teoma|ia_archiver)/}],o=0;e=r[o];o++)if(e.r.test(n)){s=e.s;break}var a="-";switch(/Windows/.test(s)&&(/Windows (.*)/.test(s)&&(a=/Windows (.*)/.exec(s)[1]),s="Windows"),s){case"Mac OS X":/Mac OS X (10[\.\_\d]+)/.test(n)&&(a=/Mac OS X (10[\.\_\d]+)/.exec(n)[1]);break;case"Android":/Android ([\.\_\d]+)/.test(n)&&(a=/Android ([\.\_\d]+)/.exec(n)[1]);break;case"iOS":/OS (\d+)_(\d+)_?(\d+)?/.test(n)&&(a=(a=/OS (\d+)_(\d+)_?(\d+)?/.exec(t))[1]+"."+a[2]+"."+(0|a[3]))}return{osName:s,osVersion:a}}();f&&f.osName&&"-"!=f.osName?(l=f.osName,p=f.osVersion):h.any()&&("Android"==(l=h.getOsName())&&(p=function getAndroidVersion(e){var t=(e=(e||i.userAgent).toLowerCase()).match(/android\s([0-9\.]*)/);return!!t&&t[1]}()));var m="object"==typeof process&&"object"==typeof process.versions&&process.versions.node;"Unknown OS"===l&&m&&(l="Nodejs",p=process.versions.node.toString().replace("v",""));var g=!1,v=!1;["captureStream","mozCaptureStream","webkitCaptureStream"].forEach(function(e){"undefined"!=typeof document&&"function"==typeof document.createElement&&(!g&&e in document.createElement("canvas")&&(g=!0),!v&&e in document.createElement("video")&&(v=!0))});var b=/^(192\.168\.|169\.254\.|10\.|172\.(1[6-9]|2\d|3[01]))/,y=/([0-9]{1,3}(\.[0-9]{1,3}){3})/,w=/[a-f0-9]{1,4}(:[a-f0-9]{1,4}){7}/,S=[],C=[],k=[],P=[];i.mediaDevices&&i.mediaDevices.enumerateDevices&&(i.enumerateDevices=function(e){var t=i.mediaDevices.enumerateDevices();t&&t.then?i.mediaDevices.enumerateDevices().then(e).catch(function(){e([])}):e([])});var x=!1;"undefined"!=typeof MediaStreamTrack&&"getSources"in MediaStreamTrack?x=!0:i.mediaDevices&&i.mediaDevices.enumerateDevices&&(x=!0);var T=!1,R=!1,E=!1,I=!1,M=!1,_=window.DetectRTC||{};_.browser=function getBrowserInfo(){var e,t,n,s=(i.appVersion,i.userAgent),h=i.appName,l=""+parseFloat(i.appVersion),p=parseInt(i.appVersion,10);if(o){h="Opera";try{p=(l=i.userAgent.split("OPR/")[1].split(" ")[0]).split(".")[0]}catch(e){l="0.0.0.0",p=0}}else u?((t=s.indexOf("rv:"))>0?l=s.substring(t+3):(t=s.indexOf("MSIE"),l=s.substring(t+5)),h="IE"):d?(t=s.indexOf("Chrome"),h="Chrome",l=s.substring(t+7)):c?-1!==s.indexOf("CriOS")?(t=s.indexOf("CriOS"),h="Chrome",l=s.substring(t+6)):-1!==s.indexOf("FxiOS")?(t=s.indexOf("FxiOS"),h="Firefox",l=s.substring(t+6)):(t=s.indexOf("Safari"),h="Safari",l=s.substring(t+7),-1!==(t=s.indexOf("Version"))&&(l=s.substring(t+8)),-1!==i.userAgent.indexOf("Version/")&&(l=i.userAgent.split("Version/")[1].split(" ")[0])):a?(t=s.indexOf("Firefox"),h="Firefox",l=s.substring(t+8)):(e=s.lastIndexOf(" ")+1)<(t=s.lastIndexOf("/"))&&(h=s.substring(e,t),l=s.substring(t+1),h.toLowerCase()===h.toUpperCase()&&(h=i.appName));return r&&(h="Edge",l=i.userAgent.split("Edge/")[1]),-1!==(n=l.search(/[; \)]/))&&(l=l.substring(0,n)),p=parseInt(""+l,10),isNaN(p)&&(l=""+parseFloat(i.appVersion),p=parseInt(i.appVersion,10)),{fullVersion:l,version:p,name:h,isPrivateBrowsing:!1}}(),function detectPrivateMode(e){var t;try{if(window.webkitRequestFileSystem)window.webkitRequestFileSystem(window.TEMPORARY,1,function(){t=!1},function(e){t=!0});else if(window.indexedDB&&/Firefox/.test(window.navigator.userAgent)){var n;try{(n=window.indexedDB.open("test")).onerror=function(){return!0}}catch(e){t=!0}void 0===t&&retry(function(){return"done"===n.readyState},function(e){e||(t=!n.result)})}else if(function isIE10OrLater(e){var t=e.toLowerCase();if(0===t.indexOf("msie")&&0===t.indexOf("trident"))return!1;var n=/(?:msie|rv:)\s?([\d\.]+)/.exec(t);return!!(n&&parseInt(n[1],10)>=10)}(window.navigator.userAgent)){t=!1;try{window.indexedDB||(t=!0)}catch(e){t=!0}}else if(window.localStorage&&/Safari/.test(window.navigator.userAgent)){try{window.localStorage.setItem("test",1)}catch(e){t=!0}void 0===t&&(t=!1,window.localStorage.removeItem("test"))}}catch(e){t=!1}retry(function(){return void 0!==t},function(n){e(t)})}(function(e){_.browser.isPrivateBrowsing=!!e}),_.browser["is"+_.browser.name]=!0,_.osName=l,_.osVersion=p;var D=("object"==typeof process&&"object"==typeof process.versions&&process.versions["node-webkit"],!1);["RTCPeerConnection","webkitRTCPeerConnection","mozRTCPeerConnection","RTCIceGatherer"].forEach(function(e){D||e in window&&(D=!0)}),_.isWebRTCSupported=D,_.isORTCSupported="undefined"!=typeof RTCIceGatherer;var O=!1;(_.browser.isChrome&&_.browser.version>=35?O=!0:_.browser.isFirefox&&_.browser.version>=34?O=!0:_.browser.isEdge&&_.browser.version>=17?O=!0:"Android"===_.osName&&_.browser.isChrome&&(O=!0),(i.getDisplayMedia||i.mediaDevices&&i.mediaDevices.getDisplayMedia)&&(O=!0),/^(https:|chrome-extension:)$/g.test(location.protocol||""))||("undefined"!=typeof document&&"string"==typeof document.domain&&document.domain.search&&-1===document.domain.search(/localhost|127.0./g)&&(_.browser.isChrome||_.browser.isEdge||_.browser.isOpera)?O=!1:_.browser.isFirefox&&(O=!1));_.isScreenCapturingSupported=O;var L={isSupported:!1,isCreateMediaStreamSourceSupported:!1};["AudioContext","webkitAudioContext","mozAudioContext","msAudioContext"].forEach(function(e){L.isSupported||e in window&&(L.isSupported=!0,window[e]&&"createMediaStreamSource"in window[e].prototype&&(L.isCreateMediaStreamSourceSupported=!0))}),_.isAudioContextSupported=L.isSupported,_.isCreateMediaStreamSourceSupported=L.isCreateMediaStreamSourceSupported;var A=!1;_.browser.isChrome&&_.browser.version>31&&(A=!0),_.isRtpDataChannelsSupported=A;var N=!1;_.browser.isFirefox&&_.browser.version>28?N=!0:_.browser.isChrome&&_.browser.version>25?N=!0:_.browser.isOpera&&_.browser.version>=11&&(N=!0),_.isSctpDataChannelsSupported=N,_.isMobileDevice=s;var F=!1;i.getUserMedia?F=!0:i.mediaDevices&&i.mediaDevices.getUserMedia&&(F=!0),_.browser.isChrome&&_.browser.version>=46&&!/^(https:|chrome-extension:)$/g.test(location.protocol||"")&&"undefined"!=typeof document&&"string"==typeof document.domain&&document.domain.search&&-1===document.domain.search(/localhost|127.0./g)&&(F="Requires HTTPs"),"Nodejs"===_.osName&&(F=!1),_.isGetUserMediaSupported=F;var j="";screen.width&&(j+=(screen.width?screen.width:"")+" x "+(screen.height?screen.height:""));_.displayResolution=j,_.displayAspectRatio=function getAspectRatio(e,t){var n=function gcd(e,t){return 0==t?e:gcd(t,e%t)}(e,t);return e/n/(t/n)}(screen.width,screen.height).toFixed(2),_.isCanvasSupportsStreamCapturing=g,_.isVideoSupportsStreamCapturing=v,"Chrome"==_.browser.name&&_.browser.version>=53&&(_.isCanvasSupportsStreamCapturing||(_.isCanvasSupportsStreamCapturing="Requires chrome flag: enable-experimental-web-platform-features"),_.isVideoSupportsStreamCapturing||(_.isVideoSupportsStreamCapturing="Requires chrome flag: enable-experimental-web-platform-features")),_.DetectLocalIPAddress=function DetectLocalIPAddress(e,t){if(_.isWebRTCSupported){var n=!0,i=!0;!function getIPs(e,t){function handleCandidate(t){if(t){var i=y.exec(t);if(i){var s=i[1],r=t.match(b);void 0===n[s]&&e(s,r,!0),n[s]=!0}}else e()}function afterCreateOffer(){var e=a.localDescription.sdp.split("\n");e.forEach(function(e){e&&0===e.indexOf("a=candidate:")&&handleCandidate(e)})}if("undefined"!=typeof document&&"function"==typeof document.getElementById){var n={},i=window.RTCPeerConnection||window.mozRTCPeerConnection||window.webkitRTCPeerConnection;if(!i){var s=document.getElementById("iframe");if(!s)return;var r=s.contentWindow;i=r.RTCPeerConnection||r.mozRTCPeerConnection||r.webkitRTCPeerConnection}if(i){var o=null;"Chrome"===_.browser&&_.browser.version<58&&(o={optional:[{RtpDataChannels:!0}]});var a=new i({iceServers:[{urls:"stun:stun.l.google.com:19302"}]},o);if(t&&(a.addStream?a.addStream(t):a.addTrack&&t.getTracks()[0]&&a.addTrack(t.getTracks()[0],t)),a.onicecandidate=function(e){e.candidate&&e.candidate.candidate?handleCandidate(e.candidate.candidate):handleCandidate()},!t)try{a.createDataChannel("sctp",{})}catch(e){}_.isPromisesSupported?a.createOffer().then(function(e){a.setLocalDescription(e).then(afterCreateOffer)}):a.createOffer(function(e){a.setLocalDescription(e,afterCreateOffer,function(){})},function(){})}}}(function(t){t?t.match(b)?e("Local: "+t,n=!1,i):t.match(w)?e("Public: "+t,n,i=!1):e("Public: "+t,n,i):e()},t)}},_.isWebSocketsSupported="WebSocket"in window&&2===window.WebSocket.CLOSING,_.isWebSocketsBlocked=!_.isWebSocketsSupported,"Nodejs"===_.osName&&(_.isWebSocketsSupported=!0,_.isWebSocketsBlocked=!1),_.checkWebSocketsSupport=function(e){e=e||function(){};try{var t,n=new WebSocket("wss://echo.websocket.org:443/");n.onopen=function(){_.isWebSocketsBlocked=!1,t=(new Date).getTime(),n.send("ping")},n.onmessage=function(){_.WebsocketLatency=(new Date).getTime()-t+"ms",e(),n.close(),n=null},n.onerror=function(){_.isWebSocketsBlocked=!0,e()}}catch(t){_.isWebSocketsBlocked=!0,e()}},_.load=function(e){(function checkDeviceSupport(e){if(x)if(!i.enumerateDevices&&window.MediaStreamTrack&&window.MediaStreamTrack.getSources&&(i.enumerateDevices=window.MediaStreamTrack.getSources.bind(window.MediaStreamTrack)),!i.enumerateDevices&&i.enumerateDevices&&(i.enumerateDevices=i.enumerateDevices.bind(i)),i.enumerateDevices){S=[],C=[],k=[],P=[],T=!1,R=!1,E=!1,I=!1,M=!1;var t={};i.enumerateDevices(function(n){n.forEach(function(e){var n={};for(var i in e)try{"function"!=typeof e[i]&&(n[i]=e[i])}catch(e){}t[n.deviceId+n.label+n.kind]||("audio"===n.kind&&(n.kind="audioinput"),"video"===n.kind&&(n.kind="videoinput"),n.deviceId||(n.deviceId=n.id),n.id||(n.id=n.deviceId),n.label?("videoinput"!==n.kind||M||(M=!0),"audioinput"!==n.kind||I||(I=!0)):(n.isCustomLabel=!0,"videoinput"===n.kind?n.label="Camera "+(P.length+1):"audioinput"===n.kind?n.label="Microphone "+(C.length+1):"audiooutput"===n.kind?n.label="Speaker "+(k.length+1):n.label="Please invoke getUserMedia once.",void 0!==_&&_.browser.isChrome&&_.browser.version>=46&&!/^(https:|chrome-extension:)$/g.test(location.protocol||"")&&"undefined"!=typeof document&&"string"==typeof document.domain&&document.domain.search&&-1===document.domain.search(/localhost|127.0./g)&&(n.label="HTTPs is required to get label of this "+n.kind+" device.")),"audioinput"===n.kind&&(T=!0,-1===C.indexOf(n)&&C.push(n)),"audiooutput"===n.kind&&(R=!0,-1===k.indexOf(n)&&k.push(n)),"videoinput"===n.kind&&(E=!0,-1===P.indexOf(n)&&P.push(n)),S.push(n),t[n.deviceId+n.label+n.kind]=n)}),void 0!==_&&(_.MediaDevices=S,_.hasMicrophone=T,_.hasSpeakers=R,_.hasWebcam=E,_.isWebsiteHasWebcamPermissions=M,_.isWebsiteHasMicrophonePermissions=I,_.audioInputDevices=C,_.audioOutputDevices=k,_.videoInputDevices=P),e&&e()})}else e&&e();else e&&e()})(e=e||function(){})},_.MediaDevices=void 0!==S?S:[],_.hasMicrophone=T,_.hasSpeakers=R,_.hasWebcam=E,_.isWebsiteHasWebcamPermissions=M,_.isWebsiteHasMicrophonePermissions=I,_.audioInputDevices=C,_.audioOutputDevices=k,_.videoInputDevices=P;var V=!1;"undefined"!=typeof document&&"function"==typeof document.createElement&&"setSinkId"in document.createElement("video")&&(V=!0),_.isSetSinkIdSupported=V;var B=!1;_.browser.isFirefox&&"undefined"!=typeof mozRTCPeerConnection?"getSenders"in mozRTCPeerConnection.prototype&&(B=!0):_.browser.isChrome&&"undefined"!=typeof webkitRTCPeerConnection&&"getSenders"in webkitRTCPeerConnection.prototype&&(B=!0),_.isRTPSenderReplaceTracksSupported=B;var U=!1;_.browser.isFirefox&&_.browser.version>38&&(U=!0),_.isRemoteStreamProcessingSupported=U;var H=!1;"undefined"!=typeof MediaStreamTrack&&"applyConstraints"in MediaStreamTrack.prototype&&(H=!0),_.isApplyConstraintsSupported=H;var q=!1;_.browser.isFirefox&&_.browser.version>=43&&(q=!0),_.isMultiMonitorScreenCapturingSupported=q,_.isPromisesSupported=!!("Promise"in window),_.version="1.3.9",void 0===_&&(window.DetectRTC={});var G=window.MediaStream;void 0===G&&"undefined"!=typeof webkitMediaStream&&(G=webkitMediaStream),_.MediaStream=void 0!==G&&"function"==typeof G&&Object.keys(G.prototype),"undefined"!=typeof MediaStreamTrack?_.MediaStreamTrack=Object.keys(MediaStreamTrack.prototype):_.MediaStreamTrack=!1;var W=window.RTCPeerConnection||window.mozRTCPeerConnection||window.webkitRTCPeerConnection;_.RTCPeerConnection=void 0!==W&&Object.keys(W.prototype),window.DetectRTC=_,"undefined"!=typeof module&&(module.exports=_),"function"==typeof define&&define.amd&&define("DetectRTC",[],function(){return _})}(),function(e,t){"function"==typeof define&&define.amd?define("croppie",t):"object"==typeof exports&&"string"!=typeof exports.nodeName?module.exports=t():e.Croppie=t()}("undefined"!=typeof self?self:this,function(){"function"!=typeof Promise&&function(t){function b(e,t){return function(){e.apply(t,arguments)}}function c(t){if("object"!=typeof this)throw new TypeError("Promises must be constructed via new");if("function"!=typeof t)throw new TypeError("not a function");this._state=null,this._value=null,this._deferreds=[],i(t,b(e,this),b(f,this))}function d(e){var t=this;return null===this._state?void this._deferreds.push(e):void s(function(){var n=t._state?e.onFulfilled:e.onRejected;if(null!==n){var i;try{i=n(t._value)}catch(t){return void e.reject(t)}e.resolve(i)}else(t._state?e.resolve:e.reject)(t._value)})}function e(t){try{if(t===this)throw new TypeError("A promise cannot be resolved with itself.");if(t&&("object"==typeof t||"function"==typeof t)){var n=t.then;if("function"==typeof n)return void i(b(n,t),b(e,this),b(f,this))}this._state=!0,this._value=t,g.call(this)}catch(e){f.call(this,e)}}function f(e){this._state=!1,this._value=e,g.call(this)}function g(){for(var e=0,t=this._deferreds.length;t>e;e++)d.call(this,this._deferreds[e]);this._deferreds=null}function h(e,t,n,i){this.onFulfilled="function"==typeof e?e:null,this.onRejected="function"==typeof t?t:null,this.resolve=n,this.reject=i}function i(e,t,n){var i=!1;try{e(function(e){i||(i=!0,t(e))},function(e){i||(i=!0,n(e))})}catch(e){if(i)return;i=!0,n(e)}}var n=setTimeout,s="function"==typeof setImmediate&&setImmediate||function(e){n(e,1)},r=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)};c.prototype.catch=function(e){return this.then(null,e)},c.prototype.then=function(e,t){var n=this;return new c(function(i,s){d.call(n,new h(e,t,i,s))})},c.all=function(){var e=Array.prototype.slice.call(1===arguments.length&&r(arguments[0])?arguments[0]:arguments);return new c(function(t,n){function d(s,r){try{if(r&&("object"==typeof r||"function"==typeof r)){var o=r.then;if("function"==typeof o)return void o.call(r,function(e){d(s,e)},n)}e[s]=r,0==--i&&t(e)}catch(e){n(e)}}if(0===e.length)return t([]);for(var i=e.length,s=0;s<e.length;s++)d(s,e[s])})},c.resolve=function(e){return e&&"object"==typeof e&&e.constructor===c?e:new c(function(t){t(e)})},c.reject=function(e){return new c(function(t,n){n(e)})},c.race=function(e){return new c(function(t,n){for(var i=0,s=e.length;s>i;i++)e[i].then(t,n)})},c._setImmediateFn=function(e){s=e},"undefined"!=typeof module&&module.exports?module.exports=c:t.Promise||(t.Promise=c)}(this),"undefined"!=typeof window&&"function"!=typeof window.CustomEvent&&function(){function CustomEvent(e,t){t=t||{bubbles:!1,cancelable:!1,detail:void 0};var n=document.createEvent("CustomEvent");return n.initCustomEvent(e,t.bubbles,t.cancelable,t.detail),n}CustomEvent.prototype=window.Event.prototype,window.CustomEvent=CustomEvent}(),"undefined"==typeof HTMLCanvasElement||HTMLCanvasElement.prototype.toBlob||Object.defineProperty(HTMLCanvasElement.prototype,"toBlob",{value:function(e,t,n){for(var i=atob(this.toDataURL(t,n).split(",")[1]),s=i.length,r=new Uint8Array(s),o=0;o<s;o++)r[o]=i.charCodeAt(o);e(new Blob([r],{type:t||"image/png"}))}});var e,t,n,i=["Webkit","Moz","ms"],s="undefined"!=typeof document?document.createElement("div").style:{},r=[1,8,3,6],o=[2,7,4,5];function vendorPrefix(e){if(e in s)return e;for(var t=e[0].toUpperCase()+e.slice(1),n=i.length;n--;)if((e=i[n]+t)in s)return e}function deepExtend(e,t){for(var n in e=e||{},t)t[n]&&t[n].constructor&&t[n].constructor===Object?(e[n]=e[n]||{},deepExtend(e[n],t[n])):e[n]=t[n];return e}function clone(e){return deepExtend({},e)}function dispatchChange(e){if("createEvent"in document){var t=document.createEvent("HTMLEvents");t.initEvent("change",!1,!0),e.dispatchEvent(t)}else e.fireEvent("onchange")}function css(e,t,n){if("string"==typeof t){var i=t;(t={})[i]=n}for(var s in t)e.style[s]=t[s]}function addClass(e,t){e.classList?e.classList.add(t):e.className+=" "+t}function setAttributes(e,t){for(var n in t)e.setAttribute(n,t[n])}function num(e){return parseInt(e,10)}function naturalImageDimensions(e,t){var n=e.naturalWidth,i=e.naturalHeight,s=t||getExifOrientation(e);if(s&&s>=5){var r=n;n=i,i=r}return{width:n,height:i}}t=vendorPrefix("transform"),e=vendorPrefix("transformOrigin"),n=vendorPrefix("userSelect");var a={translate3d:{suffix:", 0px"},translate:{suffix:""}},c=function(e,t,n){this.x=parseFloat(e),this.y=parseFloat(t),this.scale=parseFloat(n)};c.parse=function(e){return e.style?c.parse(e.style[t]):e.indexOf("matrix")>-1||e.indexOf("none")>-1?c.fromMatrix(e):c.fromString(e)},c.fromMatrix=function(e){var t=e.substring(7).split(",");return t.length&&"none"!==e||(t=[1,0,0,1,0,0]),new c(num(t[4]),num(t[5]),parseFloat(t[0]))},c.fromString=function(e){var t=e.split(") "),n=t[0].substring(Croppie.globals.translate.length+1).split(","),i=t.length>1?t[1].substring(6):1,s=n.length>1?n[0]:0,r=n.length>1?n[1]:0;return new c(s,r,i)},c.prototype.toString=function(){var e=a[Croppie.globals.translate].suffix||"";return Croppie.globals.translate+"("+this.x+"px, "+this.y+"px"+e+") scale("+this.scale+")"};var d=function(t){if(!t||!t.style[e])return this.x=0,void(this.y=0);var n=t.style[e].split(" ");this.x=parseFloat(n[0]),this.y=parseFloat(n[1])};function getExifOrientation(e){return e.exifdata&&e.exifdata.Orientation?num(e.exifdata.Orientation):1}function drawCanvas(e,t,n){var i=t.width,s=t.height,r=e.getContext("2d");switch(e.width=t.width,e.height=t.height,r.save(),n){case 2:r.translate(i,0),r.scale(-1,1);break;case 3:r.translate(i,s),r.rotate(180*Math.PI/180);break;case 4:r.translate(0,s),r.scale(1,-1);break;case 5:e.width=s,e.height=i,r.rotate(90*Math.PI/180),r.scale(1,-1);break;case 6:e.width=s,e.height=i,r.rotate(90*Math.PI/180),r.translate(0,-s);break;case 7:e.width=s,e.height=i,r.rotate(-90*Math.PI/180),r.translate(-i,s),r.scale(1,-1);break;case 8:e.width=s,e.height=i,r.translate(0,i),r.rotate(-90*Math.PI/180)}r.drawImage(t,0,0,i,s),r.restore()}function _create(){var i,s,r,o,a,h,l=this.options.viewport.type?"cr-vp-"+this.options.viewport.type:null;this.options.useCanvas=this.options.enableOrientation||_hasExif.call(this),this.data={},this.elements={},i=this.elements.boundary=document.createElement("div"),r=this.elements.viewport=document.createElement("div"),s=this.elements.img=document.createElement("img"),o=this.elements.overlay=document.createElement("div"),this.options.useCanvas?(this.elements.canvas=document.createElement("canvas"),this.elements.preview=this.elements.canvas):this.elements.preview=s,addClass(i,"cr-boundary"),i.setAttribute("aria-dropeffect","none"),a=this.options.boundary.width,h=this.options.boundary.height,css(i,{width:a+(isNaN(a)?"":"px"),height:h+(isNaN(h)?"":"px")}),addClass(r,"cr-viewport"),l&&addClass(r,l),css(r,{width:this.options.viewport.width+"px",height:this.options.viewport.height+"px"}),r.setAttribute("tabindex",0),addClass(this.elements.preview,"cr-image"),setAttributes(this.elements.preview,{alt:"preview","aria-grabbed":"false"}),addClass(o,"cr-overlay"),this.element.appendChild(i),i.appendChild(this.elements.preview),i.appendChild(r),i.appendChild(o),addClass(this.element,"croppie-container"),this.options.customClass&&addClass(this.element,this.options.customClass),function _initDraggable(){var e,i,s,r,o,a=this,d=!1;function assignTransformCoordinates(e,t){var n=a.elements.preview.getBoundingClientRect(),i=o.y+t,s=o.x+e;a.options.enforceBoundary?(r.top>n.top+t&&r.bottom<n.bottom+t&&(o.y=i),r.left>n.left+e&&r.right<n.right+e&&(o.x=s)):(o.y=i,o.x=s)}function toggleGrabState(e){a.elements.preview.setAttribute("aria-grabbed",e),a.elements.boundary.setAttribute("aria-dropeffect",e?"move":"none")}function mouseDown(t){if((void 0===t.button||0===t.button)&&(t.preventDefault(),!d)){if(d=!0,e=t.pageX,i=t.pageY,t.touches){var s=t.touches[0];e=s.pageX,i=s.pageY}toggleGrabState(d),o=c.parse(a.elements.preview),window.addEventListener("mousemove",mouseMove),window.addEventListener("touchmove",mouseMove),window.addEventListener("mouseup",mouseUp),window.addEventListener("touchend",mouseUp),document.body.style[n]="none",r=a.elements.viewport.getBoundingClientRect()}}function mouseMove(n){n.preventDefault();var r=n.pageX,c=n.pageY;if(n.touches){var d=n.touches[0];r=d.pageX,c=d.pageY}var u=r-e,h=c-i,l={};if("touchmove"===n.type&&n.touches.length>1){var p=n.touches[0],f=n.touches[1],m=Math.sqrt((p.pageX-f.pageX)*(p.pageX-f.pageX)+(p.pageY-f.pageY)*(p.pageY-f.pageY));s||(s=m/a._currentZoom);var g=m/s;return _setZoomerVal.call(a,g),void dispatchChange(a.elements.zoomer)}assignTransformCoordinates(u,h),l[t]=o.toString(),css(a.elements.preview,l),_updateOverlay.call(a),i=c,e=r}function mouseUp(){toggleGrabState(d=!1),window.removeEventListener("mousemove",mouseMove),window.removeEventListener("touchmove",mouseMove),window.removeEventListener("mouseup",mouseUp),window.removeEventListener("touchend",mouseUp),document.body.style[n]="",_updateCenterPoint.call(a),_triggerUpdate.call(a),s=0}a.elements.overlay.addEventListener("mousedown",mouseDown),a.elements.viewport.addEventListener("keydown",function keyDown(e){var i=37,d=38,u=39,h=40;if(!e.shiftKey||e.keyCode!==d&&e.keyCode!==h){if(a.options.enableKeyMovement&&e.keyCode>=37&&e.keyCode<=40){e.preventDefault();var l=function parseKeyDown(e){switch(e){case i:return[1,0];case d:return[0,1];case u:return[-1,0];case h:return[0,-1]}}(e.keyCode);o=c.parse(a.elements.preview),document.body.style[n]="none",r=a.elements.viewport.getBoundingClientRect(),function keyMove(e){var i=e[0],r=e[1],c={};assignTransformCoordinates(i,r),c[t]=o.toString(),css(a.elements.preview,c),_updateOverlay.call(a),document.body.style[n]="",_updateCenterPoint.call(a),_triggerUpdate.call(a),s=0}(l)}}else{var p;p=e.keyCode===d?parseFloat(a.elements.zoomer.value)+parseFloat(a.elements.zoomer.step):parseFloat(a.elements.zoomer.value)-parseFloat(a.elements.zoomer.step),a.setZoom(p)}}),a.elements.overlay.addEventListener("touchstart",mouseDown)}.call(this),this.options.enableZoom&&function _initializeZoom(){var n=this,i=n.elements.zoomerWrap=document.createElement("div"),s=n.elements.zoomer=document.createElement("input");function change(){(function _onZoom(n){var i=this,s=n?n.transform:c.parse(i.elements.preview),r=n?n.viewportRect:i.elements.viewport.getBoundingClientRect(),o=n?n.origin:new d(i.elements.preview);function applyCss(){var n={};n[t]=s.toString(),n[e]=o.toString(),css(i.elements.preview,n)}if(i._currentZoom=n?n.value:i._currentZoom,s.scale=i._currentZoom,i.elements.zoomer.setAttribute("aria-valuenow",i._currentZoom),applyCss(),i.options.enforceBoundary){var a=function _getVirtualBoundaries(e){var t=this._currentZoom,n=e.width,i=e.height,s=this.elements.boundary.clientWidth/2,r=this.elements.boundary.clientHeight/2,o=this.elements.preview.getBoundingClientRect(),a=o.width,c=o.height,d=n/2,u=i/2,h=-1*(d/t-s),l=-1*(u/t-r),p=1/t*d,f=1/t*u;return{translate:{maxX:h,minX:h-(a*(1/t)-n*(1/t)),maxY:l,minY:l-(c*(1/t)-i*(1/t))},origin:{maxX:a*(1/t)-p,minX:p,maxY:c*(1/t)-f,minY:f}}}.call(i,r),h=a.translate,l=a.origin;s.x>=h.maxX&&(o.x=l.minX,s.x=h.maxX),s.x<=h.minX&&(o.x=l.maxX,s.x=h.minX),s.y>=h.maxY&&(o.y=l.minY,s.y=h.maxY),s.y<=h.minY&&(o.y=l.maxY,s.y=h.minY)}applyCss(),u.call(i),_triggerUpdate.call(i)}).call(n,{value:parseFloat(s.value),origin:new d(n.elements.preview),viewportRect:n.elements.viewport.getBoundingClientRect(),transform:c.parse(n.elements.preview)})}function scroll(e){var t,i;if("ctrl"===n.options.mouseWheelZoom&&!0!==e.ctrlKey)return 0;t=e.wheelDelta?e.wheelDelta/1200:e.deltaY?e.deltaY/1060:e.detail?e.detail/-60:0,i=n._currentZoom+t*n._currentZoom,e.preventDefault(),_setZoomerVal.call(n,i),change.call(n)}addClass(i,"cr-slider-wrap"),addClass(s,"cr-slider"),s.type="range",s.step="0.0001",s.value="1",s.setAttribute("min","0"),s.setAttribute("max","1"),s.style.display=n.options.showZoomer?"":"none",s.setAttribute("aria-label","zoom"),n.element.appendChild(i),i.appendChild(s),n._currentZoom=.5,n.elements.zoomer.addEventListener("input",change),n.elements.zoomer.addEventListener("change",change),n.options.mouseWheelZoom&&(n.elements.boundary.addEventListener("mousewheel",scroll),n.elements.boundary.addEventListener("DOMMouseScroll",scroll))}.call(this),this.options.enableResize&&function _initializeResize(){var e,t,i,s,r,o,a,c=this,d=document.createElement("div"),u=!1,h=50;addClass(d,"cr-resizer"),css(d,{width:this.options.viewport.width+"px",height:this.options.viewport.height+"px"}),this.options.resizeControls.height&&(addClass(o=document.createElement("div"),"cr-resizer-vertical"),d.appendChild(o));this.options.resizeControls.width&&(addClass(a=document.createElement("div"),"cr-resizer-horisontal"),d.appendChild(a));function mouseDown(o){if((void 0===o.button||0===o.button)&&(o.preventDefault(),!u)){var a=c.elements.overlay.getBoundingClientRect();if(u=!0,t=o.pageX,i=o.pageY,e=-1!==o.currentTarget.className.indexOf("vertical")?"v":"h",s=a.width,r=a.height,o.touches){var d=o.touches[0];t=d.pageX,i=d.pageY}window.addEventListener("mousemove",mouseMove),window.addEventListener("touchmove",mouseMove),window.addEventListener("mouseup",mouseUp),window.addEventListener("touchend",mouseUp),document.body.style[n]="none"}}function mouseMove(n){var o=n.pageX,a=n.pageY;if(n.preventDefault(),n.touches){var u=n.touches[0];o=u.pageX,a=u.pageY}var l=o-t,p=a-i,f=c.options.viewport.height+p,m=c.options.viewport.width+l;"v"===e&&f>=h&&f<=r?(css(d,{height:f+"px"}),c.options.boundary.height+=p,css(c.elements.boundary,{height:c.options.boundary.height+"px"}),c.options.viewport.height+=p,css(c.elements.viewport,{height:c.options.viewport.height+"px"})):"h"===e&&m>=h&&m<=s&&(css(d,{width:m+"px"}),c.options.boundary.width+=l,css(c.elements.boundary,{width:c.options.boundary.width+"px"}),c.options.viewport.width+=l,css(c.elements.viewport,{width:c.options.viewport.width+"px"})),_updateOverlay.call(c),_updateZoomLimits.call(c),_updateCenterPoint.call(c),_triggerUpdate.call(c),i=a,t=o}function mouseUp(){u=!1,window.removeEventListener("mousemove",mouseMove),window.removeEventListener("touchmove",mouseMove),window.removeEventListener("mouseup",mouseUp),window.removeEventListener("touchend",mouseUp),document.body.style[n]=""}o&&(o.addEventListener("mousedown",mouseDown),o.addEventListener("touchstart",mouseDown));a&&(a.addEventListener("mousedown",mouseDown),a.addEventListener("touchstart",mouseDown));this.elements.boundary.appendChild(d)}.call(this)}function _hasExif(){return this.options.enableExif&&window.EXIF}function _setZoomerVal(e){if(this.options.enableZoom){var t=this.elements.zoomer,n=fix(e,4);t.value=Math.max(parseFloat(t.min),Math.min(parseFloat(t.max),n)).toString()}}function _updateCenterPoint(n){var i=this._currentZoom,s=this.elements.preview.getBoundingClientRect(),r=this.elements.viewport.getBoundingClientRect(),o=c.parse(this.elements.preview.style[t]),a=new d(this.elements.preview),u=r.top-s.top+r.height/2,h=r.left-s.left+r.width/2,l={},p={};if(n){var f=a.x,m=a.y,g=o.x,v=o.y;l.y=f,l.x=m,o.y=g,o.x=v}else l.y=u/i,l.x=h/i,p.y=(l.y-a.y)*(1-i),p.x=(l.x-a.x)*(1-i),o.x-=p.x,o.y-=p.y;var b={};b[e]=l.x+"px "+l.y+"px",b[t]=o.toString(),css(this.elements.preview,b)}function _updateOverlay(){if(this.elements){var e=this.elements.boundary.getBoundingClientRect(),t=this.elements.preview.getBoundingClientRect();css(this.elements.overlay,{width:t.width+"px",height:t.height+"px",top:t.top-e.top+"px",left:t.left-e.left+"px"})}}d.prototype.toString=function(){return this.x+"px "+this.y+"px"};var u=function debounce(e,t,n){var i;return function(){var s=this,r=arguments,o=function(){i=null,n||e.apply(s,r)},a=n&&!i;clearTimeout(i),i=setTimeout(o,t),a&&e.apply(s,r)}}(_updateOverlay,500);function _triggerUpdate(){var e,t=this.get();_isVisible.call(this)&&(this.options.update.call(this,t),this.$&&"undefined"==typeof Prototype?this.$(this.element).trigger("update.croppie",t):(window.CustomEvent?e=new CustomEvent("update",{detail:t}):(e=document.createEvent("CustomEvent")).initCustomEvent("update",!0,!0,t),this.element.dispatchEvent(e)))}function _isVisible(){return this.elements.preview.offsetHeight>0&&this.elements.preview.offsetWidth>0}function _updatePropertiesFromImage(){var n,i={},s=this.elements.preview,r=new c(0,0,1),o=new d;_isVisible.call(this)&&!this.data.bound&&(this.data.bound=!0,i[t]=r.toString(),i[e]=o.toString(),i.opacity=1,css(s,i),n=this.elements.preview.getBoundingClientRect(),this._originalImageWidth=n.width,this._originalImageHeight=n.height,this.data.orientation=_hasExif.call(this)?getExifOrientation(this.elements.img):this.data.orientation,this.options.enableZoom?_updateZoomLimits.call(this,!0):this._currentZoom=1,r.scale=this._currentZoom,i[t]=r.toString(),css(s,i),this.data.points.length?function _bindPoints(n){if(4!==n.length)throw"Croppie - Invalid number of points supplied: "+n;var i=n[2]-n[0],s=this.elements.viewport.getBoundingClientRect(),r=this.elements.boundary.getBoundingClientRect(),o={left:s.left-r.left,top:s.top-r.top},a=s.width/i,d=n[1],u=n[0],h=-1*n[1]+o.top,l=-1*n[0]+o.left,p={};p[e]=u+"px "+d+"px",p[t]=new c(l,h,a).toString(),css(this.elements.preview,p),_setZoomerVal.call(this,a),this._currentZoom=a}.call(this,this.data.points):function _centerImage(){var e=this.elements.preview.getBoundingClientRect(),n=this.elements.viewport.getBoundingClientRect(),i=this.elements.boundary.getBoundingClientRect(),s=n.left-i.left,r=n.top-i.top,o=s-(e.width-n.width)/2,a=r-(e.height-n.height)/2,d=new c(o,a,this._currentZoom);css(this.elements.preview,t,d.toString())}.call(this),_updateCenterPoint.call(this),_updateOverlay.call(this))}function _updateZoomLimits(e){var t,n,i,s,r=Math.max(this.options.minZoom,0)||0,o=this.options.maxZoom||1.5,a=this.elements.zoomer,c=parseFloat(a.value),d=this.elements.boundary.getBoundingClientRect(),u=naturalImageDimensions(this.elements.img,this.data.orientation),h=this.elements.viewport.getBoundingClientRect();this.options.enforceBoundary&&(i=h.width/u.width,s=h.height/u.height,r=Math.max(i,s)),r>=o&&(o=r+1);var l=fix(r,4);console.log("zoomer min:"),console.log(l),a.min=l,a.max=fix(o,4),!e&&(c<a.min||c>a.max)?_setZoomerVal.call(this,c<a.min?a.min:a.max):e&&(n=Math.max(d.width/u.width,d.height/u.height),t=null!==this.data.boundZoom?this.data.boundZoom:n,_setZoomerVal.call(this,t)),dispatchChange(a)}function _getCanvas(e){var t=e.points,n=num(t[0]),i=num(t[1]),s=num(t[2])-n,r=num(t[3])-i,o=e.circle,a=document.createElement("canvas"),c=a.getContext("2d"),d=e.outputWidth||s,u=e.outputHeight||r;a.width=d,a.height=u,e.backgroundColor&&(c.fillStyle=e.backgroundColor,c.fillRect(0,0,d,u));var h=n,l=i,p=s,f=r,m=0,g=0,v=d,b=u;return n<0&&(h=0,m=Math.abs(n)/s*d),p+h>this._originalImageWidth&&(v=(p=this._originalImageWidth-h)/s*d),i<0&&(l=0,g=Math.abs(i)/r*u),f+l>this._originalImageHeight&&(b=(f=this._originalImageHeight-l)/r*u),c.drawImage(this.elements.preview,h,l,p,f,m,g,v,b),o&&(c.fillStyle="#fff",c.globalCompositeOperation="destination-in",c.beginPath(),c.arc(a.width/2,a.height/2,a.width/2,0,2*Math.PI,!0),c.closePath(),c.fill()),a}function _bind(e,t){var n,i=this,s=[],r=null,o=_hasExif.call(i);if("string"==typeof e)n=e,e={};else if(Array.isArray(e))s=e.slice();else{if(void 0===e&&i.data.url)return _updatePropertiesFromImage.call(i),_triggerUpdate.call(i),null;n=e.url,s=e.points||[],r=void 0===e.zoom?null:e.zoom}return i.data.bound=!1,i.data.url=n||i.data.url,i.data.boundZoom=r,function loadImage(e,t){if(!e)throw"Source image missing";var n=new Image;return n.style.opacity="0",new Promise(function(i,s){function _resolve(){n.style.opacity="1",setTimeout(function(){i(n)},1)}n.removeAttribute("crossOrigin"),e.match(/^https?:\/\/|^\/\//)&&n.setAttribute("crossOrigin","anonymous"),n.onload=function(){t?EXIF.getData(n,function(){_resolve()}):_resolve()},n.onerror=function(e){n.style.opacity=1,setTimeout(function(){s(e)},1)},n.src=e})}(n,o).then(function(n){if(function _replaceImage(e){this.elements.img.parentNode&&(Array.prototype.forEach.call(this.elements.img.classList,function(t){e.classList.add(t)}),this.elements.img.parentNode.replaceChild(e,this.elements.img),this.elements.preview=e),this.elements.img=e}.call(i,n),s.length)i.options.relative&&(s=[s[0]*n.naturalWidth/100,s[1]*n.naturalHeight/100,s[2]*n.naturalWidth/100,s[3]*n.naturalHeight/100]);else{var r,o,a=naturalImageDimensions(n),c=i.elements.viewport.getBoundingClientRect(),d=c.width/c.height;a.width/a.height>d?r=(o=a.height)*d:(r=a.width,o=a.height/d);var u=(a.width-r)/2,h=(a.height-o)/2,l=u+r,p=h+o;i.data.points=[u,h,l,p]}i.data.orientation=e.orientation||1,i.data.points=s.map(function(e){return parseFloat(e)}),i.options.useCanvas&&function _transferImageToCanvas(e){var t=this.elements.canvas,n=this.elements.img;t.getContext("2d").clearRect(0,0,t.width,t.height),t.width=n.width,t.height=n.height,drawCanvas(t,n,this.options.enableOrientation&&e||getExifOrientation(n))}.call(i,i.data.orientation),_updatePropertiesFromImage.call(i),_triggerUpdate.call(i),t&&t()})}function fix(e,t){return parseFloat(e).toFixed(t||0)}function _get(){var e=this.elements.preview.getBoundingClientRect(),t=this.elements.viewport.getBoundingClientRect(),n=t.left-e.left,i=t.top-e.top,s=(t.width-this.elements.viewport.offsetWidth)/2,r=(t.height-this.elements.viewport.offsetHeight)/2,o=n+this.elements.viewport.offsetWidth+s,a=i+this.elements.viewport.offsetHeight+r,c=this._currentZoom;(c===1/0||isNaN(c))&&(c=1);var d=this.options.enforceBoundary?0:Number.NEGATIVE_INFINITY;return n=Math.max(d,n/c),i=Math.max(d,i/c),o=Math.max(d,o/c),a=Math.max(d,a/c),{points:[fix(n),fix(i),fix(o),fix(a)],zoom:c,orientation:this.data.orientation}}var h={type:"canvas",format:"png",quality:1},l=["jpeg","webp","png"];function _result(e){var t=this,n=_get.call(t),i=deepExtend(clone(h),clone(e)),s="string"==typeof e?e:i.type||"base64",r=i.size||"viewport",o=i.format,a=i.quality,c=i.backgroundColor,d="boolean"==typeof i.circle?i.circle:"circle"===t.options.viewport.type,u=t.elements.viewport.getBoundingClientRect(),p=u.width/u.height;return"viewport"===r?(n.outputWidth=u.width,n.outputHeight=u.height):"object"==typeof r&&(r.width&&r.height?(n.outputWidth=r.width,n.outputHeight=r.height):r.width?(n.outputWidth=r.width,n.outputHeight=r.width/p):r.height&&(n.outputWidth=r.height*p,n.outputHeight=r.height)),l.indexOf(o)>-1&&(n.format="image/"+o,n.quality=a),n.circle=d,n.url=t.data.url,n.backgroundColor=c,new Promise(function(e){switch(s.toLowerCase()){case"rawcanvas":e(_getCanvas.call(t,n));break;case"canvas":case"base64":e(function _getBase64Result(e){return _getCanvas.call(this,e).toDataURL(e.format,e.quality)}.call(t,n));break;case"blob":(function _getBlobResult(e){var t=this;return new Promise(function(n){_getCanvas.call(t,e).toBlob(function(e){n(e)},e.format,e.quality)})}).call(t,n).then(e);break;default:e(function _getHtmlResult(e){var t=e.points,n=document.createElement("div"),i=document.createElement("img");return width=t[2]-t[0],height=t[3]-t[1],addClass(n,"croppie-result"),n.appendChild(i),css(i,{left:-1*t[0]+"px",top:-1*t[1]+"px"}),i.src=e.url,css(n,{width:width+"px",height:height+"px"}),n}.call(t,n))}})}function _rotate(e){if(!this.options.useCanvas||!this.options.enableOrientation)throw"Croppie: Cannot rotate without enableOrientation && EXIF.js included";var t=this.elements.canvas;if(this.data.orientation=function getExifOffset(e,t){var n=r.indexOf(e)>-1?r:o,i=n.indexOf(e),s=t/90%n.length;return n[(n.length+i+s%n.length)%n.length]}(this.data.orientation,e),drawCanvas(t,this.elements.img,this.data.orientation),_updateCenterPoint.call(this,!0),_updateZoomLimits.call(this),Math.abs(e)/90%2==1){let e=this._originalImageHeight,t=this._originalImageWidth;this._originalImageWidth=e,this._originalImageHeight=t}}if("undefined"!=typeof window&&window.jQuery){var p=window.jQuery;p.fn.croppie=function(e){var t=typeof e;if("string"===t){var n=Array.prototype.slice.call(arguments,1),i=p(this).data("croppie");return"get"===e?i.get():"result"===e?i.result.apply(i,n):"bind"===e?i.bind.apply(i,n):this.each(function(){var t=p(this).data("croppie");if(t){var i=t[e];if(!p.isFunction(i))throw"Croppie "+e+" method not found";i.apply(t,n),"destroy"===e&&p(this).removeData("croppie")}})}return this.each(function(){var t=new Croppie(this,e);t.$=p,p(this).data("croppie",t)})}}function Croppie(e,t){if(e.className.indexOf("croppie-container")>-1)throw new Error("Croppie: Can't initialize croppie more than once");if(this.element=e,this.options=deepExtend(clone(Croppie.defaults),t),"img"===this.element.tagName.toLowerCase()){var n=this.element;addClass(n,"cr-original-image"),setAttributes(n,{"aria-hidden":"true",alt:""});var i=document.createElement("div");this.element.parentNode.appendChild(i),i.appendChild(n),this.element=i,this.options.url=this.options.url||n.src}if(_create.call(this),this.options.url){var s={url:this.options.url,points:this.options.points};delete this.options.url,delete this.options.points,_bind.call(this,s)}}return Croppie.defaults={viewport:{width:100,height:100,type:"square"},boundary:{},orientationControls:{enabled:!0,leftClass:"",rightClass:""},resizeControls:{width:!0,height:!0},customClass:"",showZoomer:!0,enableZoom:!0,enableResize:!1,mouseWheelZoom:!0,enableExif:!1,enforceBoundary:!0,enableOrientation:!1,enableKeyMovement:!0,update:function(){}},Croppie.globals={translate:"translate3d"},deepExtend(Croppie.prototype,{bind:function(e,t){return _bind.call(this,e,t)},get:function(){var e=_get.call(this),t=e.points;return this.options.relative&&(t[0]/=this.elements.img.naturalWidth/100,t[1]/=this.elements.img.naturalHeight/100,t[2]/=this.elements.img.naturalWidth/100,t[3]/=this.elements.img.naturalHeight/100),e},result:function(e){return _result.call(this,e)},refresh:function(){return function _refresh(){_updatePropertiesFromImage.call(this)}.call(this)},setZoom:function(e){_setZoomerVal.call(this,e),dispatchChange(this.elements.zoomer)},rotate:function(e){_rotate.call(this,e)},destroy:function(){return function _destroy(){this.element.removeChild(this.elements.boundary),function removeClass(e,t){e.classList?e.classList.remove(t):e.className=e.className.replace(t,"")}(this.element,"croppie-container"),this.options.enableZoom&&this.element.removeChild(this.elements.zoomerWrap),delete this.elements}.call(this)}}),Croppie}),define("format-converter",[],function(){return{base64ToBlob:function(e,t){t=t||"",e=e.replace(/^data:.*;base64,/,"");for(var n=window.atob(e),i=[],s=0,r=n.length;s<r;s+=1024){for(var o=n.slice(s,s+1024),a=new Array(o.length),c=0;c<o.length;c++)a[c]=o.charCodeAt(c);var d=new Uint8Array(a);i.push(d)}return new Blob(i,{type:t})}}}),define("text-utilities",[],function(){var e=function(){};return e.onKeyPress=function(e){var t=e.keyCode;if(9==t)return e.preventDefault(),this.insertTab(e.target),!1;if(e.shiftKey&&13==t)return!0;if(13!=t)return!0;if(!e.send||"function"!=typeof e.send)throw new Error("send function must be attached to event.");e.send()},e.insertTab=function(e){var t=e.selectionStart,n=e.selectionEnd,i=e.value.substring(0,t),s=e.value.substring(n);e.selectionStart=e.selectionEnd=t+1,e.value=i+"\t"+s},e.formatToHTML=function(t){return t=e.escapeHTML(t),t=e.insertLineBreaks(t),e.insertHTMLTabs(t)},e.escapeHTML=function(e){return e.replace(/[&<>"]/g,function(e){return{"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&apos;"}[e]||e})},e.insertLineBreaks=function(e){for(var t=e.split(/\n/gm),n="",i=0;i<t.length;i++)i<t.length-1?n+=t[i]+"<br>":n+=t[i];return n},e.insertHTMLTabs=function(e){for(var t=e.split(/\t/gm),n="",i=0;i<t.length&&(i!=t.length-1||""!=t[i]);i++)n+=t[i]+"    ";return n},e.wrapLinks=function(e,t){if(1==/iframe/.test(e))return e;let n=/((([A-Za-z]{3,9}:(?:\/\/)?)(?:[\-;:&=\+\$,\w]+@)?[A-Za-z0-9\.\-]+|(?:www\.|[\-;:&=\+\$,\w]+@)[A-Za-z0-9\.\-]+)((?:\/[\+~%\/\.\w\-_]*)?\??(?:[\-\+=&;%@\.\w_]*)#?(?:[\.\!\/\\\w]*))?)/;if(n.test(e)){var i=e.match(n)[0],s='<a target="_blank" class="'+t+'" href="'+i+'">'+i+"</a>";e=e.replace(i,s)}return e},e}),define("complementClick",["ko","jquery"],function(e,t){e.bindingHandlers.complementClick={init:function(e,n,i,s){var r=t(e);t(document).mouseup(function(e){if(t(e.target).closest(r).length>0)return!0;n()()})},update:function(e,t,n,i){}}}),define("sliderValue",["ko","jquery"],function(e,t){e.bindingHandlers.sliderValue={init:function(t,n,i,s,r){e.isObservable(n())&&t instanceof HTMLInputElement&&"range"===t.type&&t.addEventListener("input",function(){e.unwrap(n())!=t.value&&(n()(t.value),t.dispatchEvent(new Event("change")))})},update:function(t,n,i,s,r){e.isObservable(n())&&t instanceof HTMLInputElement&&"range"===t.type&&t.value!=e.unwrap(n())&&(t.value=e.unwrap(n()),t.dispatchEvent(new Event("input")))}}}),define("dispatcher/Dispatcher",[],function(){var e=[],t=0;return function(){this.reg=function(n,i){if(!n||"string"!=typeof n||n.length<2)throw new Error("name must be a non-empty string.");if(!i||"function"!=typeof i)throw new Error("callback must be a function.");var s=t;return e.push({name:n,callback:i,id:s}),t++,s},this.getCallback=function(t){for(var n=e,i=0;i<n.length;i++)if(n[i].name==t)return n[i].callback},this.getCallbackById=function(t){if(isNaN(t)||t<0)throw new Error("id must be a positive integer.");for(var n=e,i=0;i<n.length;i++)if(n[i].id==t)return n[i].callback},this.waitFor=function(t){for(var n=[],i=0;i<e.length;i++){var s=e[i];t==s.name&&n.push(s)}e=array.filter(function(e,n,i){return e.name==t}),n.forEach(function(t){e.unshift(t)})},this.dispatch=function(t,n){for(var i=0;i<e.length;i++)e[i].name==t&&e[i].callback(n)}}}),define("enterKey",["ko"],function(e){e.bindingHandlers.enterKey={init:function(e,t,n,i){var s=t();$(e).keypress(function(e){return 13!==(e.which?e.which:e.keyCode)||(s.call(i),!1)})}}}),define("RootViewModel",["ko","enterKey","jquery","complementClick"],function(e,t,n,i){return e.options.deferUpdates=!0,e.components.register("environment",{require:"environment/Component"}),e.components.register("auth",{require:"auth/AuthViewModel"}),e.components.register("forum-reply",{require:"forum-reply/Component"}),e.components.register("forum-poster",{require:"forum-poster/Component"}),e.components.register("forum-feed",{require:"forum-feed/Component"}),e.components.register("forum-stats",{require:"forum-stats/Component"}),e.components.register("session-tracker",{require:"session-tracker/Component"}),e.components.register("account-info",{require:"account-info/Component"}),e.components.register("punch-clock",{require:"punch-clock/Component"}),e.components.register("profile-setter",{require:"profile-setter/ViewModel"}),e.components.register("user-info",{require:"user-info/Component"}),e.components.register("profile-webcam",{require:"webcam/Component"}),e.components.register("permission-error",{require:"permission-error/Component"}),e.components.register("photo-controls",{require:"photo-controls/Component"}),e.components.register("new-user",{require:"new-user/Component"}),e.components.register("banner",{require:"banner/ViewModel"}),e.components.register("notification",{require:"notification/Component"}),e.components.register("search",{require:"search/Component"}),e.components.register("course-groups",{require:"course-groups/Component"}),e.components.register("course-reviews",{require:"course-reviews/Component"}),e.components.register("new-pal-list",{require:"new-pal-list/Component"}),e.components.register("pal-list",{require:"pal-list/Component"}),e.components.register("pal-request-list",{require:"pal-request-list/Component"}),e.components.register("class-list",{require:"class-list/Component"}),e.components.register("people-popups",{require:"people-popups/Component"}),e.components.register("course-features",{require:"course-features/Component"}),e.components.register("non-member-prompt",{require:"non-member-prompt/Component"}),e.components.register("in-another-section-prompt",{require:"in-another-section-prompt/Component"}),e.components.register("forum",{require:"forum/Component"}),e.components.register("course-settings",{require:"course-settings/Component"}),e.components.register("tab-selector",{require:"tab-selector/Component"}),e.components.register("course-docs",{require:"course-docs/container/Component"}),e.components.register("doc-list",{require:"doc-list/Component"}),e.components.register("doc-list-current",{require:"doc-list-current/Component"}),e.components.register("doc-uploader",{require:"doc-uploader/Component"}),e.components.register("doc-attr",{require:"doc-attr/Component"}),e.components.register("document-plans",{require:"document-plans/Component"}),e.components.register("credit-card-info",{require:"credit-card-info/Component"}),e.components.register("chat-widget",{require:"chat/ViewModel"}),e.components.register("blackboard",{require:"blackboard/ViewModel"}),e.components.register("right-panel",{require:"right-panel/Component"}),e.components.register("current-courses",{require:"right-panel/current-courses/Component"}),e.components.register("pre-view",{require:"right-panel/ad-views/pre-view/Component"}),e.components.register("lead-view",{require:"right-panel/ad-views/lead-view/Component"}),e.components.register("course-info",{require:"right-panel/course-info/Component"}),e.components.register("course-photos",{require:"right-panel/course-info/course-photos/Component"}),e.components.register("course-text-info",{require:"right-panel/course-info/text-info/Component"}),e.components.register("file-dropper",{require:"right-panel/file-dropper/Component"}),e.components.register("person-info",{require:"right-panel/person-info/Component"}),e.components.register("video-chat",{require:"video-chat/Component"}),e.components.register("incoming-call",{require:"video-chat/incoming-call/Component"}),e.components.register("tutoring-plans",{require:"tutoring-plans/Component"}),function RootViewModel(){}}),define("text!new-user/template.html",[],function(){return"<link rel=\"stylesheet\" href=\"./styles/components/new-user/style.css?v=1.0\"></link>\n<div id='new-user' class='background-dimmer'>\n\n  <div class='new-user-box' data-bind=\"visible:isFirstStep()\">\n    <div class='new-user-box-spacing'>Are you a York student?</div>\n    <button class=\"new-user-box-spacing\" data-bind='click:chooseYork'>Yes</button>\n    <button class='new-user-box-spacing' data-bind='click:chooseNonYork'>No</button>\n  </div>\n\n\n    <div class='new-user-box' data-bind=\"visible:isSecondStep()\">\n      Whats your major?\n      <input id='major-search-input' placeholder=\"Type your major\"></input>\n      <ul data-bind='foreach:majors'>\n      </li data-bind='text:name, click:$parent.selectMajor'></li>\n      </ul>\n    </div>\n\n</div>\n"}),define("abstract-interfaces/Store",[],function(){return function(){this.subs=[],this.onPubDone=null,this.pub=function(){this.subs.forEach(function(e){e()}),"function"==typeof this.onPubDone&&this.onPubDone()},this.pub=this.pub.bind(this),this.onPub=function(e){this.onPubDone=e},this.onPub=this.onPub.bind(this),this.getDis=function(){return this.dis},this.sub=function(e){this.subs.push(e)},this.getSubs=function(){return this.subs}}}),define("new-user/NewUserStore",["dispatcher/Dispatcher","abstract-interfaces/Store"],function(e,t){var n=null,i=function(){Object.setPrototypeOf(this,new t),this.dis=new e};return{getInstance:function(){return n||(n=new i),n},getNew:function(){return new i}}}),define("new-user/Component",["ko","text!new-user/template.html","dispatcher/Dispatcher","new-user/NewUserStore"],function(e,t,n,i){return{viewModel:function ViewModel(){this.dis=new n,this.store=i.getInstance(),this.majors=e.observableArray([{name:"Math"},{name:"Computer Science"}]),this.isVisible=e.observable(!1),this.isFirstStep=e.observable(!0),this.isSecondStep=e.observable(!1),this.onStore=function(){}.bind(this),this.store.sub(this.onStore),this.chooseYork=function(){}.bind(this),this.chooseNonYork=function(){}.bind(this),this.selectMajor=function(){}.bind(this)},template:t}}),define("RemoteService",["socketio","dispatcher/Dispatcher"],function(e,t){return function(){this.proto=Object.getPrototypeOf(this),this.io=e,this.sock=null,this.dis=new t,this._domain="",this.getConstructorName=function(){return"RemoteService"},this.isLive=function(){throw new Error("isLive() must be implemented in subclasses.")},this.getScheme=function(){return this._scheme},this.setScheme=function(e){this._scheme=e},this.getHost=function(){return this._host},this.setHost=function(e){this._host=e+"."},this.setMicroServer=function(e){e&&(this._microServer=e+".")},this.getMicroServer=function(){return this._microServer},this.setDomain=function(e){String(e).length<1?this._domain="":this._domain=e},this.getDomain=function(){return this._domain},this.setPath=function(e){String(e).length<1?this._path="":this._path="/"+e},this.getPath=function(){return this._path},this.setPort=function(e){String(e).length<1?this._port=e:this._port=":"+e},this.getPort=function(){return this._port},this.setSock=function(e){if(!this.sock){var t=this.getAccessToken(),n=this.getServerURL(),i={autoConnect:!0,reconnection:!0,query:{token:t}};this.sock=this.io(n,i),"function"==typeof e&&e()}},this.getServerURL=function(){return this.getScheme()+this.getHost()+this.getMicroServer()+this.getDomain()+this.getPort()+this.getPath()},this.setAuthorizationHeader=function(e){var t=this.getAccessToken();if(!t)throw new Error("accessToken must be set.");e.setRequestHeader("authorization",t)},this.setAuthorizationHeader=this.setAuthorizationHeader.bind(this),this.missingCookiesMessage="This site required cookies because it enables enhanced user experience.  Please change your browsers settings to allow cookies for this site.",this.getAccessToken=function(){try{var e=localStorage.getItem("accessToken");if(!e||e.length<=0)throw new Error("accessToken must be a non-empty string.");return e}catch(e){console.log(e)}}.bind(this),this.setAccessToken=function(e){try{localStorage.setItem("accessToken",e)}catch(e){alert(this.missingCookiesMessage)}},this.setAccessToken=this.setAccessToken.bind(this),this.setFakeToken=function(){this.setAccessToken("fakeToken")},this.deleteToken=function(){try{window.localStorage.removeItem("accessToken")}catch(e){alert(this.missingCookiesMessage)}},this.flatten=function(e){var t=Object.create(e);for(var n in t)t[n]=t[n];return t}}}),define("ActiveRemoteService",["RemoteService"],function(e){return function(){Object.setPrototypeOf(this,new e),this._scheme="http://",this._host="",this._microServer="",this._domain="localhost",this._port="",this._path="",this.isLive=function(){return!1},this.getConstructorName=function(){return"DevelopmentRemoteService"}}}),define("user/ProfileRemoteService",["ActiveRemoteService","format-converter","dispatcher/Dispatcher"],function(e,t,n){return function(){Object.setPrototypeOf(Object.getPrototypeOf(this),new e),this.setMicroServer("profile"),this.dis=new n,this.getProfileInfo=function(){var e=this,t=this.getServerURL()+"/getProfileInfo";$.ajax({url:t,type:"GET",cache:!1,contentType:"application/x-www-form-urlencoded; charset=UTF-8",beforeSend:this.setAuthorizationHeader,success:function(t){e.dis.dispatch("profileUpdate",e.setServerUrl(t))},error:function(e,t,n){console.log(n)}})},this.getProfileInfo=this.getProfileInfo.bind(this),this.onAuthChange=function(e){"authenticated"==e.state&&this.getProfileInfo()}.bind(this),this.onAuthId=this.dis.reg("authState",this.onAuthChange),this.setServerUrl=function(e){var t=this.getServerURL();return e.large_photo_url&&(e.large_photo_url=t+"/"+e.large_photo_url),e.small_photo_url&&(e.small_photo_url=t+"/"+e.small_photo_url),e},this.saveCroppedPhoto=function(e){if(!e||"string"!=typeof e||e.length<1)throw new Error("object of img must be passed as an argument.");var t=this.makeForm(e),n=this;$.ajax({url:this.getServerURL()+"/updatePhoto",type:"POST",cache:!1,contentType:!1,processData:!1,data:t,beforeSend:this.setAuthorizationHeader,success:function(){n.getProfileInfo()},error:function(e,t,i){console.log("No Face error?"),console.log(e),"NoFace"==e.responseText?n.dis.dispatch("updatePhotoNoFaceError"):n.onPhotoUploadError(i)}})},this.saveCroppedPhoto=this.saveCroppedPhoto.bind(this),this.saveCroppedPhotoId=this.dis.reg("saveCroppedPhoto",this.saveCroppedPhoto),this.registerOnPhotoUploadError=function(e){this.onPhotoUploadError=e},this.makeForm=function(e){var n=new FormData;if(e){var i=e,s=t.base64ToBlob(i,"image/png");n.append("image",s)}return n},this.saveMyInfo=function(e){var t=this.getServerURL()+"/saveMyInfo",n=this;$.ajax({url:t,beforeSend:this.setAuthorizationHeader,type:"POST",data:e,success:function(){n.getProfileInfo()},error:function(e,t,n){console.log(n)}})},this.saveMyInfo=this.saveMyInfo.bind(this),this.saveBdId=this.dis.reg("saveMyInfo",this.saveMyInfo),this.saveAboutMe=function(e){var t=this.getServerURL()+"/saveAboutMe";$.ajax({url:t,beforeSend:this.setAuthorizationHeader,type:"POST",data:{text:e},success:this.getProfileInfo,error:function(e,t,n){console.log(n)}})},this.saveAboutMe=this.saveAboutMe.bind(this),this.saveAboutId=this.dis.reg("aboutMe",this.saveAboutMe),this.setYearOfStudy=function(e){var t=this.getServerURL()+"/yearOfStudy/"+e;$.ajax({url:t,beforeSend:this.setAuthorizationHeader,type:"POST",success:this.getProfileInfo,error:function(e,t,n){console.log(n)}})}.bind(this),this.setYearId=this.dis.reg("selectYear",this.setYearOfStudy),this.getMajors=function(e){if(!e||"string"!=typeof e)throw new Error("input must be a non-empty string.");var t=this.getServerURL()+"/majors/"+e,n=this;$.ajax({url:t,type:"GET",beforeSend:this.setAuthorizationHeader,success:function(e){var t=JSON.parse(e);n.dis.dispatch("majors",t)},error:function(e){console.log(e)}})},this.getMajors=this.getMajors.bind(this),this.getMajorsId=this.dis.reg("getStudentMajors",this.getMajors),this.setMajorTo=function(e){var t=this.getServerURL()+"/major/"+e,n=this;$.ajax({url:t,type:"post",beforeSend:this.setAuthorizationHeader,success:function(){n.getProfileInfo()},error:function(e){console.log(e)}})},this.setMajorTo=this.setMajorTo.bind(this),this.selectMajorId=this.dis.reg("selectMajor",this.setMajorTo),this.recordProfileSetterOpened=function(){var e=this.getServerURL()+"/profile_setter_opened";$.ajax({url:e,type:"post",beforeSend:this.setAuthorizationHeader,success:function(){},error:function(e){console.log(e)}})},this._checkType=function(e){if("function"!=typeof e)throw new Error("callback needs to be a function.")}}}),
/**
 * @license Proprietary - Please do not steal our hard work.
 * @Author: Christopher H. Kerley
 * @Last modified time: 2019-08-24
 * @Copyright: Palolo Education Inc. 2020
 */
define("user/profile-setter/states/ProfileState",[],function(){var e=!0,t=!1,n=!1,i=!1,s=!1,r=!1,o=!1;t=!1;return function ProfileState(a,c){this.isVisible=function(){return e},this.isPhotoCropperVisible=function(){return t},this.isWebcamVisible=function(){return n},this.isSearchingMajors=function(){return i},this.majorsFound=function(){return!1},this.isSavingPhoto=function(){return s},this.isNewPhotoLoaded=function(){return r},this.isFaceErrorVisible=function(){return o},this.isPermissionErrorVisible=function(){return t},this.isSavingMyInfo=function(){return!1}}}),
/**
 * @license Proprietary - Please do not steal our hard work.
 * @Author: Christopher H. Kerley
 * @Last modified time: 2019-08-24
 * @Copyright: Palolo Education Inc. 2020
 */
define("user/profile-setter/states/ProfileNotVisible",["user/profile-setter/states/ProfileState"],function(e){return function ProfileNotVisible(){Object.setPrototypeOf(Object.getPrototypeOf(this),new e),this.isVisible=function(){return!1}}}),
/**
 * @license Proprietary - Please do not steal our hard work.
 * @Author: Christopher H. Kerley
 * @Last modified time: 2019-08-24
 * @Copyright: Palolo Education Inc. 2020
 */
define("user/profile-setter/states/PhotoCropperVisible",["user/profile-setter/states/ProfileState"],function(e){return function PhotoCropperVisible(t,n){Object.setPrototypeOf(Object.getPrototypeOf(this),new e),this.isPhotoCropperVisible=function(){return!0}}}),
/**
 * @license Proprietary - Please do not steal our hard work.
 * @Author: Christopher H. Kerley
 * @Last modified time: 2019-08-24
 * @Copyright: Palolo Education Inc. 2020
 */
define("user/profile-setter/states/SearchingMajors",["user/profile-setter/states/ProfileState"],function(e){return function SearchingMajors(t,n){Object.setPrototypeOf(Object.getPrototypeOf(this),new e),this.isSearchingMajors=function(){return!0},this.isPhotoCropperVisible=function(){return!0}}}),
/**
 * @license Proprietary - Please do not steal our hard work.
 * @Author: Christopher H. Kerley
 * @Last modified time: 2019-08-24
 * @Copyright: Palolo Education Inc. 2020
 */
define("user/profile-setter/states/WebcamVisible",["user/profile-setter/states/ProfileState"],function(e){return function WebcamVisible(t,n){Object.setPrototypeOf(Object.getPrototypeOf(this),new e),this.isWebcamVisible=function(){return!0}}}),
/**
 * @license Proprietary - Please do not steal our hard work.
 * @Author: Christopher H. Kerley
 * @Last modified time: 2019-08-24
 * @Copyright: Palolo Education Inc. 2020
 */
define("user/profile-setter/states/NewPhotoUploaded",["user/profile-setter/states/ProfileState"],function(e){return function NewPhotoUploaded(t,n){Object.setPrototypeOf(Object.getPrototypeOf(this),new e),this.isNewPhotoLoaded=function(){return!0},this.isPhotoCropperVisible=function(){return!0}}}),
/**
 * @license Proprietary - Please do not steal our hard work.
 * @Author: Christopher H. Kerley
 * @Last modified time: 2019-08-24
 * @Copyright: Palolo Education Inc. 2020
 */
define("user/profile-setter/states/SavingProfilePhoto",["user/profile-setter/states/ProfileState"],function(e){return function SavingProfilePhoto(t,n){Object.setPrototypeOf(Object.getPrototypeOf(this),new e),this.isSavingPhoto=function(){return!0}}}),
/**
 * @license Proprietary - Please do not steal our hard work.
 * @Author: Christopher H. Kerley
 * @Last modified time: 2019-08-24
 * @Copyright: Palolo Education Inc. 2020
 */
define("user/profile-setter/states/NoFaceError",["user/profile-setter/states/ProfileState"],function(e){return function NoFaceError(){Object.setPrototypeOf(Object.getPrototypeOf(this),new e),this.isFaceErrorVisible=function(){return!0}}}),
/**
 * @license Proprietary - Please do not steal our hard work.
 * @Author: Christopher H. Kerley
 * @Last modified time: 2019-08-24
 * @Copyright: Palolo Education Inc. 2020
 */
define("user/profile-setter/states/PermissionError",["user/profile-setter/states/ProfileState"],function(e){return function PermissionError(){Object.setPrototypeOf(Object.getPrototypeOf(this),new e),this.isPermissionErrorVisible=function(){return!0}}}),
/**
 * @license Proprietary - Please do not steal our hard work.
 * @Author: Christopher H. Kerley
 * @Last modified time: 2019-08-24
 * @Copyright: Palolo Education Inc. 2020
 */
define("user/profile-setter/states/SavingMyInfo",["user/profile-setter/states/ProfileState"],function(e){return function SavingProfilePhoto(t,n){Object.setPrototypeOf(Object.getPrototypeOf(this),new e),this.isSavingMyInfo=function(){return!0},this.isPhotoCropperVisible=function(){return!0}}}),define("user/profile-setter/states/MajorsFound",["user/profile-setter/states/ProfileState"],function(e){return function MajorsFound(t,n){Object.setPrototypeOf(Object.getPrototypeOf(this),new e),this.majorsFound=function(){return!0},this.isPhotoCropperVisible=function(){return!0}}}),define("user/profile-setter/ProfileStore",["user/ProfileRemoteService","dispatcher/Dispatcher","abstract-interfaces/Store","user/profile-setter/states/ProfileState","user/profile-setter/states/ProfileNotVisible","user/profile-setter/states/PhotoCropperVisible","user/profile-setter/states/SearchingMajors","user/profile-setter/states/WebcamVisible","user/profile-setter/states/NewPhotoUploaded","user/profile-setter/states/SavingProfilePhoto","user/profile-setter/states/NoFaceError","user/profile-setter/states/PermissionError","user/profile-setter/states/SavingMyInfo","user/profile-setter/states/MajorsFound"],function(e,t,n,i,s,r,o,a,c,d,u,h,l,p){new e;var f=null,m=function(){Object.setPrototypeOf(this,new n),this.currentState=new s,this.userInfo=null,this.newPhoto=null,this.dis=new t,this.majors=[],this.getUserInfo=function(){return this.userInfo},this.getMajors=function(){return this.majors},this.getProfilePhotoUrl=function(){return this.userInfo.large_photo_url},this.getNewPhoto=function(){return this.newPhoto},this.getCurrentState=function(){return this.currentState},this.onEvent=function(e){switch(e.action){case"showProfileSetter":this.currentState instanceof s&&(this.currentState=new r);break;case"hideProfileSetter":this.currentState instanceof i&&(this.currentState=new s);break;case"searchingMajors":this.currentState instanceof r&&(this.currentState=new o);break;case"showWebcam":(this.currentState instanceof r||this.currentState instanceof c)&&(this.currentState=new a);break;case"newImgUploaded":var t=this.currentState;(t instanceof r||t instanceof c)&&(this.newPhoto=e.photo,this.currentState=new c);break;case"majors":this.currentState instanceof o&&(console.log(e),this.majors=e.majors,this.currentState=new p);break;case"webcamCaptured":this.currentState instanceof a&&(this.newPhoto=e.photo,this.currentState=new c);break;case"saveProfilePhoto":this.currentState instanceof c&&(this.currentState=new d);break;case"noFaceErr":this.currentState instanceof d&&(this.currentState=new u);break;case"croppedPhotoSaved":this.currentState instanceof d&&(this.currentState=new r);break;case"closeNoFaceError":this.currentState instanceof u&&(this.currentState=new r);break;case"cameraPermissionError":this.currentState instanceof a&&(this.currentState=new h);break;case"acknowledgePermissionNeed":this.currentState instanceof h&&(this.currentState=new r);break;case"profileUpdate":this.userInfo=e.update,(this.currentState instanceof d||this.currentState instanceof l||this.currentState instanceof p)&&(this.currentState=new r);break;case"saveMyInfo":this.currentState instanceof r&&(this.currentState=new l);break;case"getStudentMajors":(this.currentState instanceof r||this.currentState instanceof p)&&(this.currentState=new o)}this.pub()},this.onEvent=this.onEvent.bind(this),this.applyAdapter=function(){var e=this;this.dis.reg("showProfileSetter",function(){e.onEvent({action:"showProfileSetter"})}),this.dis.reg("hideProfileSetter",function(){e.onEvent({action:"hideProfileSetter"})}),this.dis.reg("showWebcam",function(){e.onEvent({action:"showWebcam"})}),this.dis.reg("newImgUploaded",function(t){e.onEvent({action:"newImgUploaded",photo:t})}),this.dis.reg("webcamCaptured",function(t){e.onEvent({action:"webcamCaptured",photo:t})}),this.dis.reg("profileUpdate",function(t){e.onEvent({action:"profileUpdate",update:t})}),this.dis.reg("saveProfilePhoto",function(){e.onEvent({action:"saveProfilePhoto"})}),this.dis.reg("saveCroppedPhoto",function(t){e.onEvent({action:"saveCroppedPhoto",photo:t})}),this.dis.reg("updatePhotoNoFaceError",function(){e.onEvent({action:"noFaceErr"})}),this.dis.reg("closeNoFaceError",function(){e.onEvent({action:"closeNoFaceError"})}),this.dis.reg("croppedPhotoSaved",function(){e.onEvent({action:"croppedPhotoSaved"})}),this.dis.reg("majors",function(t){e.onEvent({action:"majors",majors:t})}),this.dis.reg("cameraPermissionError",function(){e.onEvent({action:"cameraPermissionError"})}),this.dis.reg("acknowledgePermissionNeed",function(){e.onEvent({action:"acknowledgePermissionNeed"})}),this.dis.reg("saveMyInfo",function(){e.onEvent({action:"saveMyInfo"})}),this.dis.reg("getStudentMajors",function(){e.onEvent({action:"getStudentMajors"})})},this.applyAdapter=this.applyAdapter.bind(this),this.applyAdapter(),this.setCurrentState=function(e){if(!(e instanceof i))throw new Error("state must be an instance of ProfileState");this.currentState=e}};return{getInstance:function(){return f||(f=new m),f},getNew:function(){return new m}}}),define("text!banner/template.html",[],function(){return'\n<link rel="stylesheet" href="./styles/components/banner/style.css?v=2.1"></link>\n\n\n  <div id="banner-holder"\n       data-bind=\'visible:isBannerVisible()\'\n       class="row .no-gutters">\n\n   <span id=\'hamberger-button\'\n         class=\'mobile-banner-button hidden-md hidden-lg glyphicon glyphicon-menu-hamburger\'\n         data-bind=\'click:openHambergerMenu\'>\n    </span>\n\n    <span id=\'mobile-search-button\'\n          class=\'mobile-banner-button hidden-md hidden-lg glyphicon glyphicon-search\'\n          data-bind=\'click:openSearch\'>\n    </span>\n\n    <span id=\'mobile-search-input-holder\'\n          data-bind=\'visible:isSearchVisible()\'\n          class=\'hidden-md hidden-lg background-dimmer\'>\n      <search id=\'mobile-search-bar\' data-bind=\'complementClick:closeSearch\'></search>\n    </span>\n\n    <span id=\'mobile-menu\' data-bind=\'visible:mobileMenuVisible(), complementClick:closeHambergerMenu\'>\n      <course-groups></course-groups>\n      <pal-list></pal-list>\n    </span>\n\n   <span id="you-button"\n         class=\'hidden-xs hidden-sm\'\n         data-bind="click:openProfileSetter">\n    <img id="profile-photo"\n         data-bind="style:{opacity: smallPhotoUrl().length > 0 ? \'1\' : \'0\'}, attr:{src:smallPhotoUrl()}"\n         src="./assets/no-photo.jpg">\n    </img>\n     <span id="users-name"\n           data-toggle="tooltip"\n           title="Your Reputation"\n           class="disable-select"\n           data-bind="text:usersName">\n     </span>\n   </span>\n\n   <notification></notification>\n\n\n    <img id="banner-logo"\n         class="disable-select"\n         src="./assets/banner_logo_grey.png">\n    </img>\n\n    <div id="banner_menu"\n         data-bind="complementClick: closeMenu">\n         <button id="banner-menu-btn"\n                 class="dropbtn"\n                 data-bind="click:toggleDropDown">\n\n                <i class="caret"></i>\n         </button>\n\n         <ul id="banner_menu_dropdown_content"\n             data-bind="visible:isMenuVisible">\n\n           <li class="banner_list_item"\n               data-bind="click:openCourseAdder, visible:isAdminButtonVisible()">\n               <button class="banner_menu_button">\n                       create group\n               </button>\n           </li>\n\n\n\n           <li class="banner_list_item"\n               data-bind="click:logOut">\n\n             <button id="logout-btn"\n                     class="banner_menu_button">\n                     Logout\n             </button>\n           </li>\n\n         </ul>\n    </div>\n\n\n\n\n\n  </div>\n'}),
/**
 * @license Proprietary - Please do not steal our hard work.
 * @Author: Christopher H. Kerley
 * @Last modified time: 2019-08-24
 * @Copyright: Palolo Education Inc. 2020
 */
define("banner/ViewModel",["ko","text!banner/template.html","jquery","dispatcher/Dispatcher","user/profile-setter/ProfileStore"],function(e,t,n,i,s){return{viewModel:function BannerViewModel(t,n){this.store=s.getInstance(),this.dis=new i,this.isBannerVisible=e.observable(!1),this.usersName=e.observable(""),this.smallPhotoUrl=e.observable(""),this.isMenuVisible=e.observable(!1),this.isAdminButtonVisible=e.observable(!1),this.isAdminVisible=e.observable(!1),this.mobileMenuVisible=e.observable(!1),this.isSearchVisible=e.observable(!1),this.openSearch=function(){this.isSearchVisible(!0)}.bind(this),this.closeSearch=function(e,t){return this.isSearchVisible(!1),t&&t.stopPropagation(),!1}.bind(this),this.openHambergerMenu=function(){this.mobileMenuVisible(!0)}.bind(this),this.closeHambergerMenu=function(){this.mobileMenuVisible(!1)}.bind(this),this.openAdminPanel=function(){this.isAdminVisible(!0),this.isMenuVisible(!1)},this.openCourseAdder=function(){this.dis.dispatch("openCourseAdder")},this.openProfileSetter=function(e,t){return this.dis.dispatch("showProfileSetter"),this.isMenuVisible(!1),!1},this.onAuth=function(e){"authenticated"==e.state?(this._isAuthenticated=!0,this.isBannerVisible(!0)):(this._isAuthenticated=!1,this.isBannerVisible(!1))}.bind(this),this.dis.reg("authState",this.onAuth),this.onStore=function(){var e=this.store.getUserInfo();if(e){this.isAdminButtonVisible("admin"==e.role),this.usersName(e.first+" "+e.last+", rep: "+e.rep);var t=e.small_photo_url;t?this.smallPhotoUrl(t+"?"+(new Date).getTime()):this.smallPhotoUrl("./assets/no-photo.jpg")}}.bind(this),this.store.sub(this.onStore),this.onUserInfoError=function(e){console.log(e)},this.onUserInfoError=this.onUserInfoError.bind(this),this.closeMenu=function(){this.isMenuVisible(!1)},this.closeMenu=this.closeMenu.bind(this),this.toggleDropDown=function(){!0===this.isMenuVisible()&&this.isMenuVisible(!1),this.isMenuVisible(!0)},this.toggleDropDown=this.toggleDropDown.bind(this),this.logOut=function(){this.dis.dispatch("logout")}},template:t}}),define("text!profile-setter/template.html",[],function(){return'\n<link rel="stylesheet" href="./styles/components/profile-setter/profile-setter.css?v=4.1"></link>\n<link rel="stylesheet" href="./styles/components/profile-setter/croppie.css?v=1.1"></link>\n\n  <div data-bind="visible:isVisible()"\n      class="background-dimmer">\n  </div>\n\n\n\n  <div class="window-holder"\n       data-bind="visible:isVisible(), complementClick: hideProfileSetter">\n\n       <div id="invalid-photo-error"\n             data-bind="visible:isFaceErrorVisible()">\n               <div>That photo kinda sucks..</div>\n               <div> How about a <i> good one </i> of you? </div>\n             <div>\n                   <button class="grey-flat-button"\n                           data-bind="click:closeErrorMessage">\n                           Okay\n                   </button>\n\n             </div>\n                  <small> (Preferably no nudes though.) </small>\n       </div>\n  <permission-error></permission-error>\n\n  <form id="profile-setter"\n        runat="server">\n\n    \x3c!-- LEFT SIDE --\x3e\n    <div id="profile-setter-left-side">\n\n      <div  class="profile-setter-spinner"\n            data-bind="visible:isSpinnerVisible()">\n        <div  class="screen-center-outer">\n         <div class="screen-center-inner">\n            <div class="loader"></div>\n         </div>\n       </div>\n      </div>\n\n      <div id="profile-img-holder"\n           data-bind="visible:isPhotoCropperVisible()">\n          <div id="img-uploader-preview-img">\n            <div id="no-photo-img"\n                  class="glyphicon glyphicon-camera"\n                  data-bind="visible:isLargeCameraButtonVisible(),click:webcamCapture">\n            </div>\n            <div id="missing-photo-message"\n                  data-bind="visible:isMissingPhoto()">\n                  <div>\n                      <div>upload your photo</div>\n                      <i id="missing-photo-arrow"\n                         class="glyphicon glyphicon-arrow-down">\n                       </i>\n                  </div>\n            </div>\n          </div>\n\n\n      </div>\n\n      <profile-webcam></profile-webcam>\n      <link rel="stylesheet" href="./styles/components/profile-setter/profile-videos.css?v=1.0"></link>\n      \x3c!-- <iframe class="profile-video"\n              width="560"\n              height="315"\n              src="https://www.youtube.com/embed/x0-UFKFHjU0"\n              frameborder="0"\n              allow="autoplay"\n              ></iframe> --\x3e\n      <photo-controls></photo-controls>\n    </div>\n\n\n    <user-info></user-info>\n  </form>\n</div>\n'}),
/**
 * @license Proprietary - Please do not steal our hard work.
 * @Author: Christopher H. Kerley
 * @Last modified time: 2019-08-24
 * @Copyright: Palolo Education Inc. 2020
 */
define("profile-setter/ViewModel",["ko","croppie","dispatcher/Dispatcher","text!profile-setter/template.html","jquery","user/profile-setter/ProfileStore"],function(e,t,n,i,s,r){return{viewModel:function ProfileSetterViewModel(i,o){this.store=r.getInstance(),this.dis=new n,this.isVisible=e.observable(!1),this.isFaceErrorVisible=e.observable(!1),this.isPhotoCropperVisible=e.observable(!1),this.isSpinnerVisible=e.observable(!1),this.photoURL=e.observable(""),this.isMissingPhoto=e.observable(!1),this.isLargeCameraButtonVisible=e.observable(!1),this._successHideFeedbackDelay=2e3,this._imageData=null,this.getCroppieHolder=function(){var e=s("#img-uploader-preview-img")[0];if(!e)throw new Error("Expected element with id = img-uploader-preview-img to exist in template.");return e},this.getCroppieHolder=this.getCroppieHolder.bind(this),this.injectStore=function(e){this.store=e},this.makeBox=function(e,t){this.replaceElementWithInputBox(t)},this.webcamCapture=function(){this.dis.dispatch("hidePhotoCropper")},this.closeErrorMessage=function(e,t){this.dis.dispatch("closeNoFaceError")},this.onStoreChanged=function(){var e=this.store.getCurrentState();let t=this.store.getUserInfo();this.isPhotoCropperVisible(e.isPhotoCropperVisible()),this.isVisible(e.isVisible()),this.isFaceErrorVisible(e.isFaceErrorVisible()),this.isSpinnerVisible(e.isSavingPhoto()),e.isNewPhotoLoaded()?(this.isPhotoCropperVisible(!0),this.photoURL(this.store.getNewPhoto()),this.refreshCroppie()):e.isSavingPhoto()?(this.saveCroppedPhoto(),this.isSpinnerVisible(!0)):t&&t.large_photo_url?(t.large_photo_url+="?"+(new Date).getTime(),this.photoURL(t.large_photo_url),this.refreshCroppie(),this.isLargeCameraButtonVisible(!1)):this.isMissingPhoto(!0)},this.onStoreChanged=this.onStoreChanged.bind(this),this.store.sub(this.onStoreChanged),this.refreshCroppie=function(){var e=this.photoURL();this.croppie&&this.croppie.destroy();try{if(e&&"string"==typeof e){var n=this.getCroppieHolder();this.croppie=new t(n,{viewport:{width:450,height:450},boundary:{width:"100%",height:"100%"},showZoomer:!1}),this.bindNewPhoto(e)}}catch(e){console.log(e)}},this.bindNewPhoto=function(e){var t={url:e,points:[0,0,0,0]};this.croppie.bind(t).then(this.setPhotoZoomToZero)},this.setPhotoZoomToZero=function(){this.croppie.setZoom(0)},this.setPhotoZoomToZero=this.setPhotoZoomToZero.bind(this),this.saveCroppedPhoto=function(){if(!this.photoURL())throw new Error("photoUrl observable has not been set!");var e=this;if(!this.croppie)throw new Error("Croppie has not been initialized.");this.croppie.result({type:"base64",size:"viewport"}).then(function(t){e.dis.dispatch("saveCroppedPhoto",t)}).catch(function(e){console.log(e)})},this.saveCroppedPhoto=this.saveCroppedPhoto.bind(this),this.hideProfileSetter=function(){this.dis.dispatch("hideProfileSetter")},this.hideProfileSetter=this.hideProfileSetter.bind(this)},template:i}}),define("text!user-info/template.html",[],function(){return'<div id="profile-setter-info-holder">\n  <div class="student-subject"\n       id="profile-setter-name"\n       data-bind="text:fullName()">\n  </div>\n  <div class="student-subject" id=\'year-and-major\'>\n    <span id="year"\n          data-bind="click:showYearOfStudyInput,\n                     visible:isYearOfStudyTextVisible(),\n                     text:yearOfStudy()">\n          1st\n    </span>\n    <input type=\'number\'\n           value=1\n           min=1\n           max=4\n           class=\'year-of-study\'\n           placeholder=\'Year\'\n           data-bind="visible:isYearOfStudyInputVisible(),\n                      hasFocus: isYearOfStudyInputFocused,\n                      value: yearOfStudyInput"/>\n    <span data-bind="click:showYearOfStudyInput">year,</span>\n\n    <span id="major-holder">\n        <span data-bind="visible:isMajorTextVisible(),\n                         click: showMajorInput,\n                         text:majorText">\n          Student\n        </span>\n        <input type=\'text\'\n               class=\'major\'\n               placeholder=\'Type Your Major\'\n               data-bind="visible:isMajorInputVisible(), hasFocus: isMajorInputFocused, textInput:partialMajor"/>\n\n        <ul class="major-search-results"\n            data-bind="foreach:suggestedMajors, complementClick:clearMajorResults, visible:suggestedMajors().length > 0">\n            <li class="major-search-result"\n                data-bind="text:major_name, click:$parent.selectSuggestedMajor">\n            </li>\n        </ul>\n      </span>\n      <div class="my-attr">\n        <label for="my-gender">Gender:</label>\n        <select class="my-attr-value"\n                data-bind="value:gender">\n                  <option value="0">female</option>\n                  <option value="1">male</option>\n                  <option value="2">other</option>\n        </select>\n      </div>\n      <div class="my-attr">\n\n        <div  data-bind="visible:isSpinnerVisible()"\n              class="screen-center-outer">\n         <div class="screen-center-inner">\n            <div class="small-spinner">\n            </div>\n         </div>\n\n       </div>\n        <label for="my-age">Birthday:</label>\n        <select id="birth-month"\n                data-bind="value:birthMonth"\n                class="my-attr-value" >\n          <option value="1">Jan</option>\n          <option value="2">Feb</option>\n          <option value="3">Mar</option>\n          <option value="4">Apr</option>\n          <option value="5">May</option>\n          <option value="6">Jun</option>\n          <option value="7">Jul</option>\n          <option value="8">Aug</option>\n          <option value="9">Sep</option>\n          <option value="10">Oct</option>\n          <option value="11">Nov</option>\n          <option value="12">Dec</option>\n        </select>\n\n      <input id="birth-day"\n             data-bind="value:birthDay"\n             class="my-attr-value"\n             type="number"\n             value="15"\n             min="1"\n             max="31">\n       </input>\n\n        <input\n           id="birth-year"\n           data-bind="value:birthYear"\n           class="my-attr-value"\n           type="number"\n           value="2004"\n           min="1900"\n           max="2015">\n       </input>\n\n       <div class="my-attr">\n         <label for="my-res">\n           Residence:\n         </label>\n\n        <select  id="my-res"\n                 class="my-attr-value"\n                 data-bind="options:residenceOptions,\n                            optionsText:\'name\',\n                            optionsValue:\'res_id\',\n                            value:selectedRes">\n        </select>\n       </div>\n\n       <div class="my-attr">\n         <label for="my-favourite-music">\n           Music:\n         </label>\n\n         <input type="text"\n                value="Favourite Musical Artist"\n                data-bind="textInput:favMusicArtist">\n          </input>\n       </div>\n\n      </div>\n\n\n  </div>\n\n  <textarea id="profile-about-me" data-bind="textInput:aboutMe">\n    About me.\n  </textarea>\n  <div id="profile-save-button-holder">\n    <button\n            class="profile-photo-button"\n            data-bind="click:saveMyInfo, visible:showSaveButton()">\n            save\n    </button>\n  </div>\n\n  \x3c!-- <div id="detailed-profile-info">\n\n    <div class="profile-info-row">\n        <span class=\'profile-info-label\'> hometown: </span>\n        <div class="profile-indented-input">\n          <input class="" type="text" placeholder="Country"></input>\n        </div>\n        <div class=\'profile-indented-input\'>\n          <input type="text" placeholder="City"></input>\n        </div>\n    </div>\n\n    <div class="profile-info-row">\n      <span class=\'profile-info-label\'> languages </span>\n      <div class=\'profile-indented-input\'>\n        <input type="text" placeholder="First Language"> </input>\n      </div>\n      <div class=\'profile-indented-input\'>\n        <input type="text" placeholder="Second Language"> </input>\n      </div>\n\n    </div>\n\n    <div class="profile-info-row">\n        <span class=\'profile-info-label\'> memberships </span>\n        <ul>\n          <li class="profile-group">MATH1300 M W 2020</li>\n          <li class="profile-group">EECS2030 L W 2020</li>\n        </ul>\n    </div>\n\n\n  </div> --\x3e\n</div>\n'}),
/**
 * @license Proprietary - Please do not steal our hard work.
 * @Author: Christopher H. Kerley
 * @Last modified time: 2019-08-24
 * @Copyright: Palolo Education Inc. 2020
 */
define("user-info/Component",["ko","dispatcher/Dispatcher","text!user-info/template.html","jquery","user/profile-setter/ProfileStore"],function(e,t,n,i,s){return{viewModel:function UserInfoViewModel(n,i){this.store=s.getInstance(),this.dis=new t,this.fullName=e.observable(""),this.yearOfStudy=e.observable("1st"),this.yearOfStudyInput=e.observable("1"),this.isYearOfStudyInputVisible=e.observable(!1),this.isYearOfStudyTextVisible=e.observable(!0),this.isYearOfStudyInputFocused=e.observable(!1),this.majorText=e.observable("Student"),this.isMajorInputVisible=e.observable(!1),this.isMajorInputFocused=e.observable(!1),this.isMajorTextVisible=e.observable(!0),this.partialMajor=e.observable(""),this.suggestedMajors=e.observableArray([]),this.isSpinnerVisible=e.observable(!1),this.gender=e.observable("female"),this.birthDay=e.observable("15"),this.birthMonth=e.observable("4"),this.birthYear=e.observable("2001"),this.residenceOptions=e.observable([]),this.selectedRes=e.observable(null),this.aboutMe=e.observable("About me"),this.showSaveButton=e.observable(!1),this.onProfileChange=function(){this.showSaveButton(!0)},this.onProfileChange=this.onProfileChange.bind(this),this.gender.subscribe(this.onProfileChange),this.birthDay.subscribe(this.onProfileChange),this.birthMonth.subscribe(this.onProfileChange),this.birthYear.subscribe(this.onProfileChange),this.aboutMe.subscribe(this.onProfileChange),this.selectedRes.subscribe(this.onProfileChange),this.favMusicArtist=e.observable("Favourite Musical Artist"),this.favMusicArtist.subscribe(this.onProfileChange),this.onStoreChange=function(){try{var e=this.store.getCurrentState();if(e.isSavingMyInfo()||e.isSearchingMajors())this.isSpinnerVisible(!0);else if(e.majorsFound())this.isSpinnerVisible(!1),this.suggestedMajors(this.store.getMajors());else{var t=this.store.getUserInfo();this.fullName(t.first+" "+t.last);var n=new Date(Date.parse(t.birthday));this.birthDay(n.getDate()),this.birthMonth(n.getMonth()+1),this.birthYear(n.getFullYear()),this.gender(t.sex),this.selectedRes(t.res),this.residenceOptions(t.res_arr),this.setYearOfStudyObservable(t.year_of_study),this.hideYearOfStudyInputField(),this.setMajor(t.major_name),this.aboutMe(t.about_me),this.favMusicArtist(t.music),this.isSpinnerVisible(!1)}this.showSaveButton(!1)}catch(e){console.log("## Something went wrong setting profile info ##"),console.log(e)}},this.onStoreChange=this.onStoreChange.bind(this),this.store.sub(this.onStoreChange),this.showYearOfStudyInput=function(){this.isYearOfStudyInputVisible(!0),this.isYearOfStudyInputFocused(!0),this.isYearOfStudyTextVisible(!1)},this.hideYearOfStudyInputField=function(){this.isYearOfStudyInputVisible(!1),this.isYearOfStudyTextVisible(!0)},this.onYearOfStudyLostFocus=function(e){if(!e){var t=this.yearOfStudyInput();this.dis.dispatch("selectYear",t)}},this.isYearOfStudyInputFocused.subscribe(this.onYearOfStudyLostFocus,this),this.setYearOfStudyObservable=function(e){switch(e=Number(e)){case 1:this.yearOfStudy("1st");break;case 2:this.yearOfStudy("2nd");break;case 3:this.yearOfStudy("3rd");break;case 4:this.yearOfStudy("4th");break;default:throw new Error("Bad Year.")}},this.showMajorInput=function(){this.isMajorInputVisible(!0),this.isMajorInputFocused(!0),this.isMajorTextVisible(!1),this.partialMajor("")},this.getMajors=function(e){e.length>0?this.dis.dispatch("getStudentMajors",e):this.suggestedMajors([])},this.partialMajor.subscribe(this.getMajors,this),this.selectSuggestedMajor=function(e,t){if(!e.major_id||isNaN(e.major_id))throw new Error("major_id is expected to be an attribute of majors.");var n=e.major_id;this.dis.dispatch("selectMajor",n),this.suggestedMajors([])},this.selectSuggestedMajor=this.selectSuggestedMajor.bind(this),this.setMajor=function(e){this.hideMajorInput(),this.majorText(e)},this.setMajor=this.setMajor.bind(this),this.hideMajorInput=function(){this.suggestedMajors([]),this.isMajorInputVisible(!1),this.isMajorTextVisible(!0)},this.clearMajorResults=function(){this.suggestedMajors([])},this.clearMajorResults=this.clearMajorResults.bind(this),this.saveMyInfo=function(e,t){t.preventDefault(),t.stopPropagation();var n=this.getProfileInfo();this.dis.dispatch("saveMyInfo",n)},this.saveMyInfo=this.saveMyInfo.bind(this),this.getProfileInfo=function(){var e=this.aboutMe(),t=this.gender(),n=this.birthMonth();return{a:e,g:t,d:this.birthDay(),m:n,y:this.birthYear(),r:this.selectedRes(),music:this.favMusicArtist()}},this.getProfileInfo=this.getProfileInfo.bind(this)},template:n}}),define("text!photo-controls/template.html",[],function(){return'\n<link rel="stylesheet"\n      href="./styles/components/profile-setter/profile-control-buttons.css?v=3.0">\n</link>\n\n<div id=\'profile-photo-buttons\'  data-bind="visible:isVisible()">\n\n  <label data-bind="click:webcamCapture"\n         class="profile-photo-button glyphicon glyphicon-camera">\n    <span class="profile-photo-upload-button">camera</span>\n  </label>\n\n\n\n  <label id=\'upload-profile-photo\'\n         class=\'profile-photo-button glyphicon glyphicon-open\'\n         for=\'img-upload-btn\'>\n          <span class="profile-photo-upload-button">upload</span>\n  </label>\n  <input type=\'file\'\n         id="img-upload-btn"\n         data-bind="event:{change:uploadPhoto}"\n         accept="image/*"/>\n\n\n  <label data-bind="click:saveProfilePhoto, visible:isSaveButtonVisible()"\n          class=\'profile-photo-button\'\n          id=\'save-profile-photo\'>\n          save\n  </label>\n</div>\n'}),
/**
 * @license Proprietary - Please do not steal our hard work.
 * @Author: Christopher H. Kerley
 * @Last modified time: 2019-08-24
 * @Copyright: Palolo Education Inc. 2020
 */
define("photo-controls/Component",["ko","dispatcher/Dispatcher","text!photo-controls/template.html","jquery","user/profile-setter/ProfileStore"],function(e,t,n,i,s){return{viewModel:function PhotoControlsViewModel(n,r){this.store=s.getInstance(),this.dis=new t,this.isVisible=e.observable(!1),this.isSaveButtonVisible=e.observable(!1),this.onStoreChange=function(){var e=this.store.getCurrentState();this.isVisible(e.isPhotoCropperVisible()),this.isSaveButtonVisible(e.isNewPhotoLoaded())},this.onStoreChange=this.onStoreChange.bind(this),this.store.sub(this.onStoreChange),this.webcamCapture=function(){this.dis.dispatch("showWebcam")},this.uploadPhoto=function(e,t){this.readUrl(t.currentTarget)},this.uploadPhoto=this.uploadPhoto.bind(this),this.readUrl=function(e){if(e.files&&e.files[0]){var t=e.files[0],n=new FileReader;this.inputElement=e,n.onload=this.onFileLoaded,n.readAsDataURL(t)}},this.readUrl=this.readUrl.bind(this),this.onFileLoaded=function(e){this.clearFileChooser(this.inputElement);var t=e.target.result;this.dis.dispatch("newImgUploaded",t)},this.onFileLoaded=this.onFileLoaded.bind(this),this.clearFileChooser=function(e){var t=i(e);t.wrap("<form>").closest("form").get(0).reset(),t.unwrap()},this.clearFileChooser=this.clearFileChooser.bind(this),this.saveProfilePhoto=function(){this.dis.dispatch("saveProfilePhoto")},this.saveProfilePhoto=this.saveProfilePhoto.bind(this)},template:n}}),define("text!profile-setter/view-models/webcam/template.html",[],function(){return'\n<link rel="stylesheet"\n      href="./styles/components/profile-setter/web-capture.css?v=3.1">\n</link>\n<div data-bind="visible:isVisible()" id="web-capture-holder">\n  <video id="profile-photo-player" autoplay></video>\n  <button id="take-photo-button" class="metal radial" data-bind="click:drawToCanvas"></button>\n  <canvas id="profile-photo-canvas" width=640 height=480></canvas>\n</div>\n'}),
/**
 * @license Proprietary - Please do not steal our hard work.
 * @Author: Christopher H. Kerley
 * @Last modified time: 2019-08-24
 * @Copyright: Palolo Education Inc. 2020
 */
define("webcam/Component",["ko","dispatcher/Dispatcher","text!profile-setter/view-models/webcam/template.html","user/profile-setter/ProfileStore"],function(e,t,n,i){return{viewModel:function WebcamCaptureViewModel(n,s){this.store=i.getInstance(),this.dis=new t,this.isVisible=e.observable(!1);const r=document.getElementById("profile-photo-player"),o=document.getElementById("profile-photo-canvas"),a={video:!0};this.getContext=function(){return o.getContext("2d")},this.getCanvas=function(){return o},this.onStoreChange=function(){this.store.getCurrentState().isWebcamVisible()?(this.isVisible(!0),this.attachVideoToVideoElement()):(this.isVisible(!1),this.stopCapture())},this.onStoreChange=this.onStoreChange.bind(this),this.store.sub(this.onStoreChange),this.drawToCanvas=function(){var e=this.getCanvas();this.getContext().drawImage(r,0,0,e.width,e.height);var t=e.toDataURL("image/jpeg",1);this.dis.dispatch("webcamCaptured",t),this.stopCapture()},this.drawToCanvas=this.drawToCanvas.bind(this),this.stopCapture=function(){const e=r.srcObject;e&&(e.getTracks().forEach(function(e){e.stop()}),r.srcObject=null)},this.attachVideoToVideoElement=function(e){this.getNavigatorReference().mediaDevices.getUserMedia(a).then(this.onCameraStarted).catch(this.onCameraError)},this.getNavigatorReference=function(){return navigator},this.onCameraStarted=function(e){r.srcObject=e},this.onCameraStarted=this.onCameraStarted.bind(this),this.onCameraError=function(e){/Permission/.test(e.message)&&this.dis.dispatch("cameraPermissionError")},this.onCameraError=this.onCameraError.bind(this)},template:n}}),define("text!permission-error/template.html",[],function(){return'<link rel="stylesheet"\n      href="./styles/components/profile-setter/permission-error.css?v=3.0">\n</link>\n\n<div id="permission-error-holder"\n    data-bind="visible:isVisible()">\n      <div>  We need your permission </div>\n      <div>  to turn on the camera </div>\n          <button data-bind="click:onOkay">\n            Okay I will change the settings\n          </button>\n          <button data-bind="click:onMaybeLater">\n                  Maybe later\n          </button>\n        <div>   </div>\n</div>\n'}),
/**
 * @license Proprietary - Please do not steal our hard work.
 * @Author: Christopher H. Kerley
 * @Last modified time: 2019-08-24
 * @Copyright: Palolo Education Inc. 2020
 */
define("permission-error/Component",["ko","dispatcher/Dispatcher","text!permission-error/template.html","user/profile-setter/ProfileStore"],function(e,t,n,i){return{viewModel:function PermissionErrorViewModel(n,s){this.store=i.getInstance(),this.dis=new t,this.isVisible=e.observable(!1),this.onStoreChange=function(){var e=this.store.getCurrentState().isPermissionErrorVisible();this.isVisible(e)},this.onStoreChange=this.onStoreChange.bind(this),this.store.sub(this.onStoreChange),this.onOkay=function(){this.dis.dispatch("acknowledgePermissionNeed")},this.onMaybeLater=function(){this.dis.dispatch("hideProfileSetter")}},template:n}}),define("abstract-interfaces/ValidObject",[],function(){return function(e,t){this.validateId=function(e){if(0==Number.isInteger(e)||e<0)throw new Error("id malformed")},this.validateStr=function(e){if("string"!=typeof e||e.length<1)throw new Error("must be a non-empty string")},this.validateBool=function(e){var t=Number(e);if(1!==t&&0!==t)throw new Error("must be 1 or 0")}}}),define("people-models/Person",["ko","abstract-interfaces/ValidObject"],function(e,t){var n=function(i,s){if(Object.getPrototypeOf(i)!==Object.prototype)throw new Error("Expected literal object!");Object.setPrototypeOf(this,new t),this.constructor=n,this.addable=!1,this.getConstructorName=function(){return"Person"},this.defaultPhotoURL="./assets/no-photo.jpg",this.smallPhotoURL=e.observable(this.defaultPhotoURL),this.largePhotoURL=e.observable(this.defaultPhotoURL),this.equals=function(e){return this.getId()===e.getId()},this.isPresent=function(){return!1},this.setId=function(e){this.validateId(e),this.id=e},this.setId(i.id),this.getId=function(){return this.id},this.setHost=function(e){this.validateStr(e),this.host=e}.bind(this),this.setHost(s),this.getHost=function(){return this.host},this.setFirst=function(e){this.validateStr(e),this.first=e}.bind(this),this.setFirst(i.first),this.setLast=function(e){this.validateStr(e),this.last=e}.bind(this),this.setLast(i.last),this.setDefaultPhotoURL=function(){this.smallPhotoURL(this.defaultPhotoURL),this.largePhotoURL(this.defaultPhotoURL)},this.getDefaultPhotoURL=function(){return this.defaultPhotoURL},this.getLargePhotoURL=function(){return this.largePhotoURL()},this.getRelativeLargePhotoURL=function(){return this.relativeLargePhotoURL},this.setLargePhotoURL=function(e){e&&"string"==typeof e&&e.length>0?(this.largePhotoURL(this.host+"/"+e),this.relativeLargePhotoURL=e):(this.largePhotoURL(this.defaultPhotoURL),this.relativeLargePhotoURL=this.defaultPhotoURL)},this.setLargePhotoURL(i.large_photo_url),this.setSmallPhotoURL=function(e){"string"!=typeof e||e.length<1?(this.smallPhotoURL(this.defaultPhotoURL),this.relativeSmallPhotoURL=this.defaultPhotoURL):(this.smallPhotoURL(this.host+"/"+e),this.relativeSmallPhotoURL=e)}.bind(this),this.setSmallPhotoURL(i.small_photo_url),this.getSmallPhotoURL=function(){return this.smallPhotoURL()},this.getRelativeSmallPhotoURL=function(){return this.relativeSmallPhotoURL},this.getFirst=function(){return this.first},this.getLast=function(){return this.last},this.getRole=function(){return this.role},this.setRole=function(e){this.validateStr(e),this.role=e}.bind(this),this.setRole(i.role),this.isAddable=function(){return this.addable}.bind(this),this.setAddable=function(e){this.addable=e},this.isReal=function(){return!0}};return n.getRaw=function(){return{id:2,first:"First",last:"Last",small_photo_url:"profile_images/485s.jpg",large_photo_url:"profile_images/485l.jpg",role:"Student"}},n.getDefaultPhotoURL=function(){return"./assets/no-photo.jpg"},n.getFake=function(){var e=n.getRaw();return new n(e,"https://www.profile.palolo.ca/")},n.getCopy=function(e){return new n({id:e.getId(),first:e.getFirst(),last:e.getLast(),role:e.getRole()},e.getHost())},n}),define("people-models/Classmate",["ko","people-models/Person"],function(e,t){var n=function(i,s){Object.setPrototypeOf(this,new t(i,s)),this.constructor=n,this.present=e.observable(!1),this.addable=!0,this.getConstructorName=function(){return"Classmate"},this.setActive=function(e){this.active=e},this.setActive(i.is_active),this.isActive=function(){return this.active},this.getLastSeen=function(){return this.lastLogin},this.setLastSeen=function(e){if("string"!=typeof e)throw new Error("last_login must be a string.");this.lastLogin=e},this.setLastSeen(i.last_login),this.setAge=function(e){if(0==Number.isInteger(e)||e<15)throw new Error("malformed age.");this.age=e},this.setAge(i.age),this.getAge=function(){return this.age},this.setRes=function(e){if("string"!=typeof e||e.length<1)throw new Error("malformed residence.");this.res=e},this.setRes(i.res),this.getRes=function(){return this.res},this.getFavouriteMusic=function(){return this.music},this.setFavouriteMusic=function(e){if(!e||"string"!=typeof e||e.length<1)throw new Error("music attribute is missing!");this.music=e},this.setFavouriteMusic(i.music),this.setScore=function(e){if(e<0||e>1)throw new Error("score must be between 0 and 1");this.score=e},this.setScore(i.score),this.getScore=function(){return this.score},this.isAddable=function(){return this.addable},this.setPresent=function(e){"boolean"==typeof e?this.present(e):this.present(!0)},this.setPresent(i.present),this.isPresent=function(){return this.present()},this.setAbsent=function(){this.present(!1)},this.setSharedClassCount=function(e){if(null==e)this.sharedClasses=0;else{if(!Number.isInteger(e)||e<0)throw new Error("count must be 0 or more.");this.sharedClasses=e}},this.setSharedClassCount(i.shared_classes),this.getSharedClassCount=function(){return this.sharedClasses},this.setMajor=function(e){this.major=e||"Student"},this.setMajor(i.major),this.getMajor=function(){return this.major},this.setYearOfStudy=function(e){this.yearOfStudy=e||1},this.setYearOfStudy(i.year_of_study),this.formatSchoolYear=function(e){switch(e){case 1:return"1st Year, ";case 2:return"2nd Year, ";case 3:return"3rd Year, ";case 4:return"4th Year, ";default:return"1st Year, "}},this.getEducationLevel=function(){return this.formatSchoolYear(this.yearOfStudy)+this.major},this.getYear=function(){return this.yearOfStudy}};return n.getCopy=function(e){return new n({id:e.id,first:e.first,last:e.last,role:e.role,age:e.age,res:e.res,music:e.music,present:e.present,small_photo_url:e.smallPhotoURL(),large_photo_url:e.largePhotoURL(),last_login:e.getLastSeen(),shared_classes:e.getSharedClassCount()},e.host)},n.getRaw=function(){var e=t.getRaw();return e.score=1,e.music="Nirvana",e.present=!0,e.last_login="1w",e.age=15,e.res="Vanier",e.is_pending_acceptance=!1,e.role="Student",e.shared_classes=0,e.is_active=1,e},n.getFake=function(){var e=n.getRaw();return new n(e,t.getFake().getHost())},n.getFake2=function(){var e=n.getRaw();return e.id=e.id+1,new n(e,t.getFake().getHost())},n}),define("people-models/Pal",["ko","people-models/Classmate"],function(e,t){var n=function(i,s){Object.setPrototypeOf(this,new t(i,s)),this.constructor=n,this.isNew=e.observable(!1),this.isInvitedToRoom=e.observable(!1),this.roomId=null,this.is_new=0,this.getConstructorName=function(){return"Pal"},this.unsetIsInvitedToRoom=function(){this.isInvitedToRoom(!1)},this.setIsInvitedToRoom=function(e){this.validateId(e),this.isInvitedToRoom(!0),this.roomId=e},this.getInvitedRoomId=function(){return this.roomId},this.setIsNew=function(e){if(0!=e&&1!=e)throw new Error("is_new must be 0 or 1.");1==e?(this.isNew(!0),this.is_new=1):(this.isNew(!1),this.is_new=0)},this.setIsNew(i.is_new),this.getRawNew=function(){return this.is_new},this.setAsNew=function(){this.isNew(!0),this.is_new=1},this.setAsOld=function(){this.isNew(!1)},this.isAddable=function(){return!1}};return n.getRaw=function(){var e=t.getRaw();return e.is_new=0,e},n.getFake=function(){var e=t.getRaw();e.is_new=0;return new n(e,"host")},n}),define("people-models/PersonCollection",["people-models/Classmate"],function(e){var t=function(e,n){this.getConstructorName=function(){return"PersonCollection"},this.col=[],this.isCollection=function(){return!0},this.clear=function(){this.col=[]},this.getOldPals=function(){var e=new t;return this.col.forEach(function(t){t.isNew&&0!=t.isNew()||e.add(t)}),e},this.getNewPals=function(){var e=new t;return this.col.forEach(function(t){t.isNew&&1==t.isNew()&&e.add(t)}),e},this.getPersonById=function(e){var t=null;return this.col.forEach(function(n){n.getId()!=e||(t=n)}),t}.bind(this),this.add=function(e){if("object"!=typeof e)throw new Error("Can only add objects to Person collection");if(this.contains(e))throw new Error("Duplicate entry");this.col.push(e),this.sortByPresence()}.bind(this),this.sortByPresence=function(){this.col.sort(function(e,t){return e.isPresent()&&!t.isPresent()?-1:!e.isPresent()&&t.isPresent()?1:0})},this.contains=function(e){for(var t=0;t<this.col.length;t++)if(this.col[t].equals(e))return!0;return!1}.bind(this),this.remove=function(e){for(var t=-1,n=0;n<this.col.length;n++)if(e.id==this.col[n].getId()){t=n;break}t>=0&&this.col.splice(n,1)}.bind(this),this.applyToMatch=function(e,t){if("object"!=typeof e||!e.getId)throw new Error("missing person arg.");if("function"!=typeof t)throw new Error("missing function arg.");this.col.forEach(function(n){n.getId()==e.getId()&&t(n)})},this.duplicate=function(e){if("object"!=typeof e||!e.getConstructorName||"PersonCollection"!==e.getConstructorName())throw new Error("Expected a PersonCollection");this.col=[];var t=e.toArray(),n=this;t.forEach(function(e){n.add(e)})}.bind(this),this.toArray=function(){return this.col},this.compare=function(e,t){var n=this.byScore(e,t),i=this.byPresence(e,t);return 0==i?n:i}.bind(this),this.byScore=function(e,t){return e.getScore()>t.getScore()?-1:e.getScore()<t.getScore()?1:e.getId()<t.getId()?-1:1}.bind(this),this.byPresence=function(e,t){return e.isPresent()&&!t.isPresent()?-1:!e.isPresent()&&t.isPresent()?1:0}.bind(this),this.getSize=function(){return this.col.length},this.get=function(e){return this.col[e]},this.equals=function(e){if(!e||!e.getConstructorName)return!1;if(this.getSize()!==e.getSize())return!1;for(var t=0;t<this.getSize();t++)if(0==this.col[t].equals(e.get(t)))return!1;return!0}};return t.getFake=function(){var n=e.getFake(),i=e.getFake();i.setId(i.getId()+1);var s=new t;return s.add(n),s.add(i),s},t}),define("people-store/PeopleRemoteService",["socketio","ActiveRemoteService","dispatcher/Dispatcher","people-models/Person","people-models/Pal","people-models/Classmate","people-models/PersonCollection"],function(e,t,n,i,s,r,o){var a=null,c=function(){Object.setPrototypeOf(this,new t),this.setMicroServer("friends"),this.constructor=c,this.dis=new n,this.REFRESH_RATE=5e3,this.getConstructorName=function(){return"PeopleRemoteService"},this.init=function(){this.setSock(this.onSock)}.bind(this),this.onSock=function(){this.sock.on("connect",this.getPalList),this.sock.on("connect",this.getPalRequestList),this.sock.on("palList",this.onPalList),this.sock.on("palRequestSent",this.onPalRequestSent),this.sock.on("palRequestReceived",this.onPalRequestRecieved),this.sock.on("palRequestList",this.onPalRequestList),this.sock.on("palRequestAccepted",this.onPalRequestAccepted),this.sock.on("classList",this.onClassList),this.sock.on("io_error",this.onError)}.bind(this),this.onAuth=function(e){e&&"authenticated"==e.state&&this.init()},this.onAuth=this.onAuth.bind(this),this.dis.reg("authState",this.onAuth),this.onError=function(e){console.log("Something went wrong on the relationship server."),alert(e)},this.onError=this.onError.bind(this),this.getPalList=function(){this.sock.emit("getPalList");var e=this;e.timerId=setTimeout(function(){e.getPalList()},e.REFRESH_RATE)},this.getPalList=this.getPalList.bind(this),this.onPalList=function(e){var t=this.getServerURL(),n=new o;e.forEach(function(e){n.add(new s(e,t))}),this.dis.dispatch("palList",n)}.bind(this),this.onGroupInfo=function(e){this.init(),this.sock.emit("getClassList",e.getId());var t=this;"number"==typeof this.getClassTimerId&&clearTimeout(this.getClassTimerId),this.getClassTimerId=setTimeout(function(){t.onGroupInfo(e)},t.REFRESH_RATE)},this.onGroupInfo=this.onGroupInfo.bind(this),this.onGroupInfoId=this.dis.reg("groupInfo",this.onGroupInfo),this.onClassList=function(e){var t=new o,n=this.getServerURL();e.forEach(function(e){t.add(new r(e,n))}),this.dis.dispatch("classList",t)}.bind(this),this.recordFriendClick=function(e){this.sock.emit("recordFriendClick",this.flatten(e))}.bind(this),this.focusPersonId=this.dis.reg("focusPerson",this.recordFriendClick),this.onAddPal=function(e){this.sock.emit("addPal",this.flatten(e))}.bind(this),this.addPalId=this.dis.reg("addPal",this.onAddPal),this.onPalRequestSent=function(e){e=r.getCopy(e);this.dis.dispatch("palRequestSent",e)},this.onPalRequestSent=this.onPalRequestSent.bind(this),this.onPalRequestRecieved=function(e){var t=new r(e,this.getServerURL());this.dis.dispatch("palRequestReceived",t)},this.onPalRequestRecieved=this.onPalRequestRecieved.bind(this),this.acceptRequest=function(e){this.sock.emit("acceptPalRequest",e)},this.acceptRequest=this.acceptRequest.bind(this),this.acceptRequestId=this.dis.reg("acceptRequest",this.acceptRequest),this.onPalRequestAccepted=function(e){var t=this.getServerURL(),n=new s(e,t);n.setAsNew(),this.dis.dispatch("palRequestAccepted",n)},this.onPalRequestAccepted=this.onPalRequestAccepted.bind(this),this.getPalRequestList=function(){this.sock.emit("getPalRequestList");var e=this;e.palRequestTimerId=setTimeout(function(){e.getPalRequestList()},e.REFRESH_RATE)},this.getPalRequestList=this.getPalRequestList.bind(this),this.onPalRequestList=function(e){var t=[],n=this.getServerURL();e.forEach(function(e){var s=new i(e,n);t.push(s)}),this.dis.dispatch("palRequestList",t)},this.onPalRequestList=this.onPalRequestList.bind(this),this.onDenyRequest=function(e){this.sock.emit("denyRequest",e)},this.onDenyRequest=this.onDenyRequest.bind(this),this.denyRequestId=this.dis.reg("denyRequest",this.onDenyRequest)};return{getInstance:function(){return a||(a=new c),a},getNew:function(){return new c}}}),define("people-models/NullPerson",["people-models/Person","ko"],function(e,t){var n=function(t){var i=e.getFake();Object.setPrototypeOf(Object.getPrototypeOf(this),i),this.constructor=n,this.getConstructorName=function(){return"NullPerson"},this.getId=function(){return-1},this.isNew=function(){return!1},this.isReal=function(){return!1},this.getLastSeen=function(){return""}};return n}),define("people-models/PendingPal",["people-models/Classmate"],function(e){var t=function(e){Object.setPrototypeOf(this,e),this.constructor=t,this.isAddable=function(){return!1}};return t.build=function(e){return new t(e)},t}),define("people-store/PeopleStore",["dispatcher/Dispatcher","abstract-interfaces/Store","people-store/PeopleRemoteService","people-models/Pal","people-models/NullPerson","people-models/PendingPal","people-models/PersonCollection"],function(e,t,n,i,s,r,o){var a=null,c=function(){Object.setPrototypeOf(this,new t),this.dis=new e,this.remote=n.getInstance(),this.newPalList=new o,this.palList=new o,this.palRequests=[],this.classList=new o,this.classListVisible=!1,this.focusedPerson=new s,this.isPalRequestSentVisible=!1,this.lastPalRequested=null,this.spinnerOn=!0,this.onAddPal=function(){this.focusedPerson=r.build(this.focusedPerson),this.showPalRequestSent(),this.pub()}.bind(this),this.addPalId=this.dis.reg("addPal",this.onAddPal),this.getFocusedPerson=function(){return this.focusedPerson},this.getPalCount=function(){return this.palList.getSize()},this.getDis=function(){return this.dis},this.getPalList=function(){return this.palList.getOldPals()},this.getClassList=function(){return this.classList},this.getPalRequests=function(){return this.palRequests},this.onPalList=function(e){if(!e||!e.isCollection||!e.isCollection())throw new Error("Expected a collection instance.");this.palList=e,this.updateFocusedPerson(),this.spinnerOn=!1,this.pub()}.bind(this),this.onPalsId=this.dis.reg("palList",this.onPalList),this.isSpinnerVisible=function(){return this.spinnerOn},this.getNewPals=function(){return this.palList.getNewPals()},this.updateFocusedPerson=function(){var e=this.getFocusedPerson(),t=this.palList.getPersonById(e.getId());t&&e.isPresent()!=t.isPresent()&&(this.focusedPerson=t,this.dis.dispatch("updateFocusPerson",this.focusedPerson))}.bind(this),this.onClassList=function(e){this.palList.toArray().forEach(function(t){e.applyToMatch(t,function(e){e.setAddable(!1)})}),this.classList.duplicate(e),this.pub()}.bind(this),this.onClassListId=this.dis.reg("classList",this.onClassList),this.isClassListVisible=function(){return this.classListVisible}.bind(this),this.setFocusedPerson=function(e){this.focusedPerson=e},this.onFocusPerson=function(e){this.focusedPerson=e,this.onAcknowledgeNewPal(e),this.pub()}.bind(this),this.onFocusPersonId=this.dis.reg("focusPerson",this.onFocusPerson),this.onAcknowledgeNewPal=function(e){"Pal"==e.constructor.name&&this.palList.applyToMatch(e,function(e){e.setAsOld()})}.bind(this),this.getFocusedPerson=function(){return this.focusedPerson},this.onShowClassList=function(e){this.classListVisible="classList"==e,this.pub()}.bind(this),this.showClassListId=this.dis.reg("courseFeatureSelection",this.onShowClassList),this.onHideClassList=function(){this.classListVisible=!1,this.pub()}.bind(this),this.hideClassListId=this.dis.reg("hideClassList",this.onHideClassList),this.onGrpInfo=function(e){e.getId()!=this.currentGrpId&&this.setNoPerson()}.bind(this),this.onGrpInfoId=this.dis.reg("groupInfo",this.onGrpInfo),this.setNoPerson=function(){this.focusedPerson=new s,this.pub()}.bind(this),this.dis.reg("openNews",this.setNoPerson),this.onShowGroupView=function(){this.focusedPerson=new s,this.pub()}.bind(this),this.showGroupId=this.dis.reg("showGroupView",this.onShowGroupView),this.isPalRequestSent=function(){return this.isPalRequestSentVisible}.bind(this),this.lastPalRequestPal=function(){return this.lastPalRequested}.bind(this),this.onPalRequestSent=function(e){this.lastPalRequested=e,this.classList.remove(e),this.focusedPerson.getId()==e.getId()&&(this.focusedPerson=r.build(this.focusedPerson)),this.showPalRequestSent(),this.pub()}.bind(this),this.palRequestSentId=this.dis.reg("palRequestSent",this.onPalRequestSent),this.showPalRequestSent=function(){var e=this;this.isPalRequestSentVisible=!0,this.timerId=setTimeout(function(){e.isPalRequestSentVisible=!1,e.pub()},3e3)}.bind(this),this.onPalRequestReceived=function(e){this.palRequests.push(e),this.pub()}.bind(this),this.palRequestReceivedId=this.dis.reg("palRequestReceived",this.onPalRequestReceived),this.onPalRequestAccepted=function(e){this.palList.add(e),this.pub()}.bind(this),this.onRequestAcceptedId=this.dis.reg("palRequestAccepted",this.onPalRequestAccepted),this.getPalRequestList=function(){return this.palRequests},this.addPal=function(e){e instanceof i&&this.palList.push(e)},this.addPal=this.addPal,this.onPalRequestList=function(e){this.palRequests=e,this.pub()},this.onPalRequestList=this.onPalRequestList.bind(this),this.dis.reg("palRequestList",this.onPalRequestList),this.onAcceptRequest=function(e){var t=this.findPalRequest(e);if(t>=0){var n=this.palRequests.splice(t,1);this.palList.add(n),this.pub()}},this.onAcceptRequest=this.onAcceptRequest.bind(this),this.acceptRequestId=this.dis.reg("acceptRequest",this.onAcceptRequest),this.onDenyRequest=function(e){var t=this.findPalRequest(e);t>=0&&(this.palRequests.splice(t,1),this.pub())},this.onDenyRequest=this.onDenyRequest.bind(this),this.denyRequestId=this.dis.reg("denyRequest",this.onDenyRequest),this.findPalRequest=function(e){for(var t=this.palRequests,n=-1,i=0;i<t.length;i++)if(t[i].getId()==e.getId()){n=i;break}return n},this.findPalRequest=this.findPalRequest.bind(this)};return{getInstance:function(){return a||(a=new c),a},getNew:function(){return new c}}}),define("text!notification/template.html",[],function(){return'\n<link rel="stylesheet"\n      href="./styles/components/notification/style.css?v=2.0"></link>\n\n  <div id="notification-holder" data-bind="visible:isVisible()">\n\n    <span class="glyphicon glyphicon-bell"\n          data-bind="click:openNotifications">\n\n      <span id="notification-bell-count"\n            class="notification-number-background"\n            data-bind="visible:computeUnseenCount() > 0">\n            <span  class="notification-number"\n                    data-bind="text:computeUnseenCount()">\n            </span>\n      </span>\n    </span>\n\n\n    <span data-bind="visible:isNotifcationsOpen()">\n      <span class="arrow-up notifications-arrow-up"></span>\n\n      <ul id="notification-list"\n          data-bind="foreach:notifications,\n                     complementClick: closeNotifications">\n\n            <li class="notification-row"\n                data-bind="css:{\'notification-seen\':getHasBeenSeen()}, click:$parent.onNotificationClicked">\n              <img  class="notification-profile-image"\n                    data-toggle="tooltip"\n                    data-bind="attr:{ src : getPhotoURL(), title : getFirstName() + \' \' + getLastName() }">\n              </img>\n              <span class="notification-content-holder">\n                <div class=\'notification-content\'\n                      data-bind="text:messageSnippet()">\n                </div>\n                <div class="notification-date">\n                    <span>Sent </span>\n                    <span data-bind="text:getMessageTimestamp()"></span>\n                    <span data-bind="visible:getConstructorName() === \'ForumNotification\'">\n                      \x3c!-- <span data-bind="text:getForumName()"></span> --\x3e\n                    </span>\n                </div>\n\n              </span>\n            </li>\n      </ul>\n\n\n    </span>\n\n  </div>\n'}),define("notification/models/Notification",["ko","people-models/Person"],function(e,t){return function Notification(n,i){this._hasBeenSeen=e.observable(!1),this.messageSnippet=e.observable(""),this.person=new t(n,i),this.getPerson=function(){return this.person},this.getFirstName=function(){return this.person.getFirst()},this.getLastName=function(){return this.person.getLast()},this.getPhotoURL=function(){return this.person.getSmallPhotoURL()+"?="+Date.now()},this.getPhotoURL=this.getPhotoURL.bind(this),this._isValidString=function(e){if(!e||"string"!=typeof e||e.length<1)throw new Error("attribute must be a non-empty string.")},this.getMessageId=function(){return this.id},this.setMessageId=function(e){if(!e||0==Number.isInteger(e)||e<1)throw new Error("message_id must be a positive integer.");this.id=e},this.setMessageId(n.message_id),this.setHost=function(e){this._isValidString(e),this._host=e},this.setHost(i),this.getHost=function(){return this._host},this.setMessageSnippet=function(e){this._isValidString(e),this.messageSnippet(e)},this.setMessageSnippet=this.setMessageSnippet.bind(this),this.setMessageSnippet(n.text),this.setMessageTimetamp=function(e){this._isValidString(e),this._timestamp=e},this.setMessageTimetamp(n.timestamp),this.getMessageTimestamp=function(){return this._timestamp},this.setHasBeenSeen=function(){this._hasBeenSeen(!0)},this.setSeenTo=function(e){if("number"!=typeof e||0!=e&&1!=e)throw new Error("seen must be 0 or 1.");1==e?this._hasBeenSeen(!0):this._hasBeenSeen(!1)},this.setSeenTo(n.seen),this.getHasBeenSeen=function(){return this._hasBeenSeen()}}}),define("notification/NotificationRemoteService",["ActiveRemoteService","socketio","dispatcher/Dispatcher","notification/models/Notification"],function(e,t,n,i){return function(){Object.setPrototypeOf(this,new e),this.setMicroServer("notifications"),this._io=t,this.dis=new n,this.initialize=function(){this.setSock()},this.connect=function(){this.sock&&this.sock.connect()},this.registerOnNotificationsUpdate=function(e){this._checkType(e),this.sock.on("notifications",e)},this.setChatMsgNotifSeen=function(e){if(e instanceof i==0)throw new Error("notif must be a Notification.");this.sock.emit("chatNotifSeen",{senderId:e.getPerson().getId()})},this._checkType=function(e){if("function"!=typeof e)throw new Error("callback needs to be a function.")}}}),define("notification/models/ViewedChatNotification",["ko","notification/models/Notification","people-models/Person"],function(e,t,n){function ViewedChatNotification(n,i){Object.setPrototypeOf(this,new t(n,i)),this._hasBeenSeen=e.observable(!0),this.getConstructorName=function(){return"ViewedChatNotification"}}return ViewedChatNotification.getFake=function(e){var t=ViewedChatNotification.getRaw();return new ViewedChatNotification(t,"http://host.com")},ViewedChatNotification.getRaw=function(){var e=n.getRaw();return Object.assign({message_id:100,text:"message snippet.",timestamp:"Dec 12 2019",seen:1,type:"seen-chat"},e)},ViewedChatNotification}),define("notification/models/UnseenChatNotification",["ko","notification/models/Notification","people-models/Person"],function(e,t,n){function UnseenChatNotification(e,n){Object.setPrototypeOf(this,new t(e,n)),this.getConstructorName=function(){return"UnseenChatNotification"}}return UnseenChatNotification.getFake=function(){var e=UnseenChatNotification.getRaw();return new UnseenChatNotification(e,"https://host")},UnseenChatNotification.getRaw=function(){var e=n.getRaw();return Object.assign({message_id:1,text:"message snippet.",timestamp:"Dec 12 2019",seen:0,type:"chat"},e)},UnseenChatNotification}),define("notification/models/ForumNotification",["ko","notification/models/Notification","people-models/Person"],function(e,t,n){var i=function(e,n){Object.setPrototypeOf(this,new t(e,n)),this.getConstructorName=function(){return"ForumNotification"},this.getForumName=function(){return this.forumName},this.setForumName=function(e){this._isValidString(e,"forum_name must be a attribute."),this.forumName=e},this.getGroupId=function(){return this.grpId},this.setGroupId=function(e){if(!(e&&Number.isInteger(e)&&e>0))throw new Error("group_id must be a positive integer.");this.grpId=e},this.setGroupId(e.group_id)};return i.getFake=function(){var e=i.getRaw();return new i(e,"https://host")},i.getRaw=function(){var e=n.getRaw();return Object.assign({message_id:2,group_id:55,text:"message snippet.",timestamp:"Dec 12 2019",forum_name:"MATH1300 M",seen:0,type:"forum"},e)},i}),define("notification/Component",["ko","dispatcher/Dispatcher","text!notification/template.html","notification/NotificationRemoteService","notification/models/ViewedChatNotification","notification/models/UnseenChatNotification","notification/models/ForumNotification","jquery"],function(e,t,n,i,s,r,o,a){return{viewModel:function NotificationViewModel(n,a){this._remoteService=new i,this.dis=new t,this.isVisible=e.observable(!1),this.notifications=e.observableArray([]),this.isNotifcationsOpen=e.observable(!1),this.onAuth=function(e){"authenticated"==e.state&&(this._remoteService.initialize(),this._remoteService.registerOnNotificationsUpdate(this.onNotifications),this._remoteService.connect())},this.onAuth=this.onAuth.bind(this),this.dis.reg("authState",this.onAuth),this.onNotificationClicked=function(e){if(e.setHasBeenSeen(),"ForumNotification"==e.getConstructorName())this.dis.dispatch("selectedGroupId",e.getGroupId());else{var t=e.getPerson();console.log(t),console.log(t),this.dis.dispatch("focusPerson",t),this._remoteService.setChatMsgNotifSeen(e)}this.closeNotifications()},this.onNotificationClicked=this.onNotificationClicked.bind(this),this.oldUnseenCount=0,this.computeUnseenCount=function(){for(var e=0,t=0;t<this.notifications().length;t++)0==this.notifications()[t].getHasBeenSeen()&&e++,e>this.oldUnseenCount&&e>0&&this.ding();return this.oldUnseenCount=e,e},this.computeUnseenCount=this.computeUnseenCount.bind(this),this.unseenCount=e.computed(this.computeUnseenCount),this.dingDone=!0,this.ding=function(e){var t=this;if(t.dingDone){var n=new Audio("./assets/audio/play-ding.mp3");t.dingDone=!1,n.play().catch(function(e){console.log(e)}).finally(function(){t.dingDone=!0}),e&&e(!0)}else e&&e(!1)},this.ding=this.ding.bind(this),this.onNotifications=function(e){try{this.notifications([]);for(var t=0;t<e.length;t++)this.binNotification(e[t]);this.isVisible(this.notifications().length>0)}catch(e){console.log(e),console.error("Something went wrong receiving the notifications.")}},this.onNotifications=this.onNotifications.bind(this),this.binNotification=function(e){var t=e.type,n=null,i=this._remoteService.getServerURL();switch(t){case"chat":n=new r(e,i),this.notifications.unshift(n);break;case"seen-chat":n=new s(e,i),this.notifications.push(n);break;case"forum":n=new o(e,i),this.notifications.push(n);break;default:throw new Error(t+" is an unknown notification type.")}},this.openNotifications=function(){this.isNotifcationsOpen(!0)},this.closeNotifications=function(){this.isNotifcationsOpen(!1)},this.closeNotifications=this.closeNotifications.bind(this)},template:n}}),define("text!york-forum/poster/template.html",[],function(){return"<link rel=\"stylesheet\"\n      href=\"./styles/components/york-forum/jquery.cleditor.css?v=2.0\">\n</link>\n\n<div class='background-dimmer' data-bind='visible:isVisible()'>\n\n  <div data-bind='visible:isPostSuccessful()'> Success </div>\n  <div id='york-forum-poster' data-bind='complementClick:hide' >\n    <textarea id='forum-poster-title-holder'\n              placeholder=\"What's new at YU?\"\n              maxlength=\"300\"\n              data-bind='textInput:title, hasFocus:titleHasFocus'>\n    </textarea>\n    <textarea id='forum-input'\n              name=\"input\"\n              placeholder=\"Text (Optional)\">\n\n    </textarea>\n    <button id='york-forum-post-button'\n            data-bind='click:post, enable:isPostable() && isValidBodyLength()'>\n      <span data-bind='visible:!isSpinnerOn()'>POST</span>\n      <span id='post-spinner'\n           class='nano-spinner'\n           data-bind='visible:isSpinnerOn()'>\n      </span>\n    </button>\n    <div data-bind='text:bodyErrorMessage()'></div>\n  </div>\n\n</div>\n"}),define("york-forum/models/ForumPost",["abstract-interfaces/ValidObject","ko"],function(e,t){var n=function(n){Object.setPrototypeOf(this,new e),this.expanded=t.observable(!1),this.comment=t.observable(""),this.replies=t.observableArray([]),this.replyCount=t.observable(0),this.voteCount=t.observable(0),this.alreadyVoted=t.observable(!1),this.rep=0,this.setAlreadyVoted=function(e){null==e?this.alreadyVoted(!1):(this.validateId(e),this.alreadyVoted(!0))},this.setAlreadyVoted(n.already_voted),this.isAlreadyVoted=function(){return this.alreadyVoted()},this.getRootReplyCount=function(){return this.replies().length},this.setVoteCount=function(e){null==e?this.voteCount(0):(this.validateId(e+1),this.voteCount(e))},this.setVoteCount(n.votes),this.getVoteCount=function(){return this.voteCount()},this.setReplyCount=function(e){null==e?this.replyCount(0):(this.validateId(e),this.replyCount(e))},this.setReplyCount(n.reply_count),this.incrementReplyCount=function(){this.replyCount(this.replyCount()+1)},this.deleteReplies=function(){this.replies([])},this.resetReplyCount=function(){this.replyCount(0)},this.deleteReply=function(e){var t=this.replies();this.recursiveDelete(e,t)},this.recursiveDelete=function(e,t){if(!(t.length<1))for(var n=0;n<t.length;n++){var i=t[n];if(i.getId()==e)return t.splice(n,1),!0;var s=i.getReplies();this.recursiveDelete(e,s)}},this.setReplies=function(e){this.deleteReplies(),this.resetReplyCount();for(var t=0;t<e.length;t++){var n=e[t];if(!n.isReply)throw new Error("must be a reply.");this.recurse(n,e,t+1),null==n.getParentId()&&(this.replies().push(n),this.incrementReplyCount())}},this.recurse=function(e,t,n){for(var i=n;i<t.length;i++){var s=t[i];if(!s.isReply)throw new Error("must be a reply");s.getParentId()==e.getId()&&(e.addChild(s),this.incrementReplyCount(),this.recurse(s,t,i+1))}},this.isDuplicate=function(e){var t=!1;return this.replies().forEach(function(n){n.getId()!=e||(t=!0)}),t},this.clearComment=function(){this.comment("")},this.getComment=function(){return this.comment()},this.getCommentHTML=function(){return this.getComment().replace(/\n/gi,"<br />")},this.setComment=function(e){if("string"!=typeof e||e.length<1)throw new Error("comment cannot be set to empty");this.comment(e)},this.getReplyCount=function(){return this.replyCount()},this.setExpanded=function(e){this.expanded(e)},this.isExpanded=function(){return this.expanded()},this.setId=function(e){this.validateId(e),this.id=e}.bind(this),this.setId(n.post_id),this.getId=function(){return this.id},this.getAuthor=function(){return this.author},this.setAuthor=function(e){this.validateStr(e),this.author=e},this.setAuthor(n.first+" "+n.last),this.setRep=function(e){"number"!=typeof e||e<0||(this.rep="Reputation: "+e)},this.setRep(n.author_rep),this.getRep=function(){return this.rep},this.isPoster=function(){return this.poster},this.setPoster=function(e){this.poster=1==e},this.setPoster(n.is_owner),this.getUserId=function(){return this.userId},this.setUserId=function(e){this.validateId(e),this.userId=e},this.setUserId(n.user_id),this.setTimestamp=function(e){try{this.validateStr(e),this.timestamp=e}catch(e){this.timestamp=""}},this.setTimestamp(n.timestamp),this.getTimestamp=function(){return this.timestamp},this.getTitle=function(){return this.title},this.setTitle=function(e){this.title=e},this.setTitle(n.title),this.hasAnchorTag=function(e){return/<a/.test(e)},this.changeTarget=function(e){return e.replace("<a",'<a target="_blank" rel="noopener noreferrer"')},this.setBody=function(e){this.validateStr(e),this.hasAnchorTag(e)&&(e=this.changeTarget(e)),this.body=e},this.setBody(n.body),this.getBody=function(){return this.body}};return n.buildOutgoing=function(e){var t=n.getFake();return t.setTitle(e.title),t.setBody(e.body),t},n.getRaw=function(){return{post_id:1,user_id:2,title:"title",body:"text",first:"Chris",last:"Kerley",author_rep:5,timestamp:"nulltime",is_owner:1,reply_count:2,votes:3,already_voted:1}},n.getFake=function(){return new n(n.getRaw())},n}),define("york-forum/models/PostReply",["abstract-interfaces/ValidObject","ko"],function(e,t){var n=function(n,i){Object.setPrototypeOf(this,new e),this.author="",this.userPhotoURL=t.observable("./assets/no-photo.jpg"),this.owner=null,this.postId=null,this.message="",this.replies=t.observableArray([]),this.commentBoxOpen=t.observable(!1),this.getSelf=function(){return this}.bind(this),this.openCommentBox=function(){},this.isCommentBoxOpen=function(){return this.commentBoxOpen()},this.equals=function(e){return e.isReply()&&this.getId()==e.getId()},this.getReplies=function(){return this.replies()},this.isOwner=function(){return this.owner},this.setOwner=function(e){this.validateBool(e),this.owner=e},this.setOwner(n.is_owner),this.setHost=function(e){this.validateStr(e),this.host=e},this.setHost(i),this.getHost=function(){return this.host},this.setUserPhotoURL=function(e){null!=e&&(this.validateStr(e),this.userPhotoURL(i+"/"+e))},this.setUserPhotoURL(n.small_photo_url),this.getUserPhotoURL=function(){return this.userPhotoURL()},this.getKOUserPhotoURL=function(){return this.userPhotoURL},this.setId=function(e){this.validateId(e),this.replyId=e}.bind(this),this.setId(n.reply_id),this.getId=function(){return this.replyId},this.setPostId=function(e){this.validateId(e),this.postId=e},this.setPostId(n.post_id),this.getPostId=function(){return this.postId},this.addChild=function(e){this.isDuplicate(e)||(this.replies().push(e),this.replies.valueHasMutated())},this.getChildAt=function(e){return this.replies()[e]},this.getChildCount=function(){return this.replies().length},this.isDuplicate=function(e){for(var t=0;t<this.replies().length;t++)if(this.replies()[t].getId()==e.getId())return!0;return!1},this.setParentId=function(e){null==e?this.parentId=null:(this.validateId(e),this.parentId=e)},this.setParentId(n.parent_id),this.getParentId=function(){return this.parentId},this.isReply=function(){return!0},this.getAuthor=function(){return this.author},this.setAuthor=function(e){this.validateStr(e),this.author=e},this.setAuthor(n.first+" "+n.last),this.getUserId=function(){return this.userId},this.setUserId=function(e){this.validateId(e),this.userId=e},this.setUserId(n.user_id),this.setTimestamp=function(e){this.validateStr(e),this.timestamp=e},this.setTimestamp(n.timestamp),this.getTimestamp=function(){return this.timestamp},this.setBody=function(e){this.validateStr(e),this.message=e},this.setBody(n.body),this.getBody=function(){return this.message}};return n.buildOutgoing=function(e){var t=n.getFake();return t.setBody(e.body),t.setParentId(e.parentId),t},n.getRaw=function(){return{reply_id:1,post_id:5,parent_id:2,user_id:3,body:"body",first:"Chris",last:"Kerley",small_photo_url:"fakephotourl",timestamp:"1 min",is_owner:1}},n.getFake=function(){return new n(n.getRaw(),"fakehost")},n}),define("york-forum/YorkForumRemoteService",["ActiveRemoteService","format-converter","dispatcher/Dispatcher","york-forum/models/ForumPost","york-forum/models/PostReply","ko"],function(e,t,n,i,s,r){return function(){Object.setPrototypeOf(Object.getPrototypeOf(this),new e),this.setMicroServer("forum"),this.dis=new n,this.removeVote=function(e){var t=this.getServerURL()+"/removeVote",n=JSON.stringify(this.flatten(e));$.ajax({url:t,type:"DELETE",data:n,contentType:"application/json; charset=utf-8",dataType:"json",beforeSend:this.setAuthorizationHeader,success:this.onPostsChanged,error:this.onError})}.bind(this),this.dis.reg("removeVote",this.removeVote),this.upvotePost=function(e){var t=this.getServerURL()+"/upvotePost",n=JSON.stringify(this.flatten(e));$.ajax({url:t,type:"POST",data:n,contentType:"application/json; charset=utf-8",dataType:"json",beforeSend:this.setAuthorizationHeader,success:this.onPostsChanged,error:this.onError})}.bind(this),this.dis.reg("upvotePost",this.upvotePost),this.onPostsChanged=function(e){try{var t=new i(e);this.dis.dispatch("postUpdated",t)}catch(e){alert(e.message),this.onError("Malformed post received from server.")}}.bind(this),this.onReplyToReply=function(e){var t=this.getServerURL()+"/replyToReply",n=JSON.stringify(this.flatten(e));$.ajax({url:t,type:"POST",data:n,contentType:"application/json; charset=utf-8",dataType:"json",beforeSend:this.setAuthorizationHeader,success:this.onCommentsChanged,error:this.onError})}.bind(this),this.dis.reg("replyToReply",this.onReplyToReply),this.onDeleteComment=function(e){var t=this.getServerURL()+"/comment",n=JSON.stringify(this.flatten(e));$.ajax({url:t,type:"DELETE",data:n,contentType:"application/json; charset=utf-8",dataType:"json",beforeSend:this.setAuthorizationHeader,success:this.onCommentsChanged,error:this.onError})}.bind(this),this.dis.reg("deleteComment",this.onDeleteComment),this.commentPost=function(e){var t=this.getServerURL()+"/commentForumPost",n=JSON.stringify(this.flatten(e));$.ajax({url:t,type:"POST",data:n,contentType:"application/json; charset=utf-8",dataType:"json",beforeSend:this.setAuthorizationHeader,success:this.onCommentsChanged,error:this.onError})}.bind(this),this.dis.reg("commentPost",this.commentPost),this.onCommentsChanged=function(e){var t=new i(e);this.getForumReplies(t)}.bind(this),this.getForumReplies=function(e){var t=this.getServerURL()+"/postReplies?postId="+e.getId();$.ajax({url:t,type:"GET",beforeSend:this.setAuthorizationHeader,success:this.onRepliesReceived,error:this.onError})}.bind(this),this.dis.reg("showPost",this.getForumReplies),this.onRepliesReceived=function(e){try{if(Array.isArray(e)){var t=this.wrapReplies(e);this.dis.dispatch("postReplies",t)}else{var n=new i(e);this.dis.dispatch("deleteAllPostReplies",n)}}catch(e){this.onError(e.message)}}.bind(this),this.wrapReplies=function(e){for(var t=[],n=this.getServerURL(),i=0;i<e.length;i++)t.push(new s(e[i],n));return t}.bind(this),this.onDeleteForumPost=function(e){var t=this.getServerURL()+"/deleteForumPost",n=JSON.stringify(this.flatten(e));$.ajax({url:t,type:"POST",data:n,contentType:"application/json; charset=utf-8",dataType:"json",beforeSend:this.setAuthorizationHeader,success:this.onPostDeleted,error:this.onError})}.bind(this),this.dis.reg("deleteForumPost",this.onDeleteForumPost),this.onPostDeleted=function(e){this.dis.dispatch("forumPostDeleted",e)}.bind(this),this.onPostForumMessage=function(e){var t=this.getServerURL()+"/postYorkForum",n=JSON.stringify(this.flatten(e));$.ajax({url:t,type:"POST",data:n,contentType:"application/json; charset=utf-8",dataType:"json",beforeSend:this.setAuthorizationHeader,success:this.onPostSuccess,error:this.onError})}.bind(this),this.dis.reg("postForumMessage",this.onPostForumMessage),this.onPostSuccess=function(e){try{var t=new i(e);this.dis.dispatch("postSuccess",t)}catch(e){this.onError(e.message)}}.bind(this),this.onError=function(e){e.responseText&&(e=e.responseText),this.dis.dispatch("postError",e)}.bind(this),this.onAuth=function(e){"authenticated"==e.state&&this.getYorkForumPosts()}.bind(this),this.dis.reg("authState",this.onAuth),this.getYorkForumPosts=function(){$.ajax({url:this.getServerURL()+"/posts",type:"GET",beforeSend:this.setAuthorizationHeader,success:this.onYorkForumPosts,error:this.onError})}.bind(this),this.onYorkForumPosts=function(e){try{var t=e.count,n=[];e.posts.forEach(function(e){e=new i(e),n.push(e)}),this.dis.dispatch("forumMemberCount",t),this.dis.dispatch("forumPosts",n)}catch(e){console.log(e),this.onError("There was a problem loading the news. Please try again later.")}}.bind(this),this.getFakeRepliesComplex=function(){return[{reply_id:1,parent_id:null,user_id:1,post_id:52,body:"body",first:"root",last:"1",timestamp:"1 min ago"},{reply_id:2,parent_id:1,post_id:52,user_id:4,body:"I am a child",first:"root 1",last:"child 1",timestamp:"1 min ago"},{reply_id:3,parent_id:1,post_id:52,user_id:8,body:"I am a child",first:"root 1 -",last:"child 2",timestamp:"1 min ago"},{reply_id:4,parent_id:3,post_id:52,user_id:8,body:"I am a child of root 1 - child 2",first:"child 2 -",last:"child 3",timestamp:"1 min ago"}]},this.getSimpleRawReply=function(){return[{reply_id:1,parent_id:null,post_id:52,user_id:1,body:"body",first:"root",last:"1",timestamp:"1 min ago"}]},this.getMedRawReply=function(){return[{reply_id:1,parent_id:null,user_id:1,body:"body",first:"root",last:"1",timestamp:"1 min ago"},{reply_id:2,parent_id:1,user_id:1,body:"body",first:"child",last:"1",timestamp:"1 min ago"}]}}}),define("york-forum/YorkForumStore",["dispatcher/Dispatcher","abstract-interfaces/Store","york-forum/YorkForumRemoteService","people-models/Person"],function(e,t,n,i){new n;var s=null,r=function(){Object.setPrototypeOf(this,new t),this.dis=new e,this.spinnerOn=!1,this.visible=!0,this.forumPosterVisible=!1,this.posts=[],this.postError="",this.postSuccessful=!1,this.userPhotoURL=null,this.userName=null,this.memberCount=0,this.getMemberCount=function(){return this.memberCount}.bind(this),this.onForumMemberCount=function(e){if("number"!=typeof e||e<0)throw new Error("member count  must be a non-negative integer.");this.memberCount=e,this.pub()}.bind(this),this.dis.reg("forumMemberCount",this.onForumMemberCount),this.updatePost=function(e){var t=this.getPost(e.getId());t&&(e.isAlreadyVoted()?t.setAlreadyVoted(1):t.setAlreadyVoted(null),t.setVoteCount(e.getVoteCount()),this.pub())}.bind(this),this.dis.reg("postUpdated",this.updatePost),this.getPost=function(e){var t=null;return this.posts.forEach(function(n){n.getId()==e&&(t=n)}),t}.bind(this),this.getUserName=function(){return this.userName},this.onCommentPost=function(){this.spinnerOn=!0,this.pub()}.bind(this),this.onDeleteAllPostReplies=function(e){var t=e.getId();(e=this.getPost(t))&&(e.deleteReplies(),e.resetReplyCount(),this.pub())}.bind(this),this.dis.reg("deleteAllPostReplies",this.onDeleteAllPostReplies),this.onPostReplies=function(e){if(e.length>0){for(var t=e[0].getPostId(),n=0;n<this.posts.length;n++)if(this.posts[n].getId()==t){this.posts[n].setReplies(e);break}this.pub()}}.bind(this),this.dis.reg("postReplies",this.onPostReplies),this.onShowPost=function(e){for(var t=0;t<this.posts.length;t++){var n=this.posts[t];n.getId()==e.getId()?(n.setExpanded(!0),n.clearComment()):n.setExpanded(!1)}this.pub()}.bind(this),this.dis.reg("showPost",this.onShowPost),this.getUserPhoto=function(){return this.userPhotoURL},this.onProfileInfo=function(e){this.userPhotoURL=e.small_photo_url,this.userName=e.first+" "+e.last,this.pub()}.bind(this),this.dis.reg("profileUpdate",this.onProfileInfo),this.onForumPosts=function(e){this.posts=e,this.pub()}.bind(this),this.dis.reg("forumPosts",this.onForumPosts),this.onOpenForumPoster=function(){this.forumPosterVisible=!0,this.pub()}.bind(this),this.dis.reg("openForumPoster",this.onOpenForumPoster),this.isVisible=function(){return this.visible}.bind(this),this.onOpenNews=function(){this.visible=!0,this.pub()}.bind(this),this.dis.reg("openNews",this.onOpenNews),this.hideNews=function(e){this.visible=!1,this.pub()}.bind(this),this.dis.reg("focusPerson",this.hideNews),this.selGrpId=this.dis.reg("selectedGroupId",this.hideNews),this.isForumPosterVisible=function(){return this.forumPosterVisible}.bind(this),this.hide=function(){this.forumPosterVisible=!1,this.pub()}.bind(this),this.dis.reg("hideYorkForumPoster",this.hide),this.onForumPostDeleted=function(e){for(var t=0;t<this.posts.length;t++)this.posts[t].getId()==e&&this.posts.splice(t,1);this.spinnerOn=!1,this.pub()}.bind(this),this.dis.reg("forumPostDeleted",this.onForumPostDeleted),this.onServerCall=function(){this.spinnerOn=!0,this.pub()}.bind(this),this.dis.reg("postForumMessage",this.onServerCall),this.dis.reg("deleteForumPost",this.onServerCall),this.isSpinnerOn=function(){return this.spinnerOn},this.isPostSuccessful=function(){return this.postSuccessful},this.getPosts=function(){return this.posts},this.getPostError=function(){return this.postError},this.onClearPosterError=function(){this.spinnerOn=!1,this.postError="",this.pub()}.bind(this),this.dis.reg("clearPosterError",this.onClearPosterError),this.onPostError=function(e){this.postError=e,this.forumPosterVisible=!1,this.pub()}.bind(this),this.dis.reg("postError",this.onPostError),this.onPostSuccess=function(e){this.posts.unshift(e),this.postSuccessful=!0,this.spinnerOn=!1,this.forumPosterVisible=!1,this.pub();setTimeout(this.hideSuccess,1500)}.bind(this),this.dis.reg("postSuccess",this.onPostSuccess),this.hideSuccess=function(){this.postSuccessful=!1,this.pub()}.bind(this)};return{getInstance:function(){return s||(s=new r),s},getNew:function(){return new r}}}),function(t){function vi(e){var n,i,s=this,r=e.target,a=t.data(r,u),p=F[a],f=p.popupName,v=N[f];if(!s.disabled&&t(r).attr(g)!==g){if(n={editor:s,button:r,buttonName:a,popup:v,popupName:f,command:p.command,useCSS:s.options.useCSS},p.buttonClick&&!1===p.buttonClick(e,n))return!1;if("source"===a)l(s)?(delete s.range,s.$area.hide(),s.$frame.show(),r.title=p.title):(s.$frame.hide(),s.$area.show(),r.title="Show Rich Text");else if(!l(s)){if(f){if(i=t(v),"url"===f){if("link"===a&&""===ri(s))return ut(s,"A selection is required when inserting a link.",r),!1;i.children(":button").unbind(m).bind(m,function(){var e=i.find(":text"),r=t.trim(e.val());""!==r&&h(s,n.command,r,null,n.button),e.val("http://"),o(),c(s)})}else"pastetext"===f&&i.children(":button").unbind(m).bind(m,function(){var e=i.find("textarea"),t=e.val().replace(/\n/g,"<br />");""!==t&&h(s,n.command,t,null,n.button),e.val(""),o(),c(s)});return r!==t.data(v,d)?(ui(s,v,r),!1):void 0}if("print"===a)s.$frame[0].contentWindow.print();else if(!h(s,n.command,n.value,n.useCSS,r))return!1}c(s)}}function kt(e){var n=t(e.target).closest("div");n.css(r,n.data(u)?"#FFF":"#FFC")}function dt(e){t(e.target).closest("div").css(r,"transparent")}function yi(e){var n,i=this,s=e.data.popup,r=e.target;if(s!==N.msg&&!t(s).hasClass(E)){var a,l=t.data(s,d),p=t.data(l,u),f=F[p],m=f.command,g=i.options.useCSS;if("font"===p?a=r.style.fontFamily.replace(/"/g,""):"size"===p?("DIV"===r.tagName.toUpperCase()&&(r=r.children[0]),a=r.innerHTML):"style"===p?a="<"+r.tagName+">":"color"===p?a=ti(r.style.backgroundColor):"highlight"===p&&(a=ti(r.style.backgroundColor),_?m="backcolor":g=!0),n={editor:i,button:l,buttonName:p,popup:s,popupName:f.popupName,command:m,value:a,useCSS:g},!f.popupClick||!1!==f.popupClick(e,n)){if(n.command&&!h(i,n.command,n.value,n.useCSS,l))return!1;o(),c(i)}}}function it(e){for(var t=1,n=0,i=0;i<e.length;++i)n=(n+(t=(t+e.charCodeAt(i))%65521))%65521;return n<<16|t}function gt(e,n,i,s,o){var a,c;return N[e]?N[e]:(a=t(v).hide().addClass(x).appendTo("body"),s?a.html(s):"color"===e?((c=n.colors.split(" ")).length<10&&a.width("auto"),t.each(c,function(e,n){t(v).appendTo(a).css(r,"#"+n)}),i=R):"font"===e?t.each(n.fonts.split(","),function(e,n){t(v).appendTo(a).css("fontFamily",n).html(n)}):"size"===e?t.each(n.sizes.split(","),function(e,n){t(v).appendTo(a).html('<font size="'+n+'">'+n+"</font>")}):"style"===e?t.each(n.styles,function(e,n){t(v).appendTo(a).html(n[1]+n[0]+n[1].replace("<","</"))}):"url"===e?(a.html('<label>Enter URL:<br /><input type="text" value="http://" style="width:200px" /></label><br /><input type="button" value="Submit" />'),i=E):"pastetext"===e&&(a.html('<label>Paste your content here:<br /><textarea rows="3" style="width:200px"></textarea></label><br /><input type="button" value="Submit" />'),i=E),i||s||(i=T),a.addClass(i),_&&a.attr(S,"on").find("div,font,p,h1,h2,h3,h4,h5,h6").attr(S,"on"),(a.hasClass(T)||!0===o)&&a.children().hover(kt,dt),N[e]=a[0],a[0])}function ni(e,t){t?(e.$area.attr(g,g),e.disabled=!0):(e.$area.removeAttr(g),delete e.disabled);try{_?e.doc.body.contentEditable=!t:e.doc.designMode=t?"off":"on"}catch(e){}b(e)}function h(t,n,i,s,r){var o,a,c,d,u;if(rt(t),_||(null==s&&(s=t.options.useCSS),t.doc.execCommand("styleWithCSS",0,s.toString())),o="inserthtml"===n.toLowerCase(),_&&o)w(t).pasteHTML(i);else if(O&&o)(c=(a=e(t)).getRangeAt(0)).deleteContents(),c.insertNode(c.createContextualFragment(i)),a.removeAllRanges(),a.addRange(c);else{d=!0;try{d=t.doc.execCommand(n,0,i||null)}catch(e){u=e.message,d=!1}d||("cutcopypaste".indexOf(n)>-1?ut(t,"For security reasons, your browser does not support the "+n+" command. Try using the keyboard shortcut or context menu instead.",r):ut(t,u||"Error executing the "+n+" command.",r))}return b(t),ct(t,!0),d}function c(e){setTimeout(function(){l(e)?e.$area.focus():e.$frame[0].contentWindow.focus(),b(e)},0)}function w(t){return _?e(t).createRange():e(t).getRangeAt(0)}function e(e){return _?e.doc.selection:e.$frame[0].contentWindow.getSelection()}function ti(e){var t,n=/rgba?\((\d+), (\d+), (\d+)/.exec(e);if(n){for(e=(n[1]<<16|n[2]<<8|n[3]).toString(16);e.length<6;)e="0"+e;return"#"+e}return t=e.split(""),4===e.length?"#"+t[1]+t[1]+t[2]+t[2]+t[3]+t[3]:e}function o(){t.each(N,function(e,n){t(n).hide().unbind(m).removeData(d)})}function ii(){return t("link[href*=cleditor]").attr("href").replace(/^(.*\/)[^\/]+$/,"$1")+"images/"}function ht(n){var i=n.$main,s=n.options;n.$frame&&n.$frame.remove();var r=n.$frame=t('<iframe frameborder="0" src="javascript:true;" />').hide().appendTo(i),d=r[0].contentWindow,u=n.doc=d.document,h=t(u);u.open(),u.write(s.docType+"<html>"+(""===s.docCSSFile?"":'<head><link rel="stylesheet" type="text/css" href="'+s.docCSSFile+'" /></head>')+'<body style="'+s.bodyStyle+'"></body></html>'),u.close(),(_||O)&&h.click(function(){c(n)}),ft(n),_||O?(h.bind("beforedeactivate beforeactivate selectionchange keypress keyup",function(e){if("beforedeactivate"===e.type)n.inactive=!0;else if("beforeactivate"===e.type)!n.inactive&&n.range&&n.range.length>1&&n.range.shift(),delete n.inactive;else if(!n.inactive)for(n.range||(n.range=[]),n.range.unshift(w(n));n.range.length>2;)n.range.pop()}),r.focus(function(){rt(n),t(n).triggerHandler(y)}),r.blur(function(){t(n).triggerHandler(a)})):t(r[0].contentWindow).focus(function(){t(n).triggerHandler(y)}).blur(function(){t(n).triggerHandler(a)}),h.click(o).keydown(function(t){_&&"Control"==e(n).type&&8==t.keyCode&&(e(n).clear(),t.preventDefault())}).bind("keyup mouseup",function(){b(n),ct(n,!0)}),A?n.$area.show():r.show(),t(function(){var e=n.$toolbar,t=e.children("div:last"),o=i.width(),a=t.offset().top+t.outerHeight()-e.offset().top+1;e.height(a),a=(/%/.test(""+s.height)?i.height():parseInt(s.height,10))-a,r.width(o).height(a),n.$area.width(o).height(D?a-2:a),ni(n,n.disabled),b(n)})}function b(e){var n,i;A||!L||e.focused||(e.$frame[0].contentWindow.focus(),window.focus(),e.focused=!0),n=e.doc,_&&(n=w(e)),i=l(e),t.each(e.$toolbar.find("."+k),function(s,r){var o,a=t(r),c=t.cleditor.buttons[t.data(r,u)],d=c.command,h=!0;if(e.disabled)h=!1;else if(c.getEnabled)o={editor:e,button:r,buttonName:c.name,popup:N[c.popupName],popupName:c.popupName,command:c.command,useCSS:e.options.useCSS},void 0===(h=c.getEnabled(o))&&(h=!0);else if((i||A)&&"source"!==c.name||_&&("undo"===d||"redo"===d))h=!1;else if(d&&"print"!==d&&(_&&"hilitecolor"===d&&(d="backcolor"),!_&&!O||"inserthtml"!==d))try{h=n.queryCommandEnabled(d)}catch(e){h=!1}h?(a.removeClass(P),a.removeAttr(g)):(a.addClass(P),a.attr(g,g))})}function rt(t){t.range&&(_?t.range[0].select():O&&e(t).addRange(t.range[0]))}function ri(t){return rt(t),_?w(t).text:e(t).toString()}function ut(e,t,n){var i=gt("msg",e.options,I);i.innerHTML=t,ui(e,i,n)}function ui(e,n,i){var s,r,a,c,u,h=t(n);i?(r=--(s=(c=t(i)).offset()).left,a=s.top+c.height()):(s=(u=e.$toolbar).offset(),r=Math.floor((u.width()-h.width())/2)+s.left,a=s.top+u.height()-2),o(),h.css({left:r,top:a}).show(),i&&(t.data(n,d,i),h.bind(m,{popup:n},t.proxy(yi,e))),setTimeout(function(){h.find(":text,textarea").eq(0).focus().select()},100)}function l(e){return e.$area.is(":visible")}function ft(e,n){var i,s,r=e.$area.val(),o=e.options,a=o.updateFrame,c=t(e.doc.body);if(a){if(i=it(r),n&&e.areaChecksum===i)return;e.areaChecksum=i}s=(s=a?a(r):r).replace(/<(?=\/?script)/gi,"&lt;"),o.updateTextArea&&(e.frameChecksum=it(s)),s!==c.html()&&(c.html(s),t(e).triggerHandler(p))}function ct(e,n){var i,s,r=t(e.doc.body).html(),o=e.options,a=o.updateTextArea,c=e.$area;if(a){if(i=it(r),n&&e.frameChecksum===i)return;e.frameChecksum=i}s=a?a(r):r,o.updateFrame&&(e.areaChecksum=it(s)),s!==c.val()&&(c.val(s),t(e).triggerHandler(p))}var n,i;t.cleditor={defaultOptions:{width:"auto",height:250,controls:"image link unlink | alignleft center alignright justify | undo redo",sizes:"1,2,3,4,5,6,7",useCSS:!0,docType:'<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">',docCSSFile:"",bodyStyle:"margin:4px; font:14pt Arial,Verdana; cursor:text"},buttons:{init:"bold,,|italic,,|underline,,|strikethrough,,|subscript,,|superscript,,|font,,fontname,|size,Font Size,fontsize,|style,,formatblock,|color,Font Color,forecolor,|highlight,Text Highlight Color,hilitecolor,color|removeformat,Remove Formatting,|bullets,,insertunorderedlist|numbering,,insertorderedlist|outdent,,|indent,,|alignleft,Align Text Left,justifyleft|center,,justifycenter|alignright,Align Text Right,justifyright|justify,,justifyfull|undo,,|redo,,|rule,Insert Horizontal Rule,inserthorizontalrule|image,Insert Image,insertimage,url|link,Insert Hyperlink,createlink,url|unlink,Remove Hyperlink,|cut,,|copy,,|paste,,|pastetext,Paste as Text,inserthtml,|print,,|source,Show Source"},imagesPath:function(){return ii()}},t.fn.cleditor=function(e){var n=t([]);return this.each(function(i,s){if("TEXTAREA"===s.tagName.toUpperCase()){var r=t.data(s,f);r||(r=new cleditor(s,e)),n=n.add(r)}}),n};var s,r="backgroundColor",a="blurred",d="button",u="buttonName",p="change",f="cleditor",m="click",g="disabled",v="<div>",y="focused",S="unselectable",C="cleditorGroup",k="cleditorButton",P="cleditorDisabled",x="cleditorPopup",T="cleditorList",R="cleditorColor",E="cleditorPrompt",I="cleditorMsg",M=navigator.userAgent.toLowerCase(),_=/msie/.test(M),D=/msie\s6/.test(M),O=/(trident)(?:.*rv:([\w.]+))?/.test(M),L=/webkit/.test(M),A=/iPhone|iPad|iPod/i.test(M),N={},F=t.cleditor.buttons;t.each(F.init.split("|"),function(e,t){var n=t.split(","),i=n[0];F[i]={stripIndex:e,name:i,title:""===n[1]?i.charAt(0).toUpperCase()+i.substr(1):n[1],command:""===n[2]?i:n[2],popupName:""===n[3]?i:n[3]}}),delete F.init,cleditor=function(e,n){var i=this;i.options=n=t.extend({},t.cleditor.defaultOptions,n);var r=i.$area=t(e).css({border:"none",margin:0,padding:0}).hide().data(f,i).blur(function(){ft(i,!0)}),a=i.$main=t(v).addClass("cleditorMain").width(n.width).height(n.height),c=i.$toolbar=t(v).addClass("cleditorToolbar").appendTo(a),d=t(v).addClass(C).appendTo(c),h=0;t.each(n.controls.split(" "),function(e,s){var r,o,a;if(""===s)return!0;"|"===s?(t(v).addClass("cleditorDivider").appendTo(d),d.width(h+1),h=0,d=t(v).addClass(C).appendTo(c)):(r=F[s],o=t(v).data(u,r.name).addClass(k).attr("title",r.title).bind(m,t.proxy(vi,i)).appendTo(d).hover(kt,dt),h+=24,d.width(h+1),a={},r.css?a=r.css:r.image&&(a.backgroundImage=function wi(e){return"url("+ii()+e+")"}(r.image)),r.stripIndex&&(a.backgroundPosition=-24*r.stripIndex),o.css(a),_&&o.attr(S,"on"),r.popupName&&gt(r.popupName,n,r.popupClass,r.popupContent,r.popupHover))}),a.insertBefore(r).append(r),s||(t(document).click(function(e){var n=t(e.target);n.add(n.parents()).is("."+E)||o()}),s=!0),/auto|%/.test(""+n.width+n.height)&&t(window).bind("resize.cleditor",function(){ht(i)}),ht(i)},n=cleditor.prototype,i=[["clear",function pi(e){e.$area.val(""),ft(e)}],["disable",ni],["execCommand",h],["focus",c],["hidePopups",o],["sourceMode",l,!0],["refresh",ht],["select",function bi(e){setTimeout(function(){l(e)?e.$area.select():h(e,"selectall")},0)}],["selectedHTML",function ki(e){var n,i,s;return rt(e),n=w(e),_?n.htmlText:((i=t("<layer>")[0]).appendChild(n.cloneContents()),s=i.innerHTML,i=null,s)},!0],["selectedText",ri,!0],["showMessage",ut],["updateFrame",ft],["updateTextArea",ct]],t.each(i,function(e,t){n[t[0]]=function(){for(var e,n=this,i=[n],s=0;s<arguments.length;s++)i.push(arguments[s]);return e=t[1].apply(n,i),t[2]?e:n}}),n.blurred=function(e){var n=t(this);return e?n.bind(a,e):n.trigger(a)},n.change=function(e){var n=t(this);return e?n.bind(p,e):n.trigger(p)},n.focused=function(e){var n=t(this);return e?n.bind(y,e):n.trigger(y)}}(jQuery),define("cleditor",function(){}),
/**
 * @license Proprietary - Please do not steal our hard work.
 * @Author: Christopher H. Kerley
 * @Last modified time: 2020-07-14
 * @Copyright: Palolo Education Inc. 2020
 */
define("forum-poster/Component",["ko","text!york-forum/poster/template.html","dispatcher/Dispatcher","york-forum/YorkForumStore","cleditor","york-forum/models/ForumPost"],function(e,t,n,i,s,r){return{viewModel:function ViewModel(t,s){this.dis=new n,this.isVisible=e.observable(!1),this.isSpinnerOn=e.observable(!1),this.isPostSuccessful=e.observable(!1),this.store=i.getInstance(),this.title=e.observable(""),this.titleHasFocus=e.observable(!1),this.isPostable=e.observable(!1),this.isValidBodyLength=e.observable(!1),this.bodyErrorMessage=e.observable(""),this.onStore=function(){var e=this.store.getPostError();if(e.length>0)return alert(e),void this.dis.dispatch("clearPosterError");this.isVisible(this.store.isForumPosterVisible()),this.isVisible()&&!this.store.isSpinnerOn()&&(this.refreshPoster(),this.titleHasFocus(!0)),this.isSpinnerOn(this.store.isSpinnerOn()),this.isPostSuccessful(this.store.isPostSuccessful())}.bind(this),this.store.sub(this.onStore),this.onTitle=function(e){e.length<3?this.isPostable(!1):this.isPostable(!0)}.bind(this),this.title.subscribe(this.onTitle),this.hide=function(){this.dis.dispatch("hideYorkForumPoster")}.bind(this),this.options={width:500,height:250,controls:"bold italic underline strikethrough subscript superscript | font size style | color highlight removeformat | bullets numbering | outdent indent | alignleft center alignright justify | undo redo | rule image link unlink | cut copy paste pastetext | print source",colors:"FFF FCC FC9 FF9 FFC 9F9 9FF CFF CCF FCF ",sizes:"1,2,3,4,5,6,7",styles:[["Paragraph","<p>"]],useCSS:!0,docType:'<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">',docCSSFile:"",bodyStyle:"margin:4px; font:32pt Arial,Verdana; cursor:text"},this.getMaxLength=function(){return 10096},this.onBodyChange=function(){var e=this.getEditorText();e.length<3?(this.isValidBodyLength(!1),this.bodyErrorMessage("Your message is too short.")):e.length>this.getMaxLength()?(this.isValidBodyLength(!1),this.bodyErrorMessage("Your message is too long.")):(this.isValidBodyLength(!0),this.bodyErrorMessage(""))}.bind(this);var o=this;this.initEditor=function(){try{o.editor=$("#forum-input").cleditor(this.options),o.editor[0].change(o.onBodyChange)}catch(e){console.log(e.message)}},$(document).ready(this.initEditor),this.refreshPoster=function(){this.editor[0].refresh()},this.getEditorText=function(){return this.editor[0].$area.val()},this.getTitle=function(){return this.title()},this.clear=function(){this.title(""),this.editor[0].clear()},this.post=function(){try{var e=r.buildOutgoing({title:this.getTitle(),body:this.getEditorText()});this.dis.dispatch("postForumMessage",e),this.clear()}catch(e){console.log(e)}}.bind(this)},template:t}}),define("text!forum-feed/template.html",[],function(){return"<link rel=\"stylesheet\"\n      href=\"./styles/components/york-forum/forum-feed.css?v=2.7\">\n</link>\n\n<div id='forum-feed' class='hide-scroll' data-bind='visible:isVisible()'>\n  <div id='post-message-holder'>\n    <span id='poster-icon-holder'>\n\n      \x3c!-- ko if: userPhotoURL() != null --\x3e\n          <img alt=\"User Photo\" id=\"poster-photo\" data-bind='attr:{src:userPhotoURL()}'>\n       \x3c!-- /ko --\x3e\n    \x3c!-- ko if: userPhotoURL() == null --\x3e\n      <i id='poster-replacement-photo'\n         class=\"fa fa-smile-o\"\n         ></i>\n     \x3c!-- /ko --\x3e\n\n    </span>\n      <input id='poster-input'\n              placeholder=\"What's new at YorkU?\"\n              data-bind='click:openPoster'>\n      </input>\n  </div>\n\n  <div data-bind='foreach:posts'>\n    <div class='forum-post-card' data-bind='click:$parent.showPost, css:{\"normal-cursor\" : expanded()}'>\n\n        <span class='upvote-holder disable-select'\n              data-bind='click:$parent.toggleVote'\n              data-toggle=\"tooltip\"\n              title=\"Upvote\">\n          <a class='glyphicon glyphicon-arrow-up feedback-arrow' data-bind='css:{ voted : alreadyVoted()}'></a>\n          <span class='upvote-count' data-bind='text:getVoteCount()'>0</span>\n        </span>\n\n\n\n        <div class='post-author-container'>\n            <span> Posted by </span>\n            &nbsp;\n            <span class='post-author' data-bind='click:$parent.gotoPerson'>\n              <span data-bind='text:getAuthor()'></span>\n\n              <span class='auth-info' data-bind='text:getRep()'>102</span>\n            </span>\n\n            &nbsp;\n            <span data-bind='text:getTimestamp()'></span>\n            &nbsp;\n            <span> ago </span>\n        </div>\n        <div class='post-title-container'>\n          <div class='post-title'>\n            <h3 class='post-title-text' data-bind='text:getTitle()'><h3>\n          </div>\n        </div>\n        <div class='post-message-container' data-bind='css:{ \"expanded-post-message-container\" : expanded()}'>\n          <div class='post-message' data-bind=\"html:getBody(), css:{ 'expanded-post-message' : expanded()}\"></div>\n        </div>\n        <div class='post-card-buttons-container'>\n          <div class='post-card-buttons'>\n            <a rel=\"nofollow\"\n               class='post-comment-anchor'>\n             <i class=\"glyphicon glyphicon-comment post-comment-icon\">\n            </i>\n            <span class=\"post-comments-text\" data-bind='text:replyCount()'>0</span> Comments\n          </a>\n          <a rel=\"nofollow\"\n             class='post-comment-anchor'\n             data-bind='visible:isPoster(), click:$parent.deletePost'>\n           <i class=\"glyphicon glyphicon-trash post-comment-icon\">\n          </i>\n          <span class=\"post-comments-text\">delete</span>\n        </a>\n          </div>\n        </div>\n\n        <div class=\"post-comment\" data-bind='visible:expanded()'>\n            <div class='comment-as-header'>Comment as <span data-bind='text:$parent.userFullName()'> First Last </span></div>\n            <textarea class='post-comment-message'\n                      data-bind='textInput:comment'\n                      placeholder=\"What are your thoughts?\">\n\n            </textarea>\n            <button class='blue-square-button' data-bind='click:$parent.commentPost'>COMMENT</button>\n        </div>\n\n        \x3c!-- recursive component --\x3e\n        <forum-reply class='root-reply'\n                     data-bind='visible:expanded()'\n                     params=\"replies: {isRoot:true, replies:replies, self:null}\">\n        </forum-reply>\n\n    </div>\n  </div>\n</div>\n"}),
/**
 * @license Proprietary - Please do not steal our hard work. Please do not steal our hard work.
 * @Author: Christopher H. Kerley
 * @Last modified time: 2020-07-14
 * @Copyright: Palolo Education Inc. 2020
 */
define("forum-feed/Component",["ko","text!forum-feed/template.html","dispatcher/Dispatcher","york-forum/YorkForumStore"],function(e,t,n,i){return{viewModel:function View(){this.dis=new n,this.isVisible=e.observable(!1),this.store=i.getInstance(),this.posts=e.observableArray([]),this.userPhotoURL=e.observable(""),this.userFullName=e.observable(""),this.onStore=function(){this.isVisible(this.store.isVisible());var e=this.store.getPosts();e.forEach(function(e){e.replies.valueHasMutated()}),this.posts(e),this.userPhotoURL(this.store.getUserPhoto()),this.userFullName(this.store.getUserName())}.bind(this),this.store.sub(this.onStore),this.gotoPerson=function(e,t){if(t)return t.stopPropagation(),!1}.bind(this),this.openPoster=function(){this.dis.dispatch("openForumPoster")}.bind(this),this.toggleVote=function(e,t){return e.isAlreadyVoted()?this.dis.dispatch("removeVote",e):this.dis.dispatch("upvotePost",e),t.stopPropagation(),!1}.bind(this),this.deletePost=function(e,t){return confirm("Are you sure you want to delete?")&&this.dis.dispatch("deleteForumPost",e),t.stopPropagation(),!1}.bind(this),this.showPost=function(e){if(e.isExpanded())return!1;this.dis.dispatch("showPost",e)}.bind(this),this.commentPost=function(e){var t=e.getId(),n=e.getCommentHTML();e.clearComment(),this.dis.dispatch("commentPost",{postId:t,message:n})}.bind(this)},template:t}}),define("text!york-forum/reply/template.html",[],function(){return"<link rel=\"stylesheet\"\n      href=\"./styles/components/york-forum/reply.css?v=2.3\">\n</link>\n\n\n\x3c!-- ko if: !isRoot() --\x3e\n    <div class='reply-box'>\n      <i class='reply-seperator'></i>\n      <div class='replier-info-row'>\n        <img class='reply-author-img' data-bind='attr:{ src : userPhotoURL()}'></img>\n        <span  class='reply-author' data-bind='text: author'></span>\n        <span class='reply-timestamp'>\n          - <span  data-bind='text: timestamp'></span> ago\n        </span>\n\n      </div>\n      <div  class='reply-message' data-bind='html: message'></div>\n      <div class='reply-response-row'>\n\n        <span data-toggle=\"tooltip\" title=\"Reply\" data-bind='click:openCommentBox'>\n          <i class=\"glyphicon glyphicon-comment post-comment-icon\">\n         </i>\n        </span>\n\n        <span data-toggle=\"tooltip\" title=\"Delete\" data-bind='visible:isOwner, click:deleteComment'>\n          <i class=\"glyphicon glyphicon-trash post-comment-icon\"></i>\n        </span>\n\n        <div class='post-comment' data-bind='visible:isCommentBoxOpen()'>\n          <textarea class='post-comment-message'\n                    data-bind='textInput:replyToReplyMessage, hasFocus:commentCommentHasFocus'\n                    placeholder=\"What do you think?\">\n          </textarea>\n          <button class='blue-square-button' data-bind='click:replyToReply'>COMMENT</button>\n        </div>\n\n\n      </div>\n    </div>\n\x3c!-- /ko --\x3e\n\n\n \x3c!-- ko foreach: replies --\x3e\n \x3c!-- note that what is available here is a reference to the reply object --\x3e\n   <forum-reply params='replies: {isRoot:false, replies:replies, self:getSelf}'></forum-reply>\n \x3c!-- /ko --\x3e\n"}),
/**
 * @license Proprietary - Please do not steal our hard work.
 * @Author: Christopher H. Kerley
 * @Last modified time: 2020-07-14
 * @Copyright: Palolo Education Inc. 2020
 */
define("forum-reply/Component",["ko","text!york-forum/reply/template.html","dispatcher/Dispatcher","york-forum/YorkForumStore"],function(e,t,n,i){function ReplyComponent(t){var i;return this.dis=new n,this.isRoot=e.observable(t.replies.isRoot),this.replies=t.replies.replies,t.replies.self&&(this.reply=t.replies.self(),this.replyId=this.reply.getId(),this.message=this.reply.getBody(),this.author=this.reply.getAuthor(),this.timestamp=this.reply.getTimestamp(),this.userPhotoURL=this.reply.getKOUserPhotoURL(),this.isOwner=this.reply.isOwner(),this.replyToReplyMessage=e.observable(""),this.isCommentBoxOpen=this.reply.commentBoxOpen,this.commentCommentHasFocus=e.observable(!1),this.deleteComment=function(){confirm("Are you sure you want to delete this?")&&this.dis.dispatch("deleteComment",this.reply)}.bind(this),this.openCommentBox=function(){this.isCommentBoxOpen(!0),this.commentCommentHasFocus(!0)}.bind(this),this.replyToReply=function(){var e={parentReply:this.reply,message:this.replyToReplyMessage().replace(/\n/gi,"<br />")};this.replyToReplyMessage(""),this.dis.dispatch("replyToReply",e)}.bind(this)),this.replies.length>0&&(t.replies.shift(),i=new ReplyComponent(t)),i}return{template:t,viewModel:{createViewModel:function(e,t){return new ReplyComponent(e)}}}}),define("text!york-forum/forum-stats/template.html",[],function(){return"\n<link rel=\"stylesheet\"\n      href=\"./styles/components/york-forum/stats.css?v=1\">\n<div id='forum-stats-holder' data-bind='visible:isVisible()'>\n  <img id='yorku-img' src='./assets/yorku.jpg'></img>\n  <div id='yorku-stats'>\n    <div id='school-name-title'>York University</div>\n    <div id='school-members'><span data-bind='text:memberCount()'></span> classmates registered</div>\n  </div>\n</div>\n"}),define("forum-stats/Component",["ko","text!york-forum/forum-stats/template.html","dispatcher/Dispatcher","york-forum/YorkForumStore"],function(e,t,n,i){return{viewModel:function(){this.dis=new n,this.store=i.getInstance(),this.isVisible=e.observable(!1),this.memberCount=e.observable(0),this.onStore=function(){this.memberCount(this.store.getMemberCount()),this.isVisible(this.store.isVisible())}.bind(this),this.store.sub(this.onStore)},template:t}}),define("text!class-list/template.html",[],function(){return'<link rel="stylesheet" href="./styles/components/person-panel/class-list.css?v=2.7">\n<div id="people-holder"\n    class="show-vert-scroll"\n    data-bind=\'visible: isVisible() == true\'>\n\n  <div class="person-list-wrapper">\n      <div id="no-members-yet" data-bind="visible:classmateList().length < 1">\n        No one is in this classroom yet.\n      </div>\n      <ul class="person-list"\n          data-bind="foreach:classmateList">\n\n            <li class="person-row"\n                draggable="false"\n                data-bind="click:$parent.classmateClicked,\n                           css:{\'person-row-selected\':$parent.selectedClassmate().getId() == getId(),\n                                \'professor-highlight\':getRole() == \'Professor\',\n                                \'professor-selected\':getRole() == \'Professor\' && $parent.selectedClassmate().getId() == getId()}">\n\n              <div class="person-card">\n                <span class="person-card-info">\n                  <span>\n                      <i class="glyphicon glyphicon-education person-attr-icon"></i>\n                      <span data-bind="text:getEducationLevel()"></span>\n                  </span>\n                  <span>\n                    <i class="glyphicon glyphicon-home person-attr-icon"></i>\n                    <span data-bind="text:getRes()"></span>\n                  </span>\n                  <span>\n                    <i class="glyphicon glyphicon-music person-attr-icon"></i>\n                    <span data-bind="text:getFavouriteMusic()"></span>\n                  </span>\n                </span>\n              </div>\n              <span class="name person-name disable-select"\n                    data-bind="text:getFirst() + \' \' + getLast() + \', \' + getAge()">\n                    first, last, 24\n              </span>\n              <span class="shared-classes disable-select" data-bind="visible:getSharedClassCount() > 1">\n                In <span data-bind="text:getSharedClassCount()"></span> of your classes.\n              </span>\n\n              <div class="dot presence-dot person-panel-dot-position"\n                   data-bind="visible:isPresent()">\n              </div>\n\n              <div class="last-seen"\n                   data-bind="visible:isPresent() == false, text:getLastSeen()"></div>\n\n\n              <div class="person-banner">\n                <div class="person-pic-holder">\n                  <img class="person-pic disable-select"\n                       draggable="false"\n                       data-bind="attr:{src:getSmallPhotoURL()}"/>\n\n                </div>\n              </div>\n              <div class="bevel"\n                   data-bind="css:{\'side-bevel\':$parent.selectedClassmate().getId() == getId()}">\n              </div>\n              <div id="hover-show-bevel"\n                  class="bevel side-bevel">\n              </div>\n              <span class="add-pal-btn-holder" data-bind=\'visible:isAddable()\'>\n                      <button class="add-pal add-pal-btn"\n                              data-bind="click:$parent.addPal">\n                              add friend\n                      </button>\n              </span>\n              <span class="already-friend" data-bind=\'visible:!isAddable()\'>\n                Already your friend.\n              </span>\n            </li>\n        </ul>\n\n   </div>  \x3c!-- person panel wrapper.   --\x3e\n</div>\n'}),
/**
 * @license Proprietary - Please do not steal our hard work.
 * @Author: Christopher H. Kerley
 * @Last modified time: 2019-08-24
 * @Copyright: Palolo Education Inc. 2020
 */
define("class-list/Component",["ko","dispatcher/Dispatcher","text!class-list/template.html","people-models/NullPerson","people-store/PeopleStore"],function(e,t,n,i,s){return{viewModel:function ViewModel(n,r){this.dis=new t,this.store=s.getInstance(),this.isVisible=e.observable(!1),this.groupInfo=e.observable({courseCode:"Coursecode"}),this.yourAMember=!1,this.isCourseJoinedMessageVisible=e.observable(!1),this.classmateList=e.observableArray([]),this.classmateList.extend({notify:"always"}),this.selectedClassmate=e.observable(new i),this.onStoreUpdated=function(){var e=this.store.isClassListVisible();if(this.isVisible(e),e){var t=this.store.getClassList();this.classmateList(t.toArray())}}.bind(this),this.store.sub(this.onStoreUpdated),this.setStore=function(e){this.store=e},this.getClassmateCount=function(){return this.classmateList().length},this.classmateClicked=function(e){var t=Object.getPrototypeOf(e);classmateid=t.id,this.dis.dispatch("focusPerson",e),this.selectedClassmate(e)},this.classmateClicked=this.classmateClicked.bind(this),this.onCourseViewSelected=function(){var e=new i;this.selectedClassmate(e)},this.onCourseViewSelected=this.onCourseViewSelected.bind(this),this.dis.reg("showGroupView",this.onCourseViewSelected),this.getSelectedFriendId=function(){return this.selectedClassmate().getId()},this.peopleSubscription=null,this.registerPeopleListChangeCallback=function(e){this.peopleSubscription=this.people.subscribe(e,this,"arrayChange")},this.unregisterPeopleListChangeCallbacks=function(){this.peopleSubscription.dispose()},this.updateView=function(){this.people.valueHasMutated()},this.updateView=this.updateView.bind(this),this.addPal=function(e,t){t.stopPropagation(),this.dis.dispatch("addPal",e)},this.addPal=this.addPal.bind(this)},template:n}}),define("text!course/course-features/template.html",[],function(){return'\n<link rel="stylesheet"\n      href="./styles/components/course/course-features.css?v=1.2">\n\n<div id="course-features" data-bind="visible:isVisible()">\n     <div id=\'course-loading-spinner\' data-bind=\'style: { opacity:isSpinnerVisible() ? 1.0 : 0.0 }\' class=\'small-spinner\'></div>\n     <tab-selector></tab-selector>\n     <in-another-section-prompt></in-another-section-prompt>\n     <forum></forum>\n     <class-list></class-list>\n     <course-reviews></course-reviews>\n     <course-docs></course-docs>\n</div>\n'}),define("course/models/Location",[],function(){return function Location(e){if(!e||"object"!=typeof e)throw new Error("Location constructor expects an object as an argument.");this.getConstructorName=function(){return"Location"},this._validateNonEmptyString=function(e,t){if(!t)throw new Error("_validateNonEmptyString must be supplied with a errorMessage");if(!e||"string"!=typeof e||e.length<1)throw new Error(t)},this.setId=function(e){if(!e||isNaN(e)||e<1)throw new Error("id must be a postive integer.");this._locationId=e},this.setId(e.location_id),this.getId=function(){return this._locationId},this.setLocationName=function(e){this._validateNonEmptyString(e,"location name must be a non-empty string."),this._locationName=e},this.setLocationName(e.location_name),this.getLocationName=function(){return this._locationName},this.setServerURLPrefix=function(e){this._validateNonEmptyString(e,"prefix must be a non-empty string."),this._serverURLPrefix=e},this.getServerURLPrefix=function(){return this._serverURLPrefix},this.setLocationImageURL=function(e){this._validateNonEmptyString(e,"url must be a non-empty string."),this._imgURL=e},this.setLocationImageURL(e.img_url),this.getLocationImageURL=function(){return this.getServerURLPrefix()+"/"+this._imgURL+"?"+(new Date).getTime()}}}),define("people-models/Prof",["people-models/Person","ko"],function(e,t){var n=function(n,i,s){Object.setPrototypeOf(this,new e(n,i)),this.years=t.observableArray([]),this.getConstructorName=function(){return"Prof"},this.addDoc=function(e){if(!e)throw new Error("expected doc");var n=new s(e,i),r=this.getYear(n);r?r.docs.push(n):this.years.push({year:n.year,docs:t.observableArray([n])})},this.getYear=function(e){for(var t=0;t<this.getYearCount();t++){var n=this.years()[t];if(n.year==e.year&&n.year==e.year)return n}return null},this.getYearAt=function(e){return this.years()[e]},this.getYearCount=function(){return this.years().length},this.getYears=function(){return this.years}};return n.getRaw=function(){return e.getRaw()},n.getFake=function(t){const i=e.getRaw();return new n(i,"host",t)},n}),define("course/models/CourseGroup",["course/models/Location","people-models/Prof","abstract-interfaces/ValidObject"],function(e,t,n){function CourseGroup(e,i){if(Object.setPrototypeOf(this,new n),!e||"object"!=typeof e)throw new Error("CourseSection constructor expects an object as an argument.");try{this.validateStr(i)}catch(e){throw new Error("host is required")}this.isGroup=function(){return!0},this.getHost=function(){return this.host},this.setHost=function(e){this.validateStr(e),this.host=e},this.setHost(i),this._validateId=function(e,t){if(!e||isNaN(e)||e<1)throw new Error(t)},this._validateNonEmptyString=function(e,t){if(!t)throw new Error("_validateNonEmptyString must be supplied with a errorMessage");if(!e||"string"!=typeof e||e.length<1)throw new Error(t)},this.setId=function(e){this._validateId(e,"groupId must be a postive integer."),this.groupId=e},this.setId(e.group_id),this.getId=function(){return this.groupId},this._validateNonEmptyString(e.section_letter,"section_letter must a non-empty string."),this._sectionLetter=e.section_letter,this.getSectionLetter=function(){return this._sectionLetter},this.setBuilding=function(e){if(!e||"string"!=typeof e)throw new Error("building cant be empty");this.building=e},this.setBuilding(e.building_name),this.getBuilding=function(){return this.building},this.inAnotherSection=function(){return this.isInAnotherSection},this.setInAnotherSection=function(e){if("boolean"!=typeof e)throw new Error("bool must be a boolean.");this.isInAnotherSection=e},this.setInAnotherSection(e.in_another_section),this.setImgUrl=function(e){this.imgUrl=e},this.setImgUrl(e.img_url),this.getImgUrl=function(){return this.getHost()+"/"+this.imgUrl},this.setDept=function(e){this._validateNonEmptyString(e,"dept must be non-empty."),this.dept=e},this.setDept(e.dept),this.getDept=function(){return this.dept},this.getCourseCode=function(){return this._courseCode},this.setCourseCode=function(e){this._validateNonEmptyString(e,"course_code must be a non-empty string."),this._courseCode=e},this.setCourseCode(e.course_code),this.getCourseDescription=function(){return this.description},this.setCourseDescription=function(e){this._validateNonEmptyString(e,"description must be a non-empty string."),this.description=e},this.setCourseDescription(e.description),this.setMembershipStatus=function(e){if("boolean"!=typeof e)throw new Error("membership status must be a boolean");this.isMemberStatus=e},this.setMembershipStatus(e.is_member),this.isMember=function(){return this.isMemberStatus},this.setProf=function(e){this.prof=new t(e,i)},this.setProf(e),this.getProf=function(){return this.prof},this.getProfsName=function(){return this.prof.getFirst()+" "+this.prof.getLast()},this.getProfsPhoto=function(){return this.prof.getSmallPhotoURL()}}return CourseGroup.getRaw=function(){return{group_id:1,dept:"EECS",course_code:"FAKE101",description:"Fake Course",section_letter:"A",is_member:!0,in_another_section:!1,building_name:"Accolade East",room_name:"001",id:2,first:"Nick",last:"Weber",small_photo_url:"small",large_photo_url:"large",role:"prof"}},CourseGroup.getFake=function(){return new CourseGroup(CourseGroup.getRaw(),"http://host")},CourseGroup}),define("course/models/ForumMessage",["ko","text-utilities"],function(e,t){var n=function(n){this.getConstructorName=function(){return"ForumMessage"},this.imgTag=e.observable(""),this.timestamp=n.timestamp,this.first=n.first,this.last=n.last,this.setFromSelf=function(e){this.isSelf=e},this.setFromSelf(n.from_self),this.setFromFriend=function(){this.isSelf=!1},this.setGroupId=function(e){if(!e||0==Number.isInteger(e))throw new Error("group_id is missing or malformed.");this.groupId=e},this.setGroupId(n.group_id),this.getGroupId=function(){return this.groupId},this.setSenderImgUrl=function(e){if(!e||"string"!=typeof e||e.length<1)throw new Error("sender_img_url is malformed.");this.sender_img_url=e},this.setSenderImgUrl(n.sender_img_url),this.setImgUrlPrefix=function(e){if(this.isHostSet)throw new Error("host has already been set on this forum message.");this.sender_img_url=e+"/"+this.sender_img_url},this.getImgUrl=function(){return this.sender_img_url},this.getImgTag=function(){return this.imgTag()},this.hasImage=e.computed(function(){return this.sender_img_url&&this.sender_img_url.length>0},this),this.getText=function(){return this.text},this.setText=function(e){if(!("string"==typeof e&&e.length>0))throw new Error("text must be non-empty string");this.text=e},this.setText(n.text),this.isSelfMessage=function(){return 1==this.isSelf},this.setAsFriend=function(){this.isSelf=!1},this.getHTML=function(){var e=this.getText();return this.isSelfMessage()?t.wrapLinks(e,"forum-self-msg-link"):t.wrapLinks(e,"forum-friend-msg-link")}};return n.getRaw=function(){return{group_id:1,text:"text",timestamp:"2 min ago.",first:"chris",last:"kerley",isSelf:!0,sender_img_url:"123.jpeg"}},n.getFake=function(){return new n(n.getRaw(),"http://forum.localhost")},n.createSelfMessage=function(e,t){return new n({first:"",from_self:!0,sender_img_url:"http",text:e,timestamp:"moments ago.",group_id:t})},n}),define("course/models/ForumMessageCollection",["course/models/ForumMessage"],function(e){var t=function(){this.msgs=[],this.getConstructorName=function(){return"ForumMessageCollection"},this.getSize=function(){return this.msgs.length},this.add=function(e){if("object"!=typeof e||!e.getConstructorName||"ForumMessage"!=e.getConstructorName())throw new Error("can only add ForumMessages.");this.msgs.push(e)},this.get=function(e){return this.msgs[e]},this.toArray=function(){return this.msgs},this.clear=function(){this.msgs=[]}};return t.getFake=function(){return new t},t}),define("course/CourseRemoteService",["ActiveRemoteService","socketio","dispatcher/Dispatcher","people-models/Pal","course/models/CourseGroup","course/models/ForumMessageCollection","course/models/ForumMessage"],function(e,t,n,i,s,r,o){var a=function(){this.dis=new n,this.constructor=a,Object.setPrototypeOf(this,new e),this.setMicroServer("course"),this.init=function(e){this.setSock(),this.sock.on("io_error",this.somethingBadHappened),this.sock.on("error",this.somethingBadHappened),this.sock.on("disconnect",this.somethingBadHappened),this.sock.on("connect",this.getMyCourseGroups),this.sock.on("myCourseGroups",this.onMyCourseGroups),this.sock.on("classmateCourses",this.onClassmateCourses),this.sock.on("courseLeft",this.onCourseLeft),this.sock.on("coursePhotoUpdate",this.onCoursePhotoUpdate),this.sock.on("forumMessages",this.onForumMessageCollectionReceived),this.sock.on("forumMessageReceived",this.onForumMessageReceived),this.sock.on("groupInfo",this.onGroupReceived),this.sock.on("groupJoined",this.onGroupJoined)}.bind(this),this.onAuth=function(e){e&&"authenticated"==e.state&&this.init()},this.onAuth=this.onAuth.bind(this),this.dis.reg("authState",this.onAuth),this.getMyCourseGroups=function(){this.sock.emit("getMyCourseGroups")}.bind(this),this.onMyCourseGroups=function(e){var t=this.wrapCourseGroups(e);this.dis.dispatch("myCourseGroups",t)}.bind(this),this.somethingBadHappened=function(e){console.log("Something bad happened:"),console.log(e.message)},this.onCourseLeft=function(e){this.dis.dispatch("courseLeft",e)}.bind(this),this.getClassmatesCourses=function(e){this.sock.emit("getCurrentCoursesFor",this.flatten(e))}.bind(this),this.onPalFocusId=this.dis.reg("focusPerson",this.getClassmatesCourses),this.onClassmateCourses=function(e){if(!e.classmatesId||0==Number.isInteger(e.classmatesId)||e.classmatesId<1)throw new Error("classmatesId must be a positive integer.");var t=e.classmatesId,n=this.wrapCourseGroups(e.grps);this.dis.dispatch("classmateCourses",{classmatesId:t,grps:n})}.bind(this),this.wrapCourseGroups=function(e){var t=[],n=this.getServerURL();return e.forEach(function(e){t.push(new s(e,n))}),t},this.onSwitchCourse=function(e){this.sock.emit("switchToCourseGroup",e)},this.onSwitchCourse=this.onSwitchCourse.bind(this),this.dis.reg("switchToCourseGroup",this.onSwitchCourse),this.onGroupReceived=function(e){var t=new s(e,this.getServerURL());this.dis.dispatch("groupInfo",t),this.joinGroupForum(t.getId())}.bind(this),this.getCourseGroup=function(e){this.sock.emit("getCourseGroup",e)}.bind(this),this.getGroupId=this.dis.reg("selectedGroupId",this.getCourseGroup),this.registerOnIsProfilePhotoSet=function(e){this._checkType(e),this.onIsProfilePhotoSet=e},this.joinCourse=function(e){this.sock.emit("joinCourse",e)}.bind(this),this.joinCourseId=this.dis.reg("joinCourse",this.joinCourse),this.onGroupJoined=function(e){this.dis.dispatch("groupJoined",e)}.bind(this),this.leaveCourseGroup=function(e){if(isNaN(e)||!e)throw new Error("courseId must be a number");this.sock.emit("leaveCourseGroup",e)},this.onForumMessageReceived=function(e){var t=new o(e);t.setImgUrlPrefix(this.getServerURL()),this.dis.dispatch("forumMessageReceived",t)}.bind(this),this.sendForumMessage=function(e){this.sock.emit("sendForumMessage",e)}.bind(this),this.sendForumMessageId=this.dis.reg("sendForumMessage",this.sendForumMessage),this.sendImage=function(e,t,n){if(!e||"number"!=typeof e||e<1)throw new Error("courseId must be a postive integer.");var i=new RegExp("base64");if("string"!=typeof t||0==i.test(t))throw new Error("base64Image must be a base64 string.");var s={courseId:e,base64:t,text:n};this.sock.emit("imageUpload",s,this.onImageSent)},this.registerOnImageSent=function(e){this._checkType(e),this.onImageSent=e},this.registerOnMessagesReceived=function(e){this._checkType(e),this.onMessagesReceived=e},this.onGetMessagesError=function(e,t,n){console.log(n)},this.joinGroupForum=function(e){this.sock.emit("joinGroupForum",e)},this.joinGroupForum=this.joinGroupForum.bind(this),this.onForumMessageCollectionReceived=function(e){if(0==Array.isArray(e))throw new Error("raw is expected to be an array.");for(var t=new r,n=0;n<e.length;n++){var i=new o(e[n]);i.setImgUrlPrefix(this.getServerURL()),t.add(i)}this.dis.dispatch("forumMessages",t)},this.onForumMessageCollectionReceived=this.onForumMessageCollectionReceived.bind(this),this.registerOnCheckedInLocation=function(e){this._checkType(e),this.onCheckInLocation=e},this.emitLocation=function(e,t){if("object"!=typeof location)throw new Error("location must be an object");var n={coords:{accuracy:t.coords.accuracy,latitude:t.coords.latitude,longitude:t.coords.longitude},timestamp:t.timestamp};this._checkType(this.onCheckInLocation);var i={courseId:e,location:n},s=JSON.stringify(i);this.sock.emit("checkInLocation",s,this.onCheckInLocation)},this.onSavePhoto=function(e){this.sock.emit("saveCoursePhotograph",e)},this.onSavePhoto=this.onSavePhoto.bind(this),this.onPhotoId=this.dis.reg("saveCoursePhotograph",this.onSavePhoto),this.onCoursePhotoUpdate=function(e){this.dis.dispatch("coursePhotoUpdate",e)},this.onCoursePhotoUpdate=this.onCoursePhotoUpdate.bind(this),this._checkType=function(e){if("function"!=typeof e)throw new Error("callback must be a function.")}};return a}),define("course/models/CourseSection",[],function(){function CourseSection(e){if(!e||"object"!=typeof e)throw new Error("CourseSection constructor expects an object as an argument.");this.getConstructorName=function(){return"CourseSection"},this.setSectionId=function(e){if(isNaN(e)||e<1||0==Number.isInteger(e))throw new Error("sectionId must be a postive integer.");this.sectionId=e},this.setSectionId(e.section_id),this.getId=function(){return this.sectionId},this.setSectionLetter=function(e){if("string"!=typeof e||e.length<1)throw new Error("sectionLetter must be a non empty string.");this.sectionLetter=e},this.setSectionLetter(e.section_letter),this.getLetter=function(){return this.sectionLetter}}return CourseSection.makeSectionsArray=function(e){var t=[];if(0==Array.isArray(e)||e.length<1)throw new Error("sections must be a non-empty array.");for(var n=0;n<e.length;n++){var i=new CourseSection(e[n]);t.push(i)}return t},CourseSection}),define("course/CourseStore",["jquery","ko","course/CourseRemoteService","dispatcher/Dispatcher","course/models/CourseGroup","course/models/CourseSection","course/models/ForumMessage","course/models/ForumMessageCollection","abstract-interfaces/Store"],function(e,t,n,i,s,r,o,a,c){var d=null,u=function(){Object.setPrototypeOf(this,new c),this.dis=new i,this.remoteService=new n,this.isWaitingForServer=!1,this.waitingToJoin=!1,this.userHasProfilePhoto=!1,this.waitingForRequiredPhoto=!1,this.showThankYouMessage=!1,this.group=null,this.classmatesCourseGroups=[],this.classmatesId=null,this.isGrpVisible=!1,this.forumMessages=new a,this.forumMsgWasFromSelf=!1,this.isThankYouForUploadingPhotoMessageVisible=t.observable(!1),this.selectedFeature=null,this.getDis=function(){return this.dis},this.getRemoteService=function(){return this.remoteService},this.getSelectedFeature=function(){return this.selectedFeature},this.onCourseFeatureSelection=function(e){this.selectedFeature=e,this.pub()}.bind(this),this.dis.reg("courseFeatureSelection",this.onCourseFeatureSelection),this.setImageURLPrefix=function(e){var t=this.remoteService.getServerURL();e.sender_img_url&&(e.sender_img_url=t+"/"+e.sender_img_url+"?"+(new Date).getTime())},this.setExperimentalMode=function(e){var t=e%2;0==t?this.isExperimentalGroup=!1:1==t&&(this.isExperimentalGroup=!0)},this.setCurrentCourseGroup=function(e){if(!e||!e.isGroup||!e.isGroup())throw new Error("group must be an instance of CourseGroup.");this.group=e},this.onClassmateCourseGroups=function(e){e.grps.forEach(function(e){if(!e||!e.isGroup||!e.isGroup())throw new Error("All groups must be a CourseGroup.")}),this.classmatesCourseGroups=e.grps,this.classmatesId=e.classmatesId,this.pub()}.bind(this),this.onPalsCoursesId=this.dis.reg("classmateCourses",this.onClassmateCourseGroups),this.getClassmatesId=function(){return this.classmatesId},this.getClassmateCourseGroups=function(){return this.classmatesCourseGroups},this.isGroupViewVisible=function(){return this.isGrpVisible},this.setGroupViewVisible=function(){this.isGrpVisible=!0,this.pub()},this.openGroupView=function(){this.isGrpVisible=!0,this.pub()}.bind(this),this.dis.reg("showGroupView",this.openGroupView),this.closeGroupView=function(){this.isGrpVisible=!1,this.pub()}.bind(this),this.dis.reg("closeGroupView",this.closeGroupView),this.dis.reg("openNews",this.closeGroupView),this.onFocusPerson=function(){this.isGrpVisible=!1,this.pub()}.bind(this),this.dis.reg("focusPerson",this.onFocusPerson),this.getGroupId=function(){return this.group.getId()},this.isGroupMember=function(){return!(!this.group||!this.group.isMember())},this.onCourseGroupJoined=function(e){if(!e||isNaN(e)||e<1)throw new Error("groupId is malformed.");if(e!==this.group.getId())throw new Error("groupId does not match currently selected groupId");this.group.setMembershipStatus(!0),this.pub(),this.waitingToJoin=!1}.bind(this),this.grpJoinedId=this.dis.reg("groupJoined",this.onCourseGroupJoined),this.isWaiting=function(){return this.isWaitingForServer},this.setWaitingForGroup=function(){this.isWaitingForServer=!0,this.pub()}.bind(this),this.dis.reg("selectedGroupId",this.setWaitingForGroup),this.onSaveCoursePhotograph=function(){this.isWaitingForServer=!0,this.pub()}.bind(this),this.dis.reg("saveCoursePhotograph",this.onSaveCoursePhotograph),this.isWaitingToJoin=function(){return this.waitingToJoin},this.setWaitingToJoin=function(){this.waitingToJoin=!0},this.onJoinCourse=function(){this.setWaitingToJoin(),this.pub()}.bind(this),this.dis.reg("joinCourse",this.onJoinCourse),this.onCoursePhotoUpdate=function(e){e.groupId==this.group.getId()&&(this.group.setImgUrl(e.imgUrl),this.pub())}.bind(this),this.dis.reg("coursePhotoUpdate",this.onCoursePhotoUpdate),this.onLeaveSelectedCourse=function(){var e=this.group.getId();this.remoteService.leaveCourseGroup(e)}.bind(this),this.dis.reg("leaveSelectedCourse",this.onLeaveSelectedCourse),this.onCourseLeft=function(e){e===this.group.getId()&&(this.group.setMembershipStatus(!1),this.group.setInAnotherSection(!1),this.pub())}.bind(this),this.courseLeftId=this.dis.reg("courseLeft",this.onCourseLeft),this.getCurrentGroup=function(){return this.group},this.onCourseGroupReceived=function(e){this.group=e,this.isWaitingForServer=!1,this.openGroupView()}.bind(this),this.groupReceivedId=this.dis.reg("groupInfo",this.onCourseGroupReceived),this.getGroupInfo=function(){return this.group},this.onCheckInLocation=function(e){var t=this.group.getId();this.remoteService.emitLocation(t,e)}.bind(this),this.checkInLocationCallbackId=this.dis.reg("checkInLocation",this.onCheckInLocation),this.onUserInfo=function(e){e.large_photo_url?this.userHasProfilePhoto=!0:this.userHasProfilePhoto=!1,this.userHasProfilePhoto&&this.isWaitingForRequiredPhoto()&&(this.setShowThankYouMessage(!0),this.setWaitingForRequiredPhoto(!1)),this.pub()}.bind(this),this.dis.reg("profileUpdate",this.onUserInfo),this.setUserHasProfilePhoto=function(e){this.userHasProfilePhoto=e},this.isWaitingForRequiredPhoto=function(){return this.waitingForRequiredPhoto},this.setWaitingForRequiredPhoto=function(e){this.waitingForRequiredPhoto=e},this.setShowThankYouMessage=function(e){this.showThankYouMessage=e},this.showThankyouMessage=function(){return this.showThankYouMessage},this.onShowProfileSetter=function(){0==this.userHasProfilePhoto&&(this.waitingForRequiredPhoto=!0)}.bind(this),this.dis.reg("showProfileSetter",this.onShowProfileSetter),this.userHasProfilePhoto=function(){return this.userHasProfilePhoto},this.hasJoinedForum=t.observable(!1),this.forumMessagesuccessfullySent=!1,this.onForumMessageCollectionReceived=function(e){if("object"!=typeof e||e instanceof a==0)throw new Error("ForumMessageCollection expected");this.forumMessages=e,this.pub()}.bind(this),this.forumMessagesId=this.dis.reg("forumMessages",this.onForumMessageCollectionReceived),this.setForumMessages=function(e){if(!(e instanceof a))throw new Error("msgs is expected to be a ForumMessageCollection!");this.forumMessages=e},this.getForumMessages=function(){return this.forumMessages},this.onForumMessageReceived=function(e){if("object"!=typeof e||e instanceof o==0)throw new Error("msg must be a ForumMessage");e.getGroupId()==this.getCurrentGroup().getId()&&(this.forumMessages.add(e),e.isSelfMessage()?this.setWasFromSelf():this.setWasNotFromSelf(),this.pub())}.bind(this),this.forumMessageResId=this.dis.reg("forumMessageReceived",this.onForumMessageReceived),this.setWasFromSelf=function(){this.forumMsgWasFromSelf=!0},this.setWasNotFromSelf=function(){this.forumMsgWasFromSelf=!1},this.wasLastMessageFromSelf=function(){return this.forumMsgWasFromSelf}};return{getNew:function(){return new u},getInstance:function(){return d||(d=new u),d}}}),define("course-features/Component",["ko","dispatcher/Dispatcher","text!course/course-features/template.html","course/CourseStore"],function(e,t,n,i){return{viewModel:function(){this.store=i.getInstance(),this.dis=new t,this.isVisible=e.observable(!1),this.isSpinnerVisible=e.observable(!1),this.onStoreChanged=function(){this.isSpinnerVisible(this.store.isWaiting()),this.isVisible(this.store.isGroupViewVisible())}.bind(this),this.store.sub(this.onStoreChanged)},template:n}}),define("text!course/tab-selector/template.html",[],function(){return'<link rel="stylesheet" href="./styles/components/course/tab-selector.css?v=1.4">\n<div id="tab-selector" data-bind=\'visible:isVisible()\'>\n\n  <span class="course-tab-selector disable-select"\n        data-bind="click:selectCourseForum">\n       Forum\n    <span class="course-tab-underline">\n    </span>\n    <span class="visible-tab-underline"\n          data-bind="visible: forumSelected()">\n   </span>\n  </span>\n\n\n\n  <span class="course-tab-selector disable-select"\n        data-bind="click:selectClassList">\n       Classmates\n      <span class="course-tab-underline"\n         data-bind="visible: classListSelected()">\n      </span>\n  </span>\n\n\n  \x3c!-- <span class="course-tab-selector disable-select"\n         data-bind="click:selectCourseReviews">\n         Reviews\n    <span class="course-tab-underline"></span>\n    <span class="visible-tab-underline"\n          data-bind="visible: courseReviewsSelected()">\n   </span>\n  </span> --\x3e\n\n  <span class="course-tab-selector disable-select"\n         data-bind="click:selectNoteShare">\n         Shared Notes\n    <span class="course-tab-underline"></span>\n    <span class="visible-tab-underline"\n          data-bind="visible: noteShareSelected()">\n   </span>\n  </span>\n\n\n\n</div>\n'}),define("course/tab-selector/TabSelectorStore",["ko","dispatcher/Dispatcher","abstract-interfaces/Store"],function(e,t,n){var i=null,s=function(){Object.setPrototypeOf(this,new n),this.dis=new t,this.noteShareVisible=!1,this.classListVisible=!1,this.reviewsVisible=!1,this.forumVisible=!1,this.visible=!1,this.isTabSelectorVisible=function(){return this.visible},this.isNoteShareVisible=function(){return this.noteShareVisible},this.isClassListVisible=function(){return this.classListVisible},this.isCourseReviewsVisible=function(){return this.reviewsVisible},this.isCourseForumVisible=function(){return this.forumVisible},this.setCourseForumInvisible=function(){this.forumVisible=!1},this.onShowGroupView=function(){this.visible=!0,this.pub()}.bind(this),this.dis.reg("selectedGroupId",this.onShowGroupView),this.onHideGroupView=function(){this.visible=!1,this.pub()}.bind(this),this.dis.reg("hideGroupView",this.onHideGroupView),this.onShowNoteShare=function(e){this.noteShareVisible="noteShare"==e,this.pub()}.bind(this),this.dis.reg("courseFeatureSelection",this.onShowNoteShare),this.onShowCourseReviews=function(e){this.reviewsVisible="courseReviews"==e,this.pub()}.bind(this),this.dis.reg("courseFeatureSelection",this.onShowCourseReviews),this.onShowCourseForum=function(e){this.forumVisible="courseForum"==e,this.pub()}.bind(this),this.dis.reg("courseFeatureSelection",this.onShowCourseForum),this.onShowClasslist=function(e){this.classListVisible="classList"==e,this.pub()}.bind(this),this.dis.reg("courseFeatureSelection",this.onShowClasslist)};return{getNew:function(){return new s},getInstance:function(){return i||(i=new s),i}}}),define("tab-selector/Component",["ko","text!course/tab-selector/template.html","dispatcher/Dispatcher","course/tab-selector/TabSelectorStore"],function(e,t,n,i){return{viewModel:function TabSelectorViewModel(){this.dis=new n,this.store=i.getInstance(),this.isVisible=e.observable(!1),this.forumSelected=e.observable(!1),this.classListSelected=e.observable(!1),this.courseReviewsSelected=e.observable(!1),this.noteShareSelected=e.observable(!1),this.onStore=function(){var e=this.store.isTabSelectorVisible();this.isVisible(e),e&&(this.forumSelected(this.store.isCourseForumVisible()),this.classListSelected(this.store.isClassListVisible()),this.courseReviewsSelected(this.store.isCourseReviewsVisible()),this.noteShareSelected(this.store.isNoteShareVisible()))}.bind(this),this.store.sub(this.onStore),this.selectCourseForum=function(){this.dis.dispatch("courseFeatureSelection","courseForum")}.bind(this),this.selectClassList=function(){this.dis.dispatch("courseFeatureSelection","classList")}.bind(this),this.selectCourseReviews=function(){this.dis.dispatch("courseFeatureSelection","courseReviews")}.bind(this),this.selectNoteShare=function(){this.dis.dispatch("courseFeatureSelection","noteShare")}.bind(this)},template:t}}),define("text!forum/template.html",[],function(){return'<link rel="stylesheet" href="./styles/components/course/forum.css?v=1.4">\n\n<div id="classroom-holder"\n     data-bind="visible:isVisible()">\n\n     \x3c!-- spinner --\x3e\n     <div  class="screen-center-outer">\n      <div class="screen-center-inner">\n         <div class="loader"\n              data-bind="visible:isSpinnerVisible()">\n         </div>\n      </div>\n    </div>\n\n    \x3c!-- question prompt --\x3e\n\n  <div id="empty-forum-prompt"\n       data-bind="visible:messages().length <= 0 && isSpinnerVisible() == false">\n    <div id=\'forum-group-name\' data-bind=\'text:groupName()\'>Not sure who to ask for help?</div>\n      <div id=\'forum-group-prompt\'>Why not join the conversation?</div>\n  </div>\n\n  <ul data-bind="foreach:messages"\n      id="classroom-messages"\n      class="show-vert-scroll">\n\n    <li class="forum-message"\n        data-bind="css:{ \'self-message\': isSelfMessage(), \'youtube-embed\' : /iframe/.test(getHTML()) }">\n\n      \x3c!-- ko if: typeof getImgUrl() == \'string\' --\x3e\n        <img data-bind="attr:{src:getImgUrl()}"\n             class="classroom-chat-img disable-select">\n        </img>\n      \x3c!-- /ko --\x3e\n\n      \x3c!-- ko if: typeof getImgUrl() != \'string\' && isSelf == false --\x3e\n        <img src="./assets/no-photo.jpg"\n             class="classroom-chat-img disable-select">\n        </img>\n      \x3c!-- /ko --\x3e\n\n\n\n      <span class="plain-text-post">\n        <span data-bind="html:getHTML()"\n              class="chat-text">\n        </span>\n        <span data-bind="text:timestamp"\n              class="classroom-timestamp disable-select">\n        </span>\n        <span data-bind="visible:isSelf == false, text:first + \' \' + last"\n              class="users-name">\n        </span>\n      </span>\n    </li>\n  </ul>\n\n\n\n\n  <div class="message-sender">\n\n      <div id="forum-message-sent"\n           data-bind="visible:showSent()">\n           sent!\n      </div>\n      <div id="forum-message-sent"\n           data-bind="visible:isSendingMessageVisible()">\n           sending.\n      </div>\n      <textarea\n                id="forum-chat-textarea"\n                rows="1"\n                class="show-vert-scroll message-input-holder"\n                placeholder="Type your message here."\n                type="text"\n                data-bind="textInput:newMessage,\n                        event:{\'keydown\':onKeyPress} ,\n                        hasFocus: inputHasFocus(),\n                        click: inputClicked">\n      </textarea>\n\n\n      <button\n              class="disable-select send-message-btn"\n              data-bind="enable:isValidInput(), click:sendForumMessage, css:{}">\n              SEND\n      </button>\n    </div>\n\n</div>\n\x3c!--  end of course holder--\x3e\n'}),define("forum/Component",["ko","text-utilities","text!forum/template.html","dispatcher/Dispatcher","course/models/ForumMessage","course/CourseStore"],function(e,t,n,i,s,r){return{viewModel:function ForumViewModel(){this.dis=new i,this.store=r.getInstance(),this.messages=e.observableArray([]),this.newMessage=e.observable(""),this.isVisible=e.observable(!1),this.isSpinnerVisible=e.observable(!1),this.inputHasFocus=e.observable(!1),this.isNewFeatureVisible=e.observable(!1),this.isSendingMessageVisible=e.observable(!1),this.showSent=e.observable(!1),this.hasBeenInitialized=!1,this.groupName=e.observable(""),this.onStoreChanged=function(){var e=this.store.getGroupInfo();e&&e.isGroup&&e.isGroup()&&(this.groupName(e.getDept()+" "+e.getCourseCode()+" Section "+e.getSectionLetter()),this.isVisible("courseForum"==this.store.getSelectedFeature()),this.populateMessages(),this.store.wasLastMessageFromSelf()&&this.onMessageSent())}.bind(this),this.store.sub(this.onStoreChanged,this),this.resizeTextArea=function(){var e=this.newMessage().split(/\r\n|\r|\n/).length;$("#forum-chat-textarea").attr("rows",e)}.bind(this),this.onMessageSent=function(){this.isSendingMessageVisible(!1),this.showSent(!0);var e=this;e.sentId&&clearTimeout(e.sentId),e.sentId=setTimeout(function(){e.showSent(!1)},2e3),this.resizeTextArea()},this.onMessageSent=this.onMessageSent.bind(this),this.populateMessages=function(){var e=this.store.getForumMessages().toArray();this.messages([]);for(var t=0;t<e.length;t++)this.messages.unshift(e[t]);this.isSpinnerVisible(!1)}.bind(this),this.newMessage.subscribe(function(e){/\S/.test(e)?this.isValidInput(!0):this.isValidInput(!1)},this),this.isValidInput=e.observable(!1),this.onKeyPress=function(e,n){return this.resizeTextArea(),n.send=this.sendForumMessage,t.onKeyPress(n)}.bind(this),this.sendForumMessage=function(){var e=this.newMessage();e=t.formatToHTML(e);var n=this.store.getCurrentGroup().getId(),i=s.createSelfMessage(e,n);this.messages.unshift(i),this.dis.dispatch("sendForumMessage",i),this.newMessage(""),this.isSendingMessageVisible(!0)}.bind(this),this.appendMessage=function(e){if(e instanceof s==0)throw new Error("expected messaged to be a ForumMessage");this.messages.unshift(e)},this.appendMessage=this.appendMessage.bind(this),this.inputClicked=function(){this.inputHasFocus(!0)}},template:n}}),define("text!non-member-prompt/template.html",[],function(){return'<link rel="stylesheet"\n      href="./styles/components/course/prompts/non-member.css">\n\n  <div\n      id="course-joined-message"\n      data-bind="visible:showCourseJoinedMessage()">\n    <span>You have joined!</span>\n    <span id="ok-sign">\n      &#10003;\n    </span>\n  </div>\n\n\n<div id="membership-prompt-holder"\n      data-bind="visible:isVisible()">\n\n  \x3c!-- spinner --\x3e\n  <div  class="screen-center-outer">\n   <div class="screen-center-inner">\n      <div class="loader"\n           data-bind="visible:isSpinnerVisible()">\n      </div>\n   </div>\n </div>\n\n  <div data-bind="text:joinPromptMessage(),\n                  visible:userHasPhoto() == false">\n  </div>\n\n  <div data-bind="visible:userHasPhoto() == false">\n       <img id=\'empty-photo-button\'\n            data-bind="click:showProfileSetter, attr:{src:profilePhotoURL}"\n            src="#">\n        </img>\n  </div>\n\n\n  <button class="large-blue-button"\n           data-bind="disable: userHasPhoto() == false, click:joinCourse">\n    Join\n  </button>\n\n  <div id="thank-you-message"\n       data-bind="visible: isThankYouMessageVisible()">\n    <div>Thank you!</div>\n    <div>Now you are free</div>\n    <div>to join. &#128513;</div>\n  </div>\n\n</div>\n'}),define("non-member-prompt/Component",["ko","text!non-member-prompt/template.html","dispatcher/Dispatcher","course/CourseStore"],function(e,t,n,i){return{viewModel:function MembershipPromptViewModel(){this.store=i.getInstance(),this.dis=new n,this.isVisible=e.observable(!1),this.isSpinnerVisible=e.observable(!1),this.userHasPhoto=e.observable(!0),this.profilePhotoURL="./assets/no-photo.jpg",this.joinPromptMessage=e.observable("Upload your photo to join."),this.showCourseJoinedMessage=e.observable(!1),this.isThankYouMessageVisible=e.observable(!1),this.courseCode=e.observable(""),this.sectionLetter=e.observable(""),this.onStoreChange=function(){this.store.isWaitingToJoin()&&this.showGroupJoined();var e=this.store.getGroupInfo();!e||e.isMember()||e.inAnotherSection()?this.isVisible(!1):(this.isVisible(!0),this.courseCode(e.getCourseCode()),this.sectionLetter(e.getSectionLetter()),this.userHasPhoto(this.store.userHasProfilePhoto),this.store.showThankyouMessage()&&(this.isThankYouMessageVisible(!0),this.dis.dispatch("hideProfileSetter")))}.bind(this),this.store.sub(this.onStoreChange),this.joinCourse=function(){if(!this.store.getCurrentGroup())throw new Error("groupInfo has not been initialized yet.");this.isSpinnerVisible(!0);var e=this.store.getCurrentGroup().getId();this.isThankYouMessageVisible(!1),this.dis.dispatch("joinCourse",e)},this.showGroupJoined=function(){this.isSpinnerVisible(!1),this.showCourseJoinedMessage(!0),this.isThankYouMessageVisible(!1);var e=this;window.setTimeout(function(){e.showCourseJoinedMessage(!1),e.isVisible(!1)},2500)}.bind(this),this.showProfileSetter=function(){this.dis.dispatch("showProfileSetter")}},template:t}}),define("text!in-another-section-prompt/template.html",[],function(){return'<link rel="stylesheet" href="./styles/components/course/prompts/in-another-section.css">\n\n<div data-bind="visible:isVisible()" id=\'in-another-section-holder\'>\n     <div>\n              You are already in another section for\n          <span data-bind="text:dept() + courseCode()"></span>\n     </div>\n     <div id="another-section-switch">Switch to this section?</div>\n     <div>\n       <button data-bind="click:switchCourse">Yes</button>\n     </div>\n</div>\n'}),define("in-another-section-prompt/Component",["ko","text!in-another-section-prompt/template.html","dispatcher/Dispatcher","course/CourseStore"],function(e,t,n,i){return{viewModel:function InAnotherSectionViewModel(){this.store=i.getInstance(),this.dis=new n,this.sectionLetter=e.observable(""),this.courseCode=e.observable(""),this.dept=e.observable(""),this.isVisible=e.observable(!1),this.onStoreChange=function(){var e=this.store.getCurrentGroup(),t=e&&!e.isMember()&&e.inAnotherSection();this.isVisible(t),t&&(this.sectionLetter(e.getSectionLetter()),this.dept(e.getDept()),this.courseCode(e.getCourseCode()))},this.onStoreChange=this.onStoreChange.bind(this),this.store.sub(this.onStoreChange),this.switchCourse=function(){var e=this.store.getCurrentGroup();this.dis.dispatch("switchToCourseGroup",e)}},template:t}}),define("text!course-reviews/template.html",[],function(){return"<link rel=\"stylesheet\" href=\"./styles/components/course-reviews/style.css\">\n\n<div  id='course-reviews-holder' data-bind='visible:isVisible()'>\n<div class='post-comment'>\n  <div class=\"comment-as-header\">Review as <span data-bind=\"text:'First Last'\"></span></div>\n  <textarea class='post-comment-message'\n            placeholder=\"What did you think of this course?\">\n\n  </textarea>\n  <button class='blue-square-button'>Submit</button>\n</div>\n\n\n<ul id='review-list' data-bind='foreach:reviews'>\n  <li class='course-review'>\n\n    <span class='review-helpfulness-vote'>\n      \x3c!-- <span class='review-votes-holder'>\n        <span data-bind='text:votes'></span>\n        <span class='glyphicon glyphicon-arrow-up'></span>\n      </span> --\x3e\n    </span>\n    <span class='reviewer'>\n      <span class='reviewer-image-holder'>\n        <img class='reviewer-image' src='./assets/no-photo.jpg'></img>\n        <div class='reviewer-name' data-bind='text:name'></div>\n      </span>\n    </span>\n    <span class='review-text'>\n      <div class='review-text-title' data-bind='text:title'></div>\n      <div class='review-text-body' data-bind='text:body'></div>\n    </span>\n  </li>\n</ul>\n\n</div>\n"}),define("course-reviews/ReviewsStore",["dispatcher/Dispatcher","abstract-interfaces/Store"],function(e,t){var n=null,i=function(){Object.setPrototypeOf(this,new t),this.dis=new e,this.isReviewsVisible=function(){return this.reviewsVisible},this.onShowCourseReviews=function(e){this.reviewsVisible="courseReviews"==e,this.pub()}.bind(this),this.dis.reg("courseFeatureSelection",this.onShowCourseReviews)};return{getInstance:function(){return n||(n=new i),n},getNew:function(){return new i}}}),define("course-reviews/Component",["ko","text!course-reviews/template.html","dispatcher/Dispatcher","course-reviews/ReviewsStore"],function(e,t,n,i){return{viewModel:function ForumViewModel(){this.dis=new n,this.store=i.getInstance(),this.isVisible=e.observable(!1),this.reviews=e.observableArray([{name:"Chris Kerley",image:"./assets/no-img.jpg",title:"Summer 2013 with Suprakash Datta",body:"Its math so its basically just practice. I personally never found lectures that useful in math related courses. I think you will be okay. PSYC2021 is easy stats math. Grade school level stuff like mean median mode, then t-tests and normal distributions and confidence intervals. When I took it in 2016 it was very enjoyable, Richard Murray is great. The course is very well designed. A bit of formula memorization, but if you do the homework you should be fine. Easy A+",votes:23},{name:"Mike Kerley",image:"./assets/no-img.jpg",title:"Fall 2002 with Jeffery Edmunds",body:"Its math so its basically just practice. I personally never found lectures that useful in math related courses. I think you will be okay. PSYC2021 is easy stats math. Grade school level stuff like mean median mode, then t-tests and normal distributions and confidence intervals. When I took it in 2016 it was very enjoyable, Richard Murray is great. The course is very well designed. A bit of formula memorization, but if you do the homework you should be fine. Easy A+",votes:102}]),this.onStore=function(){this.isVisible(this.store.isReviewsVisible())}.bind(this),this.store.sub(this.onStore)},template:t}}),define("course-docs/models/Doc",["abstract-interfaces/ValidObject","people-models/Prof"],function(e,t){return function(t){Object.setPrototypeOf(this,new e),this.setShallowProf=function(e){this.prof=e},this.getProf=function(){return this.prof},this.setTitle=function(e){this.validateStr(e),this.title=e},this.getTitle=function(){return this.title},this.setYear=function(e){this.validateId(e),this.year=e},this.getYear=function(){return this.year},this.setTopics=function(e){this.topics=e},this.getTopics=function(){return this.topics}}}),define("course-docs/models/SavedDoc",["course-docs/models/Doc","people-models/Person"],function(e,t){var n=function(t,n){Object.setPrototypeOf(this,new e(t)),this.setId=function(e){this.validateId(e),this.docId=e}.bind(this),this.setId(t.doc_id),this.getId=function(){return this.docId},this.setProfId=function(e){this.validateId(e),this.id=e},this.setProfId(t.id),this.getProfId=function(){return this.id},this.getCourseId=function(){return this.courseId},this.setCourseId=function(e){this.validateId(e),this.courseId=e},this.setCourseId(t.course_id),this.isLocked=function(){return this.locked},this.setLocked=function(e){this.validateBool(e),this.locked=1==e},this.setLocked(t.locked),this.getFileURL=function(){return this.host+"/"+this.fileURL},this.setFileURL=function(e){this.isLocked()||(this.validateStr(e),this.fileURL=e)},this.setFileURL(t.file_url),this.getHost=function(){return this.host},this.setHost=function(e){this.validateStr(e),this.host=e},this.setHost(n),this.getLastOpened=function(){if(this.lastOpened){return this.lastOpened.toLocaleString("en-us",{month:"long",year:"numeric",day:"numeric"})}return"never"},this.setLastOpened=function(e){this.lastOpened=e?new Date(e):null},this.setLastOpened(t.last_opened),this.setTitle(t.title),this.setTopics(t.topics),this.setYear(t.year)};return n.getRaw=function(){return Object.assign({doc_id:1,title:"Midterm",year:2020,course_id:5,file_url:"s.pdf",last_opened:"2020-04-05T17:35:15.000Z",locked:0},t.getRaw())},n.getFake=function(){var e=n.getRaw();return new n(e,"fakehost")},n}),define("course-docs/models/UnsavedDoc",["course-docs/models/Doc","people-models/Prof","course/models/CourseGroup"],function(e,t,n){var i=function(t,n){Object.setPrototypeOf(this,new e),this.MAX_FILE_SIZE=1e7,this.setTitle=function(e){if("string"!=typeof e)throw new Error("title must be a string");this.title=e},this.setFile=function(e){if(e instanceof File==0)throw new Error("must be a file");if(e.size>this.MAX_FILE_SIZE)throw new Error("That file is too large. (10mb max)");this.file=e,this.setTitle(this.file.name)}.bind(this),this.setFile(t),this.getFile=function(){return this.file},this.encodeFile=function(e){var t=new FileReader,n=this;t.onload=function(t){n.encodedFile=t.target.result,e&&"function"==typeof e&&e()},t.readAsDataURL(this.file)}.bind(this),this.getEncodedFile=function(){return this.encodedFile},this.getFileName=function(){return this.file.name},this.setGrp=function(e){if(!e.isGroup())throw new Error("Expected a CourseGroup instance");this.grp=e},this.setGrp(n),this.getGrp=function(){return this.grp},this.getGrpId=function(){return this.grp.getId()},this.isSendable=function(){return 0==!this.file&&0==!this.title&&this.profId>0},this.setProfId=function(e){this.validateId(e),this.profId=e},this.serialize=function(){if(!this.encodedFile)throw new Error("cannot serialize if the file has not been encoded yet");if(!this.year)throw new Error("to serialize, the year must be set");if(!this.profId)throw new Error("to serialize, the profId must be set");return{title:this.title,file:this.encodedFile,year:this.year,profId:this.profId,grpId:this.grp.getId()}}.bind(this)};return i.getFake=function(){var e=n.getFake();return new i(new File([],"name"),e)},i.getFakeSerializable=function(){var e=n.getFake(),t=new i(new File([],"name"),e);return t.encodedFile="string",t.setYear(2e3),t.setProfId(1),t.grp=n.getFake(),t},i}),define("course-docs/models/DocumentCollection",["abstract-interfaces/ValidObject","people-models/Prof","course-docs/models/SavedDoc","ko"],function(e,t,n,i){var s=function(s,r){Object.setPrototypeOf(this,new e),this.validateStr(r),this.profs=[],this.insertDocs=function(e){if(!Array.isArray(e))throw new Error("expected an array.");var t=this;e.forEach(function(e){t.insertDoc(e)})}.bind(this),this.insertDoc=function(e){if(this.getProf(e))this.profs.forEach(function(t){t().getId()==e.id&&t().addDoc(e)});else{var s=new t(e,r,n);s.addDoc(e);var o=i.observable(s);this.profs.push(o)}}.bind(this),this.getProf=function(e){var t=null;return this.profs.forEach(function(n){e.id==n().id&&(t=n)}),t},this.getProfs=function(){return this.profs},this.getSize=function(){return this.profs.length},this.insertDocs(s)};return s.getFake=function(){return new s([],"fakehost")},s}),define("course-docs/DocRemoteService",["ActiveRemoteService","format-converter","dispatcher/Dispatcher","course-docs/models/SavedDoc","course-docs/models/DocumentCollection","course/models/CourseGroup","people-models/Prof"],function(e,t,n,i,s,r,o){var a=function(){this.constructor=a,Object.setPrototypeOf(this,new e),this.setMicroServer("tests"),this.dis=new n,this.getDocs=function(e){if(this.isAdmin(),!e.isGroup||!e.isGroup())throw new Error("Can only get docs for a group.");var t=this.getServerURL()+"/grp/"+e.getId()+"/course-docs";$.ajax({url:t,type:"get",beforeSend:this.setAuthorizationHeader,success:this.onDocs,error:this.onError})}.bind(this),this.onGrpId=this.dis.reg("groupInfo",this.getDocs),this.onGetDocs=this.dis.reg("getDocs",this.getDocs),this.isAdmin=function(){var e=this.getServerURL()+"/course-docs/uploader",t=this;$.ajax({url:e,type:"get",beforeSend:this.setAuthorizationHeader,success:function(e){var n=!1;"true"==e&&(n=!0),t.dis.dispatch("uploadingAllowed",n)},error:this.onError})}.bind(this),this.onDocs=function(e){try{var t=JSON.parse(e),n=this.getServerURL(),i=new s(t,n);this.dis.dispatch("courseDocs",i)}catch(e){if(console.log(e),/in JSON at position/.test(e.message))throw Error("malformed json string")}},this.onDocs=this.onDocs.bind(this),this.addCourseAndUpload=function(e){var t=this.getServerURL()+"/course-docs/addCourseAndUpload";$.ajax({url:t,type:"post",data:{json:JSON.stringify(e.serialize())},beforeSend:this.setAuthorizationHeader,success:this.onDocSubmitted,error:this.onError})}.bind(this),this.onSubmitDoc=function(e){var t=this.getServerURL()+"/course-docs/upload",n=this;e.encodeFile(function(){$.ajax({url:t,type:"post",data:{json:JSON.stringify(e.serialize())},beforeSend:n.setAuthorizationHeader,success:n.onDocSubmitted,error:n.onError})})}.bind(this),this.submitDocId=this.dis.reg("submitDoc",this.onSubmitDoc),this.onDocSubmitted=function(e){/no record/.test(e)?this.dis.dispatch("openAddCourse"):this.dis.dispatch("docSubmitted",e)}.bind(this),this.onError=function(e){console.log(e),alert(e.responseText)}.bind(this),this.recordDocDownload=function(e){var t=this.getServerURL()+"/course-docs/docDownloaded";$.ajax({url:t,type:"post",data:{docId:e.getId()},beforeSend:this.setAuthorizationHeader,success:function(){},error:this.onError})}.bind(this),this.recordDownloadId=this.dis.reg("openDoc",this.recordDocDownload),this.getMatchingProfs=function(e){var t=this.getServerURL()+"/course-docs/profs?name="+e;$.ajax({url:t,type:"get",beforeSend:this.setAuthorizationHeader,success:this.onMatchingProfs,error:this.onError})}.bind(this),this.getMatchingProfsId=this.dis.reg("getMatchingProfs",this.getMatchingProfs),this.onMatchingProfs=function(e){for(var t=[],n=this.getServerURL(),s=0;s<e.length;s++){var r=e[s],a=new o(r,n,i);t.push(a)}this.dis.dispatch("matchingProfs",t)}.bind(this)};return a}),define("course-docs/DocStore",["abstract-interfaces/Store","dispatcher/Dispatcher","course-docs/models/SavedDoc","course-docs/models/UnsavedDoc","course-docs/DocRemoteService","course-docs/models/DocumentCollection"],function(e,t,n,i,s,r){var o=null,a=function(){this.constructor=a,new s,Object.setPrototypeOf(this,new e),this.currentGrp=null,this.dis=new t,this.isDocsVisible=!1,this.isUploaderOpen=!1,this.unsavedDoc=null,this.waiting=!1,this.docChanged=!1,this.lastUnsavedDoc=null,this.docs=new r([],"http://localhost/"),this.matchingProfs=null,this.isUploadingAllowed=!1,this.courseAdderOpen=!1,this.joinPromptVisible=!1,this.onAddCourseAndUpload=function(){this.waiting=!0,this.pub()}.bind(this),this.dis.reg("addCourseAndUpload",this.onAddCourseAndUpload),this.onOpenCourseAdder=function(){this.courseAdderOpen=!0,this.pub()}.bind(this),this.dis.reg("openAddCourse",this.onOpenCourseAdder),this.isCourseAdderVisible=function(){return this.courseAdderOpen},this.onUploadingAllowed=function(e){this.isUploadingAllowed=!0}.bind(this),this.dis.reg("uploadingAllowed",this.onUploadingAllowed),this.isWaiting=function(){return this.waiting},this.docCount=function(){return this.docs.getSize()},this.getUnsavedDoc=function(){return this.unsavedDoc},this.getUnsavedDocTitle=function(){return this.unsavedDoc?this.unsavedDoc.getTitle():""},this.getGroupCourseInfo=function(){if(this.currentGrp)return this.currentGrp.getDept()+this.currentGrp.getCourseCode()+" "+this.currentGrp.getCourseDescription()},this.onGrp=function(e){this.currentGrp=e}.bind(this),this.onGrpId=this.dis.reg("groupInfo",this.onGrp),this.isJoinGroupPromptVisible=function(){return this.joinPromptVisible},this.isCourseDocsPermitted=function(){return this.courseDocsPermitted},this.onJoined=function(){this.courseDocsPermitted=!0,this.pub()}.bind(this),this.dis.reg("groupJoined",this.onJoined),this.onGroupLeft=function(){this.courseDocsPermitted=!1,this.pub()}.bind(this),this.dis.reg("courseLeft",this.onGroupLeft),this.onShowCourseDocs=function(e){this.isDocsVisible="noteShare"==e,this.currentGrp&&this.currentGrp.isMember()?this.courseDocsPermitted=!0:this.courseDocsPermitted=!1,this.pub()}.bind(this),this.showDocsId=this.dis.reg("courseFeatureSelection",this.onShowCourseDocs),this.isCourseDocsVisible=function(){return this.isDocsVisible}.bind(this),this.onCourseDocs=function(e){this.docs=e,this.pub()}.bind(this),this.onDocsId=this.dis.reg("courseDocs",this.onCourseDocs),this.onTestDocUpload=function(){this.isWaitingToLoad=!0,this.pub()}.bind(this),this.onOpenDocUploader=function(){this.isUploaderOpen=!0,this.pub()}.bind(this),this.openUploaderId=this.dis.reg("openDocUploader",this.onOpenDocUploader),this.onCloseDocUploader=function(){this.isUploaderOpen=!1,this.unsavedDoc=null,this.pub()}.bind(this),this.closeUploaderId=this.dis.reg("closeDocUploader",this.onCloseDocUploader),this.onInputReset=function(){this.lastUnsavedDoc=this.unsavedDoc}.bind(this),this.dis.reg("uploaderHasBeenReset",this.onInputReset),this.onDocUpload=function(e){try{var t=this.currentGrp;this.lastUnsavedDoc=this.unsavedDoc,this.unsavedDoc=new i(e,t),this.lastUnsavedDoc||(this.lastUnsavedDoc=this.unsavedDoc),this.pub()}catch(e){console.log(e),alert(e.message)}}.bind(this),this.docUploadId=this.dis.reg("docUpload",this.onDocUpload),this.inputsShouldBeReset=function(){return this.unsavedDoc!=this.lastUnsavedDoc}.bind(this),this.onSetDocTitle=function(e){this.unsavedDoc&&this.unsavedDoc.setTitle&&this.unsavedDoc.setTitle(e),this.pub()}.bind(this),this.setTitleId=this.dis.reg("setDocTitle",this.onSetDocTitle),this.onSetDocYear=function(e){this.unsavedDoc.setYear(e),this.pub()}.bind(this),this.setYearId=this.dis.reg("setDocYear",this.onSetDocYear),this.isReadyToSubmit=function(){return this.unsavedDoc&&this.unsavedDoc.isSendable()},this.onSubmitDoc=function(e){this.waiting=!0,this.pub()}.bind(this),this.submitDocId=this.dis.reg("submitDoc",this.onSubmitDoc),this.onDocSubmitted=function(){this.unsavedDoc=null,this.waiting=!1,this.showSuccess(),this.dis.dispatch("getDocs",this.currentGrp),this.pub()}.bind(this),this.onSubmitedId=this.dis.reg("docSubmitted",this.onDocSubmitted),this.isSuccessPopupVisible=function(){return this.isSuccessVisible},this.showSuccess=function(){var e=this;setTimeout(function(){e.isSuccessVisible=!1,e.pub()},2e3),this.isSuccessVisible=!0}.bind(this),this.getCurrentDocs=function(){return this.docs},this.onOpenDoc=function(e){window.open(e.getFileURL(),"_blank","location=yes")}.bind(this),this.dis.reg("openDoc",this.onOpenDoc),this.onMatchingProfs=function(e){this.matchingProfs=e,this.pub()}.bind(this),this.matchingProfsId=this.dis.reg("matchingProfs",this.onMatchingProfs),this.onSelectedProf=function(e){this.unsavedDoc.setProfId(e.getId()),this.matchingProfs=[],this.pub()}.bind(this),this.selectedProfId=this.dis.reg("selectedProf",this.onSelectedProf)};return{getInstance:function(){return o||(o=new a),o},getNew:function(){return new a}}}),define("text!course-docs/container/template.html",[],function(){return'<link rel="stylesheet"\n      href="./styles/components/course-docs/course-docs.css?v=1.0">\n\n  <div id=\'join-to-access-prompt\'\n       data-bind="visible:isJoinPromptVisible()">\n       Join to access shared notes  <span class=\'glyphicon glyphicon-arrow-right\'></span>\n    \n   </div>\n  <div id="course-docs-container"\n       data-bind="visible:isVisible()">\n\n      <div id="no-practise-test-message"\n           data-bind="visible:isEmpty()">\n        There are no documents </br>\n        for this class yet.\n      </div>\n\n      <doc-list-current></doc-list-current>\n      <button id="doc-upload-button"\n              class=\'glyphicon glyphicon-plus\'\n              data-bind="visible:uploadingAllowed(), click:openUploader">\n      </button>\n  </div>\n'}),define("course-docs/container/Component",["dispatcher/Dispatcher","course-docs/DocStore","ko","text!course-docs/container/template.html"],function(e,t,n,i){return{viewModel:function View(i,s){this.dis=new e,this.store=t.getInstance(),this.isVisible=n.observable(!1),this.isEmpty=n.observable(!1),this.uploadingAllowed=n.observable(!1),this.isJoinPromptVisible=n.observable(!1),this.onStore=function(){this.isJoinPromptVisible(!this.store.isCourseDocsPermitted()&&this.store.isCourseDocsVisible()),this.uploadingAllowed(this.store.isUploadingAllowed),this.isVisible(this.store.isCourseDocsPermitted()&&this.store.isCourseDocsVisible()),this.isEmpty(this.store.docCount()<1)},this.onStore=this.onStore.bind(this),this.store.sub(this.onStore),this.openUploader=function(){this.dis.dispatch("openDocUploader"),$("#doc-uploader-input").trigger("click")},this.selectCurrentDocs=function(){this.dis.dispatch("selectCurrentDocs")},this.selectPreviousDocs=function(){this.dis.dispatch("selectPreviousDocs")}},template:i}}),define("text!course-docs/doc-list-current/template.html",[],function(){return"<link rel=\"stylesheet\"\n      href=\"./styles/components/course-docs/better-doc-list.css\">\n\n\n<div id='doc-list-holder'>\n\n  <span id='ask-prof-popup'\n        data-bind='visible:askProfMessageVisible(),complementClick:closeAskProf'>\n    We are asking the professor for permission to share this content.\n  </span>\n  <div class='profs'\n      data-bind=\"foreach:profs\">\n\n    <div class='prof-title'>\n      <img data-bind='attr:{src:getSmallPhotoURL()}'></img>\n      <span class='prof-name' data-bind=\"text:first + ' ' + last\">First Last</span>\n\n    </div>\n\n    <span data-bind=\"foreach:getYears()\">\n\n      <span class='profs-doc-list' data-bind=\"foreach:docs\">\n\n\n        <span class=\"doc-container\" data-bind='click:$parents[2].openDoc'>\n\n          <span class='term-title-text' data-bind=\"text:year\"></span>\n          <div class=\"locked-prof\"\n               data-bind='visible:isLocked()'>\n            <div class='locked-icon-holder'>\n              <i class=\"glyphicon glyphicon-lock doc-unlock-icon\"></i>\n              \x3c!-- <span class='unlock-text'>unlock</span> --\x3e\n            </div>\n          </div>\n\n          <span class='doc-preview'>\n\n            <span class='doc-shade'>\n            </span>\n            <img class='doc-img'\n                 src='./assets/practice_test.jpg'>\n            </img>\n          </span>\n          <span class='doc-footer'>\n\n            <div class='title ellipsis' data-bind='text:title'>No Title</div>\n            <div class='last-opened'>\n              <i class='glyphicon glyphicon-align-left doc-icon'></i>\n              Opened\n              <span data-bind='text:\" \" + getLastOpened()'>Never opened</span>\n            </div>\n\n          </span>\n          <span class='author-approval-status'\n                data-toggle=\"tooltip\" title=\"Pending professor's permission\">\n                pending\n          </span>\n        </span>\n      </span>\n    </span>\n\n  </div>\n</div>\n"}),define("doc-list-current/Component",["text!course-docs/doc-list-current/template.html","course-docs/DocStore","course-docs/models/SavedDoc","ko","dispatcher/Dispatcher"],function(e,t,n,i,s){return{viewModel:function View(){this.dis=new s,this.store=t.getInstance(),this.isVisible=i.observable(!0),this.profs=i.observableArray([]),this.askProfMessageVisible=i.observable(!1),this.onStore=function(){var e=this.store.getCurrentDocs().getProfs();this.profs(e)}.bind(this),this.store.sub(this.onStore),this.closeAskProf=function(){this.askProfMessageVisible(!1)}.bind(this),this.openDoc=function(e){e.isLocked()?this.askProfMessageVisible(!0):this.dis.dispatch("openDoc",e)}.bind(this)},template:e}}),define("text!document-plans/template.html",[],function(){return"<link rel=\"stylesheet\" href=\"./styles/components/payment/document-plans.css?v=1.1\">\n\n<div id=\"document-plans\"\n     data-bind=\"visible:isVisible()\">\n\n  <div id='document-plans-holder'>\n       <div class='x-close-holder'>\n         <span class='x-close-button' data-bind='click:closePaymentOptions'>x</span>\n       </div>\n    <div id=\"plan-title\">Choose your plan:</div>\n    <span class='payment-option'>\n      <div class='plan-duration'>12 Months</div>\n      <span class='ok-plan glyphicon glyphicon-ok'></span>\n      <span id='best-value'>BEST VALUE</span>\n      <div class='plan-price'>$9.95 <sup>/mo</sup></div>\n      <div class='plan-details'>12 months of <b class='bold'>unlimited downloads</b></div>\n      <div class='plan-details'>Billed $119.40 for a year.</div>\n\n      <button class='plan-button best-value-color'\n              data-bind='click:selectValuePlan'>Choose 12 Months</button>\n      <div class='plan-details'>Save $360 over the monthly plan</div>\n    </span>\n\n    <span class='payment-option'>\n      <div class='plan-duration'>3 Months</div>\n      <span class='ok-plan glyphicon glyphicon-ok'></span>\n      <div class='plan-price'>$24.95 <sup>/mo</sup></div>\n      <div class='plan-details'>3 months of <b class='bold'>unlimited downloads</b></div>\n      <div class='plan-details'>Billed $74.85 for 3 months</div>\n\n      <button class='plan-button'\n              data-bind=\"click:selectMediumPlan\">\n              Choose 3 Months\n      </button>\n      <div class='plan-details'>Save $40 over the monthly plan</div>\n    </span>\n\n    <span class='payment-option'>\n      <div class='plan-duration'>1 Month</div>\n      <span class='ok-plan glyphicon glyphicon-ok'></span>\n      <div class='plan-price'>$39.95 <sup>/mo</sup></div>\n      <div class='plan-details'>1 month of <b class='bold'>unlimited downloads</b></div>\n      <div class='plan-details'>Billed $39.95 for a month</div>\n      <button class='plan-button'\n              data-bind='click:selectExpensivePlan'>\n              Choose 1 Month\n      </button>\n    </span>\n\n  </div>\n\n</div>\n"}),define("payment/models/TutoringPlan",["abstract-interfaces/ValidObject"],function(e){var t=function(t){Object.setPrototypeOf(this,new e),this.getId=function(){return this.id},this.setId=function(e){this.validateId(e),this.id=e},this.setId(t.plan_id),this.getHours=function(){return this.hours},this.setHours=function(e){this.validateId(e),this.hours=e},this.setHours(t.hours),this.setHourlyRate=function(e){if(!e||Number(e)<=0)throw new Error("hourly_rate must be positive.");this.hourlyRate=e/100},this.setHourlyRate(t.hourly_rate),this.getHourlyRate=function(){return this.hourlyRate},this.getDiscountedHours=function(){return this.discountedHours},this.setDiscountedHours=function(e){if("number"!=typeof e||Number(e)<0)throw new Error("discounted_hours must be a non-negative integer.");this.discountedHours=e},this.setDiscountedHours(t.discounted_hours),this.setDuration=function(e){if(e<1)throw new Error("duration must be at least 1 day.");this.duration=e},this.setDuration(t.duration_days),this.getDuration=function(){return this.duration},this.getDescription=function(){return this.description},this.setDescription=function(e){this.validateStr(e),this.description=e},this.setDescription(t.description)};return t.getRaw=function(e){return{plan_id:43,description:"Live online tutoring",hours:1,hourly_rate:3995,discounted_hours:2,duration_days:31}},t.getFake=function(){return new t(t.getRaw())},t}),define("payment/PaymentRemoteService",["ActiveRemoteService","dispatcher/Dispatcher","payment/models/TutoringPlan"],function(e,t,n){var i=function(){this.constructor=i,Object.setPrototypeOf(this,new e),this.setMicroServer("payments"),this.dis=new t,this.onSelectDocumentPlan=function(e){var t=this.getServerURL()+"/selectDocumentPlan";$.ajax({url:t,type:"post",data:e,beforeSend:this.setAuthorizationHeader,success:this.onDocumentPlanSelected,error:this.onError})}.bind(this),this.selDocPlanId=this.dis.reg("selectDocumentPlan",this.onSelectDocumentPlan),this.onDocumentPlanSelected=function(){this.dis.dispatch("documentPlanSelected")}.bind(this),this.onAuth=function(e){(e.state="authenticated")&&(this.getTutoringPlans(),this.dis.dispatch("paymentEnvironment",this.isLive()))}.bind(this),this.dis.reg("authState",this.onAuth),this.getTutoringPlans=function(){var e=this.getServerURL()+"/tutoringPlans";$.ajax({url:e,type:"get",beforeSend:this.setAuthorizationHeader,success:this.onTutoringPlans,error:this.onError})}.bind(this),this.onBuyHours=function(e){var t=this.getServerURL()+"/buyHours";$.ajax({url:t,type:"post",data:e,beforeSend:this.setAuthorizationHeader,success:this.onHoursSelected,error:this.onError})}.bind(this),this.dis.reg("buyHours",this.onBuyHours),this.onHoursSelected=function(e){this.dis.dispatch("hoursSelected",e)}.bind(this),this.onSelectTutoringPlan=function(e){var t=this.getServerURL()+"/selectTutoringPlan";$.ajax({url:t,type:"post",data:e,beforeSend:this.setAuthorizationHeader,success:this.onPlanSelected,error:this.onError})}.bind(this),this.dis.reg("selectTutoringPlan",this.onSelectTutoringPlan),this.onTutoringPlans=function(e){var t=[];e.forEach(function(e){t.push(new n(e))}),this.dis.dispatch("tutoringPlans",t)}.bind(this),this.onPlanSelected=function(e){this.dis.dispatch("planSelected",e)}.bind(this),this.onError=function(e){console.log(e);var t="\n-- Contact Chris at 905-808-8791 for assistance. ---";if(e.responseJSON){var n=e.responseJSON.errors[0].moreInfo;alert(n+t)}else{n=e.responseText;alert(n+t)}}.bind(this)};return i}),define("payment/PaymentStore",["abstract-interfaces/Store","dispatcher/Dispatcher","payment/PaymentRemoteService"],function(e,t,n){var i=null;new n;var s=function(){Object.setPrototypeOf(this,new e),this.dis=new t,this.selectedPlan=null,this.tutorPlansOpen=!1,this.isCreditCardInfoOpen=!1,this.isWaiting=!1,this.showPaymentSuccess=!1,this.isProcessingPayment=!1,this.clientSecret,this.productDescription="",this.selectedTutor=null,this.documentPlansOpen=!1,this.orderInfo=null,this.tutoringPlans=[],this.getTutoringPlans=function(){var e=null,t=[];return this.tutoringPlans.forEach(function(n){1==n.getHours()?e=n:t.push(n)}),{normalPlan:e,packagedPlans:t}},this.onTutoringPlans=function(e){this.tutoringPlans=e}.bind(this),this.dis.reg("tutoringPlans",this.onTutoringPlans),this.onSelectDocumentPlan=function(e){if(!e)throw new Error("invalid document plan");this.isWaiting=!0,this.pub()}.bind(this),this.onOpenDocumentPlans=function(){this.documentPlansOpen=!0,this.pub()}.bind(this),this.openDocPlansId=this.dis.reg("openDocumentPlans",this.onOpenDocumentPlans),this.isDocumentPlansOpen=function(){return this.documentPlansOpen},this.onCloseDocumentPlans=function(){this.documentPlansOpen=!1,this.pub()}.bind(this),this.dis.reg("closeDocumentPlans",this.onCloseDocumentPlans),this.getClientSecret=function(){return this.clientSecret},this.onHoursSelected=function(e){console.log(e),this.orderInfo=e.order_info,this.clientSecret=e.client_secret,this.isCreditCardInfoOpen=!0,this.isWaiting=!1,this.tutorPlansOpen=!1,this.pub()}.bind(this),this.hourseSelectedId=this.dis.reg("hoursSelected",this.onHoursSelected),this.getOrderInfo=function(){return this.orderInfo},this.onBuyHours=function(e){if(!e)throw new Error("invalid hours");this.isWaiting=!0,this.pub()}.bind(this),this.dis.reg("buyHours",this.onBuyHours),this.getHoursToBuy=function(){return this.hoursToBuy},this.isWaitingForServer=function(){return this.isWaiting},this.getProductDescription=function(){return this.productDescription}.bind(this),this.getSelectedTutorId=function(){return this.selectedTutor?this.selectedTutor.getId():null},this.onOpenTutoringPlans=function(e){this.tutoringPlans.length>0?(this.tutorPlansOpen=!0,this.selectedTutor=e,this.pub()):window.alert("No tutoring service available at this time.")}.bind(this),this.dis.reg("openTutoringPlans",this.onOpenTutoringPlans),this.isTutoringPlansOpen=function(){return this.tutorPlansOpen},this.onCloseTutorPlans=function(){this.tutorPlansOpen=!1,this.pub()}.bind(this),this.dis.reg("closeTutoringPlans",this.onCloseTutorPlans),this.onSelectTutoringPlan=function(e){if(!e)throw new Error("invalid option");this.selectedPlan=e,this.isWaiting=!0,this.tutorPlansOpen=!1,this.pub()}.bind(this),this.dis.reg("selectTutoringPlan",this.onSelectTutoringPlan),this.onPlanSelected=function(e){this.clientSecret=e.client_secret,this.orderInfo=e.order_info,this.isCreditCardInfoOpen=!0,this.isWaiting=!1,this.pub()}.bind(this),this.planSelectedId=this.dis.reg("planSelected",this.onPlanSelected),this.closeCreditCardInfo=function(){this.isCreditCardInfoOpen=!1,this.showPaymentSuccess=!1,this.pub()}.bind(this),this.dis.reg("closeCreditCardInfo",this.closeCreditCardInfo),this.onConfirmingPayment=function(){this.isProcessingPayment=!0,this.pub()}.bind(this),this.confirmingPaymentId=this.dis.reg("confirmingPayment",this.onConfirmingPayment),this.onPaymentProcessed=function(e){this.isProcessingPayment=!1,this.showPaymentSuccess=e,this.pub()}.bind(this),this.paymentProcessedId=this.dis.reg("paymentProcessed",this.onPaymentProcessed)};return{getInstance:function(){return i||(i=new s),i},getNew:function(){return new s}}}),define("document-plans/Component",["ko","text!document-plans/template.html","dispatcher/Dispatcher","payment/PaymentStore"],function(e,t,n,i){return{viewModel:function ViewModel(){this.dis=new n,this.store=i.getInstance(),this.isVisible=e.observable(!1),this.onStore=function(){this.isVisible(this.store.isDocumentPlansOpen())}.bind(this),this.store.sub(this.onStore),this.selectValuePlan=function(){this.dis.dispatch("selectDocumentPlan",{plan:5})},this.selectMediumPlan=function(){this.dis.dispatch("selectDocumentPlan",{plan:6})},this.selectExpensivePlan=function(){this.dis.dispatch("selectDocumentPlan",{plan:7})},this.closePaymentOptions=function(){this.dis.dispatch("closeDocumentPlans")}.bind(this)},template:t}}),define("text!tutoring-plans/template.html",[],function(){return"<link rel=\"stylesheet\" href=\"./styles/components/payment/tutoring-plans.css?v=1.3\">\n\n\n<div id=\"tutoring-plans\"\n     class='background-dimmer'\n     data-bind=\"visible:isVisible()\">\n\n     <div class=\"middelize\"\n          data-bind=visible:showSpinner()>\n         <div class=\"big-loader\"></div>\n     </div>\n\n  <div id='tutoring-plans-holder'>\n       <div class='x-close-holder'>\n         <span class='x-close-button' data-bind='click:closePaymentOptions'>x</span>\n       </div>\n       <div id='non-package-pricing'>\n         <div id='hours-query'>How many hours would you like?</div>\n         <div class='non-package-row'>\n           <input id='hour-selector'\n                  type='number'\n                  min='1'\n                  max='9'\n                  required\n                  value=\"1\"\n                  data-bind='value:hours'>\n            </input>\n           <span class='non-package-hours'> Hours @ </span>\n          <span class='plan-price'>\n            $<span data-bind='text:hourlyRate'></span> <sup>/hr</sup>\n          </span>\n         </div>\n\n         <div id='total-price-holder'\n              class='non-package-row'>\n           Total: <span id=non-package-total>$<span data-bind='text:total'></span></span>\n           <button id='buy-button' data-bind='click:buy'>Buy</button>\n         </div>\n\n       </div>\n\n       <ul id='tutoring-packages' data-bind='foreach:plans()'>\n\n         <span class='payment-option'>\n           <div class='plan-duration' data-bind='text:getDescription()'></div>\n           <span class='ok-plan glyphicon glyphicon-ok'></span>\n           <div class='plan-price'>\n              <span data-bind='text:getHourlyRate()'> $39.95 </span>\n              <sup>/hr</sup>\n           </div>\n           <div class='plan-details'>\n             <span data-bind='text:getDiscountedHours()'>1</span> of the hours is <span class='green'>FREE</span>.\n           </div>\n           <div class='plan-details'>\n             <span data-bind='text:getHours()'> </span> hours of tutoring\n           </div>\n           <div class='plan-details'>You save\n              <span data-bind='text:($parent.hourlyRate() * getHours() - (getHourlyRate() * (getHours() - getDiscountedHours()))).toFixed(2)'>  </span>\n           </div>\n           <button class='plan-button'\n                   data-bind='click:$parent.choosePackage'>\n                   Choose <span data-bind='text:getHours()'></span> Hours\n           </button>\n         </span>\n\n       </ul>\n\n       <div id='tutoring-doc-details'>\n          Payment for online tutoring must be made\n          before tutoring sessions start.\n         </div>\n       <div id='tutoring-doc-details'>\n          Hours bought must be used within 6-months\n          from the date of purchase.\n         </div>\n  </div>\n\n</div>\n"}),define("tutoring-plans/Component",["ko","text!tutoring-plans/template.html","dispatcher/Dispatcher","payment/PaymentStore"],function(e,t,n,i){return{viewModel:function ViewModel(){this.dis=new n,this.store=i.getInstance(),this.isVisible=e.observable(!1),this.showSpinner=e.observable(!1),this.hourlyRate=e.observable(0),this.hours=e.observable(1),this.total=e.computed(function(){return(this.hourlyRate()*this.hours()).toFixed(2)},this),this.plans=e.observableArray([]),this.onHoursChanged=function(e){(""==e||e<1)&&this.hours(1),e>5&&this.hours(5)},this.hours.subscribe(this.onHoursChanged,this),this.onStore=function(){var e=this.store.isTutoringPlansOpen();if(this.isVisible(e),this.showSpinner(this.store.isWaitingForServer()),e){var t=this.store.getTutoringPlans(),n=t.packagedPlans,i=t.normalPlan;this.plans(n),this.hourlyRate(i.getHourlyRate())}}.bind(this),this.store.sub(this.onStore),this.closePaymentOptions=function(){this.dis.dispatch("closeTutoringPlans")},this.buy=function(){var e=this.store.getSelectedTutorId(),t=Number(this.hours());if(!t||"number"!=typeof t||t<1)throw new Error("hours must be a non-negative integer.");this.dis.dispatch("buyHours",{tutor:e,hours:t})}.bind(this),this.choosePackage=function(e){var t=this.store.getSelectedTutorId(),n=e.getId();this.dis.dispatch("selectTutoringPlan",{plan:n,tutor:t})}.bind(this)},template:t}}),define("text!credit-card-info/template.html",[],function(){return"<link rel=\"stylesheet\" href=\"./styles/components/payment/credit-card-info.css?v=1.3\">\n\n<div id='credit-card-info' class='background-dimmer' data-bind='visible:isVisible()'>\n\n  <div class=\"middelize\"\n       data-bind=visible:isSpinnerVisible()>\n      <div class=\"big-loader\"></div>\n  </div>\n\n\n\n  <form action=\"/charge\" method=\"post\" id=\"payment-form\">\n    <span id='payment-title'>\n      Palolo checkout\n      <i id='checkout-lock' class='glyphicon glyphicon-lock'></i>\n    </span>\n    <span class='x-close-button' data-bind='click:close'>x</span>\n\n    <div class=\"form-row\">\n      <div id='payment-method' class='payment-col'>\n\n              <label id='card-label' class='payment-col-title' for=\"card-element\">\n                CREDIT CARD OR DEBIT CARD\n              </label>\n              <div id=\"cardholder-name\">\n                <input id='cardholder-name-input'\n                       type='text'\n                       placeholder=\"Cardholder name\"\n                       data-bind='textInput:cardholderName, css:{\"invalid-name\":!isNameValid()}'>\n                </input>\n              </div>\n              <div id=\"card-element\">\n                \x3c!-- A Stripe Element will be inserted here. --\x3e\n              </div>\n              \x3c!-- Used to display form errors. --\x3e\n              <div id=\"card-errors\" role=\"alert\"></div>\n\n              <button class='payment-button' data-bind=\"attr:{disabled:isPaymentComplete() || isProcessingPayment()}\">\n                <div class=\"small-spinner hidden-element\" id=\"spinner\"\n                      data-bind='visible:isProcessingPayment()'></div>\n                <span id=\"button-text\" class=\"\"\n                      data-bind=\"visible:!isProcessingPayment() && !isPaymentComplete()\">Pay Now</span>\n                <span id=\"button-text\" class=\"\"\n                      data-bind=\"visible:isPaymentComplete()\">\n                      <span>Payment Successful</span>\n                      <span class='glyphicon glyphicon-ok credit-card-payment-success'>\n                      </span>\n                </span>\n              </button>\n\n              <div id='payment-success-info'\n                   data-bind='css:{\"slide-down\":isPaymentComplete()}'>\n                <div> Purchase Successful </div>\n                <div css='grey'>A confirmation email will be sent.</div>\n              </div>\n      </div>\n\n      <div id='order-summary' class='payment-col'>\n        <div class='order-part'>\n          <div class='order-summary-title'>ORDER SUMMARY</div>\n          <div class='order-summary-row'>\n              <span data-bind='text:productQuantity()'></span> unit(s)\n              <span class='order-cost' data-bind='text:productPrice()'> </span>\n          </div>\n          <div id='order-tax-title'>\n            Taxes\n          </div>\n          <div class='order-summary-row'>\n            HST(13%) <span class='order-cost' data-bind='text:salesTax()'> $0.00 </span>\n          </div>\n          <div class='order-summary-row'>\n            Order Total <span class='order-cost' data-bind='text:orderTotal()'>  </span>\n          </div>\n        </div>\n\n        <div id='bottom-order-part'>\n          <div class='order-summary-title'>SERVICES IN YOUR ORDER</div>\n          <div class='product-name-row'>\n            <span data-bind='text:productDescription()'></span>\n          </div>\n          <div class='order-summary-row'>\n            <span data-bind='text:productQuantity()'></span> X\n            <span data-bind='text:productPrice()'></span>\n          </div>\n        </div>\n\n\n\n      </div>\n      <div style=\"text-align:left; margin:5pt;\">\n        <img src='./assets/powered_by_stripe.svg'></img>\n        <span>256-bit secure encryption</span>\n      </div>\n    </div>\n\n\n\n  </form>\n\n\n</div>\n"}),define("credit-card-info/Component",["ko","text!credit-card-info/template.html","dispatcher/Dispatcher","payment/PaymentStore","stripe"],function(e,t,n,i){return{viewModel:function ViewModel(){this.dis=new n,this.store=i.getInstance(),this.isVisible=e.observable(!1),this.isSpinnerVisible=e.observable(!1),this.cardholderName=e.observable(""),this.isNameValid=e.observable(!1),this.orderTotal=e.observable(0),this.productDescription=e.observable(""),this.productQuantity=e.observable(0),this.productPrice=e.observable(""),this.salesTax=e.observable(""),this.isProcessingPayment=e.observable(!1),this.isPaymentComplete=e.observable(!1),this.onStore=function(){this.store.isCreditCardInfoOpen&&!this.store.showPaymentSuccess||!this.stripe||(this.card.clear(),this.cardholderName("")),this.isVisible(this.store.isCreditCardInfoOpen),this.isSpinnerVisible(this.store.isWaiting),this.isProcessingPayment(this.store.isProcessingPayment),this.isPaymentComplete(this.store.showPaymentSuccess),this.setOrderInfo()}.bind(this),this.store.sub(this.onStore),this.setOrderInfo=function(){var e=this.store.getOrderInfo();e&&(this.productDescription(e.product_description),this.productPrice("$"+Number(e.product_price).toFixed(2)),this.productQuantity(e.product_qty),this.salesTax("$"+Number(e.product_qty*e.product_price*e.sales_tax_rate).toFixed(2)),this.orderTotal("$"+Number(e.product_qty*e.product_price*(1+e.sales_tax_rate)).toFixed(2)))},this.onCardholderName=function(e){var t=document.getElementById("card-errors");/^[A-Za-z]{1,}\s+[A-Za-z]{1,}$/.test(e)?(this.isNameValid(!0),t.textContent=""):(this.isNameValid(!1),t.textContent="Cardholder name invalid.")}.bind(this),this.cardholderName.subscribe(this.onCardholderName),this.close=function(){this.dis.dispatch("closeCreditCardInfo")}.bind(this);var t={base:{color:"#32325d",fontFamily:'"Helvetica Neue", Helvetica, sans-serif',fontSmoothing:"antialiased",fontSize:"18px","::placeholder":{color:"#aab7c4"}},invalid:{color:"#fa755a",iconColor:"#fa755a"}};this.livePublicKey="pk_live_fJ6an24u7T7ziXp4oD4tLGFM00N9TudeYY",this.testPublicKey="pk_test_AkTJD4FnhRQeB9G9wfCifOzH00PPHxrLAN",this.setupCard=function(e){this.stripe=e?Stripe(this.livePublicKey):Stripe(this.testPublicKey);var n=this.stripe.elements();this.card=n.create("card",{style:t}),this.card.mount("#card-element"),this.card.addEventListener("change",function(e){var t=document.getElementById("card-errors");e.error?t.textContent=e.error.message:t.textContent=""})}.bind(this),this.dis.reg("paymentEnvironment",this.setupCard),this.confirmPayment=function(e){if(e.preventDefault(),!this.stripe)throw new Error("expected stripe to be initialized.");var t,n=this.store.clientSecret;if(!n)throw new Error("clientSecret has not been set");t=this.cardholderName().length>0?{payment_method:{card:this.card,billing_details:{name:this.cardholderName()}}}:{payment_method:{card:this.card}},this.stripe.confirmCardPayment(n,t).then(this.onConfirmPaymentComplete),this.dis.dispatch("confirmingPayment")}.bind(this),document.getElementById("payment-form").addEventListener("submit",this.confirmPayment),this.onConfirmPaymentComplete=function(e){e.error?(document.getElementById("card-errors").textContent=e.error.message,console.log(e.error.message),this.dis.dispatch("paymentProcessed",!1)):"succeeded"===e.paymentIntent.status?this.dis.dispatch("paymentProcessed",!0):(console.log("failure"),this.dis.dispatch("paymentProcessed",!1))}.bind(this)},template:t}}),define("text!session-tracker/template.html",[],function(){return"<link rel=\"stylesheet\" href=\"./styles/components/session-tracker/style.css?v=1.1\">\n\n  <div id='session-tracker'\n       data-bind='visible:isVisible()'>\n\n      <account-info></account-info>\n      <div class='session-tracker-spacer'></div>\n      <punch-clock></punch-clock>\n\n   <span id='close-session-tracker-button'\n         class='glyphicon glyphicon-chevron-left'\n         data-bind='click:close'>\n    </span>\n\n</div>\n"}),
/**
 * @license Proprietary - Please do not steal our hard work.
 * @Author: Christopher H. Kerley
 * @Last modified time: 2019-08-24
 * @Copyright: Palolo Education Inc. 2020
 */
define("session-tracker/AccountState",["abstract-interfaces/ValidObject"],function(e){var t=function(t){Object.setPrototypeOf(this,new e),this.setTimeRemaining=function(e){if("number"!=typeof e||e<0)throw new Error("remaining time must be a non-negative number.");this.remaining=e},this.setTimeRemaining(t.remaining),this.getTimeRemaining=function(){return this.remaining},this.setTimeFulfilled=function(e){if("number"!=typeof e||e<0)throw new Error("remaining time must be a non-negative number.");this.fulfilled=e},this.setTimeFulfilled(t.fulfilled),this.getTimeFulfilled=function(){return this.fulfilled},this.setCustomerId=function(e){this.validateId(e),this.customerId=e},this.setCustomerId(t.customer_id),this.getCustomerId=function(){return this.customerId}};return t.getRaw=function(){return{customer_id:1,remaining:2,fulfilled:3}},t.getFake=function(){var e=t.getRaw();return new t(e)},t}),define("session-tracker/SessionRemoteService",["ActiveRemoteService","dispatcher/Dispatcher","session-tracker/AccountState"],function(e,t,n){return function(){Object.setPrototypeOf(this,new e),this.setMicroServer("payments"),this.dis=new t,this.getAccountInfo=function(e){var t=this.getServerURL()+"/getAccountInfo?customer="+e;$.ajax({url:t,type:"get",beforeSend:this.setAuthorizationHeader,success:this.onAccountInfoReceived,error:this.onError})}.bind(this),this.dis.reg("getAccountInfo",this.getAccountInfo),this.onSaveSession=function(e){var t=this.getServerURL()+"/saveSessionTime";$.ajax({url:t,type:"post",data:e,beforeSend:this.setAuthorizationHeader,success:this.onAccountInfoReceived,error:this.onError})}.bind(this),this.dis.reg("saveSessionTime",this.onSaveSession),this.onAccountInfoReceived=function(e){try{this.dis.dispatch("accountInfoReceived",new n(e))}catch(e){this.dis.dispatch("sessionTrackerError",e.message)}}.bind(this),this.onError=function(e){this.dis.dispatch("sessionTrackerError",e.responseText)}.bind(this)}}),define("session-tracker/SessionStore",["dispatcher/Dispatcher","abstract-interfaces/Store","session-tracker/SessionRemoteService"],function(e,t,n){new n;var i=null,s=function(){Object.setPrototypeOf(this,new t),this.dis=new e,this.visible=!1,this.focusedPersonId=null,this.savingSession=!1,this.errorMessage=null,this.recordSavedShowing=!1,this.isRecordSavedShowing=function(){return this.recordSavedShowing}.bind(this),this.onError=function(e){this.savingSession=!1,this.errorMessage=e,this.pub()}.bind(this),this.dis.reg("sessionTrackerError",this.onError),this.getErrorMessage=function(){return this.errorMessage},this.isRefreshingInfo=function(){return this.refreshing},this.isVisible=function(){return this.visible},this.closeSessionTracker=function(){this.visible=!1,this.pub()}.bind(this),this.dis.reg("closeSessionTracker",this.closeSessionTracker),this.openSessionTracker=function(e){if("boolean"!=typeof e)throw new Error("isTutor must be boolean.");this.tutor=e,this.visible=!0,this.pub()}.bind(this),this.openerId=this.dis.reg("openSessionTracker",this.openSessionTracker),this.isTutor=function(){return this.tutor},this.getCustomersName=function(){return this.customersName},this.setFocusedPersonId=function(e){this.focusedPersonId=e.getId(),this.dis.dispatch("getAccountInfo",this.focusedPersonId)}.bind(this),this.dis.reg("focusPerson",this.setFocusedPersonId),this.getFocusedPersonId=function(){return this.focusedPersonId},this.onSaveSession=function(){this.savingSession=!0,this.pub()}.bind(this),this.dis.reg("saveSessionTime",this.onSaveSession),this.isSavingSession=function(){return this.savingSession},this.getTimeFulfilled=function(){return this.timeFulfilled},this.getTimeRemaining=function(){return this.timeRemaining},this.showRecordSavedMessage=function(){this.recordSavedShowing=!0;var e=this;setTimeout(function(){e.recordSavedShowing=!1,e.pub()},2500)},this.onGetAcccountInfo=function(){this.refreshing=!0,this.pub()}.bind(this),this.dis.reg("getAccountInfo",this.onGetAcccountInfo),this.onAccountInfoReceived=function(e){this.timeRemaining=e.remaining,this.timeFulfilled=e.fulfilled,this.savingSession&&this.showRecordSavedMessage(),this.savingSession=!1,this.refreshing=!1,this.pub()}.bind(this),this.dis.reg("accountInfoReceived",this.onAccountInfoReceived)};return{getInstance:function(){return i||(i=new s),i},getNew:function(){return new s}}}),
/**
 * @license Proprietary - Please do not steal our hard work.
 * @Author: Christopher H. Kerley
 * @Last modified time: 2019-08-24
 * @Copyright: Palolo Education Inc. 2020
 */
define("session-tracker/Component",["ko","text!session-tracker/template.html","dispatcher/Dispatcher","session-tracker/SessionStore"],function(e,t,n,i){return{viewModel:function View(){this.store=i.getInstance(),this.dis=new n,this.isVisible=e.observable(!1),this.close=function(){this.dis.dispatch("closeSessionTracker")}.bind(this),this.onStore=function(){this.isVisible(this.store.isVisible());var e=this.store.getErrorMessage();e&&alert(e)}.bind(this),this.store.sub(this.onStore)},template:t}}),define("text!punch-clock/template.html",[],function(){return"\n    <table id='punch-clock-table' data-bind=\"visible:isVisible()\">\n      <tbody>\n        <tr>\n          <th>SESSION DATE</th>\n        </tr>\n        <tr>\n          <td>\n            <input id='session-date'\n                   type='date'\n                   data-bind='value:sessionDate, attr:{max:maxDate()}'>\n            </input>\n          </td>\n        </tr>\n        <tr>\n          <th>DURATION</th>\n        </tr>\n        <tr>\n          <td>\n            <input type='number'\n                  step=\"0.5\"\n                  min=\"1\"\n                  data-bind=\"value:sessionDuration, attr:{max:maxDuration()}, disable:maxDuration() < 1\">\n            </input> hrs\n          </td>\n        </tr>\n\n        <tr>\n          <td>\n            <button id='record-session-button'\n                    class='purple-button'\n                    data-bind='click:saveTime, disable:!isDateValid() && !showSessionRecordSaved() || maxDuration() < 1'>\n                    <span data-bind='visible:!isSavingSession() && !showSessionRecordSaved()'>\n                      Save\n                    </span>\n                    <i data-bind='visible:isSavingSession() && !showSessionRecordSaved()'\n                       class='micro-spinner'>\n                    </i>\n                    <span\n                          data-bind='visible:showSessionRecordSaved()'>\n                      Record saved\n                      <i id='session-record-saved'\n                         class='glyphicon glyphicon-ok green'>\n                      </i>\n                    </span>\n            </button>\n          </td>\n        </tr>\n      </tbody>\n    </table>\n\n</div>\n"}),
/**
 * @license Proprietary - Please do not steal our hard work.
 * @Author: Christopher H. Kerley
 * @Last modified time: 2019-08-24
 * @Copyright: Palolo Education Inc. 2020
 */
define("punch-clock/Component",["ko","text!punch-clock/template.html","dispatcher/Dispatcher","session-tracker/SessionStore"],function(e,t,n,i){return{viewModel:function View(){this.store=i.getInstance(),this.dis=new n,this.isVisible=e.observable(!1),this.showSessionRecordSaved=e.observable(!1),this.sessionDate=e.observable(""),this.sessionDuration=e.observable("1"),this.isSavingSession=e.observable(!1),this.isDateValid=e.observable(!1),this.maxDate=e.observable(""),this.maxDuration=e.observable(""),this.setMaxDuration=function(e){e>=10?this.maxDuration(9.5):e>=1?this.maxDuration(e):e<1&&this.maxDuration(0)}.bind(this),this.getToday=function(){var e=new Date,t=String(e.getDate()).padStart(2,"0"),n=String(e.getMonth()+1).padStart(2,"0");return e.getFullYear()+"-"+n+"-"+t},this.maxDate(this.getToday());var t=document.getElementById("session-tracker");t&&t.addEventListener("mousedown",function(e){e.stopPropagation()}),this.close=function(){this.dis.dispatch("closeSessionTracker")}.bind(this),this.checkDate=function(e){e.length>0?this.isDateValid(!0):this.isDateValid(!1)}.bind(this),this.sessionDate.subscribe(this.checkDate,this),this.onStore=function(){this.showSessionRecordSaved(this.store.isRecordSavedShowing()),this.isVisible(this.store.isTutor()&&this.store.isVisible()),this.isSavingSession(this.store.isSavingSession()),this.setMaxDuration(this.store.getTimeRemaining()),this.sessionDate(""),this.store.getTimeRemaining()>=1?this.sessionDuration(1):this.sessionDuration(0)}.bind(this),this.store.sub(this.onStore),this.saveTime=function(){this.isDateValid()&&this.dis.dispatch("saveSessionTime",{customerId:this.store.getFocusedPersonId(),date:this.sessionDate(),duration:this.sessionDuration()})}.bind(this)},template:t}}),define("text!account-info/template.html",[],function(){return"  <div id='account-info'>\n\n    <table id='session-table-top'>\n        <tr>\n          <th>FULFILLED</th>\n        </tr>\n      <tr>\n        <td data-bind='text:timeFulfilled()'>10</td>\n      </tr>\n      <tr>\n        <th>REMAINING</th>\n      </tr>\n      <tr>\n        <td data-bind='text:timeRemaining()'>2</td>\n      </tr>\n      <tr>\n        <td colspan=\"2\">\n          <button id='session-tracker-refresh-btn' data-bind='click:refreshAccountInfo'>\n            <span data-bind=\"visible:!isSpinnerVisible()\">refresh</span>\n            <i data-bind='visible:isSpinnerVisible()'\n               class='micro-spinner'>\n            </i>\n          </button>\n        </td>\n      </tr>\n    </table>\n\n</div>\n"}),
/**
 * @license Proprietary - Please do not steal our hard work.
 * @Author: Christopher H. Kerley
 * @Last modified time: 2019-08-24
 * @Copyright: Palolo Education Inc. 2020
 */
define("account-info/Component",["ko","text!account-info/template.html","dispatcher/Dispatcher","session-tracker/SessionStore"],function(e,t,n,i){return{viewModel:function View(){this.store=i.getInstance(),this.dis=new n,this.timeRemaining=e.observable("0"),this.timeFulfilled=e.observable("0"),this.isSpinnerVisible=e.observable(!1),this.refreshAccountInfo=function(){var e=this.store.getFocusedPersonId();this.dis.dispatch("getAccountInfo",e)}.bind(this),this.onStore=function(){this.isSpinnerVisible(this.store.isRefreshingInfo()),this.timeRemaining(this.store.getTimeRemaining()),this.timeFulfilled(this.store.getTimeFulfilled())}.bind(this),this.store.sub(this.onStore)},template:t}}),define("text!doc-uploader/template.html",[],function(){return'<link rel="stylesheet"\n      href="./styles/components/course-docs/doc-uploader.css?v=1.0">\n\n<div class=\'dark-background\' data-bind=\'visible:isVisible()\'>\n\n  <span id="upload-success-message"\n        data-bind="visible:showUploadSuccess()">\n        <div>Upload successful!</div>\n           <div>Great Job!</div>\n  </span>\n\n    <div id=\'doc-uploader\' >\n          <span id=\'uploader-course-reminder\' data-bind=\'text:courseDescription()\'></span>\n          <span class=\'x-close-button\' data-bind=\'click:close\'>x</span>\n          <div id=\'doc-input\'\n              data-bind="visible:unsavedDocLoaded()">\n            <span id=\'uploader-title\'>\n              <label id="doc-reupload-btn"\n                     class="glyphicon glyphicon-upload doc-upload-btn"\n                     for="doc-uploader-input">\n              </label>\n              <span>Upload another document</span>\n            </span>\n\n            <input contenteditable="true"\n                   class=\'unsaved-doc-attr\'\n                   data-bind="textInput:unsavedDocName">\n            </input>\n            <span id=\'matching-profs-holder\'>\n              <input contenteditable="true"\n                     class=\'unsaved-doc-attr\'\n                     placeholder="Professor"\n                     data-bind="textInput:profName">\n\n              </input>\n              <ul id=\'matching-profs\'\n                      data-bind="foreach:matchingProfs, visible:matchingProfs().length > 0">\n                <div class=\'matching-prof\'\n                      data-bind="text:getFirst() + \' \' + getLast(), click:$parent.selectProf">\n                </div>\n              </ul>\n            </span>\n\n            <select contenteditable="true"\n                   class=\'unsaved-doc-attr\'\n                   data-bind="options:years,\n                              value:selectedYear,\n                              valueAllowUnset: true">\n                   <option > </option>\n\n            </select>\n\n          </div>\n          <div>\n            <label id="doc-reupload-btn"\n                   data-bind="visible:!unsavedDocLoaded()"\n                   class="glyphicon glyphicon-upload doc-upload-btn"\n                   for="doc-uploader-input">\n            </label>\n            <input id=\'doc-uploader-input\'\n                   type=\'file\'\n                   accept="application/pdf"\n                   data-bind="event:{change:uploadDoc}">\n            </input>\n          </div>\n\n          <button id=\'doc-submit\'\n                  data-bind="enable:submittable(), click:submitDoc"\n                  disabled>\n                  Submit\n                  <span class=\'spinner\'></span>\n          </button>\n\n          <div id=\'doc-course-adder\' data-bind=\'visible:courseAdderVisible()\'>\n            <div>No record of that prof teaching that course</div>\n                <div>Would you like to add the record?</div>\n                <div>\n                   <button data-bind=\'click:addCourse\'\n                           class=\'doc-course-adder-button\'>Yes</button>\n                   <button data-bind="click:closeAdder"\n                           class=\'doc-course-adder-button\'>No</button>\n                </div>\n          </div>\n\n          <div id=\'doc-uploader-terms\'>\n            By uploading you are agreeing that the content does not violate copyright\n            and you agree to the\n            <a target="_blank"  href="https://www.legal.palolo.ca/terms_and_conditions">\n              Terms and Conditions\n            </a>\n          </div>\n\n    </div>\n</div>\n'}),define("doc-uploader/Component",["ko","text!doc-uploader/template.html","dispatcher/Dispatcher","course-docs/DocStore","people-models/Prof"],function(e,t,n,i,s){return{viewModel:function ViewModel(){this.dis=new n,this.store=i.getInstance(),this.isVisible=e.observable(!1),this.courseDescription=e.observable(""),this.unsavedDocLoaded=e.observable(!1),this.unsavedDocName=e.observable(""),this.years=e.observableArray([2e3,2001,2002,2003,2004,2005,2006,2007,2008,2009,2010,2011,2012,2013,2014,2015,2016,2017,2018,2019,2020].sort().reverse()),this.selectedYear=e.observable("year"),this.profName=e.observable(""),this.matchingProfs=e.observableArray([]),this.showUploadSuccess=e.observable(!1),this.submittable=e.observable(!1),this.courseAdderVisible=e.observable(!1),this.onStore=function(){this.courseDescription(this.store.getGroupCourseInfo()),this.isVisible(this.store.isUploaderOpen),this.courseAdderVisible(this.store.isCourseAdderVisible()),this.submittable(this.store.isReadyToSubmit()),this.matchingProfs(this.store.matchingProfs),this.store.inputsShouldBeReset()&&this.clearInputFields(),this.store.getUnsavedDoc()?(this.unsavedDocLoaded(!0),this.unsavedDocName(this.store.getUnsavedDocTitle())):(this.unsavedDocLoaded(!1),this.unsavedDocName("")),this.showUploadSuccess(this.store.isSuccessPopupVisible())}.bind(this),this.store.sub(this.onStore),this.closeAdder=function(){this.dis.dispatch("closeCourseAdder")},this.addCourse=function(){var e=this.store.getUnsavedDoc();this.dis.dispatch("addCourseAndUpload",e)},this.close=function(e){this.dis.dispatch("closeDocUploader")}.bind(this),this.getMatchingProfs=function(e){e.length>0?this.dis.dispatch("getMatchingProfs",e):this.matchingProfs([])}.bind(this),this.profNameId=this.profName.subscribe(this.getMatchingProfs),this.selectProf=function(e,t){t.preventDefault(),t.stopPropagation(),this.profName(e.getFirst()+" "+e.getLast()),this.dis.dispatch("selectedProf",e)}.bind(this),this.setTitle=function(e){e.length>0&&this.dis.dispatch("setDocTitle",e)}.bind(this),this.subTit=this.unsavedDocName.subscribe(this.setTitle),this.setYear=function(e){String(e).length>0&&this.dis.dispatch("setDocYear",e)}.bind(this),this.subYearId=this.selectedYear.subscribe(this.setYear),this.clearInputFields=function(){this.profName(""),this.selectedYear(""),this.dis.dispatch("uploaderHasBeenReset")}.bind(this),this.uploadDoc=function(e,t){var n=t.currentTarget.files[0];$("#doc-uploader-input").val(""),this.dis.dispatch("docUpload",n)}.bind(this),this.submitDoc=function(){this.store.isReadyToSubmit()&&this.dis.dispatch("submitDoc",this.store.getUnsavedDoc())}},template:t}}),define("text!chat/template.html",[],function(){return'<link rel="stylesheet" href="./styles/components/chat/style.css?v=2.6"></link>\n\n<div id="chat-holder"\n     data-bind="visible:isVisible()">\n\n     \x3c!-- spinner --\x3e\n     <div  class="screen-center-outer">\n      <div class="screen-center-inner">\n         <div class="loader"\n              data-bind="visible:isSpinnerVisible()">\n         </div>\n      </div>\n    </div>\n\n  <ul class="show-vert-scroll"\n      data-bind="foreach: messages"\n      id="chat">\n\n      <li class="chat-message"\n          draggable="false"\n          data-bind="css:{ \'chat-message-self\': owner == true}">\n\n        \x3c!-- ko if: typeof img_url == \'string\' --\x3e\n          <img data-bind="attr:{src:img_url}"\n               class="one-on-one-chat-img disable-select">\n          </img>\n        \x3c!-- /ko --\x3e\n\n        <span data-bind="html:getHTML()"\n              class="chat-text">\n        </span>\n\n        \x3c!-- ko if: owner --\x3e\n        <i data-toggle="tooltip" title="sending">\n          <i class="dot acknowledgement-dot empty-dot sent-dot"\n           data-bind="visible:!sent()">\n         </i>\n        </i>\n        <i data-toggle="tooltip" title="sent">\n          <i class="dot acknowledgement-dot filled-dot sent-dot"\n             data-bind="visible:sent()">\n          </i>\n        </i>\n        <i data-toggle="tooltip" title="seen">\n          <i class="dot acknowledgement-dot filled-dot seen-dot"\n             data-bind="visible:seen()">\n          </i>\n        </i>\n        <i class="dot acknowledgement-dot empty-dot seen-dot"\n           data-bind="visible:!seen()">\n        </i>\n        \x3c!-- /ko --\x3e\n\n        <span data-bind="text:timestamp, css: { \'chat-timestamp-other-person\': owner != true }"\n              class="chat-timestamp disable-select">\n        </span>\n\n        <i class="sender-img-holder"\n          data-bind="visible: owner == true">\n          <img class="sender-img"\n              data-bind="attr:{src:getSenderImageURL()}">\n        </img>\n        </i>\n\n        <i class="sender-img-holder-other"\n          data-bind="visible: owner == false">\n          <img class="sender-img"\n              data-bind="attr:{src:getSenderImageURL()}">\n        </img>\n        </i>\n\n      </li>\n  </ul>\n\n\n\n\n  <div class="message-sender">\n\n    <div data-bind="visible:friendTyping()"\n          id="typing-message-pos">\n      <div class="horz-loader">Loading...</div>\n      <i id="typing-message">Typing..</i>\n    </div>\n\n\x3c!-- New friend message prompt. --\x3e\n    <div id="send-msg-prompt"\n         data-bind="visible:showSendMsgPrompt()">\n\n        <span id="send-message-prompt-text"\n              class="disable-select">\n\n            Say hello!\n                <i class="down"\n                   id="send-message-prompt-down-arrow">\n                </i>\n          </span>\n    </div>\n    <textarea\n               id="chat-text-area"\n               rows="1"\n               class="message-input-holder show-vert-scroll"\n               placeholder="What would you like to say to them?"\n               type="text"\n               data-bind="textInput:newMessage,\n                          event:{keydown: onKeyPress}\n                          attr: {placeholder:placeholder()},\n                          hasFocus: inputHasFocus(),\n                          click: inputClicked">\n    </textarea>\n\n    <button\n            class="disable-select send-message-btn"\n            data-bind="enable:isValidInput(), click:send, css:{}">\n            SEND\n    </button>\n  </div>\n</div>\n'}),define("chat/models/ChatMessage",["ko"],function(e){var t=function(t,n){this.sent=e.observable(!1),this.seen=e.observable(!1),this.getConstructorName=function(){return"ChatMessage"},this.setHost=function(e){if("string"!=typeof e||e.lenth<1)throw new Error("host must be set");this.host=e},this.setHost(n),this.setId=function(e){if(!e||"number"!=typeof e)throw new Error("message_id must be specified.");this.message_id=e},this.getId=function(){return this.message_id},this.setText=function(e){if(!e||"string"!=typeof e)throw new Error("text property must exist in the message.");this.text=e},this.setText(t.text),this.setSenderImgURL=function(e){"string"!=typeof e||e.length<1?this.imgURL="./assets/no-photo.jpg":this.imgURL=e},this.setSenderImgURL(t.small_photo_url),this.getSenderImageURL=function(){return this.host+"/"+this.imgURL},this.getSenderId=function(){},this.isOwner=function(){}};return t.getRaw=function(e){var t={timestamp:"2019-04-09T05:42:56.000Z",message_id:3,recipient_id:2,user_id:1,text:"default text",small_photo_url:"img.jpg"};return e?(t.user_id=e,t):t},t.getFake=function(){var e=t.getRaw();return new t(e,"fakehost")},t}),define("chat/models/OutboundChatMessage",["ko","chat/models/ChatMessage","text-utilities"],function(e,t,n){var i=function(e,i){Object.setPrototypeOf(this,new t(e,i)),this.owner=!0,this.token=Date.now(),this.getConstructorName=function(){return"OutboundChatMessage"},this.setRecipientId=function(e){if(!e||0==Number.isInteger(e))throw new Error("recipient_id must be a integer.");this.recipient_id=e},this.setRecipientId(e.recipient_id),this.setSent=function(e){e==this.token&&this.sent(!0)},this.setSeen=function(e){e==this.getId()&&this.seen(!0)},this.getHTML=function(){return n.wrapLinks(this.text,"chat-link")},this.getToken=function(){return this.token}};return i.constructor=i,i.getFake=function(){var e=t.getRaw();return e.recipient_id=1,new i(e,"host")},i}),define("chat/models/InboundChatMessage",["chat/models/ChatMessage","text-utilities"],function(e,t){var n=function(n,i){Object.setPrototypeOf(this,new e(n,i)),this.setId(n.message_id),this.sent(!0),this.setSeen=function(e){if(1!=e&&0!=e)throw new Error("seen must be 1 or 0");this.seen(e)},this.setSeen(n.seen),this.setSenderId=function(e){if(!e||"number"!=typeof e)throw new Error("user_id must be set on each message.");this.user_id=e},this.setSenderId(n.user_id),this.getSenderId=function(){return this.user_id},this.setRecipientId=function(e){if(!e||"number"!=typeof e)throw new Error("recipient_id must be set on each message.");this.recipient_id=e},this.setRecipientId(n.recipient_id),this.setTimestamp=function(e){if("string"!=typeof e||e.length<1)throw new Error("timestamp must exist.");this.timestamp=e},this.setTimestamp(n.timestamp),this.isSent=function(){return!1},this.maybeSetAsOwner=function(e){this.owner=!(!e||"recipient"==e)},this.maybeSetAsOwner(n.owner),this.isOwner=function(){return!0===this.owner},this.setStyleClass=function(e){this.styleClass=e},this.getHTML=function(){return this.isOwner()?t.wrapLinks(this.text,"chat-link"):t.wrapLinks(this.text,"chat-link-friend")}};return n.getRaw=function(){var t=e.getRaw(),n=Object.assign(t,{message_id:1,user_id:2,recipient_id:3,text:"hello",timestamp:"moments ago",seen:0});return console.log(n),n},n.getFake=function(){var e=n.getRaw();return new n(e,"host")},n}),define("chat/ChatRemoteService",["socketio","ActiveRemoteService","dispatcher/Dispatcher","chat/models/InboundChatMessage"],function(e,t,n,i){var s=function(){this.constructor=s,this.sock=null,this.io=e,this.dis=new n,Object.setPrototypeOf(this,new t),this.setMicroServer("chat"),this.onAuth=function(e){"authenticated"==e.state&&this.setSock(this.onSock)},this.onAuth=this.onAuth.bind(this),this.disAuthId=this.dis.reg("authState",this.onAuth),this.onSock=function(){this.sock.on("io_error",this.onError),this.sock.on("messageSent",this.onMessageSent),this.sock.on("chatHistory",this.onMessageHistory),this.sock.on("friendTyping",this.onTyping),this.sock.on("message",this.onMessage),this.sock.on("seen",this.onSeen)},this.onSock=this.onSock.bind(this),this.onError=function(e){console.log(e)},this.onMessageHistory=function(e){var t=[],n=this.getServerURL();e.forEach(function(e){t.push(new i(e,n))}),this.dis.dispatch("chatHistory",t)},this.onMessageHistory=this.onMessageHistory.bind(this),this.onMessage=function(e){var t=this.getServerURL();this.dis.dispatch("message",new i(e,t))},this.onMessage=this.onMessage.bind(this),this.onMessageSent=function(e){this.dis.dispatch("messageSent",e)},this.onMessageSent=this.onMessageSent.bind(this),this.onSeen=function(e){if(!Array.isArray(e))throw new Error("messageIds must be an array.");e.length>0&&this.dis.dispatch("seen",e)},this.onSeen=this.onSeen.bind(this),this.emitGetHistory=function(e){this.sock.emit("getChatHistory",e)},this.emitGetHistory=this.emitGetHistory.bind(this),this.histId=this.dis.reg("getChatHistory",this.emitGetHistory),this.emitSeen=function(e){this.sock.emit("messageSeen",e)},this.emitSeen=this.emitSeen.bind(this),this.seenId=this.dis.reg("messageSeen",this.emitSeen),this.emitMessage=function(e){this.sock.emit("sendMessage",e)},this.emitMessage=this.emitMessage.bind(this),this.sendMessageId=this.dis.reg("sendMessage",this.emitMessage),this.emitTyping=function(e){this.sock.emit("typing",e)},this.emitTyping=this.emitTyping.bind(this),this.typingId=this.dis.reg("typing",this.emitTyping),this.onTyping=function(e){this.dis.dispatch("friendTyping",e)},this.onTyping=this.onTyping.bind(this)};return s}),
/**
 * @license Proprietary - Please do not steal our hard work.
 * @Author: Christopher H. Kerley
 * @Last modified time: 2019-08-24
 * @Copyright: Palolo Education Inc. 2020
 */
define("chat/ViewModel",["ko","socketio","text-utilities","text!chat/template.html","chat/models/ChatMessage","chat/models/OutboundChatMessage","chat/ChatRemoteService","dispatcher/Dispatcher"],function(e,t,n,i,s,r,o,a){return{viewModel:function ViewModel(t,i){this.dis=new a,this.selectedClassmateId=e.observable(null),this.inputHasFocus=e.observable(!1).extend({notify:"always"}),this.placeholder=e.observable(""),this.messages=e.observableArray([]),this.showSendMsgPrompt=e.observable(!1),this.newMessage=e.observable(""),this.isValidInput=e.observable(!1),this.isSpinnerVisible=e.observable(!1),this.friendTyping=e.observable(!1),this.remoteService=new o,this._messageSentHideDelay=5e3,this.chatBoxHeight=e.observable(1),this.onClassmateSelected=function(e){if(!e||"object"!=typeof e)throw new Error("Classmate must be an object.");this.selectedClassmateId(e.getId()),this.refreshChat()}.bind(this),this.dis.reg("focusPerson",this.onClassmateSelected),this.isVisible=e.computed(function(){return this.selectedClassmateId()>0&&null!=this.selectedClassmateId()},this),this.possiblyScaleInputBox=function(){var e=this.newMessage().split(/\r\n|\r|\n/).length;$("#chat-text-area").attr("rows",e)}.bind(this),this.onKeyPress=function(e,t){return t.send=this.send,this.possiblyScaleInputBox(),n.onKeyPress(t)}.bind(this),this.validateTextInput=function(e){/[^\s]+/.test(e)?this.isValidInput(!0):this.isValidInput(!1)},this.validateTextInput=this.validateTextInput.bind(this),this.newMessage.subscribe(this.validateTextInput,this),this.recordPartialText=function(e){var t=this.selectedClassmateId();if(isNaN(t)||t<1)throw new Error("classmateId must be a postive integer.");"string"==typeof e&&e.length>0&&this.dis.dispatch("typing",{recipient_id:t,text:e})},this.recordPartialText=this.recordPartialText.bind(this),this.typingSub=this.newMessage.subscribe(this.recordPartialText,this),this.setNoPersonSelected=function(){this.selectedClassmateId(null)}.bind(this),this.dis.reg("groupInfo",this.setNoPersonSelected),this.dis.reg("openNews",this.setNoPersonSelected),this.onMessageHistory=function(e){if(!Array.isArray(e))throw new Error("msgs must be an array.");if(this.isSpinnerVisible(!1),e.length<=0)this.attachSendMessagePrompt();else{this.showSendMsgPrompt(!1);for(var t=0;t<e.length;t++){var n=this.selectedClassmateId(),i=e[t].getSenderId(),s=e[t].isOwner();(n==i||s)&&this.messages.unshift(e[t])}}},this.onMessageHistory=this.onMessageHistory.bind(this),this.dis.reg("chatHistory",this.onMessageHistory),this.attachSendMessagePrompt=function(){this.showSendMsgPrompt(!0)},this.attachSendMessagePrompt=this.attachSendMessagePrompt.bind(this),this.initialize=e.computed(function(){return this.selectedClassmateId()},this),this.clearChat=function(){this.messages([]),this.friendTyping(!1)},this.updateTextInputPlaceHolder=function(e){this.placeholder("What would you like to say to "+e.getFirst()+"?")},this.updateTextInputPlaceHolder=this.updateTextInputPlaceHolder.bind(this),this.dis.reg("selectedClassmate",this.updateTextInputPlaceHolder),this.oldFriendId=null,this.refreshChat=function(){var e=this.selectedClassmateId();e<1||(this.oldFriendId&&this.clearChat(),this.isSpinnerVisible(!0),this.oldFriendId=e,this.newMessage(""),this.dis.dispatch("getChatHistory",e))},this.refreshChat=this.refreshChat.bind(this),this.inputClicked=function(){this.inputHasFocus(!0)},this.send=function(){var e=this.selectedClassmateId(),t=n.formatToHTML(this.newMessage()),i=this.remoteService.getServerURL(),s=new r({text:t,small_photo_url:"img",recipient_id:e},i);this.messages.unshift(s),s.text=Object.getPrototypeOf(s).text,this.dis.dispatch("sendMessage",s),this.newMessage("")},this.send=this.send.bind(this),this.onMessageSent=function(e){var t=e.token;this.messages().forEach(function(n){"OutboundChatMessage"==n.getConstructorName()&&t==n.getToken()&&(n.setSent(t),n.setId(e.id))}),this.possiblyScaleInputBox()},this.onMessageSent=this.onMessageSent.bind(this),this.dis.reg("messageSent",this.onMessageSent),this.onMessagesSeen=function(e){this.messages().forEach(function(t){"OutboundChatMessage"==t.getConstructorName()&&e.forEach(function(e){t.setSeen(e)})})},this.onMessagesSeen=this.onMessagesSeen.bind(this),this.seenId=this.dis.reg("seen",this.onMessagesSeen),this.onTyping=function(e){if(e==this.selectedClassmateId()){this.friendTyping(!0);var t=this;t.onTypingId&&clearTimeout(t.onTypingId),t.onTypingId=setTimeout(function(){t.friendTyping(!1)},3e3)}},this.onTyping=this.onTyping.bind(this),this.dis.reg("friendTyping",this.onTyping),this.onMessage=function(e){var t=this.selectedClassmateId();e.getSenderId()===t&&(this.messages.unshift(e),this.showSendMsgPrompt(!1),this.friendTyping(!1),this.dis.dispatch("messageSeen",e))},this.onMessage=this.onMessage.bind(this),this.disChatId=this.dis.reg("message",this.onMessage)},template:i}}),define("text!right-panel/template.html",[],function(){return"\n\n\n    <screen-share></screen-share>\n    <forum-stats></forum-stats>\n    <course-info></course-info>\n    <pre-view></pre-view>\n    <person-info></person-info>\n    <file-dropper></file-dropper>\n"}),define("right-panel/Component",["ko","text!right-panel/template.html"],function(e,t){return{viewModel:function(){},template:t}}),define("ad-views/AdRemoteService",["ActiveRemoteService","socketio","dispatcher/Dispatcher","jquery"],function(e,t,n,i){var s=function(r){this._io=t,this.dis=new n,this.constructor=s,Object.setPrototypeOf(this,new e),this.setMicroServer("ads"),this.registerOnAdReceived=function(e){this.checkFunction(e),this.onAdReceived=e},this.getAdFromServer=function(){var e=this.getServerURL()+"/ad",t=this;i.ajax({url:e,type:"GET",beforeSend:this.setAuthorizationHeader,success:function(e){t.onAdReceived(JSON.parse(e))},error:function(e,t,n){console.log(n)}})},this.registerOnMessageSent=function(e){this.checkFunction(e),this.onMessageSent=e},this.onAdHovered=function(e){var t=this.getServerURL()+"/adHovered";i.ajax({url:t,type:"POST",data:{adId:e.getId()},beforeSend:this.setAuthorizationHeader,error:function(e,t,n){console.log(n)}})},this.onAdHovered=this.onAdHovered.bind(this),this.adHoveredId=this.dis.reg("adHovered",this.onAdHovered),this.recordLeadClick=function(e){var t=this.getServerURL()+"/adClicked";i.ajax({url:t,type:"POST",data:{adId:e.getId()},beforeSend:this.setAuthorizationHeader,error:function(e,t,n){console.log(n)}})},this.sendMessage=function(e){var t=this.getServerURL()+"/message",n=e.ad,s=e.message;i.ajax({url:t,type:"POST",data:{adId:n.getId(),message:s,headline:n.getHeadline()},beforeSend:this.setAuthorizationHeader,success:this.onMessageSent,error:function(e,t,n){console.log(n)}})},this.checkFunction=function(e){if("function"!=typeof e)throw new Error("fn must be a function")}};return s}),define("ad-views/NullAd",["ko"],function(e){return function(e){this.getConstructorName=function(){return"NullAd"},this.id=0,this.headline="Your Headline",this.degree="B.A",this.school="York University",this.major="Computer Science",this.experience=2,this.firstName="First",this.lastName="Last",this.imgURL="./assets/no-photo.jpg",this.hourlyRate=25,this.isDegreeVerified=!0,this.getId=function(){return this.id},this.getHeadline=function(){return this.headline},this.getDegree=function(){return this.degree},this.getSchool=function(){return this.school},this.getMajor=function(){return this.major},this.getExperience=function(){return this.experience},this.getFirstName=function(){return this.firstName},this.getLastName=function(){return this.lastName},this.getImgURL=function(){return this.imgURL},this.getHourlyRate=function(){return this.hourlyRate},this.isDegreeVerified=function(){return this.isDegreeVerified},this.getText=function(){return""}}}),define("ad-views/Ad",["ko"],function(e){return function(e){this.getConstructorName=function(){return"Ad"},this.checkString=function(e,t){if(!e||"string"!=typeof e||e.length<1)throw new Error(t)},this.checkNum=function(e,t){if(!e||0==Number.isInteger(e)||e<1)throw new Error(t)},this.setId=function(e){this.checkNum(e,"ad_id required"),this.ad_id=e},this.setId(e.ad_id),this.getId=function(){return this.ad_id},this.setHeadline=function(e){this.checkString(e,"headline is required."),this.headline=e},this.setHeadline(e.headline),this.getHeadline=function(){return this.headline},this.setDegree=function(e){this.checkString(e,"degree is required."),this.degree=e},this.setDegree(e.degree),this.getDegree=function(){return this.degree},this.setSchool=function(e){this.checkString(e,"school is required."),this.school=e},this.setSchool(e.school),this.getSchool=function(){return this.school},this.setMajor=function(e){this.checkString(e,"major is required."),this.major=e},this.setMajor(e.major),this.getMajor=function(){return this.major},this.setExperience=function(e){this.checkNum(e,"experience is required."),this.experience=e},this.setExperience(e.experience),this.getExperience=function(){return this.experience+" years"},this.setFirstName=function(e){this.checkString(e,"first_name is is required."),this.firstName=e},this.setFirstName(e.first_name),this.getFirstName=function(){return this.firstName},this.setLastName=function(e){this.checkString(e,"last_name is is required."),this.lastName=e},this.setLastName(e.last_name),this.getLastName=function(){return this.lastName},this.setImgURL=function(e){this.checkString(e,"img_url is is required."),this.imgURL=e},this.setImgURL(e.img_url),this.getImgURL=function(){return this.serverPrefix+"/"+this.imgURL},this.setServerPrefix=function(e){this.checkString(e),this.serverPrefix=e},this.setHourlyRate=function(e){this.checkNum(e,"hourly_rate is required."),this.hourlyRate=e},this.setHourlyRate(e.hourly_rate),this.getHourlyRate=function(){return this.hourlyRate},this.setDegreeVerification=function(e){if(0!=e&&1!=e)throw new Error("is_degree_verified is required.");this.isDegreeVerified=e},this.setDegreeVerification(e.is_degree_verified),this.isDegreeVerified=function(){return this.isDegreeVerified},this.setText=function(e){if(!e||"string"!=typeof e||e.length<1)throw new Error("Ads must have non-empty text.");this.text=e},this.setText(e.text),this.getText=function(){return this.text}}}),define("ad-views/AdStore",["ko","ad-views/AdRemoteService","dispatcher/Dispatcher","ad-views/NullAd","ad-views/Ad"],function(e,t,n,i,s){var r={},o=new i,a=[],c=new t,d=!1,u=new n,h=!0,l=!1,p=null,f=function(){a.forEach(function(e){e()}),"function"==typeof p&&p()};return r.onPub=function(e){p=e},r.getCurrentAd=function(){return o},r.setCurrentAd=function(e){if("Ad"!=e.getConstructorName())throw new Error("error");o=e},r.isAdVisible=function(){return h},r.setAdVisible=function(){h=!0},r.setAdNotVisible=function(){h=!1},r.onOpenGroupView=function(){r.setAdVisible(),f()},u.reg("showGroupView",r.onOpenGroupView),r.onGiveClassmateFocus=function(){r.setAdNotVisible(),f()},r.classmateId=u.reg("focusPerson",r.onGiveClassmateFocus),r.init=function(){c.registerOnAdReceived(r.onAdReceived),c.registerOnMessageSent(r.onMessageSent)},r.onAdReceived=function(e){(o=new s(e)).setServerPrefix(c.getServerURL()),r.publish()},r.onMessageSent=function(){d=!1,r.publish()},r.getLeadMessage=function(){return"Hi, I’m interested. Please contact me."},r.onCourseInfo=function(e){c.getAdFromServer()},u.reg("groupInfo",r.onCourseInfo),r.isWaiting=function(){return d},r.isLeadOpen=function(){return l},r.onOpenLead=function(){l=!0,r.publish(),c.recordLeadClick(o)},u.reg("openLead",r.onOpenLead),r.onCloseLead=function(){l=!1,r.publish()},u.reg("closeLead",r.onCloseLead),r.onMessage=function(e){c.sendMessage({ad:o,message:e}),d=!0,r.publish()},u.reg("leadMessage",r.onMessage),r.subscribe=function(e){a.push(e)},r.publish=function(){a.forEach(function(e){e()}),"function"==typeof p&&p()},r.getRemoteService=function(){return c},r.init(),r}),define("text!ad-views/pre-view/template.html",[],function(){return'<link rel="stylesheet"\n      href="./styles/components/right-panel/ad-views/pre-view.css">\n  <div id=\'ad-views-holder\'\n       data-bind="visible:isVisible(),click:openLead,  event: { mouseenter: onHover}">\n       <div id="inner-ad-holder">\n         <img id="ad-image"\n              data-bind="attr:{\'src\':currentAd().getImgURL()}">\n         </img>\n         <div id="preview-bottom-part">\n           <div id="preview-footer"\n                data-bind="text:currentAd().getHeadline()">\n           </div>\n         </div>\n       </div>\n\n\n  </div>\n'}),define("right-panel/ad-views/pre-view/Component",["ko","dispatcher/Dispatcher","ad-views/AdStore","text!ad-views/pre-view/template.html","ad-views/NullAd"],function(e,t,n,i,s){return{viewModel:function(){this.dis=new t,this.isVisible=e.observable(!1),this.isLeadVisible=e.observable(!1).extend({notify:"always"}),this.currentAd=e.observable(new s),this.store=n,this.onStoreChange=function(){this.isVisible(this.store.isAdVisible()),this.currentAd(this.store.getCurrentAd())},this.onStoreChange=this.onStoreChange.bind(this),this.store.subscribe(this.onStoreChange),this.openLead=function(){this.dis.dispatch("openLead")},this.onHover=function(){this.dis.dispatch("adHovered",this.currentAd())},this.onHover=this.onHover.bind(this)},template:i}}),define("text!ad-views/lead-view/template.html",[],function(){return'\n<link rel="stylesheet"\n      href="./styles/components/right-panel/ad-views/lead-view.css?v=1.0">\n\n<div id="lead-submitter"\n     class=\'background-dimmer\'\n     data-bind="visible: isVisible()">\n  <div id="ad-waiting"\n       class="loader"\n       data-bind="visible:isWaiting()">\n  </div>\n\n  <div id="message-sent" data-bind="visible:showMessageSent()">\n      Message Sent!\n  </div>\n\n  \x3c!-- ko if: currentAd() != null --\x3e\n  <div id="submitter-window" data-bind="click : closeLead">\n\n    <div>\n\n      <div id="ad-space" data-bind="click: dontPropagate">\n         <div id="ad-headline" data-bind="text:currentAd().getHeadline()"></div>\n         \x3c!-- top row --\x3e\n            <div id="ad-header-holder">\n\n              <img id="tutor-image"\n                   data-bind="attr:{src : currentAd().getImgURL()}">\n              </img>\n\n              <ul id=\'qualifications-list\'>\n                <li>\n                   <span> School</span> <span class="qual-data" data-bind="text:currentAd().getSchool()"></span>\n                </li>\n                <li>\n                   <span> Degree </span> <span class="qual-data"  data-bind="text:currentAd().getDegree()"></span>\n                </li>\n                <li>\n                   <span> Major </span><span class="qual-data"  data-bind="text:currentAd().getMajor()"></span>\n                </li>\n                <li>\n                   Experience <span  class="qual-data" data-bind="text:currentAd().getExperience()"></span>\n                </li>\n              </ul>\n\n            </div>\n         <div id="ad-text" data-bind="html:currentAd().getText()"></div>\n      </div>\n\n\n\n\n      <div id="ad-right-side" data-bind="click: dontPropagate">\n        <div id="lead-submition-space">\n          <div id="advertiser-name"> Contact\n            <span data-bind="text:currentAd().getFirstName()"></span>\n            <span data-bind="text:currentAd().getLastName()"></span>\n          </div>\n          <textarea id="submitter-text-area"\n                    data-bind="value:leadMessage">\n          </textarea>\n          <button id="submitter-message-button"\n                  data-bind="click:sendMessage">Send Message</button>\n        </div>\n\n      </div>\n\n    </div>\n\n\n\n  </div>\n \x3c!-- /ko --\x3e\n\n\n</div>\n'}),define("right-panel/ad-views/lead-view/Component",["ko","dispatcher/Dispatcher","text!ad-views/lead-view/template.html","ad-views/AdStore","ad-views/NullAd"],function(e,t,n,i,s){return{viewModel:function(){this.isVisible=e.observable(!1),this.leadMessage=e.observable("Hi, I’m interested. Please contact me."),this.isWaiting=e.observable(!1),this.currentAd=e.observable(new s),this.showMessageSent=e.observable(!1),this.store=i,this.dis=new t,this.onStoreChanged=function(){this.currentAd(this.store.getCurrentAd()),this.isVisible(this.store.isLeadOpen());var e=this.isWaiting(),t=this.store.isWaiting();if(e&&!t){this.leadMessage(this.store.getLeadMessage()),this.showMessageSent(!0);var n=this;setTimeout(function(){n.showMessageSent(!1),n.isVisible(!1)},1500)}this.isWaiting(t)},this.onStoreChanged=this.onStoreChanged.bind(this),this.store.subscribe(this.onStoreChanged),this.dontPropagate=function(e,t){t.stopImmediatePropagation()},this.closeLead=function(e,t){this.dis.dispatch("closeLead")},this.closeLead=this.closeLead.bind(this),this.sendMessage=function(){var e=this.leadMessage().trim();e.length>0?(this.dis.dispatch("leadMessage",e),this.leadMessage("")):alert("Messages can't be empty")},this.sendMessage=this.sendMessage.bind(this)},template:n}}),define("text!right-panel/current-courses/template.html",[],function(){return'\n<link rel="stylesheet" href="./styles/components/right-panel/current-courses.css">\n\n<div id="current-courses-holder"\n     data-bind="visible:isVisible()">\n\n  <div data-bind="visible:isConciseVisible()">\n    <span data-bind="visible:verboseCourses().length > 0">\n      Courses:\n      <span data-bind="foreach:conciseCourses()">\n        <span class="current-course"\n              data-bind="text:getDept() + getCourseCode() + getSectionLetter(), click:$parent.selectCourse">\n        </span>\n      </span>\n    </span>\n     <span data-bind="visible:verboseCourses().length > 3, click:showVerboseList"\n           class="current-course">more</span>\n  </div>\n\n\n  <div data-bind="visible:isVerboseVisible()">\n    <span data-bind="visible:verboseCourses().length > 0">\n      Courses:\n      <span data-bind="foreach:verboseCourses()">\n        <span class="current-course"\n              data-bind="text:getDept() + getCourseCode() + getSectionLetter(), click:$parent.selectCourse">\n        </span>\n      </span>\n    </span>\n    <span data-bind="visible:isVerboseVisible(), click:hideVerboseList"\n          class="current-course">less</span>\n  </div>\n\n\n</div> \x3c!--end holder  --\x3e\n'}),define("right-panel/current-courses/Component",["ko","text!right-panel/current-courses/template.html","dispatcher/Dispatcher","course/models/CourseGroup","course/CourseStore"],function(e,t,n,i,s){return{viewModel:function(){this.dis=new n,this.store=s.getInstance(),this.isVisible=e.observable(!1),this.isVerboseVisible=e.observable(!1),this.verboseCourses=e.observableArray([]),this.isConciseVisible=e.observable(!0),this.conciseCourses=e.observableArray([]),this.onStoreUpdate=function(){this.maybeSetExperimentalMode();var e=this.store.getClassmateCourseGroups();this.verboseCourses(e);var t=e.slice(0,3);this.conciseCourses(t)},this.onStoreUpdate=this.onStoreUpdate.bind(this),this.store.sub(this.onStoreUpdate),this.maybeSetExperimentalMode=function(){var e=this.store.getClassmatesId();Number.isInteger(e)&&(e%2==0?this.isVisible(!1):this.isVisible(!0))},this.selectCourse=function(e){this.dis.dispatch("selectedGroupId",e.getId())},this.selectCourse=this.selectCourse.bind(this),this.showVerboseList=function(){this.isVerboseVisible(!0),this.isConciseVisible(!1)},this.hideVerboseList=function(){this.isVerboseVisible(!1),this.isConciseVisible(!0)}},template:t}}),define("text!right-panel/course-info/template.html",[],function(){return'\n\x3c!-- <link rel="stylesheet"\n      href="./styles/components/right-panel/course-info/course-info.css"> --\x3e\n\n<div id="course-info-holder"\n     data-bind="visible:isVisible()">\n     <course-photos></course-photos>\n     <course-text-info></course-text-info>\n</div>\n'}),define("right-panel/course-info/Component",["ko","text!right-panel/course-info/template.html","dispatcher/Dispatcher","course/CourseStore"],function(e,t,n,i){return{viewModel:function(){this.dis=new n,this.store=i.getInstance(),this.isVisible=e.observable(!1),this.onStoreChanged=function(){this.isVisible(this.store.isGroupViewVisible())},this.onStoreChanged=this.onStoreChanged.bind(this),this.store.sub(this.onStoreChanged)},template:t}}),define("text!right-panel/course-info/text-info/template.html",[],function(){return'\n<link rel="stylesheet"\n      href="./styles/components/right-panel/course-info/text-info.css?v=1.1">\n\n<div id="course-text-info-holder">\n\n\n    \x3c!-- ko if: group() != null --\x3e\n\n  <div id="course-info-text">\n\n    <span id="course-group-location"\n         class="disable-select">\n\n        <span data-bind=\'text:group().getDept()\'></span>\n        <span data-bind="text:group().getCourseCode()"></span>\n        <span> Section </span>\n        <span data-bind="text:group().getSectionLetter()"></span>\n    </span>\n    <span id="course-description"\n         class="disable-select">\n         <span id=\'desc-name\' data-bind="text:group().getCourseDescription()"></span>\n    </span>\n    <span id="course-description"\n         class="disable-select">\n         Location:\n         <span data-bind="text:group().getBuilding()"></span>\n    </span>\n  </div>\n\n  <non-member-prompt></non-member-prompt>\n\n  <span id="leave-group-button"\n          data-bind="visible:isLeaveButtonVisible(), click:leaveGroup">\n          leave group\n  </span>\n\n\n\n  \x3c!-- /ko --\x3e\n\n\n</div>\n'}),define("right-panel/course-info/text-info/Component",["ko","text!right-panel/course-info/text-info/template.html","dispatcher/Dispatcher","course/CourseStore"],function(e,t,n,i){return{viewModel:function(){this.dis=new n,this.store=i.getInstance(),this.group=e.observable(null),this.isLeaveButtonVisible=e.observable(!1),this.onStoreChange=function(){var e=this.store.getCurrentGroup();e&&this.group(e),this.isLeaveButtonVisible(this.store.isGroupMember())}.bind(this),this.store.sub(this.onStoreChange),this.leaveGroup=function(){this.dis.dispatch("leaveSelectedCourse")}},template:t}}),define("text!right-panel/course-info/course-photos/template.html",[],function(){return'<link rel="stylesheet"\n      href="./styles/components/right-panel/course-info/course-photos.css?v=1.1">\n\n<div id="location-image-holder">\n\n\n  <img id="forum-img"\n       class="disable-select"\n       src="#"\n       data-bind="attr:{src:currentImageUrl()}">\n\n   <input id="location-image-upload-button"\n          type="file"\n          data-bind="event:{change:uploadPhoto}">\n   </input>\n   <span class=\'course-prof-holder\'>\n          <img class=\'prof-img\'\n               data-bind=\'attr:{src:profsPhotoURL()}\'>\n          </img>\n      <span class=\'groups-prof-name\'\n            data-bind=\'text:profsName()\'>\n      </span>\n  </span>\n</div>\n'}),define("right-panel/course-info/course-photos/CoursePhoto",[],function(){return function(e,t){this.setGroup=function(e){if(0==Number.isInteger(e))throw new Error("group cant be empty.");this.groupId=e},this.setGroup(e),this.getGroupId=function(){return this.groupId},this.setImage=function(e){if(!e)throw new Error("image cant be empty.");this.image=e},this.setImage(t),this.getImage=function(){return this.image}}}),define("right-panel/course-info/course-photos/Component",["ko","text!right-panel/course-info/course-photos/template.html","dispatcher/Dispatcher","course/CourseStore","right-panel/course-info/course-photos/CoursePhoto"],function(e,t,n,i,s){return{viewModel:function(){this.currentImageUrl=e.observable("./assets/missing-group-photo.jpg"),this.dis=new n,this.store=i.getInstance(),this.isVisible=e.observable(!1),this.profsName=e.observable("Unknown Professor"),this.profsPhotoURL=e.observable("./assets/no-photo.jpg"),this.onStoreChange=function(){var e=this.store.getGroupInfo();e&&(this.profsName(e.getProfsName()),this.currentImageUrl(e.getImgUrl()+"?"+(new Date).getTime()),this.profsPhotoURL(e.getProfsPhoto()))},this.onStoreChange=this.onStoreChange.bind(this),this.store.sub(this.onStoreChange),this.uploadPhoto=function(e,t){var n=t.currentTarget.files;if(n&&n[0]){var i=n[0],s=new FileReader,r=this;s.onload=function(e){r.onPhotoReady(e)},s.readAsDataURL(i)}},this.uploadPhoto=this.uploadPhoto.bind(this),this.onPhotoReady=function(e){var t=e.target.result,n=this.store.getGroupId(),i=new s(n,t);this.dis.dispatch("saveCoursePhotograph",i)},this.onPhotoReady=this.onPhotoReady.bind(this),this.nextPhoto=function(){},this.nextPhoto=this.nextPhoto.bind(this)},template:t}}),define("text!file-dropper/template.html",[],function(){return'<link rel="stylesheet" href="./styles/components/right-panel/file-dropper.css?v=1.0">\n\n\n      <form id="file-dropper-form"\n              data-bind="visible:isVisible()">\n              <div id="upload-button-holder">\n                  <label for="upload-button"\n                         title="Upload File"\n                         data-toggle="tooltip">\n                    <span class="glyphicon glyphicon-open"\n                          id="upload-button-image"></span>\n                  </label>\n                  <input id="upload-button"\n                         type="file"\n                         data-bind="event: { change : uploadFile}"/>\n              </div>\n      </form>\n\n\n      <span id="file-upload-progress-holder"\n            data-bind="visible:uploadInProgress()">\n      <span id="file-upload-progress-percentage"\n            data-bind="text:percentageComplete"></span>\n            <div id="file-upload-progress-bar"></div>\n      </span>\n      <div id="shared-files-holder"\n           class="show-vert-scroll"\n           data-bind="visible:isVisible()">\n           <div id="no-files-shared-message"\n                class="disable-select"\n                data-bind="visible:files().length <= 0">\n              no files shared.\n           </div>\n          <ul id="file-list"\n              class="show-vert-scroll"\n              data-bind="foreach: files">\n              <li>\n                <div class ="shared-files-holder "\n                     data-bind="css:{\'opened-file\' : user_opened(), \'unopened-file\' : !user_opened()},\n                                click:$parent.downloadFile">\n\n                  <div class="file-name-holder shared-files-text disable-select"\n                       data-bind="text:name">\n                  </div>\n                  <span class="trashbin glyphicon glyphicon-trash"\n                        data-toggle="tooltip"\n                        title="Delete"\n                        data-bind="click:$parent.deleteFile">\n                  </span>\n                </div>\n\n              </li>\n          </ul>\n        </div>\n'}),define("file-dropper/FileSharerRemoteService",["ActiveRemoteService","format-converter"],function(e,t){return function(){Object.setPrototypeOf(this,new e),this.sock=null,this._callbacks={},this.setMicroServer("files"),this.initSocket=function(){this.setSock()},this.registerFileUploadCallback=function(e){this.sock.on("fileUpload",e)},this.registerFileDeleteCallback=function(e){this.sock.on("fileDelete",e)},this.registerUploadProgressCallback=function(e){this._callbacks.uploadProgressCallback=e},this.getFileUploadCallback=function(){let e=this.sock._callbacks.$fileUpload;if(e)return e[0];throw new Exception("no callback for that event is registered.")},this.setFileAsOpened=function(e,t,n){var i=this.getServerURL()+"/"+t+"/seen/"+e;$.ajax({url:i,type:"POST",beforeSend:this.setAuthorizationHeader,success:n,error:function(e,t,n){console.log(n)}})},this.loadFiles=function(e,t){var n=this;$.ajax({url:this.getServerURL()+"/"+e+"/files",type:"GET",cache:!0,beforeSend:this.setAuthorizationHeader,success:function(e){for(var i=JSON.parse(e),s=0;s<i.length;s++)i[s].url=n.getServerURL()+"/"+i[s].url;t(i)},error:function(e,t,n){console.log(n)}})},this.deleteFile=function(e,t,n){var i=this.getServerURL()+"/"+t+"/"+e;$.ajax({url:i,type:"DELETE",beforeSend:this.setAuthorizationHeader,success:function(e){n()},error:function(e,t,n){console.log(e.responseText),console.log(n)}})},this.uploadFile=function(e,n,i,s,r){var o=e.replace(/^data:(.*);base64,/,""),a=t.base64ToBlob(o),c=new FormData;c.append("fileName",n),c.append("friendId",i),c.append("file",a);var d=this;$.ajax({url:this.getServerURL()+"/uploadFile",type:"POST",contentType:!1,processData:!1,data:c,beforeSend:this.setAuthorizationHeader,xhr:function(){var e=new window.XMLHttpRequest;return e.upload.addEventListener("progress",d._callbacks.uploadProgressCallback,!1),e},success:function(e){var t=JSON.parse(e);t.url=d.getServerURL()+"/"+t.url,s(t)},error:function(e,t,n){r(e.responseText)}})},this.uploadFile=this.uploadFile.bind(this)}}),
/**
 * @license Proprietary - Please do not steal our hard work.
 * @Author: Christopher H. Kerley
 * @Last modified time: 2019-08-24
 * @Copyright: Palolo Education Inc. 2020
 */
define("right-panel/file-dropper/Component",["jquery","ko","text!file-dropper/template.html","file-dropper/FileSharerRemoteService","dispatcher/Dispatcher","people-store/PeopleStore","people-models/NullPerson"],function(e,t,n,i,s,r,o){return{viewModel:function SharedFilesViewModel(n,o){this._remoteService=new i,this.dis=new s,this.store=r.getInstance(),this.files=t.observableArray([]),this.isVisible=t.observable(!1),this.uploadInProgress=t.observable(!1),this.percentageComplete=t.observable("0"),this.selectedClassmateId=-1,this._fileToBeUploaded=null,this.FILE_SIZE_LIMIT=25e6,this.formatURL=function(e){e.url=this._remoteService.getServerURL()+"/"+e.url,e.senderId==this.selectedClassmateId&&this.onSuccessfulUpload(e)},this.formatURL=this.formatURL.bind(this),this.friendDeleteFile=function(e){e.senderId==this.selectedClassmateId&&this.removeFileFromView(e.name)},this.friendDeleteFile=this.friendDeleteFile.bind(this),this.onAuth=function(e){"authenticated"==e.state?(this._remoteService.initSocket(),this._remoteService.registerFileUploadCallback(this.formatURL),this._remoteService.registerFileDeleteCallback(this.friendDeleteFile),this._remoteService.registerUploadProgressCallback(this.uploadProgressCallback)):this.isVisible(!1)},this.onAuth=this.onAuth.bind(this),this.dis.reg("authState",this.onAuth),this.onFilesDownloaded=function(e){this.files([]);for(var n=0;n<e.length;n++)e[n].user_opened=t.observable(e[n].user_opened),this.files.push(e[n])},this.onFilesDownloaded=this.onFilesDownloaded.bind(this),this.showFileAsSeen=function(e){var t=this;return function(){for(var n=0;n<t.files().length;n++)if(t.files()[n].name==e){t.files()[n].user_opened(!0);break}}},this.showFileAsSeen=this.showFileAsSeen.bind(this),this.onStoreChange=function(){var e=this.store.getFocusedPerson();"NullPerson"==e.getConstructorName()?this.isVisible(!1):(this.selectedClassmateId=e.getId(),this._remoteService.loadFiles(this.selectedClassmateId,this.onFilesDownloaded),this.isVisible(!0))},this.onStoreChange=this.onStoreChange.bind(this),this.store.sub(this.onStoreChange),this.downloadFile=function(e,t,n){if("test"!=n&&window.open(e.url,"_blank"),!e.user_opened()){var i=e.name;this._remoteService.setFileAsOpened(e.name,this.selectedClassmateId,this.showFileAsSeen(i))}},this.downloadFile=this.downloadFile.bind(this),this.uploadFile=function(t,n,i){if(this.uploadInProgress())alert("Only one file can be uploaded at a time."),e("#file-dropper-upload-btn").val("");else if(i&&i.callback(),n.target.files&&n.target.files[0]){var s=new FileReader;if(this._fileToBeUploaded=n.target.files[0],this._fileToBeUploaded.size>this.FILE_SIZE_LIMIT)return void alert("Files greater than 10mb cant be uploaded at the moment.");var r=this;s.onload=function(t){r.clearFileChooserInput(n.target),r.onFileLoadedInBrowser(t),e("#file-dropper-upload-btn").val("")},s.readAsDataURL(this._fileToBeUploaded)}},this.uploadFile=this.uploadFile.bind(this),this.clearFileChooserInput=function(t){var n=e(t);n.wrap("<form>").closest("form").get(0).reset(),n.unwrap()},this.clearFileChooserInput=this.clearFileChooserInput.bind(this),this.uploadProgressCallback=function(t){this.uploadInProgress(!0);var n=t.loaded/t.total*100,i=Math.round(n)+"%";this.percentageComplete(i),e("#file-upload-progress-bar").css("width",i)},this.uploadProgressCallback=this.uploadProgressCallback.bind(this),this.onFileLoadedInBrowser=function(e){for(var t=0;t<this.files().length;t++)if(this.files()[t].name==this._fileToBeUploaded.name)return void alert("A file already exists with that name, please choose another name.");this._remoteService.uploadFile(e.target.result,this._fileToBeUploaded.name,this.selectedClassmateId,this.onSuccessfulUpload,this.onFailedUpload)},this.onFileLoadedInBrowser=this.onFileLoadedInBrowser.bind(this),this.onFailedUpload=function(e){this.uploadInProgress(!1),alert(e)},this.onFailedUpload=this.onFailedUpload.bind(this),this.onSuccessfulUpload=function(e){if(!e.name||void 0===e.user_opened||!e.url)throw new Error("invalid file response! Are you sure you did JSON.parse?");e.user_opened=t.observable(e.user_opened),this.files.unshift(e),this.uploadInProgress(!1)},this.onSuccessfulUpload=this.onSuccessfulUpload.bind(this),this.deleteFile=function(e,t){t&&t.stopPropagation();var n=this;this._remoteService.deleteFile(e.name,this.selectedClassmateId,function(){n.removeFileFromView(e.name)})},this.deleteFile=this.deleteFile.bind(this),this.removeFileFromView=function(e){for(var t=0;t<this.files().length;t++)if(this.files()[t].name==e){this.files.splice(t,1);break}},this.removeFileFromView=this.removeFileFromView.bind(this)},template:n}}),define("text!right-panel/person-info/template.html",[],function(){return'\n<link rel="stylesheet"\n      href="./styles/components/right-panel/person-info.css?v=1.2">\n\n\n<div id="person-info-holder" data-bind="visible:isVisible()">\n        \x3c!-- ko if: selectedClassmate() != null --\x3e\n      <div id="large-user-photo-holder">\n\n          <button class=\'book-tutor-button\'\n                  data-bind=\'click:buyHours, visible:isTutor()\'>\n            Pro Tutor\n          </button>\n\n\n            <img id="person-info-photo"\n                 class="disable-select"\n                 src="#"\n                 data-bind="visible:isPhotoVisible(),\n                            attr:{src:selectedClassmate().getLargePhotoURL()}">\n            </img>\n\n            \x3c!-- Video room button --\x3e\n            <div id=\'video-button-panel\'>\n              <span id=\'call-button\'\n                    class=\'glyphicon glyphicon-facetime-video\'\n                    data-bind=\'click:connectToRoom, visible:isCallButtonVisible()\'\n                    title="Live video call"\n                    data-toggle="tooltip">\n              </span>\n              <span data-bind="visible:isCallButtonLoaderVisible()"\n                    class=\'nano-spinner\'>\n              </span>\n            </div>\n      </div>\n\n\n      <div id="person-info-name"\n           class="disable-select"\n           data-bind="text:selectedClassmate().getFirst()">\n      </div>\n\n      <div class="person-info-row-holder">\n\n        <i class="glyphicon glyphicon-education person-info-row-icon"></i>\n        <span class="person-info-row"\n              data-bind="text:selectedClassmate().getEducationLevel()">\n        </span>\n\n\n      </div>\n  \x3c!-- /ko --\x3e\n\n\n      <current-courses></current-courses>\n      <div  data-bind="visible:isAddPalVisible()"\n            class="right-panel-add-pal-holder">\n        <button class="add-pal add-pal-btn right-panel-add-pal"\n                data-bind="click:addPal">\n                add friend\n        </button>\n      </div>\n\n</div>\n'}),define("compatability",[],function(){var e=function(){};return e.isVideoCallingSupported=function(e,t){require("twilio-video").isSupported?e():t()},e}),define("right-panel/person-info/Component",["jquery","ko","text!right-panel/person-info/template.html","dispatcher/Dispatcher","people-models/NullPerson","people-store/PeopleStore","compatability"],function(e,t,n,i,s,r,o){return{viewModel:function(){this.dis=new i,this.store=r.getInstance(),this.isVisible=t.observable(!1),this.selectedClassmate=t.observable(null),this.isPhotoVisible=t.observable(!0),this.isExperimentalGroup=!1,this.isAddPalVisible=t.observable(!1),this.isTutor=t.observable(!1),this.isCallButtonVisible=t.observable(!0),this.isCallButtonLoaderVisible=t.observable(!1),this.onStore=function(){var e=this.store.getFocusedPerson();e.isReal()?(this.selectedClassmate(e),this.isVisible(!0),this.isAddPalVisible(e.isAddable()),this.isTutor("tutor"==e.getRole())):this.isVisible(!1)}.bind(this),this.store.sub(this.onStore),this.addPal=function(){var e=this.selectedClassmate();e.isAddable()&&this.dis.dispatch("addPal",e)}.bind(this),this.connectToRoom=function(){o.isVideoCallingSupported(this.onCallingSupported,this.onNoCallingSupported)}.bind(this),this.onCallingSupported=function(){var e=this.store.getFocusedPerson().getId();this.isCallButtonVisible(!1),this.isCallButtonLoaderVisible(!0);var t=this;setTimeout(function(){t.isCallButtonVisible(!0),t.isCallButtonLoaderVisible(!1)},1e3),this.dis.dispatch("getRoomToken",e)}.bind(this),this.onNoCallingSupported=function(){alert("Your browser does not support video calling here. \nPlease use the latest version of one of the following browsers:\n - Google Chrome\n - Firefox\n - Safari\n - Chromium Edge")}.bind(this),this.buyHours=function(){var e=this.store.getFocusedPerson();this.dis.dispatch("openTutoringPlans",e)}},template:n}}),define("text!video-chat/template.html",[],function(){return"<link rel=\"stylesheet\"\n      href=\"./styles/components/video-chat/style.css?v=1.4\">\n</link>\n    <div id=\"video-chat-loader\"\n         class=\"loader\"\n         data-bind=\"visible:isSpinnerVisible()\">\n    </div>\n\n<div id='caller-hungup-message'\n     data-bind='visible:isPalHungupVisible()'>\n     They hungup.\n</div>\n\n\n<div id='video-chat-holder'\n     data-bind=\"visible:isVisible()\">\n\n  <div id='video-chat-control-center'>\n    \x3c!-- <button style=\"position:absolute; z-index:10;\" data-bind='click:download'>DOWNLOAD RECORDING</button> --\x3e\n\n    <span id='control-center-resizer' class='resize-window-button'>\n    </span>\n    <span id='hangup-button'\n            data-bind=\"click:disconnect\">\n            x\n    </span>\n    <div id='camera-video-holder'>\n      <span id='camera-preview'>\n      </span>\n    </div>\n    <div id='video-chat-buttons'>\n\n      <div class=\"video-chat-button\"\n           data-bind='click:shareScreen'>\n          <div class=\"video-chat-screen-share-icon\">\n            <span id='sharescreen-button-arrow'\n                  class='glyphicon glyphicon-arrow-up'>\n            </span>\n          </div>\n          <div class=\"video-chat-button-text\">Share Screen</div>\n      </div>\n\n\n      <div id='mic-button' class=\"video-chat-button\" data-bind='click:toggleMicrophone'>\n          <div class=\"video-chat-mute-icon\">\n               <i id='mute-icon' data-bind='visible:!isSharingMicrophone()' class=\"video-chat-icon  fa fa-microphone-slash\"></i>\n               <i id='mute-icon' data-bind='visible:isSharingMicrophone()' class=\"video-chat-icon fa fa-microphone\"></i>\n          </div>\n          <div data-bind=\"visible:isSharingMicrophone()\"class=\"video-chat-button-text\">Mute</div>\n          <div data-bind=\"visible:!isSharingMicrophone()\"class=\"video-chat-button-text\">Unmute</div>\n      </div>\n\n\n      <div class=\"video-chat-button\"\n           data-bind='click:shareVideo'>\n          <div class=\"video-chat-facetime-icon\">\n            <span class='video-chat-icon glyphicon glyphicon-facetime-video'>\n            </span>\n          </div>\n          <div class=\"video-chat-button-text\">Start Video</div>\n      </div>\n\n      <div id='session-timer-button'\n           class=\"video-chat-button\"\n           data-bind='click:openSessionTracker'>\n          <div class=\"video-chat-time-icon\">\n            <span\n                  class='video-chat-icon glyphicon glyphicon-time'>\n            </span>\n          </div>\n          <div class=\"video-chat-button-text\">Session Timer</div>\n      </div>\n\n    </div>\n      <session-tracker></session-tracker>\n\n    <div class='video-chat-message'\n         data-bind='visible:showCallingRecipient()'>\n        Calling\n        <span data-bind='text:focusedPersonsName()'></span>...\n    </div>\n\n\n\n    <div class='video-chat-message'\n        data-bind='visible:participants() < 1 && !showWaitingForPalToJoin() && isPalOnline()'>\n      <div> No one in this room yet.</div>\n      <button id='invite-pal-button'\n              data-bind='click:invitePal'>\n        Invite <span data-bind=\"text:focusedPersonsName()\"></span>\n      </button>\n    </div>\n\n    <div class='video-chat-message'\n        data-bind='visible:!isPalOnline() && participants() < 1'>\n         <span>\n            <span data-bind=\"text:focusedPersonsName()\"></span> is offline.\n         </span>\n    </div>\n\n    <div class='video-chat-message'\n        data-bind='visible:showWaitingForPalToJoin()'>\n        Waiting for <span data-bind=\"text:focusedPersonsName()\"></span> to join..\n    </div>\n\n    <div class='video-chat-message'\n        data-bind='visible:participants() > 0 && isParticipantsCameraOn() == false'>\n      <div>\n        <span data-bind=\"text:participantsName()\"></span> is in this room.\n      </div>\n    </div>\n\n    <div  class='mic-state-message'\n          data-bind='visible:!isParticipantMicrophoneOn() && participants() > 0'>\n      Their microphone is off.\n    </div>\n\n    <div  class='mic-state-message'\n          data-bind='visible:isParticipantMicrophoneOn() && participants() > 0'>\n      Their microphone is on.\n    </div>\n\n\n\n  </div>\n\n  <div id=\"remote-media-holder\">\n    \x3c!-- all the media tracks get appended here. --\x3e\n  </div>\n\n\n\x3c!-- <span id='effect-credit' >Sound effects obtained from https://www.zapsplat.com</span> --\x3e\n  </div>\n\n\n</div>\n"}),define("video-chat/VideoRemoteService",["dispatcher/Dispatcher","ActiveRemoteService","people-models/Person"],function(e,t,n){return function(){Object.setPrototypeOf(this,new t),this.dis=new e,this.setMicroServer("live"),this.onLeaveRoom=function(e){this.sock.emit("leaveRoom",e)}.bind(this),this.leaveRoomId=this.dis.reg("leaveRoom",this.onLeaveRoom),this.emitRoomInviteError=function(e){this.sock.emit("roomInviteError",e)}.bind(this),this.inviteErrId=this.dis.reg("roomInviteError",this.emitRoomInviteError),this.onRingRecipient=function(e){this.sock.emit("invitePalToRoom",e)}.bind(this),this.ringRecipId=this.dis.reg("invitePalToRoom",this.onRingRecipient),this.onAuth=function(e){"authenticated"!=e.state||this.sock||(this.setSock(),this.sock.on("roomInvite",this.onRoomInvite),this.sock.on("roomInviteError",this.onRoomInviteError),this.sock.on("palLeftRoom",this.onPalLeftRoom))}.bind(this),this.dis.reg("authState",this.onAuth),this.onPalLeftRoom=function(e){this.dis.dispatch("palLeftRoom",e)}.bind(this),this.onRoomInviteError=function(e){this.dis.dispatch("inboundRoomInviteError",e)}.bind(this),this.onRoomInvite=function(e){var t=this.getServerURL(),i=new n(e,t);this.dis.dispatch("roomInvite",i)}.bind(this),this.onDownloadSessionRecording=function(){var e=this.getServerURL()+"/downloadSessionRecording";$.ajax({url:e,type:"get",beforeSend:this.setAuthorizationHeader,success:function(e){console.log(e),window.location=e},error:this.onError})}.bind(this),this.dis.reg("downloadSessionRecording",this.onDownloadSessionRecording),this.getRoomToken=function(e){var t=this.getServerURL()+"/getRoomToken?palId="+e;$.ajax({url:t,type:"get",beforeSend:this.setAuthorizationHeader,success:this.onTokenReceived,error:this.onError})}.bind(this),this.dis.reg("getRoomToken",this.getRoomToken),this.dis.reg("joinRoom",this.getRoomToken),this.onTokenReceived=function(e){this.dis.dispatch("roomToken",e)}.bind(this),this.onError=function(e){console.log(e),this.dis.dispatch("videoChatDown")}.bind(this)}}),define("video-chat/WebRTCDevices",["DetectRTC"],function(e){var t,n=function(){this._detect=e,this.callbacks=[],this.reg=function(e,t){if(!e||"string"!=typeof e)throw new Error("name must be a string.");if(!t||"function"!=typeof t)throw new Error("callback must be a function.");this.callbacks.push({name:e,callback:t})},this.getCallbackFor=function(e){for(var t=this.callbacks,n=0;n<length;n++)if(e==t[n].name)return t[n].callback},this.onLoaded=function(){for(var e=0;e<this.callbacks.length;e++){var t=this.callbacks[e],n=this.getCapabilties();t.callback(n)}}.bind(this),this._detect.load(this.onLoaded),this.getCapabilties=function(){return this._detect.isWebRTCSupported?{hasWebcam:this.isWebcamAvailable(),hasMicrophone:this.isMicrophoneAvailable()}:{hasWebcam:!1,hasMicrophone:!1}},this.isWebcamAvailable=function(){var e=this._detect.isWebsiteHasWebcamPermissions,t=this._detect.hasWebcam;return e&&t},this.isMicrophoneAvailable=function(){var e=this._detect.isWebsiteHasMicrophonePermissions,t=this._detect.hasMicrophone;return e&&t}};return{getInstance:function(){return t||(t=new n),t},getNew:function(){return new n}}}),define("window-utilities",[],function(){var e=function(){};return e.toggleFullscreen=function(e){document.fullscreenElement?document.exitFullscreen():e.requestFullscreen().catch(function(e){alert("Error attempting to enable full-screen mode: "+e.message+" "+e.name)})},e.attachResizer=function(e,t,n){if(!e||!t)throw new Error("elemen and resizer must be arguments.");var i=function(t){t.preventDefault();var i=e.offsetWidth/2,s=e.offsetLeft-i,r=e.offsetTop,o=t.clientX-s,a=t.clientY-r;n?(n["min-width"]<o&&(e.style.width=o+"px"),n["min-height"]<a&&(e.style.height=a+"px")):(e.style.width=o+"px",e.style.height=a+"px")};t.addEventListener("mousedown",function(e){e.stopPropagation(),document.addEventListener("mousemove",i)}),document.addEventListener("mouseup",function(){document.removeEventListener("mousemove",i)})},e.makeDragable=function(e){!function dragElement(e){var t=0,n=0,i=0,s=0;e?document.getElementById(e.id+"header")?document.getElementById(e.id+"header").onmousedown=dragMouseDown:(e.onmousedown=dragMouseDown,e.ontouchstart=dragMouseDown):console.log("element does not exist!");function dragMouseDown(e){(e=e||window.event).preventDefault(),i=e.clientX,s=e.clientY,document.onmouseup=closeDragElement,document.ontouchend=closeDragElement,document.onmousemove=elementDrag,document.ontouchmove=elementDrag}function elementDrag(r){(r=r||window.event).preventDefault(),t=i-r.clientX,n=s-r.clientY,i=r.clientX,s=r.clientY,e.style.top=e.offsetTop-n+"px",e.style.left=e.offsetLeft-t+"px"}function closeDragElement(){document.onmouseup=null,document.ontouchend=null,document.onmousemove=null,document.ontouchmove=null}}(e)},e}),define("video-chat/VideoStore",["dispatcher/Dispatcher","abstract-interfaces/Store","video-chat/VideoRemoteService","video-chat/WebRTCDevices","window-utilities","people-models/Person"],function(e,t,n,i,s,r){var o=null,a=function(){new n,this.twilio=require("twilio-video"),Object.setPrototypeOf(this,new t),this.dis=new e,this.focusedPerson=null,this.isRoomVisible=!1,this.isSpinnerOn=!1,this.currentParticipant=null,this.participantCount=0,this.room=null,this.videoChatDown=!1,this.roomInviter=null,this.receivingRoomInvite=!1,this.RTCDevices=i.getInstance(),this.capabilities=null,this.sharingScreen=!1,this.sharingMicrophone=!0,this.participantCameraOn=!1,this.participantMicrophoneOn=!1,this.isTutor=!1,this.palHungupVisible=!1,this.isParticipantMicrophoneOn=function(){return this.participantMicrophoneOn}.bind(this),this.getFocusedPersonsId=function(){return this.focusedPerson?this.focusedPerson.getId():null},this.onPalLeftRoom=function(e){this.roomInviter&&this.roomInviter.getId()==e&&(this.roomInviter=null,this.receivingRoomInvite=!1,this.showPalHungup(),this.pub())}.bind(this),this.palLeftId=this.dis.reg("palLeftRoom",this.onPalLeftRoom),this.showPalHungup=function(){this.palHungupVisible=!0;var e=this;setTimeout(function(){e.palHungupVisible=!1,e.pub()},2500)}.bind(this),this.isPalHungupVisible=function(){return this.palHungupVisible},this.onInboundRoomInviteErr=function(e){this.focusedPerson&&this.focusedPerson.getId()==e.id&&(this.waitingForPalToJoin=!1,alert(e.err),this.pub())}.bind(this),this.dis.reg("inboundRoomInviteError",this.onInboundRoomInviteErr),this.onProfile=function(e){"tutor"==e.role?this.isTutor=!0:this.isTutor=!1,this.pub()}.bind(this),this.dis.reg("profileUpdate",this.onProfile),this.isCurrentUserTutor=function(){return this.isTutor},this.onInvitePalToRoom=function(){this.waitingForPalToJoin=!0,this.pub()}.bind(this),this.dis.reg("invitePalToRoom",this.onInvitePalToRoom),this.isWaitingForPalToJoin=function(){return this.waitingForPalToJoin}.bind(this),this.onShareScreen=function(){if(!this.getRoom())throw new Error("You must be in a room to share your screen.");navigator.mediaDevices.getDisplayMedia().then(this.onScreenStream).catch(function(e){alert(e.message)})}.bind(this),this.dis.reg("shareScreen",this.onShareScreen),this.onScreenStream=function(e,t){var n=null;t||(n=new(0,this.twilio.LocalVideoTrack)(e.getTracks()[0]));e.getVideoTracks()[0].onended=this.stopScreenShareTrack,this.getRoom().localParticipant.publishTrack(n),this.sharingScreen=!0,this.pub()}.bind(this),this.isSharingScreen=function(){return this.sharingScreen},this.getRoom=function(){return this.room},this.onJoinRoom=function(){this.isSpinnerOn=!0,this.pub()}.bind(this),this.dis.reg("joinRoom",this.onJoinRoom),this.isReceivingRoomInvite=function(){return this.receivingRoomInvite},this.onRoomInvite=function(e){if(this.twilio&&this.twilio.isSupported)this.roomInviter=e,this.receivingRoomInvite=!0,this.pub();else{this.dis.dispatch("roomInviteError",{err:"This persons device does not support video calling.",id:e.getId()});var t=e.getFirst()+" is trying to call you but your browser does not support video calling.\n";t+="Please upgrade your browser to its latest version.",alert(t)}}.bind(this),this.onRoomInviteId=this.dis.reg("roomInvite",this.onRoomInvite),this.getRoomInviter=function(){return this.roomInviter},this.wasInvitedToRoom=function(){return null!=this.roomInviter},this.onVideoChatDown=function(){this.videoChatDown=!0,this.pub()}.bind(this),this.onVideoDownId=this.dis.reg("videoChatDown",this.onVideoChatDown),this.isVideoChatDown=function(){return this.videoChatDown},this.onFocusPerson=function(e){this.room||(this.focusedPerson=e,this.pub())}.bind(this),this.FPersonId=this.dis.reg("focusPerson",this.onFocusPerson),this.onUpdateFocusPerson=function(e){this.focusedPerson=e,0==this.focusedPerson.isPresent()&&(this.waitingForPalToJoin=!1),this.pub()}.bind(this),this.updateFPersonId=this.dis.reg("updateFocusPerson",this.onUpdateFocusPerson),this.isFocusedPersonOnline=function(){return this.focusedPerson&&this.focusedPerson.isPresent()},this.getFocusedPersonsName=function(){if(this.focusedPerson)return this.focusedPerson.getFirst()},this.hasPalId=function(){return null!=this.focusedPerson},this.getPalId=function(){return this.focusedPerson.getId()},this.showSpinner=function(){return this.isSpinnerOn},this.isRoomWindowOpen=function(){return this.isRoomVisible&&(this.hasPalId()||this.wasInvitedToRoom())},this.onGettingToken=function(){this.isSpinnerOn=!0,this.pub()}.bind(this),this.dis.reg("getRoomToken",this.onGettingToken),this.onDevicesLoaded=function(e){this.capabilities=e}.bind(this),this.RTCDevices.reg("deviceCheck",this.onDevicesLoaded),this.getCapabilities=function(){return this.capabilities},this.isVideoAvailable=function(){if(!this.capabilities)throw new Error("Devices have not had a chance to load yet.");return this.capabilities.hasWebcam},this.isMicrophoneAvailable=function(){if(!this.capabilities)throw new Error("Devices have not had a chance to load yet.");return this.capabilities.hasMicrophone},this.onRoomToken=function(e){this.isRoomVisible=!0,this.receivingRoomInvite=!1,this.waitingForPalToJoin=!1;var t=e.token,n={name:e.room,audio:!1,video:!1};this.twilio.connect(t,n).then(this.onRoomConnected,this.onRoomError)}.bind(this),this.roomTokenId=this.dis.reg("roomToken",this.onRoomToken),this.onShareVideo=function(){var e=this,t=document.getElementById("camera-preview");if(t.childElementCount<1){var n=$('<button id="stop-video-button">stop video</button>');n.on("click",this.stopCameraTrack),t.appendChild(n[0]),this.twilio.createLocalVideoTrack({name:"camera"}).then(function(n){e.room.localParticipant.publishTrack(n),t.appendChild(n.attach()),e.sharingCamera=!0,e.pub()})}else console.log("Already sharing your webcam.")}.bind(this),this.dis.reg("shareVideo",this.onShareVideo),this.getConstraints=function(){return this.isVideoAvailable()&&this.isMicrophoneAvailable()?{audio:!0,video:{width:600}}:this.isVideoAvailable()&&!this.isMicrophoneAvailable()?{audio:!1,video:{width:600}}:!this.isVideoAvailable()&&this.isMicrophoneAvailable()?{audio:!0,video:!1}:void 0},this.onRoomConnected=function(e){if(!this.focusedPerson&&!this.roomInviter)throw new Error("if caller then person must be focused,  if recipient, roomInviter must exist!");this.isSpinnerOn=!1,this.dis.dispatch("videoCallRoomConnected"),this.updateParticipantCount(e),this.showParticipantsAlreadyConnected(e),e.on("participantConnected",this.onParticipantConnected),e.on("participantDisconnected",this.onParticipantDisconnected),e.on("disconnected",this.onDisconnect),this.room=e,this.pub()}.bind(this),this.getParticipantCount=function(){return this.participantCount},this.updateParticipantCount=function(e){e&&(this.participantCount=e.participants.size)}.bind(this),this.isParticipantsCameraOn=function(){return this.participantCameraOn},this.appendToMediaTrackHolder=function(e){var t=document.getElementById("remote-media-holder");if("video"==e.kind)if("camera"==e.name){var n=document.getElementById("camera-video-holder");n.appendChild(e.attach()),n.childNodes[0].id="camera-video",this.participantCameraOn=!0}else this.attachSharedScreen(e,t);else"audio"==e.kind&&(t.appendChild(e.attach()),this.participantMicrophoneOn=!0);this.pub()}.bind(this),this.attachSharedScreen=function(e,t){var n=document.createElement("div"),i=document.createElement("span");i.classList.add("resize-window-button"),s.attachResizer(n,i),n.appendChild(i);var r=document.createElement("button");r.classList.add("toggle-fullscreen-share-button"),r.innerHTML="Toggle Fullscreen";r.onclick=function(e){s.toggleFullscreen(n)},n.appendChild(r),n.classList.add("screen-video-track"),n.appendChild(e.attach()),s.makeDragable(n),t.appendChild(n),this.participantScreenOn=!0}.bind(this),this.isParticipantsScreenShared=function(){return this.participantScreenOn},this.showParticipantsAlreadyConnected=function(e){var t=this;e.participants.forEach(function(e){console.log("Participant "+e.identity+" is connected to the Room"),t.setParticipant(e),t.attachAudioTrack(),e.tracks.forEach(function(e){e.track&&t.appendToMediaTrackHolder(track)}),e.on("trackUnsubscribed",t.onParticipantTrackUnsubscribed),e.on("trackSubscribed",e=>{t.appendToMediaTrackHolder(e)})})}.bind(this),this.onParticipantTrackUnsubscribed=function(e){"camera"==e.name?($("#camera-video-holder").find("video").remove(),this.participantCameraOn=!1):"video"==e.kind?($(".screen-video-track").remove(),this.participantScreenOn=!1):"audio"==e.kind&&(this.participantMicrophoneOn=!1),this.pub()}.bind(this),this.getCurrentParticipant=function(){return this.currentParticipant},this.setParticipant=function(e){if(this.waitingForPalToJoin=!1,this.roomInviter&&this.roomInviter.getId()==e.identity)this.currentParticipant=this.roomInviter;else{if(!this.focusedPerson||this.focusedPerson.getId()!=e.identity)throw new Error("expected participant to be either inviter or focusedPerson.");this.currentParticipant=this.focusedPerson}},this.attachAudioTrack=function(e){var t=this.twilio.LocalAudioTrack,n=this;return navigator.mediaDevices.getUserMedia({audio:!0}).then(function(i){var s=new t(i.getTracks()[0]);n.room.localParticipant.publishTrack(s),n.sharingMicrophone=!0,"function"==typeof e&&e()}).catch(function(e){alert(e.message)})}.bind(this),this.shareMicrophone=function(){if(!this.isSharingMicrophone()){var e=this;this.attachAudioTrack().then(function(){e.pub()})}}.bind(this),this.dis.reg("unmuteMicrophone",this.shareMicrophone),this.onParticipantConnected=function(e){console.log("Participant "+e.identity+" is connected to the Room"),this.attachAudioTrack(),this.updateParticipantCount(this.room),this.setParticipant(e),e.tracks.forEach(e=>{if(e.isSubscribed){var t=e.track;this.appendToMediaTrackHolder(t)}}),e.on("trackSubscribed",e=>{this.appendToMediaTrackHolder(e)}),e.on("trackUnsubscribed",this.onParticipantTrackUnsubscribed),this.pub()}.bind(this),this.onParticipantDisconnected=function(e){console.log("Participant "+e.identity+" has disconnected from the Room"),this.stopMicrophoneTrack(),this.stopCameraTrack(),this.stopScreenShareTrack(),this.currentParticipant=null,this.removeMediaDivs(),this.updateParticipantCount(this.room),this.pub()}.bind(this),this.stopMicrophoneTrack=function(){this.room&&(this.room.localParticipant.tracks.forEach(function(e){"audio"==e.track.kind&&(e.track.stop(),e.unpublish(),console.log("microphone muted"))}),this.sharingMicrophone=!1,this.pub())}.bind(this),this.dis.reg("muteMicrophone",this.stopMicrophoneTrack),this.isSharingMicrophone=function(){return this.sharingMicrophone},this.isSharingCamera=function(){return this.sharingCamera},this.stopCameraTrack=function(){var e=this;this.room&&this.room.localParticipant.tracks.forEach(function(t){"camera"==t.track.name&&(t.track.stop(),t.unpublish(),$("#camera-preview").empty(),e.sharingCamera=!1,e.pub())})}.bind(this),this.dis.reg("stopCamera",this.stopCameraTrack),this.stopScreenShareTrack=function(){var e=this.getRoom(),t=this;e.localParticipant.tracks.forEach(function(e){"camera"!=e.track.name&&"video"==e.track.kind&&(e.track.stop(),e.unpublish(),t.sharingScreen=!1,t.pub())})}.bind(this),this.dis.reg("stopSharingScreen",this.stopScreenShareTrack),this.onDisconnect=function(e){e&&(this.stopMicrophoneTrack(),this.stopScreenShareTrack(),this.stopCameraTrack()),this.removeMediaDivs(),this.room=null,this.roomInviter=null,this.isRoomVisible=!1,this.sharingScreen=!1,this.pub()}.bind(this),this.removeMediaDivs=function(){document.getElementById("remote-media-holder").innerHTML=""}.bind(this),this.disconnect=function(){this.room&&this.room.disconnect()}.bind(this),this.dis.reg("leaveRoom",this.disconnect),window.addEventListener("beforeunload",this.disconnect),this.onRoomError=function(e){console.log(e),/Invalid Access Token/.test(e.message)?alert("Video access has been disabled.  Please contact use at 905-808-8791 and we will fix it quickly."):/Permission denied/.test(e.message)?alert("Please change your browsers permissions\nto allow microphone or webcam access."):/Could not start video source/.test(e.message)?alert("Video could not start\nCheck that your camera is not already in use."):/NotFoundError/.test(e.message)?alert("No webcam or microphone detected\nPlease ensure either your webcam or microphone are enabled."):alert("Video calling is currently not working.\n  Please contact support at 905-808-8791 and we will fix it quickly."),this.receivingRoomInvite=!1,this.isRoomVisible=!1,this.disconnect(),this.pub()}.bind(this)};return{getInstance:function(){return o||(o=new a),o},getNew:function(){return new a}}}),define("video-chat/Component",["ko","text!video-chat/template.html","video-chat/VideoStore","dispatcher/Dispatcher","window-utilities"],function(e,t,n,i,s){return{viewModel:function ViewModel(t,r){this.dis=new i,this.store=n.getInstance(),this.isVisible=e.observable(!1),this.participants=e.observable(0),this.focusedPersonsName=e.observable("name"),this.participantsName=e.observable(""),this.showCallingRecipient=e.observable(!1),this.showWaitingForPalToJoin=e.observable(!1),this.isParticipantsCameraOn=e.observable(!1),this.isSharingMicrophone=e.observable(!1),this.isSharingScreen=e.observable(!1),this.isSharingCamera=e.observable(!1),this.mediaCenterOpenedAtLeastOnce=!1,this.isSpinnerVisible=e.observable(!1),this.isPalOnline=e.observable(!1),this.isPalHungupVisible=e.observable(!1),this.isParticipantMicrophoneOn=e.observable(!1),this.onStore=function(){this.isParticipantMicrophoneOn(this.store.isParticipantMicrophoneOn()),this.isPalHungupVisible(this.store.isPalHungupVisible()),this.isSpinnerVisible(this.store.showSpinner());var e=this.store.isFocusedPersonOnline();if(this.isPalOnline(e),this.store.isVideoChatDown())alert("Sorry, video chat is currently not working.\n please try again later.");else{if(this.isVisible(this.store.isRoomWindowOpen()),this.store.isRoomWindowOpen()&&0==this.mediaCenterOpenedAtLeastOnce){this.mediaCenterOpenedAtLeastOnce=!0;var t=document.getElementById("video-chat-control-center");s.makeDragable(t)}this.isSharingMicrophone(this.store.isSharingMicrophone()),this.isSharingScreen(this.store.isSharingScreen()),this.isSharingCamera(this.store.isSharingCamera()),this.isParticipantsCameraOn(this.store.isParticipantsCameraOn()),this.participants(this.store.getParticipantCount());var n=this.store.getCurrentParticipant();n&&this.participantsName(n.getFirst()+" "+n.getLast()),this.focusedPersonsName(this.store.getFocusedPersonsName()),this.showWaitingForPalToJoin(this.store.isWaitingForPalToJoin())}}.bind(this),this.store.sub(this.onStore),this.download=function(){this.dis.dispatch("downloadSessionRecording")},this.openSessionTracker=function(){var e=this.store.isCurrentUserTutor();this.dis.dispatch("openSessionTracker",e)}.bind(this),this.attachResizers=function(e){var t=document.getElementById("video-chat-control-center"),n=document.getElementById("control-center-resizer");s.attachResizer(t,n,{"min-width":454,"min-height":341})},this.attachResizers(),this.onStopResize=function(e,t){t.stopPropagation()}.bind(this),this.invitePal=function(){var e=this.store.getPalId();this.dis.dispatch("invitePalToRoom",e)}.bind(this),this.isScreenSharingSupported=function(){return!!navigator.mediaDevices.getDisplayMedia},this.shareScreen=function(){this.store.isSharingScreen()||(this.isScreenSharingSupported()?this.dis.dispatch("shareScreen"):alert("Please upgrade your browser to its latest versions to support screen share."))}.bind(this),this.stopScreenShare=function(){this.dis.dispatch("stopSharingScreen")}.bind(this),this.shareVideo=function(){this.dis.dispatch("shareVideo")}.bind(this),this.stopCamera=function(){this.dis.dispatch("stopCamera")}.bind(this),this.toggleMicrophone=function(){this.store.isSharingMicrophone()?this.dis.dispatch("muteMicrophone"):this.dis.dispatch("unmuteMicrophone")}.bind(this),this.disconnect=function(){var e=this.store.getFocusedPersonsId();this.dis.dispatch("leaveRoom",e)}.bind(this),window.onunload=this.disconnect},template:t}}),define("text!video-chat/incoming-call/template.html",[],function(){return"<link rel=\"stylesheet\"\n      href=\"./styles/components/video-chat/incoming-call.css?v=1.1\">\n\n<div class='background-dimmer'\n     data-bind='visible:isVisible()'\n       id='incoming-call-holder'>\n\n       <div id='incoming-call-box'>\n         <img id='caller-photo'\n              data-bind='attr:{src:invitersPhoto()}'>\n         </img>\n         <div id='caller-message'>\n            <span id='inviters-name'\n                  data-bind=\"text:invitersName()\">\n            </span>\n            has invited you to join a room.\n         </div>\n         <button id='call-answer-button'\n                 data-bind='click:join'>\n                 Join With Computer Audio\n          </button>\n       </div>\n</div>\n"}),define("video-chat/incoming-call/Component",["ko","text!video-chat/incoming-call/template.html","video-chat/VideoStore","dispatcher/Dispatcher"],function(e,t,n,i){return{viewModel:function View(){this.dis=new i,this.store=n.getInstance(),this.isVisible=e.observable(!1),this.invitersName=e.observable(""),this.invitersPhoto=e.observable(""),this.audio=new Audio("./assets/audio/cutering.mp3"),this.onStore=function(){var e=this.store.isReceivingRoomInvite();if(this.isVisible(e),e){var t=this.store.getRoomInviter();this.invitersName(t.getFirst()+" "+t.getLast()),this.invitersPhoto(t.getLargePhotoURL()),this.startRinging()}else this.stopRinging()}.bind(this),this.store.sub(this.onStore),this.startRinging=function(){this.audio.loop=!0,this.audio.play()},this.stopRinging=function(){this.audio.pause(),this.audio.currentTime=0},this.join=function(){this.stopRinging();var e=this.store.getRoomInviter();this.dis.dispatch("joinRoom",e.getId())}.bind(this)},template:t}}),define("text!blackboard/template.html",[],function(){return'<link rel="stylesheet" href="./styles/components/blackboard/style.css?v=2.1"></link>\n<div id="blackboard-holder"\n     draggable="false">\n\n  <div id="blackboard-background"\n       class=\'background-dimmer\'\n       data-bind="visible:blackboardOpen(), click:toggleVisibility">\n  </div>\n\n\n  <div id="hideable-area"\n       data-bind="visible:blackboardOpen()">\n\n     <div id="board-trashed-message"\n           data-bind="visible:isTrashedMessageVisible()">\n       Your classmate deleted the board.\n     </div>\n\n\n     <div id="left-tool-bar" class="tool-bar">\n       <button\n               class="top-board-buttons tool-button glyphicon glyphicon glyphicon-trash"\n               data-bind="click:trashCurrentBoard"\n               data-toggle="tooltip"\n               title="Delete board.">\n       </button>\n       <button id="board-undo-button"\n               class="fa fa-undo tool-button top-board-buttons"\n               data-toggle="tooltip"\n               title="Undo delete."\n               data-bind="visible:recentlyTrashedBoards().length > 0, click:undoTrashBoard">\n       </button>\n     </div>\n\n\n    <div id="center-tool-bar"\n         class="tool-bar">\n    <div id=\'blackboard-colors\'>\n      <button id=\'blackboard-blue\'\n              class=\'blackboard-color-picker\'\n              data-bind=\'click:selectBlue\'>\n      </button>\n      <button id=\'blackboard-pink\'\n              class=\'blackboard-color-picker\'\n              data-bind=\'click:selectPink\'>\n      </button>\n      <button id=\'blackboard-yellow\'\n              class=\'blackboard-color-picker\'\n              data-bind=\'click:selectYellow\'>\n      </button>\n      <button id=\'blackboard-green\'\n              class=\'blackboard-color-picker\'\n              data-bind=\'click:selectGreen\'>\n      </button>\n    </div>\n    <button\n            data-bind="click: setPencilTool"\n            class="tool-button glyphicon glyphicon-pencil"\n            data-toggle="tooltip"\n            data-placement="top"\n            title="Pencil" >\n    </button>\n    <button class="tool-button glyphicon glyphicon-erase"\n            data-bind="click:setEraserTool"\n            data-toggle="tooltip"\n            data-placement="top"\n            title="Eraser">\n    </button>\n    </div>\n\n    <div id="right-tool-bar" class="tool-bar">\n      <div id=\'blackboard-sharing-options\'\n           data-bind=\'visible:isEmailOptionsOpen()\'>\n        <input type=\'text\' placeholder=\'Subject\' data-bind=\'textInput:emailBoardTitle\'></input>\n        <textarea id=\'shared-blackboard-message\'\n                  data-bind=\'textInput:emailBoardMessage\'>\n        </textarea>\n        <button id=\'send-blackboards\'\n                class=\'purple-button\'\n                data-bind=\'click:emailBoard\'>\n                <span data-bind=\'!isWaitingForEmail()\'>SEND</span>\n                <span class=\'nano-spinner\' data-bind=\'visible:isWaitingForEmail()\'></span>\n                <span data-bind=\'visible:showEmailCheckmark()\' id=\'okay-message\' class=\'glyphicon glyphicon-ok\'></span>\n        </button>\n      </div>\n      <button\n              id=\'blackboard-email-button\'\n              class="top-board-buttons tool-button glyphicon glyphicon-envelope"\n              data-toggle="tooltip"\n              data-bind=\'click:openEmailWindow\'\n              title="Email board">\n      </button>\n      <button\n              id=\'blackboard-fullscreen-button\'\n              class="top-board-buttons tool-button glyphicon glyphicon-fullscreen"\n              data-toggle="tooltip"\n              title="Toggle fullscreen">\n      </button>\n\n    </div>\n\n\n\n    \x3c!-- spinner --\x3e\n    <div  class="screen-center-outer">\n     <div class="screen-center-inner">\n        <div id="blackboard-loader"\n             class="loader"\n             data-bind="visible:spinnerVisible()"></div>\n     </div>\n   </div>\n\n    <span class="blackboard-btn blackboard-prev-btn glyphicon glyphicon-menu-left"\n          data-toggle="tooltip"\n          title="Previous board"\n          data-bind="visible:prevArrowVisible(), click:prevArrowClicked">\n    </span>\n      <canvas id="tool-area"\n               width="1864"\n               height="980">\n      </canvas>\n      <canvas id=\'drawing-area\'\n              width=1864\n              height=980>\n      </canvas>\n      <span class="blackboard-btn blackboard-next-btn glyphicon glyphicon-menu-right"\n            data-toggle="tooltip"\n            title="Next board"\n            data-bind="click:nextArrowClicked">\n      </span>\n  </div>\n\x3c!-- END hideable area --\x3e\n\n\n    \x3c!-- toggle open / close blackboard  --\x3e\n    <div id="blackboard-toggle-button-holder" data-bind="visible:isToggleVisible()">\n      <button id="blackboard-toggle-button"\n              data-toggle="tooltip"\n              title="Chalkboard"\n              data-bind="click:toggleVisibility, visible:!blackboardOpen()"\n              class="blackboardButton glyphicon">\n      </button>\n      <span data-bind="visible:blackboardOpen()"\n            class="blackboard-toggle-button-arrow glyphicon glyphicon-menu-up"></span>\n      <span data-bind="visible:!blackboardOpen()"\n            class="blackboard-toggle-button-arrow glyphicon glyphicon-menu-down"></span>\n    </div>\n\n</div>\n'}),define("blackboard/BlackboardRemoteService",["jquery","ActiveRemoteService"],function(e,t){return function(){Object.setPrototypeOf(this,new t),this._callbacks={},this.lastBoardDataRequest=null,this.setMicroServer("blackboard"),this.initialize=function(){this.setSock(),this.sock.on("io_error",this.onError),this.sock.on("friendAddedNewBoard",this.onFriendAddedNewBoard)}.bind(this),this.onFriendAddedNewBoard=function(e){this.dis.dispatch("friendAddedNewBoard",JSON.parse(e))}.bind(this),this.onError=function(e){alert(e)}.bind(this),this.attachFriendJoinedBlackboardHandler=function(e){this.sock.on("friendJoinedBlackboard",e)}.bind(this),this.emailBlackboard=function(e,t){this.sock.emit("emailBlackboard",e,t)}.bind(this),this.getBoardData=function(e,t){this.sock.emit("getBoard",e,t)}.bind(this),this.saveCurrentBoard=function(e){var t=this._callbacks.onSaveCallback;if("function"!=typeof t)throw new Error("saveCurrentBoard callback missing.");var n=JSON.stringify(e);this.sock.emit("saveBoardState",{json:n},t)}.bind(this),this.registerOnSaveCallback=function(e){if("function"!=typeof e)throw new Error("Save board callback needs to be a function.");this._callbacks.onSaveCallback=e}.bind(this),this.getSharedBoards=function(e){if(isNaN(e)||e<1)throw new Error("friendId must be a positive integer.");if("function"!=typeof this._callbacks.onSharedBoardsReceived)throw new Error("onSharedBoardsReceived callback has not been registered.");this.sock._callbacks.$sharedBoards||this.sock.on("sharedBoards",this._callbacks.onSharedBoardsReceived),this.sock.emit("getSharedBoards",{friendId:e})}.bind(this),this.getNextBoard=function(e,t){this.sock.emit("nextBoard",{boardId:e,friendId:t})}.bind(this),this.registerOnNextBoardRecievedCallback=function(e){this.sock.on("nextBoardReceived",e)}.bind(this),this.joinFriend=function(e,t){if(this.sock){var n={friendId:e,currentTool:t};this.sock.emit("joinRoom",n,function(e){})}},this.getPreviousBoard=function(e,t){this.sock.emit("previousBoard",{boardId:e,friendId:t})}.bind(this),this.registerOnPreviousBoardRecievedCallback=function(e){this.sock.on("previousBoardReceived",e)}.bind(this),this.registerGetSharedBoardsCallback=function(e){this._callbacks.onSharedBoardsReceived=e},this.getAdditionalBoardData=function(e,t){this.sock.emit("getAdditionalBoardData",e,t)}.bind(this),this.emitMyCursorPosition=function(e,t){this.sock.emit("myCursorPosition",e,function(e){"success"==e&&t()})},this.attachOnFriendCursorPositionReceivedHandler=function(e){this.sock.on("friendsCursorPosition",e)}.bind(this),this.emitMyPencilPosition=function(e){this.sock.emit("myPencilPosition",e)}.bind(this),this.attachOnFriendPencilPositionCallback=function(e){this.sock.on("friendPencilPositionUpdate",e)}.bind(this),this.emitMyPencilLine=function(e,t){this.sock.emit("myPencilLine",e,t)}.bind(this),this.attachFriendsPencilLineUpdateHandler=function(e){this.sock.on("friendsPencilLineUpdate",e)}.bind(this),this.emitMyEraserPosition=function(e){this.sock.emit("myEraserPosition",e)},this.attachOnFriendsEraserPositionUpdateCallback=function(e){this.sock.on("onFriendsEraserPositionUpdate",e)}.bind(this),this.emitMyEraserDown=function(e,t){this.sock.emit("myEraserDown",e,t)}.bind(this),this.attachFriendsEraserDownCallback=function(e){this.sock.on("friendsEraserDownUpdate",e)}.bind(this),this.registerOnBoardTrashedCallback=function(e){this.checkType(e),this.sock.on("boardTrashed",e)}.bind(this),this.registerOnFriendTrashedBoard=function(e){this.checkType(e),this.sock.on("boardTrashed",e)},this.trashBoard=function(e,t){var n={friendId:t,boardId:e};this.sock.emit("trashBoard",n),this.sock.emit("relayTrashBoard",n)}.bind(this),this.registerOnTrashBoardUndone=function(e){this.checkType(e),this.sock.on("boardRestored",e)}.bind(this),this.undoTrashBoard=function(e,t){var n={friendId:t,boardId:e};this.sock.emit("restoreBoard",n),this.sock.emit("relayRestoreBoard",n)}.bind(this),this.registerOnFriendRestoredBoard=function(e){this.sock.on("friendsBoardRestored",e)}.bind(this),this.checkType=function(e){if("function"!=typeof e)throw new Error("Callback must be a function")}}}),define("blackboard/canvas/Layer",[],function(){return function(e){this.getDefaultStroke=function(){return"#ffffff"},this.setupCanvas=function(){var e=this.getLayerId();if(this._canvas=document.getElementById(e),!this._canvas)throw new Error("html template is missing canvas with id "+e);if("CANVAS"!=$(this._canvas).prop("tagName"))throw new Error("tag must be a canvas element");this._context=this._canvas.getContext("2d")},this.getContext=function(){return this._context},this.getCanvas=function(){return this._canvas},this.clear=function(){if(!this._canvas)throw new Error("Canvas not set.");var e=this._canvas.width,t=this._canvas.height;this._context.clearRect(0,0,e,t)},this.getLayerId=function(){throw new Error("cannot call abstract function.")},this.normalizedToCanvasCoordinates=function(e){var t=this.getCanvas().width,n=this.getCanvas().height;return{x:e.x*t,y:e.y*n}},this.getCurrentPosition=function(e){var t=$(this._canvas).offset().left,n=$(this._canvas).offset().top,i=$(this._canvas).width(),s=$(this._canvas).height();return{x:(e.clientX-t)/i,y:(e.clientY-n)/s}},this.getHeight=function(){return this._canvas.height},this.setHeight=function(e){e&&(this._canvas.style.height=e+"px")},this.getWidth=function(){return this._canvas.width},this.setWidth=function(e){this._canvas.style.width=e+"px"}}}),define("blackboard/canvas/ToolLayer",["blackboard/canvas/Layer"],function(e){return function(t){Object.setPrototypeOf(this,new e),this._layerId="tool-area",this.getLayerId=function(){return this._layerId},this.setupCanvas.call(this),this.getCurrentPosition=this.getCurrentPosition.bind(this),this._context.font="39px Arial",this._context.fillStyle="#828282",this._context.zIndex="5",this.drawEraserCircle=function(e,t){var n=this.normalizedToCanvasCoordinates(t),i=e*this.getCanvas().width,s=2*Math.PI;this.clear(),this._context.lineWidth="4",this._context.strokeStyle="#dfffff",this._context.beginPath(),this._context.arc(n.x,n.y,i,0,s),this._context.stroke()},this.drawFriendsCursor=function(e){this.drawImage(e,0,"./assets/cursor_friend_small.png")},this.drawFriendLeftMarker=function(e){e*=this._canvas.height,this.clear(),this._context.fillText("<- Friend",20,e)},this.drawFriendRightMarker=function(e){e*=this._canvas.height,this.clear(),this._context.fillText("Friend ->",this._canvas.width-180,e)},this.drawFriendsPencil=function(e){var t={x:e.x0,y:e.y0};this.drawImage(t,-67,"./assets/friends_pencil.png")}.bind(this),this.drawFriendsEraser=function(e){this.drawImage(e,-45,"./assets/eraser_friend.png")},this.drawImage=function(e,t,n){var i=new Image;i.src=n;var s=this.normalizedToCanvasCoordinates(e),r=s.x,o=s.y;this.clear(),this.getContext().drawImage(i,r,o+t)}}}),define("blackboard/canvas/DrawingLayer",["blackboard/canvas/Layer"],function(e){return function(){Object.setPrototypeOf(this,new e),this._layerId="drawing-area",this.getLayerId=function(){return this._layerId},this.setupCanvas.call(this),this.getCurrentPosition=this.getCurrentPosition.bind(this),this.getCanvas().oncontextmenu=function(){return!1},this.getPNG=function(){return document.getElementById(this.getLayerId()).toDataURL("image/png")},this.drawOntoBoard=function(e){this._context.lineWidth="4",this._context.strokeStyle=this.getDefaultStroke();for(var t=e,n=0;n<t.length;n++){var i=t[n];if(!i||!i.isLine)throw new Error("Unrecognized command:"+i);if(i.isLine()){if(!i.isLine())throw new Error("Unrecognized command:"+i);this.drawLine(i)}else this.eraseArea(i)}},this.drawEntireBoard=function(e){this.clear(),this.drawOntoBoard(e)},this.eraseArea=function(e){this._context.beginPath();var t=2*Math.PI,n=this.normalizedToCanvasCoordinates(e),i=e.getRad()*this.getWidth();this._context.arc(n.x,n.y,i,0,t),this._context.fillStyle="black",this._context.fill()},this.drawLine=function(e){var t=e.getColor();this._context.strokeStyle=t;var n=this.getWidth(),i=this.getHeight();this._context.beginPath();var s=e.x0*n,r=e.y0*i;this._context.moveTo(s,r);var o=e.x1*n,a=e.y1*i;this._context.lineTo(o,a),this._context.stroke()}}}),define("blackboard/models/Line",[],function(){var e=function(e){this.boardId=null,this.friendId=null,this.setColor=function(e){this.color=e},this.setColor(e.color),this.getColor=function(){return this.color},this.isLine=function(){return!0},this.isBoardable=function(){return!0},this.getColor=function(){return this.color},this.getBoardId=function(){return this.boardId},this.setBoardId=function(e){this.boardId=e},this.setBoardId(e.board_id),this.isOnBoard=function(e){return this.boardId==e},this.getFriendId=function(){return this.friendId},this.setFriendId=function(e){this.friendId=e},this.setFriendId(e.friend_id),this.isFrom=function(e){return this.friendId==e},this.checkKind=function(e){if("line"!=e)throw new Error("kind was expected to be of type line.")},this.checkKind(e.kind),this.getEndPoint=function(){var e=this;return{getX:function(){return e.getEndX()},getY:function(){return e.getEndY()}}},this.getStartX=function(){return this.x0},this.setStartX=function(e){this.x0=e},this.setStartX(e.x0),this.getStartY=function(){return this.y0},this.setStartY=function(e){this.y0=e},this.setStartY(e.y0),this.getEndX=function(){return this.x1},this.setEndX=function(e){this.x1=e},this.setEndX(e.x1),this.getEndY=function(){return this.y1},this.setEndY=function(e){this.y1=e},this.setEndY(e.y1),this.serialize=function(){return{color:this.color,x0:this.x0,y0:this.y0,x1:this.x1,y1:this.y1,kind:"line",board_id:this.getBoardId(),friend_id:this.getFriendId()}}};return e.WHITE="#ffffff",e.getDefaultColor=function(){return e.WHITE},e.getRaw=function(){return{color:"#ffffff",board_id:6,friend_id:7,x0:2,y0:3,x1:4,y1:5,kind:"line"}},e.getFake=function(){var t=e.getRaw();return new e(t)},e}),define("blackboard/canvas/Canvas",["blackboard/canvas/ToolLayer","blackboard/canvas/DrawingLayer","blackboard/models/Line","window-utilities"],function(e,t,n,i){return function(s){if(!s||"function"!=typeof s.setMyCursorPosition)throw new Error("Canvas must have a board collection injected.");this.viewModel=s,this.toolLayer=new e,this.drawingLayer=new t,this._drawingCanvas=this.drawingLayer.getCanvas(),this.HIDEABLE_AREA_ID="hideable-area",this.mouseDown=!1,this.LEFT_MOUSE_BUTTON=0,this.RIGHT_MOUSE_BUTTON=2,this.initialize=function(){var e=$("#blackboard-fullscreen-button");this._hideableArea=document.getElementById(this.HIDEABLE_AREA_ID),e.on("click",this.makeFullScreen),$(window).on("resize",this.resizeBlackboard),this.initMouseListeners()},this.makeFullScreen=function(){i.toggleFullscreen(this._hideableArea)}.bind(this),this.clear=function(){this.toolLayer.clear()},this.clear=this.clear.bind(this),this.mouseMoveHandler=function(e){var t=this.drawingLayer.getCurrentPosition(e),n=this.viewModel.getMyCurrentTool();if(this.toolLayer.clear(),"cursor"==n)this.viewModel.setMyCursorPosition(t);else if("eraser"==n){var i=this.viewModel.ERASER_RADIUS;this.drawEraserCircle(i,t),0==this.mouseDown?this.viewModel.setMyEraserPosition(t):(this.viewModel.setMyEraserDown(t),this.viewModel.startSaveCountDown())}else"pencil"==n&&(0==this.mouseDown?this.viewModel.setMyPencilPosition(t):this.possiblyDrawLine(t))}.bind(this),this.possiblyDrawLine=function(e){if(!e)throw new Error("currentMousePosition must be an object with a x and y coordinate.");if(this.previousPosition){this.viewModel.startSaveCountDown();var t=this.previousPosition.x,i=this.previousPosition.y,s=e.x,r=e.y,o=new n({kind:"line",x0:t,y0:i,x1:s,y1:r});this.viewModel.setMyPencilLine(o),this.previousPosition=e}else this.previousPosition=e}.bind(this),this.mouseDownHandler=function(e){this.mouseDown=!0,e.button==this.RIGHT_MOUSE_BUTTON&&this.viewModel.setEraserTool()},this.mouseDownHandler=this.mouseDownHandler.bind(this),this.mouseUpHandler=function(e){this.mouseDown=!1,this.previousPosition=null,e.button==this.RIGHT_MOUSE_BUTTON&&this.viewModel.setPencilTool()},this.mouseUpHandler=this.mouseUpHandler.bind(this),this.mouseLeaveHandler=function(e){if(this.mouseDown){var t=this.drawingLayer.getCurrentPosition(e),n=this.viewModel.getMyCurrentTool();"pencil"==n?(this.mouseDown=!1,this.possiblyDrawLine(t)):"eraser"==n&&(this.mouseDown=!1),this.previousPosition=null}},this.mouseLeaveHandler=this.mouseLeaveHandler.bind(this),this.dragStartHandler=function(e){e.preventDefault()},this.dragStartHandler=this.dragStartHandler.bind(this),this.initMouseListeners=function(){this._drawingCanvas.onmousemove=this.mouseMoveHandler,this._drawingCanvas.onmousedown=this.mouseDownHandler,this._drawingCanvas.onmouseup=this.mouseUpHandler,this._drawingCanvas.onmouseleave=this.mouseLeaveHandler,this._drawingCanvas.ondragstart=this.dragStartHandler},this.initMouseListeners=this.initMouseListeners.bind(this),this.setMyToolToPencil=function(){this._drawingCanvas.style.cursor="url('./assets/my_pencil.cur') 0 45,auto"},this.setMyToolToEraser=function(){this._drawingCanvas.style.cursor="url('./assets/eraser_my.cur') 0 45,auto"},this.drawFriendsCursor=function(e){this.toolLayer.drawFriendsCursor(e.position)},this.drawFriendsCursor=this.drawFriendsCursor.bind(this),this.drawFriendsEraser=function(e){this.toolLayer.drawFriendsEraser(e)}.bind(this),this.drawFriendsPencil=function(e){this.toolLayer.drawFriendsPencil(e)}.bind(this),this.drawMyPencilLine=function(e){this.drawLine(e)},this.drawFriendsPencilLine=function(e){this.drawLine(e),this.drawFriendsPencil(e)},this.friendEraseArea=function(e){this.drawFriendsEraser(e),this.eraseArea(e)}.bind(this),this.getPNG=function(){return this.drawingLayer.getPNG()},this.eraseArea=function(e){this.drawingLayer.eraseArea(e)}.bind(this),this.drawEraserCircle=function(e,t){this.toolLayer.drawEraserCircle(e,t)},this.drawFriendLeftMarker=function(e){this.toolLayer.drawFriendLeftMarker(e)},this.drawFriendRightMarker=function(e){this.toolLayer.drawFriendRightMarker(e)},this.resizeBlackboard=function(){var e=$(this._hideableArea).width()/1.777777778;this.drawingLayer.setHeight(e),this.toolLayer.setHeight(e)},this.resizeBlackboard=this.resizeBlackboard.bind(this),this.drawEntireBoard=function(e){this.drawingLayer.drawEntireBoard(e)},this.drawOntoBoard=function(e){this.drawingLayer.drawOntoBoard(e)},this.drawLine=function(e){this.drawingLayer.drawLine(e)}.bind(this)}}),define("blackboard/boards/BlackBoard",[],function(){var e=function(t){if(!t||"object"!=typeof t)throw new Error("Board data must be passed to constructor.");this.getLastModifiedMillis=function(){return new Date(this.lastModified).getTime()},this.setLastModified=function(e){this.lastModified=new Date(e).toISOString()},this.lastModified=null,this.updateLastModified=function(){this.lastModified=new Date(Date.now()).toISOString()}.bind(this),this.getCommandCount=function(){return this.commands.length},this.setBoardId=function(e){if(!e||isNaN(e))throw new Error("board_id missing or not a number.");this.boardId=e},this.setBoardId(t.board_id),this.setBoardURL=function(e){if(!e||"string"!=typeof e)throw new Error("board_url missing or not a string.");this.boardURL=e},this.setBoardURL(t.board_url),this.dirty=!1,this.getCommands=function(){return this.commands.slice(0)},this.setCommands=function(e){Array.isArray(e)?this.commands=e:this.commands=[]},this.setCommands(t.commands),this.append=function(e){if("object"!=typeof e||!e.isBoardable||!e.isBoardable())throw new Error("Expected a Boardable command.");this.commands.push(e),this.setDirty(),this.updateLastModified()},this.getId=function(){return this.boardId},this.isDirty=function(){return this.dirty},this.setDirty=function(){this.dirty=!0},this.getURL=function(){return this.boardURL},this.getLastTimeLoadedMillis=function(){return new Date(this.lastLoaded).getTime()},this.getLastTimeLoadedISO=function(){return this.lastLoaded},this.setLastTimeLoaded=function(e){if("string"!=typeof e||e.length<1)throw new Error("last_loaded must be a iso date string.");this.lastLoaded=e},this.setLastTimeLoaded(t.last_loaded),this.deepCopy=function(){var t={board_url:this.getURL(),last_loaded:this.getLastTimeLoadedISO(),is_dirty:this.isDirty(),board_id:this.getId(),commands:this.getCommands()},n=new e(t);return n.setLastModified(this.getLastModifiedMillis()),n},this.serialize=function(){var e=[];return this.getCommands().forEach(function(t){e.push(t.serialize())}),{board_url:this.getURL(),last_loaded:this.getLastTimeLoadedISO(),is_dirty:this.isDirty(),board_id:this.getId(),commands:e}}};return e.getRaw=function(){return{board_url:"url",last_loaded:new Date(0).toISOString(),is_dirty:!0,board_id:1,commands:[]}},e.getFake=function(){var t=e.getRaw();return new e(t)},e}),define("blackboard/models/Erase",[],function(){var e=function(e){this.x=null,this.y=null,this.r=null,this.isBoardable=function(){return!0},this.isLine=function(){return!1},this.getX=function(){return this.x},this.setX=function(e){this.x=e},this.setX(e.x),this.getY=function(){return this.y},this.setY=function(e){this.y=e},this.setY(e.y),this.getRad=function(){return this.rad},this.setRad=function(e){this.rad=e},this.setRad(e.r),this.serialize=function(){return{x:this.x,y:this.y,r:this.rad}}};return e.getRaw=function(){return{x:.2,y:.3,r:.1}},e.getFake=function(){var t=e.getRaw();return new e(t)},e}),define("blackboard/boards/BlackboardCollection",["blackboard/boards/BlackBoard","blackboard/models/Erase"],function(e,t){var n=function(){this.boards=[],this.index=-1,this.contains=function(e){return null!=this.getBoardById(e.board_id)},this.getLastBoard=function(){if(0==this.boards.length)throw new Error("Cannot get a last board because no boards exist yet.");return this.boards[this.boards.length-1]},this.getBoards=function(){return this.boards.slice(0)},this.getBoardById=function(e){var t=null;return this.boards.forEach(function(n){n.getId()!=e||(t=n)}),t},this.setBoards=function(t){if(!Array.isArray(t))throw new Error("Needs to be an array.");if(t.length<1)throw new Error("Needs to have at least one element.");this.boards=[];for(var n=0;n<t.length;n++){var i=t[n],s=new e(i);this.boards.push(s)}var r=this.getLastViewedBoardIndex();this.index=r}.bind(this),this.getLastViewedBoardIndex=function(){for(var e=0,t=0,n=0;n<this.boards.length;n++){var i=this.boards[n].getLastTimeLoadedMillis();i>e&&(t=n,e=i)}return t},this.appendBoard=function(t){var n=new e(t);this.boards.push(n),1==this.getCount()&&(this.index=0)},this.setIndexToLastBoard=function(){this.index=this.boards.length-1},this.setCurrentBoardById=function(e){for(var t=0;t<this.getCount();t++){if(e==this.boards[t].getId())return void(this.index=t)}throw new Error("That boardId does not exist in the board set.")},this.setCurrentBoardIndex=function(e){if(isNaN(e)||e<0||e>=this.getCount())throw new Error("Invalid index.");this.index=e},this.deleteAll=function(){this.index=null,this.boards=[]},this.appendCommandsToCurrentBoard=function(e){var t=this;e.forEach(function(e){t.boards[t.index].append(e)})},this.getCurrentBoardDeepCopy=function(){return this.boards[this.index].deepCopy()},this.getSerializedCurrentBoard=function(){return this.getCurrentBoardDeepCopy().serialize()},this._getCurrentBoard=function(){var e=this.boards[this.index];if(e)return e;throw new Error("Current board has not been initialized.")},this.pushEraserCallOntoState=function(e){if(this.isEmpty())throw new Error("Can't store erase call because current board does not exist yet.");if(!e.isBoardable||!e.isBoardable())throw new Error("Can only add Boardable objects to a Blackboards state.");var t=this._getCurrentBoard();t.setDirty(),t.append(e)},this.appendLineToCurrentBoard=function(e){var t=this._getCurrentBoard();t.append(e),t.setDirty()},this.appandCommandToAnotherBoard=function(e){this.boards.forEach(function(t){if(t.getId()==e.getBoardId())return t.append(e),void t.updateLastModified()})},this.getCurrentBoardCommandCount=function(){return this._getCurrentBoard().getCommands().length},this.isEmpty=function(){return 0==this.boards.length},this.isNotEmpty=function(){return this.boards.length>0},this.getCount=function(){return this.boards.length},this.getCurrentBoardIndex=function(){return this.index},this.getCurrentBoardCommands=function(){return this._getCurrentBoard().getCommands()},this.getCurrentBoardId=function(){return this._getCurrentBoard().getId()},this.isCurrentBoardDirty=function(){var e=this._getCurrentBoard();return!!e&&e.isDirty()},this.isCurrentBoardDirty=this.isCurrentBoardDirty.bind(this),this.getCurrentBoardURL=function(){return this._getCurrentBoard().getURL()},this.setCurrentBoardCommands=function(e){this._getCurrentBoard().setCommands(e)}};return n.getFake=function(){var t=e.getRaw(),i=e.getRaw();i.board_id=t.board_id+1;var s=[t,i],r=new n;return r.setBoards(s),r},n}),define("blackboard/models/RemoteErase",["blackboard/models/Erase"],function(e){var t=function(t){Object.setPrototypeOf(this,new e(t)),this.setX=function(e){if(e>1||e<0)throw new Error("x must be between 0 and 1");this.x=e},this.setX(t.x),this.setY=function(e){if(e>1||e<0)throw new Error("y must be between 0 and 1");this.y=e},this.setY(t.y),this.setFriendId=function(e){this.friendId=e},this.setFriendId(t.friend_id),this.getFriendId=function(){return this.friendId},this.setBoardId=function(e){this.boardId=e},this.setBoardId(t.board_id),this.getBoardId=function(){return this.boardId},this.isForCurrentBoard=function(e,t){var n=e==this.friendId,i=this.boardId==t;return n&&i},this.serialize=function(){return{x:this.x,y:this.y,r:this.rad,board_id:this.getBoardId(),friend_id:this.getFriendId()}}};return t.getRaw=function(){var t=e.getRaw();return t.board_id=2,t.friend_id=3,t},t.getFake=function(){var e=t.getRaw();return new t(e)},t.create=function(e,n,i){return new t({x:e,y:n,r:i})},t}),define("blackboard/BlackboardStore",["dispatcher/Dispatcher","abstract-interfaces/Store","blackboard/BlackboardRemoteService"],function(e,t,n){new n;var i=null,s=function(){Object.setPrototypeOf(this,new t),this.dis=new e,this.blackboardSharerOpen=!1,this.openBlackboardSharer=function(){this.blackboardSharerOpen=!0,this.pub()}.bind(this),this.dis.reg("openBlackboardSharer",this.openBlackboardSharer),this.closeBlackboardSharer=function(){this.blackboardSharerOpen=!1,this.pub()}.bind(this),this.dis.reg("closeBlackboardSharer",this.closeBlackboardSharer),this.isBlackboardSharerOpen=function(){return this.blackboardSharerOpen}};return{getInstance:function(){return i||(i=new s),i},getNew:function(){return new s}}}),this.selectedClassmateId,define("blackboard/ViewModel",["ko","dispatcher/Dispatcher","text!blackboard/template.html","blackboard/BlackboardRemoteService","blackboard/canvas/Canvas","blackboard/boards/BlackBoard","blackboard/boards/BlackboardCollection","blackboard/models/Line","blackboard/models/Erase","blackboard/models/RemoteErase","blackboard/BlackboardStore"],function(e,t,n,i,s,r,o,a,c,d,u){return{viewModel:function BlackboardViewModel(n,r){this.dis=new t,this.store=u.getInstance(),this.selectedClassmateId=-1,this.isToggleVisible=e.observable(!1),this.spinnerVisible=e.observable(!1),this.prevArrowVisible=e.observable(!1),this.blackboardOpen=e.observable(!1),this.isTrashedMessageVisible=e.observable(!1),this.recentlyTrashedBoards=e.observableArray([]),this.isWaitingForEmail=e.observable(!1),this.showEmailCheckmark=e.observable(!1),this.isEmailOptionsOpen=e.observable(!1),this.remoteService=new i,this.SAVING_DELAY=5e3,this.ERASER_RADIUS=.02,this.boards=new o,this.white="#ffffff",this.blue="#00c4ff",this.green="#00FF2D",this.yellow="#ffd800",this.pink="#FF00DC",this._myCurrentTool="cursor",this.myToolsColor=this.white,this._friendsCurrentTool="cursor",this.setPencilTool=function(){this._myCurrentTool="pencil",this.canvas.setMyToolToPencil()}.bind(this),this.setEraserTool=function(){this._myCurrentTool="eraser",this.canvas.setMyToolToEraser()},this.selectBlue=function(){this.myToolsColor=this.blue,this.setPencilTool()},this.selectPink=function(){this.myToolsColor=this.pink,this.setPencilTool()},this.selectYellow=function(){this.myToolsColor=this.yellow,this.setPencilTool()},this.selectGreen=function(){this.myToolsColor=this.green,this.setPencilTool()},this.getMyCurrentTool=function(){return this._myCurrentTool}.bind(this),this.setBoardCollection=function(e){this.boards=e},this.emailBoard=function(){var e=this.canvas.getPNG(),t={friendId:this.selectedClassmateId,img:e};this.remoteService.emailBlackboard(t,this.onBlackboardEmailed),this.isWaitingForEmail(!0)}.bind(this),this.emailBoardTitle=e.observable(""),this.titleValid=e.observable(!1),this.onEmailBoardTitle=function(e){e.length<2?(this.titleError("needs to be longer."),this.titleValid(!1)):this.titleValid(!0)}.bind(this),this.emailBoardTitle.subscribe(this.onEmailBoardTitle),this.emailBoardMessage=e.observable(""),this.messageValid=e.observable(!1),this.onEmailBoardMessage=function(e){e.length<2?(this.messageError("message must be longer"),this.messageValid(!1)):this.messageValid(!0)}.bind(this),this.onStore=function(){this.isEmailOptionsOpen(this.store.isBlackboardSharerOpen())}.bind(this),this.store.sub(this.onStore),this.openEmailWindow=function(){this.dis.dispatch("openBlackboardSharer")}.bind(this),this.closeEmailWindow=function(){this.dis.dispatch("closeBlackboardSharer")}.bind(this),this.onBlackboardEmailed=function(){this.isWaitingForEmail(!1);var e=this;this.showEmailCheckmark(!0),setTimeout(function(){e.showEmailCheckmark(!1)},1250)}.bind(this),this.toggleVisibility=function(){if(this.blackboardOpen())this.blackboardOpen(!1);else{this.blackboardOpen(!0),this.canvas.resizeBlackboard();var e=this;setTimeout(function(){e.canvas.resizeBlackboard()},50)}}.bind(this),this.hideBlackboard=function(){this.blackboardOpen(!1),this.isToggleVisible(!1)}.bind(this),this.openGroupId=this.dis.reg("showGroupView",this.hideBlackboard),this.groupInfoId=this.dis.reg("groupInfo",this.hideBlackboard),this.dis.reg("openNews",this.hideBlackboard),this.handleFriendChange=function(e){if(e){this.selectedClassmateId=e.getId();var t=this.selectedClassmateId;this.possiblySaveState(),this.canvas.clear&&this.canvas.clear(),this.spinnerVisible(!0),this.remoteService.getSharedBoards(t),this.remoteService.joinFriend(t,this._myCurrentTool),this.recentlyTrashedBoards([]),this.isToggleVisible(!0)}else this.blackboardOpen(!1)}.bind(this),this.classmateCallbackId=this.dis.reg("focusPerson",this.handleFriendChange),this.setMyCursorPosition=function(e){if(0==this.boards.isEmpty()){var t={position:e,boardId:this.getCurrentBoardId(),friendId:this.selectedClassmateId};this.remoteService.emitMyCursorPosition(t,function(){})}}.bind(this),this.canvas=new s(this),this.onFriendsCursorPositionReceived=function(e){this.selectedClassmateId==e.friendId&&e.boardId==this.getCurrentBoardId()?this.canvas.drawFriendsCursor(e):this.selectedClassmateId==e.friendId&&this.drawFriendPositionHintMarker(e)}.bind(this),this.drawFriendPositionHintMarker=function(e){e.boardId<this.getCurrentBoardId()?this.canvas.drawFriendLeftMarker(e.y0):e.boardId>this.getCurrentBoardId()&&this.canvas.drawFriendRightMarker(e.y0)}.bind(this),this.setMyPencilPosition=function(e){if(0==this.boards.isEmpty()){var t={x0:e.x,y0:e.y,boardId:this.getCurrentBoardId(),friendId:this.selectedClassmateId};this.remoteService.emitMyPencilPosition(t)}}.bind(this),this.onFriendPencilPositionReceived=function(e){e.friendId==this.selectedClassmateId&&0==this.boards.isEmpty()&&(e.boardId==this.getCurrentBoardId()?this.canvas.drawFriendsPencil(e):this.drawFriendPositionHintMarker(e))}.bind(this),this.setMyPencilLine=function(e){e.setFriendId(this.selectedClassmateId),e.setBoardId(this.getCurrentBoardId()),e.setColor(this.myToolsColor);var t=this,n=e.serialize();this.remoteService.emitMyPencilLine(n,function(){t.onPencilLineSent(e),t.startSaveCountDown()})},this.onPencilLineSent=function(e){this.boards.appendLineToCurrentBoard(e),this.canvas.drawMyPencilLine(e)}.bind(this),this.setMyEraserPosition=function(e){e.boardId=this.getCurrentBoardId(),e.friendId=this.selectedClassmateId,this.remoteService.emitMyEraserPosition(e)}.bind(this),this.onFriendsEraserPositionReceived=function(e){e.friendId==this.selectedClassmateId&&(e.boardId==this.getCurrentBoardId()?this.canvas.drawFriendsEraser(e.position):this.drawFriendPositionHintMarker(e))}.bind(this),this.setMyEraserDown=function(e){var t=d.create(e.x,e.y,this.ERASER_RADIUS);t.setFriendId(this.selectedClassmateId),t.setBoardId(this.getCurrentBoardId());var n=t.serialize(),i=this;this.remoteService.emitMyEraserDown(n,function(){i.onEraseSent(t)})}.bind(this),this.onEraseSent=function(e){this.boards.pushEraserCallOntoState(e),this.canvas.eraseArea(e),this.startSaveCountDown()}.bind(this),this.onFriendsEraserDown=function(e){console.log("here");var t=new d(e),n=this.selectedClassmateId,i=this.getCurrentBoardId();console.log("erase:"),console.log(t),console.log("friendId:"+n),console.log("boardId:"+i),t.isForCurrentBoard(n,i)&&(this.boards.pushEraserCallOntoState(t),this.canvas.friendEraseArea(t))}.bind(this),this.onFriendPencilLineReceived=function(e){var t=new a(e),n=this.selectedClassmateId,i=this.getCurrentBoardId();if(t.isFrom(n))if(t.isOnBoard(i))this.boards.appendLineToCurrentBoard(t),this.canvas.drawFriendsPencilLine(t);else{this.boards.appandCommandToAnotherBoard(t);var s=t.getEndPoint();this.drawFriendPositionHintMarker(s)}}.bind(this),this.onSharedBoardsReceived=function(e){var t=JSON.parse(e);this.boards.setBoards(t),this.boards.getCurrentBoardIndex()>0?this.prevArrowVisible(!0):this.prevArrowVisible(!1);var n=this.getCurrentBoardId();this.remoteService.getBoardData(n,this.onBoardDataReceived)}.bind(this),this.timeoutReferences=[],this.testMode=!1,this.startSlowServerResponseTimer=function(e){var t=this,n=setTimeout(function(){t.testMode||alert("Problem loading chalkboards, try refreshing the screen.")},5e3);this.timeoutReferences.push(n)}.bind(this),this.getCurrentBoardId=function(){return this.boards.getCurrentBoardId()},this.processIncomingBoardData=function(e){var t=JSON.parse(e),n=t.board_id,i=[];return n==this.getCurrentBoardId()&&t.commands.forEach(function(e){"line"==e.kind?i.push(new a(e)):i.push(new c(e))}),this.spinnerVisible(!1),i}.bind(this),this.onBoardDataReceived=function(e){var t=this.processIncomingBoardData(e);this.canvas.drawEntireBoard(t),this.boards.setCurrentBoardCommands(t)}.bind(this),this.onAdditionalBoardData=function(e){var t=this.processIncomingBoardData(e);this.canvas.drawOntoBoard(t),this.boards.appendCommandsToCurrentBoard(t)}.bind(this),this.saveTimers=[],this.startSaveCountDown=function(e){this.clearExistingTimers(),this.createNewSaveTimer()}.bind(this),this.clearExistingTimers=function(){if(this.saveTimers.length>0){for(var e=0;e<this.saveTimers.length;e++)clearTimeout(this.saveTimers[e]);this.saveTimers=[]}}.bind(this),this.createNewSaveTimer=function(e){var t=this,n=setTimeout(function(){t.possiblySaveState(),e&&"function"==typeof e&&e(!0)},t.SAVING_DELAY);this.saveTimers.push(n)}.bind(this),this.trashCurrentBoard=function(){try{this.spinnerVisible(!0);var e=this.getCurrentBoardId(),t=this.selectedClassmateId;this.possiblySaveState(),this.remoteService.trashBoard(e,t)}catch(e){console.log(e.message)}}.bind(this),this.onBoardTrashed=function(e){var t=JSON.parse(e).boardId,n=this.selectedClassmateId;this.remoteService.getSharedBoards(n),this.recentlyTrashedBoards.push(t)}.bind(this),this.undoTrashBoard=function(){if(this.recentlyTrashedBoards().length<=0)throw new Error("Cannot undo because there is no recently trashed boards.");this.possiblySaveState();var e=this.recentlyTrashedBoards.pop(),t=this.selectedClassmateId;this.remoteService.undoTrashBoard(e,t)},this.onTrashBoardUndone=function(){var e=this.selectedClassmateId;this.remoteService.getSharedBoards(e)}.bind(this),this.onFriendRestoredBoard=function(e){this.validateBoardUpdateInfo(e);var t=e.friendId;t==this.selectedClassmateId&&this.remoteService.getSharedBoards(t)}.bind(this),this.onFriendTrashedBoard=function(e){var t=JSON.parse(e);this.validateBoardUpdateInfo(t);var n=this.selectedClassmateId,i=this.getCurrentBoardId();if(t.friendId==n&&i==t.boardId){this.remoteService.getSharedBoards(n),this.isTrashedMessageVisible(!0);var s=this;setTimeout(function(){s.isTrashedMessageVisible(!1)},3e3)}}.bind(this),this.validateBoardUpdateInfo=function(e){if(!e||"object"!=typeof e||isNaN(e.friendId)||e.friendId<1)throw new Error("Invalid trash board command,  friendId is required.");if(!e.boardId||isNaN(e.boardId)||e.boardId<1)throw new Error("boardId must be a positive integer.")},this.onFriendToolUpdated=function(e){e.friendId==this.selectedClassmateId&&(this._friendsCurrentTool=e.currentTool)}.bind(this),this.onAuth=function(e){"authenticated"==e.state&&(this.remoteService.initialize(),this.canvas.initialize(),this.remoteService.registerGetSharedBoardsCallback(this.onSharedBoardsReceived),this.remoteService.registerOnNextBoardRecievedCallback(this.onNextBoardRecieved),this.remoteService.registerOnPreviousBoardRecievedCallback(this.onPreviousBoardRecieved),this.remoteService.registerOnSaveCallback(this.onCurrentBoardSaved),this.remoteService.registerOnBoardTrashedCallback(this.onBoardTrashed),this.remoteService.registerOnFriendTrashedBoard(this.onFriendTrashedBoard),this.remoteService.registerOnTrashBoardUndone(this.onTrashBoardUndone),this.remoteService.registerOnFriendRestoredBoard(this.onFriendRestoredBoard),this.remoteService.attachFriendJoinedBlackboardHandler(this.onFriendToolUpdated),this.remoteService.attachOnFriendCursorPositionReceivedHandler(this.onFriendsCursorPositionReceived),this.remoteService.attachOnFriendPencilPositionCallback(this.onFriendPencilPositionReceived),this.remoteService.attachFriendsPencilLineUpdateHandler(this.onFriendPencilLineReceived),this.remoteService.attachOnFriendsEraserPositionUpdateCallback(this.onFriendsEraserPositionReceived),this.remoteService.attachFriendsEraserDownCallback(this.onFriendsEraserDown),this.setPencilTool())},this.onAuth=this.onAuth.bind(this),this.dis.reg("authState",this.onAuth),this.onCurrentBoardSaved=function(){console.log("Current board saved.")},this.onCurrentBoardSaved=this.onCurrentBoardSaved.bind(this),this.prevArrowClicked=function(){this.possiblySaveState(),this.spinnerVisible(!0);var e=this.getCurrentBoardId(),t=this.selectedClassmateId;this.remoteService.getPreviousBoard(e,t)},this.nextArrowClicked=function(){this.possiblySaveState(),this.spinnerVisible(!0);var e=this.getCurrentBoardId(),t=this.selectedClassmateId;this.remoteService.getNextBoard(e,t)}.bind(this),this.possiblySaveState=function(){if(this.boards.isNotEmpty()&&this.boards.isCurrentBoardDirty()){var e=this.boards.getSerializedCurrentBoard();this.remoteService.saveCurrentBoard(e)}}.bind(this),this.onFriendAddedNewBoard=function(e){this.boards.contains(e)||this.boards.appendBoard(e)}.bind(this),this.dis.reg("friendAddedNewBoard",this.onFriendAddedNewBoard),this.onNextBoardRecieved=function(e){var t=JSON.parse(e);this.boards.contains(t)?this.boards.setCurrentBoardById(t.board_id):(this.boards.appendBoard(t),this.boards.setIndexToLastBoard());var n=this.boards.getCurrentBoardDeepCopy();if(n.getLastModifiedMillis()>new Date(t.last_loaded).getTime()){var i=n.getCommands();this.canvas.drawEntireBoard(i);var s=this.onAdditionalBoardData,r=n.getId();this.remoteService.getAdditionalBoardData(r,s)}else this.remoteService.getBoardData(n.getId(),this.onBoardDataReceived);this.prevArrowVisible(!0)}.bind(this),this.onPreviousBoardRecieved=function(e){var t=JSON.parse(e);if(2!=t.length||isNaN(t[1].board_id))throw new Error("onPreviousBoardRecieved() expects JSON array of length 2 as input.");if(this.boards.isEmpty())throw new Error("Can't set previous board without its reference existing somewhere in the board set.");-1==t[0].board_id&&-1!=t[1].board_id&&this.prevArrowVisible(!1),this.boards.setCurrentBoardById(t[1].board_id);var n=this.getCurrentBoardId();this.remoteService.getBoardData(n,this.onBoardDataReceived)}.bind(this)},template:n}}),define("text!auth/template.html",[],function(){return'<link rel="stylesheet" href="./styles/components/auth/style.css?v=1.4"></link>\n\n\n<div id="auth-holder" data-bind="visible:isVisible()">\n\n  <img  id="logo"\n        src="./styles/components/auth/logo.png" >\n\n    <div class="landing-page-background-image">\n    </div>\n          <img id=\'student-graph\'\n               src=\'./assets/graph.png\'></img>\n\n    <div id="signup-holder" data-bind="visible:signupPageVisible()">\n      <div class="input-holder" data-bind="visible: !activationEmailSent()">\n      <div style="position:relative">\n        <input class="auth-input" placeholder="First name" id="firstName" type="text"\n               data-bind="textInput:firstName, enterKey: signUp, hasFocus:invokeSignupFormEndowment"/>\n        <span data-bind="visible: isFirstNameValid()"  class="auth-check-mark glyphicon glyphicon-ok"></span>\n      </div>\n\n      <div id="last-name-holder" style="position:relative;">\n        <input class="auth-input" placeholder="Last name" id="lastName" type="text" data-bind="textInput:lastName, enterKey: signUp"/>\n        <span data-bind="visible: isLastNameValid()"  class="auth-check-mark glyphicon glyphicon-ok"></span>\n      </div>\n\n\n\n      <div style="position:relative;">\n\n        <input class="auth-input"\n               autocorrect="off"\n               autocapitalize="none"\n               autofocus placeholder="Email"\n               id="signup-email"\n               type="text"\n               data-bind="textInput:email, enterKey: signUp"/>\n\n\n        <span data-bind="visible: isEmailValid()"\n              class="auth-check-mark glyphicon glyphicon-ok">\n        </span>\n\n      </div>\n\n      <div style="position:relative;">\n        <input class="auth-input"\n               placeholder="Password"\n               id="password-signup"\n               type="password"\n               data-bind="textInput:password ,enterKey: signUp" />\n\n        \x3c!-- Quick Feedback --\x3e\n        <span data-bind="visible: isPasswordValid()"\n              class="auth-check-mark glyphicon glyphicon-ok">\n\n        </span>\n        <span id="signup-password-caution-mark"\n              data-bind="visible: !isPasswordValid() && password().length > 0">\n\n                  <div id="signup-password-callout"\n                       class="callout">\n\n                      <b id="signup-password-error-msg"\n                         class="callout-msg"\n                         data-bind="text:invalidPasswordMessage">\n\n                      </b>\n                      <b class="notch">\n                      </b>\n                  </div>\n        </span>\n      </div>\n\n      <button id="signup-btn"\n              class="auth-btn"\n              data-bind="click:signUp">\n              Signup</button>\n\n\n\n      <button\n            class="glyphicon glyphicon-menu-left back-to-login-page-button"\n            data-bind="click: goToLoginPage">\n      </button>\n\n\n      <div id="terms-and-conditions">By signing up you are agreeing to the\n          <a href="https://www.legal.palolo.ca/terms_and_conditions">\n            terms and conditions\n          </a>\n\n      </div>\n\n\n\n      </div>\n    </div>\n\n\n\n\n\x3c!-- Login Page  --\x3e\n\n        <div id="login-holder"\n             style="color:white"\n             data-bind="visible: loginPageVisible()">\n          <div class="input-holder">\n\n          <div style="position:relative;">\n\n\n\n\n\n\n            <input class="auth-input"\n                   autocorrect="off"\n                   autocapitalize="none"\n                   autofocus placeholder="Email"\n                   id="email"\n                   type="text"\n                   data-bind="textInput:email, enterKey: login"/>\n\n            <span data-bind="visible:  isEmailValid()"\n                  class="auth-check-mark glyphicon glyphicon-ok">\n            </span>\n\n\n\n\n          </div>\n\n          <div style="position:relative;">\n            <input class="auth-input"\n                   placeholder="Password"\n                   id="password-login"\n                   type="password"\n                   data-bind="textInput:password ,enterKey: login" />\n            <span data-bind="visible: isPasswordValid()"  class="auth-check-mark glyphicon glyphicon-ok"></span>\n\n            \x3c!--Quick feedback  --\x3e\n\n            <span id="login-password-caution-mark"\n                  data-bind="visible: !isPasswordValid() && password().length > 0"\n                  class="caution-mark glyphicon glyphicon-exclamation-sign">\n\n                      <div id="login-password-callout"\n                           class="callout">\n\n                          <b id="login-password-error-msg"\n                             class="callout-msg"\n                             data-bind="text:invalidPasswordMessage">\n\n                          </b>\n                          <b class="notch">\n                          </b>\n                      </div>\n            </span>\n\n          </div>\n\n          <button id="login-btn"\n                  class="auth-btn"\n                  data-bind="click:login"\n                  >Login</button>\n\n\n          <div id="or-signup">or</div>\n          <button\n                id="signup-button"\n                data-bind="click:goToSignupPage">\n          Signup\n          </button>\n          </div>\n\n\n        </div>\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n        <div id="signup-spinner"\n             class="middelize"\n             data-bind=visible:spinner()>\n            <div class="big-loader"></div>\n        </div>\n\n\n \x3c!-- Activation Email Sent!  --\x3e\n        <div id="email-sent-page"\n             data-bind="visible: activationEmailSentPageVisible()"\n             class="middelize">\n\n          <div id="activation-email-sent-msg">\n            Activation email sent.\n          </div>\n          <div id="activation-email-sent-instructions">\n            Please check your email to complete\n            your account activation.\n          </div>\n        </div>\n\n\n\n\n        \x3c!-- Password reset stuff. --\x3e\n        <div data-bind="visible:errorMessage().length > 0">\n              <div class="error-msg"\n                   data-bind="text:errorMessage">\n              </div>\n              <div class="auth-clickable"\n                   data-bind="click:goToPasswordResetState">\n                   reset password\n                </div>\n        </div>\n\n\n\n\n        \x3c!-- Password Reset Page --\x3e\n\n            <div id="password-reset-holder"\n                  style="color:white"\n                  data-bind="visible:resetPasswordVisible()">\n\n              <div class="input-holder">\n              <div style="position:relative;">\n                <input class="auth-input"\n                       autocorrect="off"\n                       autocapitalize="none"\n                       autofocus placeholder="Email"\n                       id="reset-email"\n                       type="text"\n                       data-bind="textInput:email"/>\n\n                <span data-bind="visible:  isEmailValid()"\n                      class="auth-check-mark glyphicon glyphicon-ok">\n                </span>\n              </div>\n\n\n\n              <button id="send-reset-email-btn"\n                      class="auth-btn"\n                      data-bind="click:submitResetEmail"\n                      >Submit</button>\n\n              <button\n                    id="password-reset-page-back-button"\n                    class="glyphicon glyphicon-menu-left back-to-login-page-button"\n                    data-bind="click:goToLoginPage"\n                    data-toggle="tooltip"\n                    title="Back">\n              </button>\n              </div>\n              <div class="error-msg"\n                   data-bind="text:malformedEmailError">\n              </div>\n            </div>\n\n\n            \x3c!--  Email Sent! --\x3e\n            <div\n                 data-bind="visible: resetPasswordEmailSentPageVisible()"\n                 class="middelize">\n\n              <div id="activation-email-sent-msg">\n                Reset email sent.\n              </div>\n              <div id="activation-email-sent-instructions">\n                Check your email to complete\n                resetting your password.\n              </div>\n            </div>\n\n\n\n\n            \x3c!-- <div id="conformity-banner"> Over 250 registered York Students.</div> --\x3e\n            <div id=\'affilation\'>Not affiliated with York University</div>\n    </div>\n\n</div>\n'}),define("auth/AuthRemoteService",["ActiveRemoteService"],function(e){var t=function(){Object.setPrototypeOf(this,new e),this.constructor=t,this.constructor.name="AuthRemoteService",this.getConstructorName=function(){return"AuthRemoteService"},this.setMicroServer("auth"),this.setPath("Auth.php"),this.setPort(""),this.checkIfCurrentTokenIsValid=function(){var e=this.getAccessToken();if("function"!=typeof this.onTokenAnalyzed)throw new Error("Callback has not been set.");e&&"null"!=e||this.onTokenAnalyzed(!1);var t=this.getServerURL();$.ajax({type:"POST",url:t,withCredentials:!0,data:{action:"verifyToken",token:e},success:this.onTokenAnalyzed,error:function(e){console.log(e)}})},this.registerOnTokenVerified=function(e){if("function"!=typeof e)throw new Error("callback must be function.");this.onTokenAnalyzed=e}};return t}),define("auth/states/AuthState",[],function(){return function AuthState(e){if(!e)throw new Error("context must be injected into authstate, but it is undefined");if(!e.triggerUpdate)throw new Error("context needs triggerUpdate function");this.activationEmailSent=!1,this.authServer=null,this.context=e,this.email="",this.errorMessage="",this.localErrorMessage={passwordError:"",wrongEmail:""},this.firstName="",this.MIN_PASSWORD_LENGTH=8,this.isVisible=!0,this.isEmailValid=!1,this.isPasswordValid=!1,this.lastName="",this.password="",this.spinner=!1,this.endowSignupForm=!1,this.getConstructorName=function(){throw new Error("getConstructorName must be implemented in a subclass.")},this.validateRemoteService=function(e){if(!e||"AuthRemoteService"!=e.getConstructorName())throw new Error("AuthRemoteService must be injected.")},this.signUp=function(){throw new Error("cant signup when your not on the signup screen")},this.login=function(){throw new Error("cant execute abstract login function")},this.submitResetEmail=function(){throw new Error("cant execute abstract submitResetEmail function")},this.isFirstNameValid=!1,this.validateEmail=function(e){var t=/^([a-zA-Z0-9_\.\-])+\@(([a-zA-Z0-9\-])+\.)+([a-zA-Z0-9]{2,4})+\s*$/.test(e),n=/.*yorku\.ca/.test(e);this.isEmailValid=0!=t&&0!=n},this.validateEmail=this.validateEmail.bind(this),this.setEmail=function(e){this.validateEmail(e),this.email=e},this.validatePassword=function(e){var t=this;return function(n){n.length<t.MIN_PASSWORD_LENGTH?e("Password is too short."):/[a-zA-Z]/.test(n)?/\d/.test(n)?/\s/.test(n)?e("Password can't have any spaces."):e("success"):e("Password must have at least one number."):e("Password must have at least 1 letter.")}},this.validatePassword=this.validatePassword.bind(this),this.passwordValidateCallback=function(e){"success"==e?this.isPasswordValid=!0:(this.isPasswordValid=!1,this.localErrorMessage.passwordError=e)},this.passwordValidateCallback=this.passwordValidateCallback.bind(this),this.setPassword=function(e){this.validatePassword(this.passwordValidateCallback)(e),this.password=e},this.setNextState=function(e){if("AuthState"!==Object.getPrototypeOf(e).constructor.name)throw new Error("State must be a decendant of AuthState");this._nextState=e},this.goToNextState=function(){}}}),
/**
 * @license Proprietary - Please do not steal our hard work.
 * @Author: Christopher H. Kerley
 * @Last modified time: 2019-08-24
 * @Copyright: Palolo Education Inc. 2020
 */
define("auth/states/SignupState",["auth/states/AuthState"],function(e){return function SignupState(t,n){Object.setPrototypeOf(this,new e(t)),this.validateRemoteService(n),this.isVisible=!0,this.endowSignupForm=!0,this.remoteService=n,this.constructor=SignupState,this.getConstructorName=function(){return"SignupState"},this.EXPECTED_SIGNUP_RESPONSE="Activation email sent.",this.nameRegex=/^[a-zA-Z]{2,}$/,this.activationEmailSent=!1,this.firstName="",this.isFirstNameValid=!1,this.lastName="",this.validateFirstName=function(e){var t=this.nameRegex.test(e);this.isFirstNameValid=!!t},this.validateFirstName=this.validateFirstName.bind(this),this.setFirstName=function(e){this.validateFirstName(e)},this.validateLastName=function(e){var t=this.nameRegex.test(e);this.isLastNameValid=!!t},this.validateLastName=this.validateLastName.bind(this),this.setLastName=function(e){this.validateLastName(e),this.lastName=e},this.signUp=function(){this.spinner=!0;var e={action:"createNewUser",first:this.firstName,last:this.lastName,email:this.email,password:this.password};$.ajax({type:"POST",url:this.remoteService.getServerURL(),crossDomain:!0,data:e,success:this.onSignupCallback}),this.context.triggerUpdate()},this.signUp=this.signUp.bind(this),this.onSignupCallback=function(e){this.spinner=!1;var t=JSON.parse(e);t===this.EXPECTED_SIGNUP_RESPONSE?this.activationEmailSent=!0:(this.activationEmailSent=!1,this.errorMessage=t),this.context.triggerUpdate()},this.onSignupCallback=this.onSignupCallback.bind(this)}}),
/**
 * @license Proprietary - Please do not steal our hard work.
 * @Author: Christopher H. Kerley
 * @Last modified time: 2019-08-24
 * @Copyright: Palolo Education Inc. 2020
 */
define("auth/states/LoginState",["auth/states/AuthState"],function(e){return function LoginState(t,n){Object.setPrototypeOf(this,new e(t)),this.validateRemoteService(n),this.remoteService=n,this.constructor=LoginState,this.getConstructorName=function(){return"LoginState"},this.isVisible=!0,this.login=function(){var e={action:"login",email:this.email,password:this.password};this.email="",this.password="",this.context.triggerUpdate(),$.ajax({type:"POST",url:this.remoteService.getServerURL(),withCredentials:!0,data:e,success:this.onLoginCallback,error:this.onLoginError})},this.login=this.login.bind(this),this.onLoginCallback=function(e){this.spinner=!1;try{this.context.onTokenAnalyzed(e),this.context.triggerUpdate()}catch(e){console.log(e)}},this.onLoginCallback=this.onLoginCallback.bind(this),this.onLoginError=function(e){this.spinner=!1,this.errorMessage=e.responseText,this.context.triggerUpdate()},this.onLoginError=this.onLoginError.bind(this)}}),
/**
 * @license Proprietary - Please do not steal our hard work.
 * @Author: Christopher H. Kerley
 * @Last modified time: 2019-08-24
 * @Copyright: Palolo Education Inc. 2020
 */
define("auth/states/SentResetEmailState",["auth/states/AuthState"],function(e){return function SentResetEmailState(t,n){Object.setPrototypeOf(this,new e(t)),this.validateRemoteService(n),this.remoteService=n,this.constructor=SentResetEmailState,this.getConstructorName=function(){return"SentResetEmailState"},this.isVisible=!0}}),
/**
 * @license Proprietary - Please do not steal our hard work.
 * @Author: Christopher H. Kerley
 * @Last modified time: 2019-08-24
 * @Copyright: Palolo Education Inc. 2020
 */
define("auth/states/ActivationEmailSentState",["auth/states/AuthState"],function(e){return function ActivationEmailSentState(t,n){Object.setPrototypeOf(this,new e(t)),this.validateRemoteService(n),this.remoteService=n,this.constructor=ActivationEmailSentState,this.getConstructorName=function(){return"ActivationEmailSentState"},this.isVisible=!0,this.activationEmailSent=!0}}),
/**
 * @license Proprietary - Please do not steal our hard work.
 * @Author: Christopher H. Kerley
 * @Last modified time: 2019-08-24
 * @Copyright: Palolo Education Inc. 2020
 */
define("auth/states/PasswordResetState",["auth/states/AuthState"],function(e){return function PasswordResetState(t,n){Object.setPrototypeOf(this,new e(t)),this.validateRemoteService(n),this.remoteService=n,this.constructor=PasswordResetState,this.getConstructorName=function(){return"PasswordResetState"},this.onResetPasswordCallback=function(e){var t=JSON.parse(e);console.log(t),"success"==t&&(this.spinner=!1,this.context.gotoSentResetEmailState())},this.onResetPasswordCallback=this.onResetPasswordCallback.bind(this),this.onResetPasswordError=function(e,t,n,i){this.spinner=!1,console.log(e.responseText),this.localErrorMessage.wrongEmail=e.responseText,this.context.triggerUpdate()},this.onResetPasswordError=this.onResetPasswordError.bind(this),this.submitResetEmail=function(){var e={action:"resetPassword",email:this.email};$.ajax({type:"POST",url:this.remoteService.getServerURL(),withCredentials:!0,data:e,success:this.onResetPasswordCallback,error:this.onResetPasswordError}),this.spinner=!0,this.context.triggerUpdate()}}}),define("auth/StateBuilder",["auth/states/SignupState","auth/states/LoginState","auth/states/SentResetEmailState","auth/states/ActivationEmailSentState","auth/states/PasswordResetState"],function(e,t,n,i,s){return function(r,o){if(!r||!o)throw new Error("Both remoteService and viewModel must be injected.");this._context=o,this.states=[],this.getContext=function(){return this._context},this.getState=function(e){for(var t=0;t<this.states.length;t++)if(this.states[t].constructor.name==e)return this.states[t];return null},this.buildInitialState=function(e){return this.buildLoginState(e)},this.build=function(t,o){var a=this.getState(t);if(a)return a;switch(t){case"LoginState":return t=this.buildLoginState(o),this.states.push(t),t;case"SignupState":return t=new e(o,r),this.states.push(t),t;case"ActivationEmailSentState":return t=new i(o,r),this.states.push(t),t;case"PasswordResetState":return t=new s(o,r),this.states.push(t),t;case"SentResetEmailState":return t=new n(o,r),this.states.push(t),t;default:return this.buildLoginState(o)}},this.buildLoginState=function(e){var n=new t(e,r);return this.states.push(n),n},this.setNextStateOf=function(e,t){e.setNextState(t)},this.goToNextState=function(){}}}),
/**
 * @license Proprietary - Please do not steal our hard work.
 * @Author: Christopher H. Kerley
 * @Last modified time: 2019-08-24
 * @Copyright: Palolo Education Inc. 2020
 */
define("auth/AuthViewModel",["jquery","ko","dispatcher/Dispatcher","text!auth/template.html","auth/AuthRemoteService","auth/StateBuilder"],function(e,t,n,i,s,r){return{viewModel:function AuthViewModel(e,i){this.isVisible=t.observable(!1).extend({notify:"always"}),this.authState=t.observable("anonymous"),this.dis=new n,this._remoteService=new s,this.stateBuilder=new r(this._remoteService,this),this.errorTimeout=8e3,this._userId=-1,this.setUserId=function(e){if(!e||isNaN(e)||e<1)throw new Error("id must be a postive integer.");this._userId=e}.bind(this),this.dispatchAuth=function(e){"authenticated"===e&&this.dis.dispatch("authState",{id:this._userId,state:e})}.bind(this),this.authStateSubscription=this.authState.subscribe(this.dispatchAuth),this.onLogout=function(e){this._remoteService.deleteToken(),e||location.reload()}.bind(this),this.dis.reg("logout",this.onLogout),this.triggerUpdate=function(){this.state.valueHasMutated()},this.triggerUpdate=this.triggerUpdate.bind(this);var o=this.stateBuilder.buildInitialState(this);this.state=t.observable(o),this.activationEmailSent=t.computed(function(){var e=this.state().activationEmailSent;return e&&this.goToActivationEmailSentPage(),e},this).extend({notify:"always"}),this.onTokenAnalyzed=function(e){try{var t=JSON.parse(e);if(t&&!1!==Array.isArray(t)){var n=t[0];this.setUserId(n);var i=t[1];this._remoteService.setAccessToken(i),this.authState("authenticated"),this.isVisible(!1)}else this.isVisible(!0),this._remoteService.deleteToken(),this.authState("anonymous")}catch(e){console.log(e)}},this.onTokenAnalyzed=this.onTokenAnalyzed.bind(this),this.email=t.computed({read:function(){return this.state().email},write:function(e){this.state().setEmail(e),this.state.valueHasMutated()},owner:this}).extend({notify:"always"}),this.errorMessage=t.computed({read:function(){return this.state().errorMessage},write:function(e){this.state().errorMessage=e},owner:this}).extend({notify:"always"}),this.timerDone=!0,this.clearErrorCallback=function(){this.errorMessage(""),this.triggerUpdate(),this.timerDone=!0},this.clearErrorCallback=this.clearErrorCallback.bind(this),this.errorSubscribeCallback=function(){this.timerDone&&(this.timerDone=!1,setTimeout(this.clearErrorCallback,this.errorTimeout))},this.errorSubscribeCallback=this.errorSubscribeCallback.bind(this),this.errorMessage.subscribe(this.errorSubscribeCallback),this.firstName=t.computed({read:function(){return this.state().firstName},write:function(e){this.state().firstName=e},owner:this}).extend({notify:"always"}),this.isEmailValid=t.computed({read:function(){return this.state().isEmailValid},write:function(e){this.state().isEmailValid=e},owner:this}),this.isFirstNameValid=t.computed(function(){return this.state().isFirstNameValid},this).extend({notify:"always"}),this.isLastNameValid=t.computed(function(){return this.state().isLastNameValid},this),this.lastName=t.computed({read:function(){return this.state().lastName},write:function(e){this.state().lastName=e}},this).extend({notify:"always"}),this.login=function(){this.state().login()},this.loginPageVisible=t.computed({read:function(){return"LoginState"==this.state().getConstructorName()&&0==this.activationEmailSent()},write:function(e){},owner:this}).extend({notify:"always"}),this.resetPasswordVisible=t.computed({read:function(){return"PasswordResetState"==this.state().constructor.name},write:function(e){},owner:this}).extend({notify:"always"}),this.resetPasswordEmailSentPageVisible=t.computed({read:function(){return"SentResetEmailState"==this.state().constructor.name},write:function(e){},owner:this}).extend({notify:"always"}),this.password=t.computed({read:function(){return this.state().password},write:function(e){this.state().setPassword(e),this.state.valueHasMutated()},owner:this}),this.signUp=function(){this.state().signUp()},this.signupPageVisible=t.computed(function(){return"SignupState"==this.state().constructor.name},this),this.injectSignupPageCallback=function(e){this.signupPageVisible.subscribe(e)},this.submitResetEmail=function(){this.state().submitResetEmail()},this.spinner=t.computed(function(){return this.state().spinner},this),this.activationEmailSentPageVisible=t.computed(function(){return"ActivationEmailSentState"==this.state().constructor.name},this),this.isPasswordValid=t.computed(function(){return this.state().isPasswordValid},this).extend({notify:"always"}),this.invalidPasswordMessage=t.computed(function(){return this.state().localErrorMessage.passwordError},this).extend({notify:"always"}),this.malformedEmailError=t.computed(function(){return this.state().localErrorMessage.wrongEmail},this).extend({notify:"always"}),this.invokeSignupFormEndowment=t.computed(function(){return this.state().endowSignupForm},this),this.goToSignupPage=function(){this.state(this.stateBuilder.build("SignupState",this))},this.goToActivationEmailSentPage=function(){this.state(this.stateBuilder.build("ActivationEmailSentState",this))},this.goToLoginPage=function(){this.state(this.stateBuilder.build("LoginState",this))},this.goToPasswordResetState=function(){this.state(this.stateBuilder.build("PasswordResetState",this))},this.gotoSentResetEmailState=function(){this.state(this.stateBuilder.build("SentResetEmailState",this))},this._remoteService.registerOnTokenVerified(this.onTokenAnalyzed),this._remoteService.checkIfCurrentTokenIsValid()},template:i}}),define("text!environment/template.html",[],function(){return'\n\n<link rel="stylesheet"\n      href="./styles/components/environment/style.css">\n\n<div  id="connection-lost-alert"\n      data-bind="visible:showConnectionLost()">\n  <div>Internet Disconnected</div>\n</div>\n\n\n<div id="no-mobile-holder"\n     data-bind="visible:showDeviceNotSupportedMessage()">\n  <div id="no-mobile-message">\n    <div>Sorry this website is not mobile friendly.</div>\n    <img  id="no-mobile-math-joke"\n          src="https://i.pinimg.com/originals/6f/a2/b3/6fa2b37c7165c9cdc061b6b1f599f543.jpg">\n    </img>\n    <div id="desktop-laptop-prompt">\n          Please try again on your laptop or desktop computer.\n    </div>\n  </div>\n</div>\n'}),
/**
 * @license Proprietary - Please do not steal our hard work.
 * @Author: Christopher H. Kerley
 * @Last modified time: 2019-08-24
 * @Copyright: Palolo Education Inc. 2020
 */
define("environment/Component",["ko","dispatcher/Dispatcher","text!environment/template.html"],function(e,t,n){return{viewModel:function InternetHeartBeatViewModel(n,i){this.dis=new t,this.showConnectionLost=e.observable(!1),this.showDeviceNotSupportedMessage=e.observable(!1),this.MIN_WIDTH=500,this.onAuthUpdate=function(e){"authenticated"==e.state&&(this.isSupportedDevice(),this.showDeviceNotSupportedMessage(!1))}.bind(this),this.authStateId=this.dis.reg("authState",this.onAuthUpdate),this.onOffline=function(){this.showConnectionLost(!0)},this.onOffline=this.onOffline.bind(this),window.addEventListener("offline",this.onOffline),this.onOnline=function(){this.showConnectionLost(!1)},this.onOnline=this.onOnline.bind(this),window.addEventListener("online",this.onOnline),this.getWindowWidth=function(){return window.innerWidth},this.isSupportedDevice=function(){var e=navigator.userAgent,t=this.getWindowWidth();return!(e.match(/iPod/i)||t<this.MIN_WIDTH)}},template:n}}),define("text!search/template.html",[],function(){return'<link rel="stylesheet"\n      href="./styles/components/search/style.css?v=2.3">\n</link>\n\n<div id="search-bar-holder"\n     data-bind="visible:isVisible()">\n\n     <div class="search-holder">\n\n\n         <input class="search-bar"\n                type="text"\n                autoComplete="off"\n                placeholder="Search people or courses"\n                data-bind="textInput:query">\n         </input>\n\n         \x3c!-- spinner --\x3e\n         <span  id="pal-list-spinner"\n                 data-bind="visible:isSpinnerVisible()">\n           <div  class="screen-center-outer">\n            <div class="screen-center-inner">\n               <div class="small-spinner">\n               </div>\n            </div>\n          </div>\n         </span>\n\n         <button type="button"\n                 id="search-button"\n                 class="btn search-button">\n            <span class="glyphicon glyphicon-search">\n            </span>\n          </button>\n\n          <div class=\'search-result-header\' data-bind="visible:coursesFound().length > 0"> Courses </div>\n         <ul class="course-code-search-results"\n             data-bind="visible:coursesFound().length > 0,\n                        foreach:coursesFound">\n\n           <li class="course-code-search-result"\n               data-bind="click:$parent.selectCourse">\n               <span data-bind="text:course_code + \' Section \' + section_letter + \' - \' + description + \' - \' + first + \' \' + last"></span>\n           </li>\n         </ul>\n\n         <div class=\'search-result-header\' data-bind="visible:peopleFound().length > 0"> People </div>\n         <ul class="course-code-search-results"\n             data-bind="visible:peopleFound().length > 0,\n                        foreach:peopleFound">\n\n           <li class="course-code-search-result"\n               data-bind="click:$parent.selectPerson">\n               <img class=\'person-result-img\' data-bind=\'attr:{src:getSmallPhotoURL()}\'></img>\n               <span data-bind="text:getFirst() + \' \' + getLast()"></span>\n               <span class=\'role\' data-bind=\'text:getRole()\'>\n           </li>\n         </ul>\n\n\n\n         \x3c!-- <div id="recent-search-holder"\n              data-bind="visible:recentSearches().length > 0">\n           <div style="width:fit-content;">\n             <div id="recent-searches-title">\n               Recent Searches\n             </div>\n             <ul class="course-code-search-results"\n                 data-bind="foreach:recentSearches, complementClick:clearHistoryResults">\n               <li class="course-code-search-result"\n                   data-bind="click:$parent.selectCourse">\n                   <div data-bind="text:course_code + \' \' + section_letter + \' \' + description, "></div>\n               </li>\n             </ul>\n         </div> --\x3e\n\n         </div>\n\n\n         <div  id="search-match-message"\n               data-bind="visible:peopleFound().length == 0 && coursesFound().length == 0 && query().length > 2">\n               No matches found.\n         </div>\n\n\n     </div>\n\n\n\n</div>\n'}),define("people-models/Stranger",["people-models/Person"],function(e){var t=function(n,i){Object.setPrototypeOf(this,new e(n,i)),this.constructor=t,this.getConstructorName=function(){return"Stranger"},this.isAddable=function(){return!0}};return t.getRaw=function(){return e.getRaw()},t.getFake=function(){var n=e.getRaw();return new t(n,"host")},t}),define("search/SearchRemoteService",["ActiveRemoteService","dispatcher/Dispatcher","people-models/PersonCollection","people-models/Person","people-models/Stranger"],function(e,t,n,i,s){var r=function(){this.constructor=r,Object.setPrototypeOf(this,new e),this.setMicroServer("search"),this.dis=new t,this.onSelectedGroupId=function(e){var t=this.getServerURL()+"/selectedCourse";$.ajax({url:t,type:"post",data:{courseId:e},beforeSend:this.setAuthorizationHeader,success:function(){console.log("updated course.")},error:this.onError})}.bind(this),this.dis.reg("selectedGroupId",this.onSelectedGroupId),this.onQueryCourse=function(e){var t=e.query,n=e.grpId,i=this.getServerURL()+"/queryCourse?query="+t+"&grpId="+n;$.ajax({url:i,type:"get",beforeSend:this.setAuthorizationHeader,success:this.onCoursesFound,error:this.onError})}.bind(this),this.queryCourseId=this.dis.reg("queryCourse",this.onQueryCourse),this.onCoursesFound=function(e){this.dis.dispatch("coursesFound",e)}.bind(this),this.onQueryName=function(e){var t=this.getServerURL()+"/queryName?query="+e;$.ajax({url:t,type:"get",beforeSend:this.setAuthorizationHeader,success:this.onPeopleFound,error:this.onError})}.bind(this),this.queryNameId=this.dis.reg("queryName",this.onQueryName),this.onPeopleFound=function(e){for(var t=new n,i=this.getServerURL(),r=0;r<e.length;r++){var o=new s(e[r],i);t.add(o)}this.dis.dispatch("peopleFound",t)}.bind(this),this.onError=function(e){console.log(e),alert("Sorry this feature is not working at the moment.")}.bind(this)};return r}),define("search/SearchStore",["dispatcher/Dispatcher","abstract-interfaces/Store","search/SearchRemoteService","people-models/PersonCollection"],function(e,t,n,i){var s=null,r=function(){new n,Object.setPrototypeOf(this,new t),this.dis=new e,this.visible=!1,this.peopleFound=new i,this.currentGroup=null,this.coursesFound=[],this.onClearResults=function(){this.coursesFound=[],this.peopleFound=new i,this.pub()}.bind(this),this.dis.reg("clearResults",this.onClearResults),this.getCoursesFound=function(){return this.coursesFound},this.onCoursesFound=function(e){this.coursesFound=e,this.pub()}.bind(this),this.dis.reg("coursesFound",this.onCoursesFound),this.getCurrentGroupId=function(){return this.currentGroup?this.currentGroup.getId():null},this.onCourseGroup=function(e){e&&e.isGroup&&e.isGroup()&&(this.currentGroup=e)}.bind(this),this.dis.reg("groupInfo",this.onCourseGroup),this.onFocusPerson=function(){this.currentGroup=null,this.pub()}.bind(this),this.dis.reg("focusPerson",this.onFocusPerson),this.onClearPeopleFound=function(){this.peopleFound=null,this.pub()}.bind(this),this.clearPeopleId=this.dis.reg("clearPeopleFound",this.onClearPeopleFound),this.onPeopleFound=function(e){this.peopleFound=e,this.pub()}.bind(this),this.peopleFoundId=this.dis.reg("peopleFound",this.onPeopleFound),this.getPeopleFound=function(){return this.peopleFound?this.peopleFound.toArray():[]},this.isVisible=function(){return this.visible},this.setVisible=function(){this.visible=!0},this.onAuth=function(e){"authenticated"==e.state?this.visible=!0:this.visible=!1,this.pub()}.bind(this),this.dis.reg("authState",this.onAuth)};return{getInstance:function(){return s||(s=new r),s},getNew:function(){return new r}}}),define("search/Component",["ko","text!search/template.html","dispatcher/Dispatcher","search/SearchStore"],function(e,t,n,i){var s=3;return{viewModel:function ViewModel(t,r){this.dis=new n,this.store=i.getInstance(),this.query=e.observable(""),this.isSpinnerVisible=e.observable(!1),this.coursesFound=e.observableArray([]),this.peopleFound=e.observableArray([]),this.isVisible=e.observable(!1),this.onStore=function(){this.isVisible(this.store.isVisible()),this.coursesFound(this.store.getCoursesFound()),this.peopleFound(this.store.getPeopleFound())}.bind(this),this.store.sub(this.onStore),this.selectPerson=function(e,t){this.dis.dispatch("focusPerson",e),this.dis.dispatch("clearResults"),this.query("")}.bind(this),this.onTyping=function(e){if(e.length>=s){var t=this.store.getCurrentGroupId();this.dis.dispatch("queryCourse",{query:e,grpId:t}),this.dis.dispatch("queryName",e)}else e.length==s-1&&this.dis.dispatch("clearResults")}.bind(this),this.query.subscribe(this.onTyping),this.selectCourse=function(e){var t=e.group_id;this.dis.dispatch("selectedGroupId",t),this.clearResults()}.bind(this),this.clearResults=function(){this.query(""),this.dis.dispatch("clearResults")}.bind(this)},template:t}}),define("text!course-groups/template.html",[],function(){return"\n<link rel=\"stylesheet\" href=\"./styles/components/course-groups/style.css?v=2.1\"></link>\n\n  <div id=\"course-groups-holder\">\n\n      <div id='school-group-title'\n          data-bind='click:openNews,\n                     css: {\"selected-group\" : newsSelected() }'>\n                     YorkU News\n      </div>\n      \x3c!-- ko if:courses().length > 0 --\x3e\n\n      <div id='course-groups-title'>Course Groups</div>\n      <ul id='course-groups-list' data-bind='foreach:courses'>\n        <li class='course-group-li'\n            data-bind=\"attr:{title:getCourseDescription()},\n                       text:getDept() + getCourseCode() + getSectionLetter(),\n                       click:$parent.selectCourseGroup,\n                       css: { 'selected-group': $parent.currentCourseGroup() != null && $parent.currentCourseGroup().getId() == getId() }\">\n\n        </li>\n\n      </ul>\n      \x3c!-- /ko --\x3e\n  </div>\n"}),define("course-groups/GroupsStore",["dispatcher/Dispatcher","abstract-interfaces/Store","course/models/CourseGroup"],function(e,t,n){var i=null,s=function(){Object.setPrototypeOf(this,new t),this.dis=new e,this.groupViewVisible=!1,this.courseGroups=[],this.selectedGroup=null,this.newsSelected=!0,this.isNewsViewVisible=function(){return this.newsSelected},this.onGroupJoined=function(e){this.selectedGroup&&this.selectedGroup.getId()==e&&(this.courseGroups.push(this.selectedGroup),this.pub())}.bind(this),this.dis.reg("groupJoined",this.onGroupJoined),this.getSelectedGroup=function(){return this.selectedGroup},this.onGroupLeft=function(e){for(var t=-1,n=0;n<this.courseGroups.length;n++){if(this.courseGroups[n].getId()==e){t=n;break}}t>=0&&(this.courseGroups.splice(t,1),this.pub())}.bind(this),this.dis.reg("courseLeft",this.onGroupLeft),this.onOpenNews=function(){this.groupViewVisible=!1,this.newsSelected=!0,this.pub()}.bind(this),this.dis.reg("openNews",this.onOpenNews),this.isGroupViewVisible=function(){return this.groupViewVisible},this.onGroupInfo=function(e){this.selectedGroup=e,this.groupViewVisible=!0,this.newsSelected=!1,this.pub()}.bind(this),this.dis.reg("groupInfo",this.onGroupInfo),this.onFocusPerson=function(){this.groupViewVisible=!1,this.pub()}.bind(this),this.dis.reg("focusPerson",this.onFocusPerson),this.getMyCourseGroups=function(){return this.courseGroups},this.onMyCourseGroups=function(e){this.courseGroups=e,this.pub()}.bind(this),this.dis.reg("myCourseGroups",this.onMyCourseGroups)};return{getInstance:function(){return i||(i=new s),i},getNew:function(){return new s}}}),define("course-groups/Component",["ko","text!course-groups/template.html","dispatcher/Dispatcher","course-groups/GroupsStore","course/models/CourseGroup"],function(e,t,n,i,s){return{viewModel:function ViewModel(){this.dis=new n,this.store=i.getInstance(),this.courses=e.observableArray([]),this.newsSelected=e.observable(!1),this.currentCourseGroup=e.observable(null),this.onStore=function(){this.newsSelected(this.store.isNewsViewVisible()),this.courses(this.store.getMyCourseGroups()),!this.store.isGroupViewVisible()&&this.currentCourseGroup(null)}.bind(this),this.store.sub(this.onStore),this.openNews=function(){this.dis.dispatch("openNews")}.bind(this),this.selectCourseGroup=function(e){this.currentCourseGroup(e),e&&this.dis.dispatch("selectedGroupId",e.getId())}.bind(this)},template:t}}),define("text!new-pal-list/template.html",[],function(){return'<link rel="stylesheet" href="./styles/components/person-panel/new-pal-list.css?v=1">\n\n  <ul id="new-pal-list" data-bind="foreach:newPals">\n    <li class="pal-row"  data-bind="css:{\'pal-row-selected\':$parent.selectedPal() != null && $parent.selectedPal().getId() == getId() && $parent.selectedPal().getId() >=0}, click:$parent.palClicked">\n      <i\n           class="pal-list-notification"\n           data-bind="visible:isNew()">\n           <i class="arrow-left">\n           </i>\n           You have a new friend!\n       </i>\n\n       <span class="pal-presence">\n         <i class="pal-last-seen centerize"\n            data-bind="visible:isPresent() == false, text:getLastSeen()">\n         </i>\n         <i class="dot presence-dot centerize"\n            data-bind="visible:isPresent()">\n          </i>\n       </span>\n       <img class="pal-img"\n            data-bind="attr:{src: getSmallPhotoURL()}">\n       </img>\n       <span class="pal-name-holder">\n         <span class="pal-name"\n               data-bind="text:getFirst() + \' \' + getLast()">\n         </span>\n       </span>\n\n    </li>\n\n\n  </ul>\n'}),define("new-pal-list/Component",["ko","text!new-pal-list/template.html","dispatcher/Dispatcher","people-models/NullPerson","people-store/PeopleStore"],function(e,t,n,i,s){return{viewModel:function ViewModel(){this.dis=new n,this.store=s.getInstance(),this.newPals=e.observableArray([]),this.selectedPal=e.observable(null),this.onStore=function(){var e=this.store.getNewPals().toArray();this.newPals(e)}.bind(this),this.store.sub(this.onStore),this.palClicked=function(e){this.selectedPal(e),this.dis.dispatch("focusPerson",e)}.bind(this)},template:t}}),define("text!pal-list/template.html",[],function(){return'<link rel="stylesheet" href="./styles/components/person-panel/pal-list.css?v=3.1">\n<div id="pal-holder">\n  <span data-bind="visible:isSpinnerVisible()">\n    <div  class="screen-center-outer">\n     <div class="screen-center-inner">\n        <div class="small-spinner">\n        </div>\n     </div>\n   </div>\n  </span>\n  <div id="no-pals-message"\n        data-bind="visible:palCount() < 1">\n    No friends yet.\n    <div id="great-job">Great job! <span class="glyphicon glyphicon-thumbs-up"></span></div>\n  </div>\n      \x3c!-- ko if: selectedPal() != null --\x3e\n  <div id=\'pal-list-header\'>\n    <div>Friends</div>\n\n  </div>\n\n  <new-pal-list></new-pal-list>\n\n  <ul id="pal-list"\n      data-bind="foreach:pals">\n\n    <li class="pal-row"\n        data-bind="css:{\'pal-row-selected\':$parent.selectedPal().getId() == getId() && $parent.selectedPal().getId() >=0}, click:$parent.palClicked">\n\n      <span class="pal-presence">\n        <i class="pal-last-seen centerize"\n           data-bind="visible:isPresent() == false, text:getLastSeen()">\n        </i>\n        <i class="dot presence-dot centerize"\n           data-bind="visible:isPresent()">\n         </i>\n      </span>\n      <img class="pal-img"\n           data-bind="attr:{src: getSmallPhotoURL()}">\n      </img>\n      <span class="pal-name-holder">\n        <span class="pal-name"\n              data-bind="text:getFirst() + \' \' + getLast()">\n        </span>\n      </span>\n    </li>\n\n  </ul>\n        \x3c!-- /ko --\x3e\n</div>\n'}),define("pal-list/Component",["ko","text!pal-list/template.html","dispatcher/Dispatcher","people-models/Pal","people-store/PeopleStore"],function(e,t,n,i,s){return{viewModel:function ViewModel(){this.dis=new n,this.store=s.getInstance(),this.pals=e.observableArray([]),this.selectedPal=e.observable(null),this.palCount=e.observable(0),this.isSpinnerVisible=e.observable(!1),this.onStoreUpdate=function(){this.isSpinnerVisible(this.store.isSpinnerVisible()),this.palCount(this.store.getPalCount()),this.pals(this.store.getPalList().toArray()),this.selectedPal(this.store.getFocusedPerson())}.bind(this),this.store.sub(this.onStoreUpdate),this.palClicked=function(e){this.selectedPal(e),this.dis.dispatch("focusPerson",e)}.bind(this)},template:t}}),define("text!pal-request-list/template.html",[],function(){return'<link rel="stylesheet" href="./styles/components/person-panel/pal-request-list.css?v=1.0">\n<div id="pal-request-list-holder">\n    <ul data-bind="foreach:requests" id="pal-request-list">\n      <li class="pal-request-row">\n\n        <span>\n          <div class="pal-img-request-holder">\n            <img class="pal-img"\n                 data-bind="attr:{src: getSmallPhotoURL()}, click:$parent.faceClicked">\n            </img>\n          </div>\n\n          <span class="pal-request-name-holder">\n            <span class="pal-request-name"\n                  data-bind="text:getFirst() + \' \' + getLast()">\n            </span>\n          </span>\n\n          <div class="pal-request-title">\n              wants to be your friend.\n          </div>\n\n        </span>\n\n        <span class="pal-request-button-holder">\n            <div>\n              <button data-bind="click:$parent.acceptRequest">\n                  accept\n              </button>\n              <button data-bind="click:$parent.denyRequest">\n                  deny\n              </button>\n            </div>\n        </span>\n\n\n\n\n      </li>\n    </ul>\n</div>\n'}),define("pal-request-list/Component",["ko","text!pal-request-list/template.html","dispatcher/Dispatcher","people-models/Person","people-store/PeopleStore"],function(e,t,n,i,s){return{viewModel:function ViewModel(){this.dis=new n,this.store=s.getInstance(),this.requests=e.observableArray([]),this.onStoreUpdate=function(){var e=this.store.getPalRequests();this.requests(e)},this.onStoreUpdate=this.onStoreUpdate.bind(this),this.store.sub(this.onStoreUpdate),this.acceptRequest=function(e){this.dis.dispatch("acceptRequest",e)},this.acceptRequest=this.acceptRequest.bind(this),this.denyRequest=function(e){this.dis.dispatch("denyRequest",e)},this.denyRequest=this.denyRequest.bind(this),this.faceClicked=function(e){this.dis.dispatch("focusPerson",e)},this.faceClicked=this.faceClicked.bind(this)},template:t}}),define("text!people-popups/template.html",[],function(){return'\n<link rel="stylesheet"\n      href="./styles/components/person-panel/people-popups.css?v=2.1">\n\n<i id="pal-request-sent"\n   data-bind="visible:isPalRequestSentVisible()">\n  Friend request sent.\n</i>\n'}),
/**
 * @license Proprietary - Please do not steal our hard work.
 * @Author: Christopher H. Kerley
 * @Last modified time: 2019-08-24
 * @Copyright: Palolo Education Inc. 2020
 */
define("people-popups/Component",["ko","dispatcher/Dispatcher","text!people-popups/template.html","people-store/PeopleStore"],function(e,t,n,i){return{viewModel:function ViewModel(n,s){this.dis=new t,this.store=i.getInstance(),this.isPalRequestSentVisible=e.observable(!1),this.onStoreUpdated=function(){this.isPalRequestSentVisible(this.store.isPalRequestSent())},this.onStoreUpdated=this.onStoreUpdated.bind(this),this.store.sub(this.onStoreUpdated)},template:n}}),requirejs.config({paths:{stripe:"https://js.stripe.com/v3?noext","twilio-video":"https://media.twiliocdn.com/sdk/js/video/releases/2.4.0/twilio-video.min"}}),require(["stripe","twilio-video"],function(e){requirejs(["ko","enterKey","complementClick","sliderValue","RootViewModel"],function(e,t,n,i,s){e.applyBindings(new s)})}),define("/var/www/palolo/src/main.js",function(){});
